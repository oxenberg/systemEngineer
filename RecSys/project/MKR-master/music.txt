272    eval auc: 0.7650  acc: 0.6878    test auc: 0.7656  acc: 0.6887, time: 0.8070
epoch 19    train auc: 0.9341  acc: 0.8256    eval auc: 0.7655  acc: 0.6863    test auc: 0.7662  acc: 0.6880, time: 0.8160
epoch 20    train auc: 0.9339  acc: 0.8246    eval auc: 0.7626  acc: 0.6864    test auc: 0.7630  acc: 0.6870, time: 0.7990
epoch 21    train auc: 0.9360  acc: 0.8284    eval auc: 0.7612  acc: 0.6833    test auc: 0.7622  acc: 0.6831, time: 0.8160
epoch 22    train auc: 0.9351  acc: 0.8254    eval auc: 0.7612  acc: 0.6837    test auc: 0.7622  acc: 0.6834, time: 0.7890
epoch 23    train auc: 0.9338  acc: 0.8230    eval auc: 0.7600  acc: 0.6833    test auc: 0.7615  acc: 0.6819, time: 0.7870
epoch 24    train auc: 0.9345  acc: 0.8245    eval auc: 0.7615  acc: 0.6857    test auc: 0.7630  acc: 0.6850, time: 0.7940
epoch 25    train auc: 0.9336  acc: 0.8230    eval auc: 0.7604  acc: 0.6861    test auc: 0.7624  acc: 0.6857, time: 0.7730
epoch 26    train auc: 0.9368  acc: 0.8272    eval auc: 0.7594  acc: 0.6840    test auc: 0.7610  acc: 0.6843, time: 0.7990
epoch 27    train auc: 0.9379  acc: 0.8282    eval auc: 0.7598  acc: 0.6839    test auc: 0.7614  acc: 0.6847, time: 0.7950
epoch 28    train auc: 0.9402  acc: 0.8314    eval auc: 0.7602  acc: 0.6852    test auc: 0.7615  acc: 0.6849, time: 0.7730
epoch 29    train auc: 0.9435  acc: 0.8374    eval auc: 0.7599  acc: 0.6861    test auc: 0.7608  acc: 0.6827, time: 0.7680
epoch 30    train auc: 0.9451  acc: 0.8386    eval auc: 0.7602  acc: 0.6878    test auc: 0.7605  acc: 0.6853, time: 0.7890
epoch 31    train auc: 0.9478  acc: 0.8420    eval auc: 0.7586  acc: 0.6887    test auc: 0.7588  acc: 0.6847, time: 0.7710
epoch 32    train auc: 0.9495  acc: 0.8439    eval auc: 0.7576  acc: 0.6900    test auc: 0.7567  acc: 0.6857, time: 0.7790
epoch 33    train auc: 0.9519  acc: 0.8470    eval auc: 0.7571  acc: 0.6898    test auc: 0.7566  acc: 0.6850, time: 0.7630
epoch 34    train auc: 0.9525  acc: 0.8481    eval auc: 0.7564  acc: 0.6902    test auc: 0.7554  acc: 0.6856, time: 0.7720
epoch 35    train auc: 0.9543  acc: 0.8506    eval auc: 0.7558  acc: 0.6906    test auc: 0.7550  acc: 0.6865, time: 0.7640
epoch 36    train auc: 0.9555  acc: 0.8510    eval auc: 0.7557  acc: 0.6909    test auc: 0.7554  acc: 0.6879, time: 0.7509
epoch 37    train auc: 0.9561  acc: 0.8521    eval auc: 0.7555  acc: 0.6923    test auc: 0.7550  acc: 0.6904, time: 0.7500
epoch 38    train auc: 0.9567  acc: 0.8527    eval auc: 0.7554  acc: 0.6964    test auc: 0.7543  acc: 0.6919, time: 0.7630
epoch 39    train auc: 0.9583  acc: 0.8557    eval auc: 0.7538  acc: 0.6951    test auc: 0.7527  acc: 0.6926, time: 0.7450
epoch 40    train auc: 0.9595  acc: 0.8591    eval auc: 0.7538  acc: 0.7002    test auc: 0.7523  acc: 0.6957, time: 0.7490
epoch 41    train auc: 0.9589  acc: 0.8580    eval auc: 0.7551  acc: 0.7027    test auc: 0.7540  acc: 0.6991, time: 0.7500
epoch 42    train auc: 0.9599  acc: 0.8595    eval auc: 0.7541  acc: 0.7030    test auc: 0.7530  acc: 0.6994, time: 0.7420
epoch 43    train auc: 0.9612  acc: 0.8613    eval auc: 0.7536  acc: 0.7009    test auc: 0.7510  acc: 0.6980, time: 0.7490
epoch 44    train auc: 0.9610  acc: 0.8619    eval auc: 0.7544  acc: 0.7032    test auc: 0.7526  acc: 0.7006, time: 0.7710
epoch 45    train auc: 0.9631  acc: 0.8649    eval auc: 0.7522  acc: 0.7011    test auc: 0.7502  acc: 0.6964, time: 0.7530
epoch 46    train auc: 0.9632  acc: 0.8653    eval auc: 0.7523  acc: 0.7000    test auc: 0.7507  acc: 0.6987, time: 0.7480
epoch 47    train auc: 0.9648  acc: 0.8696    eval auc: 0.7512  acc: 0.6984    test auc: 0.7489  acc: 0.6974, time: 0.7439
epoch 48    train auc: 0.9663  acc: 0.8713    eval auc: 0.7502  acc: 0.6983    test auc: 0.7480  acc: 0.6961, time: 0.7320
epoch 49    train auc: 0.9660  acc: 0.8715    eval auc: 0.7518  acc: 0.6977    test auc: 0.7492  acc: 0.6943, time: 0.7380
avg time per epoch : 0.7909332752227783
--- 45.62600588798523 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:03:05.229646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:03:05.230011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4937  acc: 0.4978    eval auc: 0.4955  acc: 0.4956    test auc: 0.4943  acc: 0.4911, time: 1.1760
epoch 1    train auc: 0.5066  acc: 0.5086    eval auc: 0.4983  acc: 0.4956    test auc: 0.5032  acc: 0.5014, time: 0.7670
epoch 2    train auc: 0.5409  acc: 0.5232    eval auc: 0.4645  acc: 0.4836    test auc: 0.4795  acc: 0.4975, time: 0.7310
epoch 3    train auc: 0.5516  acc: 0.5307    eval auc: 0.4285  acc: 0.4501    test auc: 0.4338  acc: 0.4646, time: 0.7480
epoch 4    train auc: 0.5586  acc: 0.5394    eval auc: 0.4154  acc: 0.4408    test auc: 0.4200  acc: 0.4415, time: 0.7380
epoch 5    train auc: 0.5704  acc: 0.5476    eval auc: 0.4003  acc: 0.4280    test auc: 0.4024  acc: 0.4299, time: 0.7300
epoch 6    train auc: 0.5773  acc: 0.5511    eval auc: 0.3924  acc: 0.4217    test auc: 0.3949  acc: 0.4263, time: 0.7380
epoch 7    train auc: 0.5853  acc: 0.5543    eval auc: 0.3885  acc: 0.4185    test auc: 0.3889  acc: 0.4194, time: 0.7180
epoch 8    train auc: 0.5956  acc: 0.5566    eval auc: 0.3879  acc: 0.4169    test auc: 0.3881  acc: 0.4145, time: 0.7210
epoch 9    train auc: 0.6097  acc: 0.5569    eval auc: 0.3926  acc: 0.4182    test auc: 0.3913  acc: 0.4146, time: 0.7310
epoch 10    train auc: 0.6345  acc: 0.5594    eval auc: 0.4086  acc: 0.4246    test auc: 0.4071  acc: 0.4198, time: 0.7170
epoch 11    train auc: 0.6700  acc: 0.5826    eval auc: 0.4418  acc: 0.4545    test auc: 0.4399  acc: 0.4474, time: 0.7450
epoch 12    train auc: 0.7338  acc: 0.6483    eval auc: 0.5311  acc: 0.5371    test auc: 0.5339  acc: 0.5408, time: 0.7320
epoch 13    train auc: 0.7909  acc: 0.7110    eval auc: 0.6491  acc: 0.6070    test auc: 0.6510  acc: 0.6044, time: 0.7190
epoch 14    train auc: 0.8197  acc: 0.7131    eval auc: 0.7089  acc: 0.6073    test auc: 0.7146  acc: 0.6119, time: 0.7410
epoch 15    train auc: 0.8322  acc: 0.7162    eval auc: 0.7343  acc: 0.6155    test auc: 0.7415  acc: 0.6193, time: 0.7210
epoch 16    train auc: 0.8408  acc: 0.7216    eval auc: 0.7440  acc: 0.6186    test auc: 0.7507  acc: 0.6190, time: 0.7119
epoch 17    train auc: 0.8474  acc: 0.7287    eval auc: 0.7495  acc: 0.6252    test auc: 0.7558  acc: 0.6249, time: 0.7300
epoch 18    train auc: 0.8525  acc: 0.7364    eval auc: 0.7529  acc: 0.6312    test auc: 0.7591  acc: 0.6316, time: 0.7129
epoch 19    train auc: 0.8556  acc: 0.7402    eval auc: 0.7549  acc: 0.6347    test auc: 0.7607  acc: 0.6341, time: 0.7110
epoch 20    train auc: 0.8590  acc: 0.7445    eval auc: 0.7567  acc: 0.6375    test auc: 0.7622  acc: 0.6368, time: 0.7549
epoch 21    train auc: 0.8618  acc: 0.7499    eval auc: 0.7584  acc: 0.6426    test auc: 0.7638  acc: 0.6413, time: 0.7480
epoch 22    train auc: 0.8654  acc: 0.7548    eval auc: 0.7601  acc: 0.6479    test auc: 0.7652  acc: 0.6447, time: 0.7540
epoch 23    train auc: 0.8667  acc: 0.7558    eval auc: 0.7611  acc: 0.6494    test auc: 0.7658  acc: 0.6445, time: 0.7720
epoch 24    train auc: 0.8704  acc: 0.7620    eval auc: 0.7630  acc: 0.6551    test auc: 0.7676  acc: 0.6492, time: 0.7690
epoch 25    train auc: 0.8728  acc: 0.7663    eval auc: 0.7645  acc: 0.6596    test auc: 0.7689  acc: 0.6545, time: 0.7850
epoch 26    train auc: 0.8747  acc: 0.7663    eval auc: 0.7655  acc: 0.6580    test auc: 0.7697  acc: 0.6532, time: 0.7690
epoch 27    train auc: 0.8763  acc: 0.7682    eval auc: 0.7666  acc: 0.6608    test auc: 0.7707  acc: 0.6547, time: 0.7630
epoch 28    train auc: 0.8789  acc: 0.7712    eval auc: 0.7680  acc: 0.6649    test auc: 0.7721  acc: 0.6571, time: 0.7810
epoch 29    train auc: 0.8804  acc: 0.7730    eval auc: 0.7693  acc: 0.6676    test auc: 0.7735  acc: 0.6606, time: 0.7530
epoch 30    train auc: 0.8824  acc: 0.7753    eval auc: 0.7703  acc: 0.6671    test auc: 0.7745  acc: 0.6610, time: 0.7700
epoch 31    train auc: 0.8842  acc: 0.7769    eval auc: 0.7714  acc: 0.6716    test auc: 0.7756  acc: 0.6641, time: 0.7580
epoch 32    train auc: 0.8852  acc: 0.7779    eval auc: 0.7722  acc: 0.6723    test auc: 0.7764  acc: 0.6640, time: 0.7500
epoch 33    train auc: 0.8863  acc: 0.7787    eval auc: 0.7733  acc: 0.6741    test auc: 0.7777  acc: 0.6655, time: 0.8130
epoch 34    train auc: 0.8883  acc: 0.7818    eval auc: 0.7741  acc: 0.6784    test auc: 0.7785  acc: 0.6684, time: 0.8240
epoch 35    train auc: 0.8893  acc: 0.7813    eval auc: 0.7748  acc: 0.6782    test auc: 0.7794  acc: 0.6687, time: 0.8480
epoch 36    train auc: 0.8906  acc: 0.7819    eval auc: 0.7756  acc: 0.6775    test auc: 0.7803  acc: 0.6695, time: 0.8290
epoch 37    train auc: 0.8919  acc: 0.7835    eval auc: 0.7763  acc: 0.6794    test auc: 0.7810  acc: 0.6706, time: 0.8280
epoch 38    train auc: 0.8943  acc: 0.7866    eval auc: 0.7769  acc: 0.6882    test auc: 0.7816  acc: 0.6768, time: 0.8420
epoch 39    train auc: 0.8950  acc: 0.7863    eval auc: 0.7774  acc: 0.6864    test auc: 0.7823  acc: 0.6753, time: 0.8540
epoch 40    train auc: 0.8958  acc: 0.7868    eval auc: 0.7782  acc: 0.6861    test auc: 0.7831  acc: 0.6743, time: 0.8270
epoch 41    train auc: 0.8962  acc: 0.7865    eval auc: 0.7790  acc: 0.6870    test auc: 0.7841  acc: 0.6747, time: 0.9280
epoch 42    train auc: 0.8972  acc: 0.7874    eval auc: 0.7792  acc: 0.6863    test auc: 0.7843  acc: 0.6739, time: 0.9510
epoch 43    train auc: 0.8982  acc: 0.7892    eval auc: 0.7798  acc: 0.6887    test auc: 0.7849  acc: 0.6774, time: 0.8980
epoch 44    train auc: 0.8995  acc: 0.7902    eval auc: 0.7804  acc: 0.6928    test auc: 0.7854  acc: 0.6820, time: 0.9520
epoch 45    train auc: 0.9004  acc: 0.7913    eval auc: 0.7806  acc: 0.6912    test auc: 0.7857  acc: 0.6810, time: 0.9220
epoch 46    train auc: 0.9012  acc: 0.7923    eval auc: 0.7812  acc: 0.6921    test auc: 0.7862  acc: 0.6820, time: 0.9290
epoch 47    train auc: 0.9019  acc: 0.7925    eval auc: 0.7816  acc: 0.6923    test auc: 0.7866  acc: 0.6821, time: 0.9390
epoch 48    train auc: 0.9027  acc: 0.7937    eval auc: 0.7818  acc: 0.6921    test auc: 0.7867  acc: 0.6827, time: 0.9190
epoch 49    train auc: 0.9037  acc: 0.7947    eval auc: 0.7821  acc: 0.6952    test auc: 0.7870  acc: 0.6857, time: 0.9080
avg time per epoch : 0.7995175647735596
--- 46.12499952316284 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:03:51.517017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:03:51.517409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4944  acc: 0.5009    eval auc: 0.5132  acc: 0.4981    test auc: 0.5043  acc: 0.4988, time: 1.2610
epoch 1    train auc: 0.4863  acc: 0.4923    eval auc: 0.5144  acc: 0.5062    test auc: 0.5268  acc: 0.5169, time: 0.9330
epoch 2    train auc: 0.5344  acc: 0.5199    eval auc: 0.4529  acc: 0.4729    test auc: 0.4439  acc: 0.4675, time: 0.9290
epoch 3    train auc: 0.5776  acc: 0.5509    eval auc: 0.3895  acc: 0.4286    test auc: 0.3809  acc: 0.4186, time: 0.9180
epoch 4    train auc: 0.5829  acc: 0.5562    eval auc: 0.3809  acc: 0.4204    test auc: 0.3736  acc: 0.4111, time: 0.9270
epoch 5    train auc: 0.5896  acc: 0.5629    eval auc: 0.3722  acc: 0.4084    test auc: 0.3645  acc: 0.4030, time: 0.8390
epoch 6    train auc: 0.6857  acc: 0.6187    eval auc: 0.4873  acc: 0.4747    test auc: 0.4922  acc: 0.4780, time: 0.8410
epoch 7    train auc: 0.8734  acc: 0.7772    eval auc: 0.7508  acc: 0.7316    test auc: 0.7569  acc: 0.7337, time: 0.8480
epoch 8    train auc: 0.8969  acc: 0.8075    eval auc: 0.7695  acc: 0.7135    test auc: 0.7743  acc: 0.7150, time: 0.8320
epoch 9    train auc: 0.9104  acc: 0.8080    eval auc: 0.7831  acc: 0.7291    test auc: 0.7847  acc: 0.7294, time: 0.8450
epoch 10    train auc: 0.9189  acc: 0.8168    eval auc: 0.7776  acc: 0.7139    test auc: 0.7779  acc: 0.7166, time: 0.8160
epoch 11    train auc: 0.9245  acc: 0.8234    eval auc: 0.7790  acc: 0.7081    test auc: 0.7786  acc: 0.7135, time: 0.8360
epoch 12    train auc: 0.9294  acc: 0.8290    eval auc: 0.7715  acc: 0.7017    test auc: 0.7701  acc: 0.7011, time: 0.8490
epoch 13    train auc: 0.9323  acc: 0.8327    eval auc: 0.7769  acc: 0.7048    test auc: 0.7760  acc: 0.7061, time: 0.8230
epoch 14    train auc: 0.9363  acc: 0.8379    eval auc: 0.7693  acc: 0.6958    test auc: 0.7685  acc: 0.6951, time: 0.8280
epoch 15    train auc: 0.9386  acc: 0.8376    eval auc: 0.7696  acc: 0.6988    test auc: 0.7679  acc: 0.6948, time: 0.8580
epoch 16    train auc: 0.9413  acc: 0.8422    eval auc: 0.7686  acc: 0.6964    test auc: 0.7676  acc: 0.6956, time: 0.8239
epoch 17    train auc: 0.9439  acc: 0.8447    eval auc: 0.7664  acc: 0.6959    test auc: 0.7640  acc: 0.6912, time: 0.8380
epoch 18    train auc: 0.9467  acc: 0.8488    eval auc: 0.7667  acc: 0.6963    test auc: 0.7649  acc: 0.6934, time: 0.8370
epoch 19    train auc: 0.9492  acc: 0.8522    eval auc: 0.7663  acc: 0.6948    test auc: 0.7646  acc: 0.6942, time: 0.8270
epoch 20    train auc: 0.9534  acc: 0.8599    eval auc: 0.7604  acc: 0.6884    test auc: 0.7593  acc: 0.6919, time: 0.8470
epoch 21    train auc: 0.9565  acc: 0.8645    eval auc: 0.7571  acc: 0.6869    test auc: 0.7546  acc: 0.6883, time: 0.8310
epoch 22    train auc: 0.9609  acc: 0.8717    eval auc: 0.7555  acc: 0.6847    test auc: 0.7535  acc: 0.6886, time: 0.8320
epoch 23    train auc: 0.9646  acc: 0.8772    eval auc: 0.7524  acc: 0.6830    test auc: 0.7497  acc: 0.6849, time: 0.8290
epoch 24    train auc: 0.9685  acc: 0.8854    eval auc: 0.7552  acc: 0.6857    test auc: 0.7515  acc: 0.6882, time: 0.8300
epoch 25    train auc: 0.9717  acc: 0.8902    eval auc: 0.7482  acc: 0.6817    test auc: 0.7445  acc: 0.6793, time: 0.8040
epoch 26    train auc: 0.9744  acc: 0.8967    eval auc: 0.7442  acc: 0.6767    test auc: 0.7390  acc: 0.6759, time: 0.8170
epoch 27    train auc: 0.9775  acc: 0.9064    eval auc: 0.7479  acc: 0.6804    test auc: 0.7438  acc: 0.6827, time: 0.8290
epoch 28    train auc: 0.9794  acc: 0.9096    eval auc: 0.7460  acc: 0.6807    test auc: 0.7420  acc: 0.6789, time: 0.8240
epoch 29    train auc: 0.9815  acc: 0.9165    eval auc: 0.7445  acc: 0.6799    test auc: 0.7392  acc: 0.6772, time: 0.7970
epoch 30    train auc: 0.9828  acc: 0.9183    eval auc: 0.7411  acc: 0.6768    test auc: 0.7356  acc: 0.6739, time: 0.8190
epoch 31    train auc: 0.9846  acc: 0.9225    eval auc: 0.7380  acc: 0.6774    test auc: 0.7316  acc: 0.6712, time: 0.8000
epoch 32    train auc: 0.9853  acc: 0.9239    eval auc: 0.7425  acc: 0.6806    test auc: 0.7368  acc: 0.6776, time: 0.8000
epoch 33    train auc: 0.9868  acc: 0.9288    eval auc: 0.7371  acc: 0.6775    test auc: 0.7315  acc: 0.6747, time: 0.8080
epoch 34    train auc: 0.9876  acc: 0.9299    eval auc: 0.7341  acc: 0.6751    test auc: 0.7271  acc: 0.6671, time: 0.7969
epoch 35    train auc: 0.9888  acc: 0.9345    eval auc: 0.7330  acc: 0.6728    test auc: 0.7265  acc: 0.6668, time: 0.8020
epoch 36    train auc: 0.9894  acc: 0.9376    eval auc: 0.7336  acc: 0.6765    test auc: 0.7274  acc: 0.6691, time: 0.8040
epoch 37    train auc: 0.9901  acc: 0.9383    eval auc: 0.7310  acc: 0.6733    test auc: 0.7240  acc: 0.6671, time: 0.7809
epoch 38    train auc: 0.9906  acc: 0.9410    eval auc: 0.7340  acc: 0.6765    test auc: 0.7272  acc: 0.6704, time: 0.7890
epoch 39    train auc: 0.9912  acc: 0.9430    eval auc: 0.7311  acc: 0.6730    test auc: 0.7237  acc: 0.6682, time: 0.8050
epoch 40    train auc: 0.9913  acc: 0.9435    eval auc: 0.7320  acc: 0.6752    test auc: 0.7254  acc: 0.6706, time: 0.7830
epoch 41    train auc: 0.9919  acc: 0.9462    eval auc: 0.7308  acc: 0.6733    test auc: 0.7238  acc: 0.6668, time: 0.7690
epoch 42    train auc: 0.9922  acc: 0.9472    eval auc: 0.7317  acc: 0.6735    test auc: 0.7237  acc: 0.6696, time: 0.7810
epoch 43    train auc: 0.9926  acc: 0.9473    eval auc: 0.7283  acc: 0.6715    test auc: 0.7208  acc: 0.6655, time: 0.7760
epoch 44    train auc: 0.9929  acc: 0.9489    eval auc: 0.7289  acc: 0.6706    test auc: 0.7208  acc: 0.6670, time: 0.7784
epoch 45    train auc: 0.9934  acc: 0.9509    eval auc: 0.7278  acc: 0.6720    test auc: 0.7199  acc: 0.6657, time: 0.7690
epoch 46    train auc: 0.9936  acc: 0.9516    eval auc: 0.7274  acc: 0.6729    test auc: 0.7194  acc: 0.6673, time: 0.7670
epoch 47    train auc: 0.9937  acc: 0.9528    eval auc: 0.7253  acc: 0.6714    test auc: 0.7168  acc: 0.6637, time: 0.7620
epoch 48    train auc: 0.9942  acc: 0.9541    eval auc: 0.7256  acc: 0.6714    test auc: 0.7176  acc: 0.6644, time: 0.7700
epoch 49    train auc: 0.9943  acc: 0.9537    eval auc: 0.7238  acc: 0.6706    test auc: 0.7157  acc: 0.6652, time: 0.7600
avg time per epoch : 0.8293641662597656
--- 47.931392669677734 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:04:39.389899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:04:39.390257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5188  acc: 0.5116    eval auc: 0.4955  acc: 0.4937    test auc: 0.5124  acc: 0.5069, time: 1.0860
epoch 1    train auc: 0.6348  acc: 0.5126    eval auc: 0.6266  acc: 0.5113    test auc: 0.6308  acc: 0.5172, time: 0.7770
epoch 2    train auc: 0.8392  acc: 0.6823    eval auc: 0.7603  acc: 0.6668    test auc: 0.7673  acc: 0.6833, time: 0.7540
epoch 3    train auc: 0.8745  acc: 0.7104    eval auc: 0.7816  acc: 0.6948    test auc: 0.7850  acc: 0.7026, time: 0.7590
epoch 4    train auc: 0.8873  acc: 0.7425    eval auc: 0.7905  acc: 0.7213    test auc: 0.7926  acc: 0.7291, time: 0.7660
epoch 5    train auc: 0.8927  acc: 0.7668    eval auc: 0.7932  acc: 0.7399    test auc: 0.7957  acc: 0.7497, time: 0.7707
epoch 6    train auc: 0.8959  acc: 0.7797    eval auc: 0.7945  acc: 0.7499    test auc: 0.7970  acc: 0.7557, time: 0.7560
epoch 7    train auc: 0.8992  acc: 0.7818    eval auc: 0.7954  acc: 0.7506    test auc: 0.7976  acc: 0.7571, time: 0.7500
epoch 8    train auc: 0.9012  acc: 0.7916    eval auc: 0.7955  acc: 0.7514    test auc: 0.7983  acc: 0.7574, time: 0.7500
epoch 9    train auc: 0.9037  acc: 0.7916    eval auc: 0.7963  acc: 0.7516    test auc: 0.7984  acc: 0.7561, time: 0.7670
epoch 10    train auc: 0.9055  acc: 0.7933    eval auc: 0.7966  acc: 0.7501    test auc: 0.7985  acc: 0.7527, time: 0.7430
epoch 11    train auc: 0.9071  acc: 0.7981    eval auc: 0.7967  acc: 0.7491    test auc: 0.7986  acc: 0.7484, time: 0.7480
epoch 12    train auc: 0.9084  acc: 0.7990    eval auc: 0.7969  acc: 0.7455    test auc: 0.7983  acc: 0.7452, time: 0.7570
epoch 13    train auc: 0.9099  acc: 0.8022    eval auc: 0.7965  acc: 0.7425    test auc: 0.7979  acc: 0.7392, time: 0.7400
epoch 14    train auc: 0.9111  acc: 0.8029    eval auc: 0.7960  acc: 0.7406    test auc: 0.7970  acc: 0.7367, time: 0.7399
epoch 15    train auc: 0.9124  acc: 0.8063    eval auc: 0.7954  acc: 0.7392    test auc: 0.7964  acc: 0.7313, time: 0.7540
epoch 16    train auc: 0.9139  acc: 0.8101    eval auc: 0.7947  acc: 0.7388    test auc: 0.7955  acc: 0.7295, time: 0.7280
epoch 17    train auc: 0.9151  acc: 0.8095    eval auc: 0.7939  acc: 0.7367    test auc: 0.7942  acc: 0.7264, time: 0.7439
epoch 18    train auc: 0.9167  acc: 0.8129    eval auc: 0.7930  acc: 0.7344    test auc: 0.7929  acc: 0.7224, time: 0.7340
epoch 19    train auc: 0.9185  acc: 0.8153    eval auc: 0.7918  acc: 0.7300    test auc: 0.7918  acc: 0.7196, time: 0.7370
epoch 20    train auc: 0.9205  acc: 0.8184    eval auc: 0.7903  acc: 0.7218    test auc: 0.7903  acc: 0.7130, time: 0.7430
epoch 21    train auc: 0.9217  acc: 0.8169    eval auc: 0.7892  acc: 0.7287    test auc: 0.7883  acc: 0.7165, time: 0.7240
epoch 22    train auc: 0.9238  acc: 0.8216    eval auc: 0.7874  acc: 0.7202    test auc: 0.7867  acc: 0.7132, time: 0.7280
epoch 23    train auc: 0.9255  acc: 0.8237    eval auc: 0.7856  acc: 0.7209    test auc: 0.7846  acc: 0.7115, time: 0.7750
epoch 24    train auc: 0.9270  acc: 0.8256    eval auc: 0.7840  acc: 0.7203    test auc: 0.7828  acc: 0.7113, time: 0.7920
epoch 25    train auc: 0.9282  acc: 0.8280    eval auc: 0.7826  acc: 0.7183    test auc: 0.7813  acc: 0.7107, time: 0.7530
epoch 26    train auc: 0.9297  acc: 0.8297    eval auc: 0.7798  acc: 0.7105    test auc: 0.7786  acc: 0.7055, time: 0.7519
epoch 27    train auc: 0.9303  acc: 0.8307    eval auc: 0.7802  acc: 0.7147    test auc: 0.7786  acc: 0.7080, time: 0.7549
epoch 28    train auc: 0.9313  acc: 0.8316    eval auc: 0.7784  acc: 0.7130    test auc: 0.7766  acc: 0.7062, time: 0.7790
epoch 29    train auc: 0.9321  acc: 0.8313    eval auc: 0.7778  acc: 0.7127    test auc: 0.7760  acc: 0.7061, time: 0.7650
epoch 30    train auc: 0.9329  acc: 0.8331    eval auc: 0.7770  acc: 0.7088    test auc: 0.7754  acc: 0.7062, time: 0.7670
epoch 31    train auc: 0.9338  acc: 0.8328    eval auc: 0.7744  acc: 0.7066    test auc: 0.7727  acc: 0.7042, time: 0.7670
epoch 32    train auc: 0.9343  acc: 0.8335    eval auc: 0.7737  acc: 0.7067    test auc: 0.7720  acc: 0.7048, time: 0.7510
epoch 33    train auc: 0.9347  acc: 0.8340    eval auc: 0.7743  acc: 0.7075    test auc: 0.7729  acc: 0.7048, time: 0.7590
epoch 34    train auc: 0.9352  acc: 0.8334    eval auc: 0.7731  acc: 0.7074    test auc: 0.7711  acc: 0.7042, time: 0.8070
epoch 35    train auc: 0.9361  acc: 0.8369    eval auc: 0.7713  acc: 0.7039    test auc: 0.7700  acc: 0.6997, time: 0.8100
epoch 36    train auc: 0.9365  acc: 0.8366    eval auc: 0.7713  acc: 0.7048    test auc: 0.7698  acc: 0.7001, time: 0.7560
epoch 37    train auc: 0.9369  acc: 0.8375    eval auc: 0.7702  acc: 0.7009    test auc: 0.7691  acc: 0.6974, time: 0.7470
epoch 38    train auc: 0.9372  acc: 0.8354    eval auc: 0.7706  acc: 0.7033    test auc: 0.7687  acc: 0.6988, time: 0.7490
epoch 39    train auc: 0.9379  acc: 0.8382    eval auc: 0.7689  acc: 0.7019    test auc: 0.7673  acc: 0.6976, time: 0.7970
epoch 40    train auc: 0.9381  acc: 0.8381    eval auc: 0.7686  acc: 0.7023    test auc: 0.7667  acc: 0.6957, time: 0.7550
epoch 41    train auc: 0.9385  acc: 0.8388    eval auc: 0.7687  acc: 0.7022    test auc: 0.7671  acc: 0.6964, time: 0.7710
epoch 42    train auc: 0.9391  acc: 0.8397    eval auc: 0.7665  acc: 0.6974    test auc: 0.7650  acc: 0.6930, time: 0.7750
epoch 43    train auc: 0.9393  acc: 0.8394    eval auc: 0.7675  acc: 0.7013    test auc: 0.7656  acc: 0.6954, time: 0.8350
epoch 44    train auc: 0.9395  acc: 0.8393    eval auc: 0.7672  acc: 0.7017    test auc: 0.7653  acc: 0.6957, time: 0.9310
epoch 45    train auc: 0.9399  acc: 0.8402    eval auc: 0.7660  acc: 0.7017    test auc: 0.7639  acc: 0.6936, time: 0.8619
epoch 46    train auc: 0.9395  acc: 0.8384    eval auc: 0.7661  acc: 0.6994    test auc: 0.7638  acc: 0.6955, time: 0.8680
epoch 47    train auc: 0.9405  acc: 0.8408    eval auc: 0.7646  acc: 0.6996    test auc: 0.7628  acc: 0.6931, time: 0.8510
epoch 48    train auc: 0.9408  acc: 0.8415    eval auc: 0.7634  acc: 0.6959    test auc: 0.7619  acc: 0.6912, time: 0.8530
epoch 49    train auc: 0.9410  acc: 0.8417    eval auc: 0.7641  acc: 0.6980    test auc: 0.7624  acc: 0.6928, time: 0.8649
avg time per epoch : 0.7800351905822754
--- 45.083707332611084 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:05:24.482618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:05:24.482968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5050  acc: 0.5003    eval auc: 0.4970  acc: 0.4983    test auc: 0.4887  acc: 0.5017, time: 1.1480
epoch 1    train auc: 0.4770  acc: 0.4874    eval auc: 0.5346  acc: 0.5158    test auc: 0.5346  acc: 0.5220, time: 0.5230
epoch 2    train auc: 0.5285  acc: 0.5181    eval auc: 0.4565  acc: 0.4746    test auc: 0.4576  acc: 0.4711, time: 0.8300
epoch 3    train auc: 0.5085  acc: 0.4961    eval auc: 0.4867  acc: 0.5062    test auc: 0.4875  acc: 0.5056, time: 0.5130
epoch 4    train auc: 0.5695  acc: 0.5490    eval auc: 0.3968  acc: 0.4254    test auc: 0.3977  acc: 0.4276, time: 0.8200
epoch 5    train auc: 0.5848  acc: 0.5538    eval auc: 0.3824  acc: 0.4167    test auc: 0.3822  acc: 0.4219, time: 0.5120
epoch 6    train auc: 0.6796  acc: 0.6009    eval auc: 0.4780  acc: 0.4662    test auc: 0.4818  acc: 0.4688, time: 0.8160
epoch 7    train auc: 0.8123  acc: 0.7467    eval auc: 0.7074  acc: 0.6785    test auc: 0.7213  acc: 0.6841, time: 0.5030
epoch 8    train auc: 0.8351  acc: 0.7448    eval auc: 0.7797  acc: 0.6856    test auc: 0.7902  acc: 0.6961, time: 0.8390
epoch 9    train auc: 0.8716  acc: 0.7879    eval auc: 0.7505  acc: 0.7030    test auc: 0.7598  acc: 0.7114, time: 0.5050
epoch 10    train auc: 0.8695  acc: 0.7570    eval auc: 0.7911  acc: 0.6993    test auc: 0.7965  acc: 0.7053, time: 0.8170
epoch 11    train auc: 0.9035  acc: 0.8021    eval auc: 0.7653  acc: 0.7048    test auc: 0.7686  acc: 0.7087, time: 0.5190
epoch 12    train auc: 0.8899  acc: 0.7702    eval auc: 0.7893  acc: 0.7072    test auc: 0.7896  acc: 0.7120, time: 0.8030
epoch 13    train auc: 0.9168  acc: 0.8186    eval auc: 0.7612  acc: 0.6904    test auc: 0.7620  acc: 0.6982, time: 0.5139
epoch 14    train auc: 0.9048  acc: 0.7824    eval auc: 0.7853  acc: 0.7086    test auc: 0.7832  acc: 0.7151, time: 0.8290
epoch 15    train auc: 0.9245  acc: 0.8228    eval auc: 0.7624  acc: 0.6935    test auc: 0.7615  acc: 0.6981, time: 0.5019
epoch 16    train auc: 0.9153  acc: 0.7999    eval auc: 0.7794  acc: 0.7108    test auc: 0.7769  acc: 0.7131, time: 0.8200
epoch 17    train auc: 0.9286  acc: 0.8275    eval auc: 0.7621  acc: 0.6943    test auc: 0.7623  acc: 0.6957, time: 0.5140
epoch 18    train auc: 0.9214  acc: 0.8086    eval auc: 0.7766  acc: 0.7112    test auc: 0.7751  acc: 0.7153, time: 0.8220
epoch 19    train auc: 0.9319  acc: 0.8295    eval auc: 0.7601  acc: 0.6939    test auc: 0.7612  acc: 0.6990, time: 0.5140
epoch 20    train auc: 0.9252  acc: 0.8123    eval auc: 0.7728  acc: 0.7093    test auc: 0.7722  acc: 0.7122, time: 0.8310
epoch 21    train auc: 0.9347  acc: 0.8320    eval auc: 0.7574  acc: 0.6904    test auc: 0.7592  acc: 0.6967, time: 0.5180
epoch 22    train auc: 0.9300  acc: 0.8197    eval auc: 0.7686  acc: 0.7048    test auc: 0.7695  acc: 0.7115, time: 0.8200
epoch 23    train auc: 0.9358  acc: 0.8337    eval auc: 0.7626  acc: 0.7003    test auc: 0.7649  acc: 0.7036, time: 0.5130
epoch 24    train auc: 0.9297  acc: 0.8162    eval auc: 0.7678  acc: 0.7035    test auc: 0.7686  acc: 0.7100, time: 0.8360
epoch 25    train auc: 0.9380  acc: 0.8362    eval auc: 0.7592  acc: 0.6929    test auc: 0.7617  acc: 0.7002, time: 0.4980
epoch 26    train auc: 0.9312  acc: 0.8186    eval auc: 0.7675  acc: 0.7047    test auc: 0.7683  acc: 0.7111, time: 0.8180
epoch 27    train auc: 0.9397  acc: 0.8380    eval auc: 0.7530  acc: 0.6878    test auc: 0.7560  acc: 0.6955, time: 0.5020
epoch 28    train auc: 0.9306  acc: 0.8178    eval auc: 0.7686  acc: 0.7082    test auc: 0.7698  acc: 0.7144, time: 0.8179
epoch 29    train auc: 0.9415  acc: 0.8395    eval auc: 0.7520  acc: 0.6854    test auc: 0.7544  acc: 0.6904, time: 0.5080
epoch 30    train auc: 0.9335  acc: 0.8226    eval auc: 0.7653  acc: 0.7034    test auc: 0.7665  acc: 0.7078, time: 0.8140
epoch 31    train auc: 0.9427  acc: 0.8408    eval auc: 0.7528  acc: 0.6861    test auc: 0.7564  acc: 0.6943, time: 0.5330
epoch 32    train auc: 0.9312  acc: 0.8160    eval auc: 0.7639  acc: 0.6997    test auc: 0.7652  acc: 0.7045, time: 0.8140
epoch 33    train auc: 0.9435  acc: 0.8410    eval auc: 0.7542  acc: 0.6886    test auc: 0.7575  acc: 0.6939, time: 0.5100
epoch 34    train auc: 0.9346  acc: 0.8225    eval auc: 0.7620  acc: 0.7002    test auc: 0.7637  acc: 0.7030, time: 0.8400
epoch 35    train auc: 0.9448  acc: 0.8435    eval auc: 0.7488  acc: 0.6831    test auc: 0.7525  acc: 0.6897, time: 0.5060
epoch 36    train auc: 0.9381  acc: 0.8277    eval auc: 0.7584  acc: 0.6974    test auc: 0.7611  acc: 0.7002, time: 0.8140
epoch 37    train auc: 0.9463  acc: 0.8446    eval auc: 0.7502  acc: 0.6841    test auc: 0.7543  acc: 0.6906, time: 0.4950
epoch 38    train auc: 0.9399  acc: 0.8328    eval auc: 0.7581  acc: 0.6951    test auc: 0.7611  acc: 0.7011, time: 0.8325
epoch 39    train auc: 0.9475  acc: 0.8465    eval auc: 0.7496  acc: 0.6844    test auc: 0.7532  acc: 0.6893, time: 0.4990
epoch 40    train auc: 0.9378  acc: 0.8273    eval auc: 0.7593  acc: 0.6984    test auc: 0.7625  acc: 0.7028, time: 0.8160
epoch 41    train auc: 0.9501  acc: 0.8499    eval auc: 0.7473  acc: 0.6839    test auc: 0.7509  acc: 0.6893, time: 0.5160
epoch 42    train auc: 0.9393  acc: 0.8339    eval auc: 0.7600  acc: 0.6971    test auc: 0.7626  acc: 0.7032, time: 0.8100
epoch 43    train auc: 0.9541  acc: 0.8558    eval auc: 0.7442  acc: 0.6812    test auc: 0.7480  acc: 0.6890, time: 0.5120
epoch 44    train auc: 0.9393  acc: 0.8369    eval auc: 0.7631  acc: 0.7061    test auc: 0.7650  acc: 0.7040, time: 0.8220
epoch 45    train auc: 0.9615  acc: 0.8728    eval auc: 0.7406  acc: 0.6800    test auc: 0.7429  acc: 0.6817, time: 0.5140
epoch 46    train auc: 0.9402  acc: 0.8386    eval auc: 0.7663  acc: 0.7087    test auc: 0.7664  acc: 0.7053, time: 0.8160
epoch 47    train auc: 0.9665  acc: 0.8821    eval auc: 0.7398  acc: 0.6781    test auc: 0.7410  acc: 0.6827, time: 0.5040
epoch 48    train auc: 0.9458  acc: 0.8476    eval auc: 0.7647  acc: 0.7108    test auc: 0.7639  acc: 0.7026, time: 0.8370
epoch 49    train auc: 0.9707  acc: 0.8903    eval auc: 0.7377  acc: 0.6800    test auc: 0.7386  acc: 0.6802, time: 0.5050
avg time per epoch : 0.6726725149154663
--- 40.02333879470825 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:06:04.527368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:06:04.527718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5245  acc: 0.5138    eval auc: 0.4989  acc: 0.4985    test auc: 0.5126  acc: 0.5083, time: 1.0960
epoch 1    train auc: 0.5043  acc: 0.5038    eval auc: 0.4901  acc: 0.4910    test auc: 0.4992  acc: 0.4991, time: 0.4610
epoch 2    train auc: 0.5872  acc: 0.5559    eval auc: 0.5082  acc: 0.4984    test auc: 0.5099  acc: 0.4996, time: 0.7501
epoch 3    train auc: 0.5474  acc: 0.5322    eval auc: 0.4313  acc: 0.4529    test auc: 0.4281  acc: 0.4502, time: 0.4510
epoch 4    train auc: 0.5621  acc: 0.5428    eval auc: 0.4118  acc: 0.4400    test auc: 0.4043  acc: 0.4319, time: 0.7451
epoch 5    train auc: 0.5669  acc: 0.5470    eval auc: 0.4049  acc: 0.4361    test auc: 0.3970  acc: 0.4231, time: 0.4617
epoch 6    train auc: 0.5753  acc: 0.5519    eval auc: 0.3949  acc: 0.4280    test auc: 0.3875  acc: 0.4161, time: 0.7508
epoch 7    train auc: 0.5783  acc: 0.5542    eval auc: 0.3910  acc: 0.4260    test auc: 0.3832  acc: 0.4113, time: 0.4552
epoch 8    train auc: 0.5860  acc: 0.5570    eval auc: 0.3867  acc: 0.4204    test auc: 0.3778  acc: 0.4085, time: 0.7275
epoch 9    train auc: 0.5874  acc: 0.5577    eval auc: 0.3842  acc: 0.4176    test auc: 0.3759  acc: 0.4095, time: 0.4566
epoch 10    train auc: 0.5990  acc: 0.5594    eval auc: 0.3834  acc: 0.4139    test auc: 0.3747  acc: 0.4094, time: 0.7308
epoch 11    train auc: 0.5980  acc: 0.5596    eval auc: 0.3813  acc: 0.4135    test auc: 0.3731  acc: 0.4077, time: 0.4429
epoch 12    train auc: 0.6167  acc: 0.5608    eval auc: 0.3853  acc: 0.4114    test auc: 0.3770  acc: 0.4078, time: 0.7344
epoch 13    train auc: 0.6145  acc: 0.5608    eval auc: 0.3838  acc: 0.4136    test auc: 0.3751  acc: 0.4048, time: 0.4390
epoch 14    train auc: 0.6437  acc: 0.5612    eval auc: 0.3997  acc: 0.4149    test auc: 0.3906  acc: 0.4071, time: 0.7305
epoch 15    train auc: 0.6482  acc: 0.5761    eval auc: 0.4020  acc: 0.4215    test auc: 0.3919  acc: 0.4101, time: 0.4517
epoch 16    train auc: 0.6765  acc: 0.5892    eval auc: 0.4257  acc: 0.4291    test auc: 0.4179  acc: 0.4217, time: 0.7110
epoch 17    train auc: 0.6993  acc: 0.6353    eval auc: 0.4429  acc: 0.4620    test auc: 0.4364  acc: 0.4563, time: 0.4413
epoch 18    train auc: 0.7634  acc: 0.6806    eval auc: 0.5027  acc: 0.5114    test auc: 0.4972  acc: 0.5092, time: 0.7095
epoch 19    train auc: 0.8514  acc: 0.7646    eval auc: 0.6305  acc: 0.6011    test auc: 0.6310  acc: 0.6081, time: 0.4502
epoch 20    train auc: 0.8889  acc: 0.7920    eval auc: 0.7116  acc: 0.6795    test auc: 0.7075  acc: 0.6830, time: 0.7217
epoch 21    train auc: 0.8971  acc: 0.8171    eval auc: 0.7256  acc: 0.6840    test auc: 0.7215  acc: 0.6849, time: 0.4416
epoch 22    train auc: 0.9038  acc: 0.8044    eval auc: 0.7397  acc: 0.7058    test auc: 0.7344  acc: 0.7027, time: 0.7169
epoch 23    train auc: 0.9109  acc: 0.8285    eval auc: 0.7378  acc: 0.6983    test auc: 0.7341  acc: 0.6952, time: 0.4320
epoch 24    train auc: 0.9112  acc: 0.8085    eval auc: 0.7473  acc: 0.7112    test auc: 0.7414  acc: 0.7088, time: 0.7056
epoch 25    train auc: 0.9185  acc: 0.8335    eval auc: 0.7406  acc: 0.7002    test auc: 0.7368  acc: 0.6968, time: 0.4401
epoch 26    train auc: 0.9177  acc: 0.8162    eval auc: 0.7472  acc: 0.7114    test auc: 0.7413  acc: 0.7085, time: 0.7147
epoch 27    train auc: 0.9237  acc: 0.8375    eval auc: 0.7389  acc: 0.7016    test auc: 0.7343  acc: 0.6976, time: 0.4445
epoch 28    train auc: 0.9229  acc: 0.8229    eval auc: 0.7485  acc: 0.7130    test auc: 0.7425  acc: 0.7119, time: 0.7514
epoch 29    train auc: 0.9276  acc: 0.8406    eval auc: 0.7389  acc: 0.6998    test auc: 0.7336  acc: 0.6977, time: 0.4889
epoch 30    train auc: 0.9259  acc: 0.8234    eval auc: 0.7487  acc: 0.7128    test auc: 0.7422  acc: 0.7124, time: 0.7916
epoch 31    train auc: 0.9316  acc: 0.8445    eval auc: 0.7366  acc: 0.6974    test auc: 0.7311  acc: 0.6928, time: 0.4617
epoch 32    train auc: 0.9288  acc: 0.8258    eval auc: 0.7488  acc: 0.7120    test auc: 0.7425  acc: 0.7134, time: 0.7410
epoch 33    train auc: 0.9347  acc: 0.8476    eval auc: 0.7392  acc: 0.6998    test auc: 0.7335  acc: 0.6949, time: 0.4660
epoch 34    train auc: 0.9325  acc: 0.8299    eval auc: 0.7478  acc: 0.7117    test auc: 0.7414  acc: 0.7109, time: 0.6899
epoch 35    train auc: 0.9377  acc: 0.8489    eval auc: 0.7382  acc: 0.6976    test auc: 0.7320  acc: 0.6937, time: 0.4368
epoch 36    train auc: 0.9351  acc: 0.8314    eval auc: 0.7479  acc: 0.7119    test auc: 0.7413  acc: 0.7117, time: 0.7071
epoch 37    train auc: 0.9402  acc: 0.8515    eval auc: 0.7377  acc: 0.6959    test auc: 0.7313  acc: 0.6922, time: 0.4503
epoch 38    train auc: 0.9383  acc: 0.8361    eval auc: 0.7468  acc: 0.7107    test auc: 0.7401  acc: 0.7106, time: 0.6848
epoch 39    train auc: 0.9428  acc: 0.8532    eval auc: 0.7386  acc: 0.6977    test auc: 0.7322  acc: 0.6932, time: 0.4421
epoch 40    train auc: 0.9402  acc: 0.8369    eval auc: 0.7466  acc: 0.7094    test auc: 0.7399  acc: 0.7113, time: 0.7006
epoch 41    train auc: 0.9454  acc: 0.8553    eval auc: 0.7388  acc: 0.6989    test auc: 0.7323  acc: 0.6944, time: 0.4402
epoch 42    train auc: 0.9426  acc: 0.8393    eval auc: 0.7464  acc: 0.7106    test auc: 0.7397  acc: 0.7101, time: 0.7076
epoch 43    train auc: 0.9475  acc: 0.8554    eval auc: 0.7372  acc: 0.6991    test auc: 0.7302  acc: 0.6939, time: 0.4512
epoch 44    train auc: 0.9448  acc: 0.8423    eval auc: 0.7444  acc: 0.7098    test auc: 0.7379  acc: 0.7102, time: 0.7017
epoch 45    train auc: 0.9497  acc: 0.8584    eval auc: 0.7374  acc: 0.6987    test auc: 0.7307  acc: 0.6945, time: 0.4407
epoch 46    train auc: 0.9470  acc: 0.8476    eval auc: 0.7429  acc: 0.7095    test auc: 0.7366  acc: 0.7086, time: 0.7149
epoch 47    train auc: 0.9514  acc: 0.8602    eval auc: 0.7359  acc: 0.6964    test auc: 0.7289  acc: 0.6939, time: 0.4289
epoch 48    train auc: 0.9490  acc: 0.8512    eval auc: 0.7410  acc: 0.7082    test auc: 0.7348  acc: 0.7062, time: 0.6806
epoch 49    train auc: 0.9531  acc: 0.8615    eval auc: 0.7353  acc: 0.6962    test auc: 0.7284  acc: 0.6944, time: 0.4389
avg time per epoch : 0.5926114797592164
--- 35.442224979400635 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:06:39.997074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:06:39.997442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.7139  acc: 0.4989    eval auc: 0.6846  acc: 0.4995    test auc: 0.6885  acc: 0.5038, time: 1.0740
epoch 1    train auc: 0.8789  acc: 0.7597    eval auc: 0.7952  acc: 0.7361    test auc: 0.8052  acc: 0.7424, time: 0.4680
epoch 2    train auc: 0.8974  acc: 0.7888    eval auc: 0.7967  acc: 0.7493    test auc: 0.8016  acc: 0.7546, time: 0.7630
epoch 3    train auc: 0.9098  acc: 0.8116    eval auc: 0.7953  acc: 0.7362    test auc: 0.7967  acc: 0.7311, time: 0.4837
epoch 4    train auc: 0.9184  acc: 0.8188    eval auc: 0.7906  acc: 0.7265    test auc: 0.7898  acc: 0.7229, time: 0.7743
epoch 5    train auc: 0.9230  acc: 0.8221    eval auc: 0.7859  acc: 0.7170    test auc: 0.7847  acc: 0.7108, time: 0.4729
epoch 6    train auc: 0.9278  acc: 0.8273    eval auc: 0.7802  acc: 0.7104    test auc: 0.7782  acc: 0.7046, time: 0.7620
epoch 7    train auc: 0.9301  acc: 0.8286    eval auc: 0.7792  acc: 0.7108    test auc: 0.7763  acc: 0.7039, time: 0.4859
epoch 8    train auc: 0.9320  acc: 0.8301    eval auc: 0.7765  acc: 0.7088    test auc: 0.7732  acc: 0.7016, time: 0.7837
epoch 9    train auc: 0.9337  acc: 0.8319    eval auc: 0.7741  acc: 0.7002    test auc: 0.7718  acc: 0.6961, time: 0.4811
epoch 10    train auc: 0.9352  acc: 0.8329    eval auc: 0.7727  acc: 0.7020    test auc: 0.7703  acc: 0.6959, time: 0.7619
epoch 11    train auc: 0.9351  acc: 0.8313    eval auc: 0.7746  acc: 0.7066    test auc: 0.7714  acc: 0.7036, time: 0.4669
epoch 12    train auc: 0.9364  acc: 0.8325    eval auc: 0.7709  acc: 0.6981    test auc: 0.7683  acc: 0.6945, time: 0.7818
epoch 13    train auc: 0.9374  acc: 0.8340    eval auc: 0.7715  acc: 0.7030    test auc: 0.7677  acc: 0.6976, time: 0.4835
epoch 14    train auc: 0.9386  acc: 0.8357    eval auc: 0.7682  acc: 0.6963    test auc: 0.7655  acc: 0.6951, time: 0.7841
epoch 15    train auc: 0.9393  acc: 0.8367    eval auc: 0.7638  acc: 0.6937    test auc: 0.7598  acc: 0.6891, time: 0.4689
epoch 16    train auc: 0.9404  acc: 0.8385    eval auc: 0.7636  acc: 0.6932    test auc: 0.7598  acc: 0.6890, time: 0.7600
epoch 17    train auc: 0.9410  acc: 0.8393    eval auc: 0.7611  acc: 0.6896    test auc: 0.7585  acc: 0.6879, time: 0.4739
epoch 18    train auc: 0.9413  acc: 0.8384    eval auc: 0.7643  acc: 0.6939    test auc: 0.7618  acc: 0.6916, time: 0.7620
epoch 19    train auc: 0.9420  acc: 0.8401    eval auc: 0.7614  acc: 0.6919    test auc: 0.7586  acc: 0.6889, time: 0.4750
epoch 20    train auc: 0.9428  acc: 0.8408    eval auc: 0.7596  acc: 0.6887    test auc: 0.7569  acc: 0.6872, time: 0.7869
epoch 21    train auc: 0.9430  acc: 0.8399    eval auc: 0.7612  acc: 0.6917    test auc: 0.7587  acc: 0.6904, time: 0.4828
epoch 22    train auc: 0.9435  acc: 0.8408    eval auc: 0.7597  acc: 0.6903    test auc: 0.7572  acc: 0.6887, time: 0.7600
epoch 23    train auc: 0.9432  acc: 0.8405    eval auc: 0.7624  acc: 0.6934    test auc: 0.7601  acc: 0.6928, time: 0.4720
epoch 24    train auc: 0.9443  acc: 0.8423    eval auc: 0.7561  acc: 0.6856    test auc: 0.7529  acc: 0.6830, time: 0.7888
epoch 25    train auc: 0.9446  acc: 0.8419    eval auc: 0.7587  acc: 0.6889    test auc: 0.7561  acc: 0.6867, time: 0.4710
epoch 26    train auc: 0.9448  acc: 0.8426    eval auc: 0.7596  acc: 0.6899    test auc: 0.7562  acc: 0.6869, time: 0.7660
epoch 27    train auc: 0.9456  acc: 0.8431    eval auc: 0.7572  acc: 0.6883    test auc: 0.7543  acc: 0.6841, time: 0.4800
epoch 28    train auc: 0.9460  acc: 0.8439    eval auc: 0.7577  acc: 0.6878    test auc: 0.7551  acc: 0.6850, time: 0.7660
epoch 29    train auc: 0.9467  acc: 0.8451    eval auc: 0.7542  acc: 0.6863    test auc: 0.7508  acc: 0.6812, time: 0.4660
epoch 30    train auc: 0.9468  acc: 0.8447    eval auc: 0.7556  acc: 0.6847    test auc: 0.7527  acc: 0.6824, time: 0.7670
epoch 31    train auc: 0.9473  acc: 0.8448    eval auc: 0.7569  acc: 0.6883    test auc: 0.7549  acc: 0.6870, time: 0.4838
epoch 32    train auc: 0.9476  acc: 0.8454    eval auc: 0.7536  acc: 0.6844    test auc: 0.7510  acc: 0.6806, time: 0.7577
epoch 33    train auc: 0.9490  acc: 0.8470    eval auc: 0.7558  acc: 0.6864    test auc: 0.7534  acc: 0.6836, time: 0.4670
epoch 34    train auc: 0.9510  acc: 0.8491    eval auc: 0.7531  acc: 0.6846    test auc: 0.7509  acc: 0.6805, time: 0.7539
epoch 35    train auc: 0.9532  acc: 0.8516    eval auc: 0.7518  acc: 0.6807    test auc: 0.7512  acc: 0.6813, time: 0.4639
epoch 36    train auc: 0.9563  acc: 0.8594    eval auc: 0.7495  acc: 0.6776    test auc: 0.7491  acc: 0.6823, time: 0.7795
epoch 37    train auc: 0.9588  acc: 0.8603    eval auc: 0.7496  acc: 0.6781    test auc: 0.7485  acc: 0.6818, time: 0.4822
epoch 38    train auc: 0.9627  acc: 0.8744    eval auc: 0.7491  acc: 0.6780    test auc: 0.7497  acc: 0.6874, time: 0.7796
epoch 39    train auc: 0.9649  acc: 0.8781    eval auc: 0.7476  acc: 0.6781    test auc: 0.7478  acc: 0.6837, time: 0.4811
epoch 40    train auc: 0.9670  acc: 0.8830    eval auc: 0.7481  acc: 0.6810    test auc: 0.7485  acc: 0.6874, time: 0.7552
epoch 41    train auc: 0.9698  acc: 0.8875    eval auc: 0.7448  acc: 0.6793    test auc: 0.7454  acc: 0.6825, time: 0.4881
epoch 42    train auc: 0.9717  acc: 0.8904    eval auc: 0.7458  acc: 0.6828    test auc: 0.7458  acc: 0.6839, time: 0.7780
epoch 43    train auc: 0.9724  acc: 0.8913    eval auc: 0.7421  acc: 0.6782    test auc: 0.7421  acc: 0.6834, time: 0.4833
epoch 44    train auc: 0.9749  acc: 0.8963    eval auc: 0.7449  acc: 0.6830    test auc: 0.7434  acc: 0.6854, time: 0.7570
epoch 45    train auc: 0.9763  acc: 0.8990    eval auc: 0.7410  acc: 0.6807    test auc: 0.7385  acc: 0.6792, time: 0.4824
epoch 46    train auc: 0.9771  acc: 0.8998    eval auc: 0.7396  acc: 0.6824    test auc: 0.7370  acc: 0.6806, time: 0.7660
epoch 47    train auc: 0.9785  acc: 0.9031    eval auc: 0.7412  acc: 0.6834    test auc: 0.7378  acc: 0.6799, time: 0.4690
epoch 48    train auc: 0.9795  acc: 0.9062    eval auc: 0.7406  acc: 0.6845    test auc: 0.7376  acc: 0.6802, time: 0.7665
epoch 49    train auc: 0.9804  acc: 0.9088    eval auc: 0.7396  acc: 0.6840    test auc: 0.7363  acc: 0.6817, time: 0.4660
avg time per epoch : 0.6286705303192138
--- 37.08725094795227 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:07:17.089186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:07:17.089550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5273  acc: 0.5227    eval auc: 0.5115  acc: 0.5089    test auc: 0.5082  acc: 0.5047, time: 1.1257
epoch 1    train auc: 0.5312  acc: 0.5202    eval auc: 0.4797  acc: 0.4906    test auc: 0.4812  acc: 0.4858, time: 0.4720
epoch 2    train auc: 0.6470  acc: 0.5408    eval auc: 0.5463  acc: 0.5318    test auc: 0.5528  acc: 0.5296, time: 0.7698
epoch 3    train auc: 0.7921  acc: 0.6870    eval auc: 0.6857  acc: 0.6669    test auc: 0.6958  acc: 0.6787, time: 0.4670
epoch 4    train auc: 0.8541  acc: 0.7030    eval auc: 0.7376  acc: 0.6858    test auc: 0.7436  acc: 0.6958, time: 0.7838
epoch 5    train auc: 0.8808  acc: 0.7409    eval auc: 0.7660  acc: 0.7146    test auc: 0.7691  acc: 0.7249, time: 0.4649
epoch 6    train auc: 0.8905  acc: 0.7585    eval auc: 0.7776  acc: 0.7270    test auc: 0.7795  acc: 0.7373, time: 0.7620
epoch 7    train auc: 0.8957  acc: 0.7809    eval auc: 0.7824  acc: 0.7418    test auc: 0.7836  acc: 0.7499, time: 0.4804
epoch 8    train auc: 0.8993  acc: 0.7766    eval auc: 0.7848  acc: 0.7398    test auc: 0.7851  acc: 0.7471, time: 0.7795
epoch 9    train auc: 0.9026  acc: 0.8009    eval auc: 0.7859  acc: 0.7383    test auc: 0.7860  acc: 0.7360, time: 0.4790
epoch 10    train auc: 0.9053  acc: 0.8020    eval auc: 0.7868  acc: 0.7375    test auc: 0.7864  acc: 0.7352, time: 0.7532
epoch 11    train auc: 0.9075  acc: 0.8029    eval auc: 0.7868  acc: 0.7347    test auc: 0.7859  acc: 0.7326, time: 0.4852
epoch 12    train auc: 0.9095  acc: 0.8026    eval auc: 0.7875  acc: 0.7340    test auc: 0.7862  acc: 0.7328, time: 0.7520
epoch 13    train auc: 0.9120  acc: 0.8143    eval auc: 0.7868  acc: 0.7276    test auc: 0.7853  acc: 0.7223, time: 0.4610
epoch 14    train auc: 0.9140  acc: 0.8147    eval auc: 0.7870  acc: 0.7276    test auc: 0.7853  acc: 0.7222, time: 0.7788
epoch 15    train auc: 0.9157  acc: 0.8159    eval auc: 0.7859  acc: 0.7251    test auc: 0.7838  acc: 0.7215, time: 0.4649
epoch 16    train auc: 0.9174  acc: 0.8169    eval auc: 0.7857  acc: 0.7252    test auc: 0.7832  acc: 0.7220, time: 0.7537
epoch 17    train auc: 0.9193  acc: 0.8216    eval auc: 0.7843  acc: 0.7199    test auc: 0.7819  acc: 0.7165, time: 0.4890
epoch 18    train auc: 0.9202  acc: 0.8184    eval auc: 0.7849  acc: 0.7237    test auc: 0.7823  acc: 0.7206, time: 0.7698
epoch 19    train auc: 0.9222  acc: 0.8260    eval auc: 0.7824  acc: 0.7152    test auc: 0.7801  acc: 0.7056, time: 0.4811
epoch 20    train auc: 0.9233  acc: 0.8242    eval auc: 0.7818  acc: 0.7167    test auc: 0.7790  acc: 0.7126, time: 0.7377
epoch 21    train auc: 0.9244  acc: 0.8257    eval auc: 0.7809  acc: 0.7144    test auc: 0.7780  acc: 0.7082, time: 0.4529
epoch 22    train auc: 0.9253  acc: 0.8258    eval auc: 0.7814  acc: 0.7150    test auc: 0.7784  acc: 0.7102, time: 0.7611
epoch 23    train auc: 0.9265  acc: 0.8277    eval auc: 0.7798  acc: 0.7127    test auc: 0.7767  acc: 0.7072, time: 0.4543
epoch 24    train auc: 0.9273  acc: 0.8271    eval auc: 0.7796  acc: 0.7124    test auc: 0.7765  acc: 0.7080, time: 0.7370
epoch 25    train auc: 0.9281  acc: 0.8282    eval auc: 0.7790  acc: 0.7131    test auc: 0.7758  acc: 0.7068, time: 0.4635
epoch 26    train auc: 0.9287  acc: 0.8282    eval auc: 0.7790  acc: 0.7134    test auc: 0.7757  acc: 0.7083, time: 0.7538
epoch 27    train auc: 0.9299  acc: 0.8322    eval auc: 0.7758  acc: 0.7066    test auc: 0.7730  acc: 0.7002, time: 0.4642
epoch 28    train auc: 0.9304  acc: 0.8323    eval auc: 0.7771  acc: 0.7093    test auc: 0.7740  acc: 0.7022, time: 0.7631
epoch 29    train auc: 0.9311  acc: 0.8328    eval auc: 0.7758  acc: 0.7074    test auc: 0.7727  acc: 0.7020, time: 0.4678
epoch 30    train auc: 0.9316  acc: 0.8325    eval auc: 0.7758  acc: 0.7073    test auc: 0.7727  acc: 0.7030, time: 0.7518
epoch 31    train auc: 0.9325  acc: 0.8334    eval auc: 0.7733  acc: 0.7039    test auc: 0.7702  acc: 0.6998, time: 0.4733
epoch 32    train auc: 0.9323  acc: 0.8306    eval auc: 0.7754  acc: 0.7094    test auc: 0.7720  acc: 0.7041, time: 0.7565
epoch 33    train auc: 0.9333  acc: 0.8330    eval auc: 0.7729  acc: 0.7041    test auc: 0.7696  acc: 0.7001, time: 0.4529
epoch 34    train auc: 0.9340  acc: 0.8353    eval auc: 0.7729  acc: 0.7034    test auc: 0.7700  acc: 0.7001, time: 0.7566
epoch 35    train auc: 0.9347  acc: 0.8353    eval auc: 0.7707  acc: 0.6989    test auc: 0.7678  acc: 0.6965, time: 0.4529
epoch 36    train auc: 0.9348  acc: 0.8352    eval auc: 0.7723  acc: 0.7033    test auc: 0.7694  acc: 0.6998, time: 0.7419
epoch 37    train auc: 0.9354  acc: 0.8357    eval auc: 0.7715  acc: 0.7021    test auc: 0.7687  acc: 0.6996, time: 0.4609
epoch 38    train auc: 0.9358  acc: 0.8353    eval auc: 0.7708  acc: 0.7022    test auc: 0.7678  acc: 0.6977, time: 0.7360
epoch 39    train auc: 0.9365  acc: 0.8376    eval auc: 0.7687  acc: 0.6993    test auc: 0.7659  acc: 0.6944, time: 0.4490
epoch 40    train auc: 0.9360  acc: 0.8351    eval auc: 0.7711  acc: 0.7046    test auc: 0.7680  acc: 0.7000, time: 0.7390
epoch 41    train auc: 0.9373  acc: 0.8386    eval auc: 0.7674  acc: 0.6980    test auc: 0.7650  acc: 0.6919, time: 0.4613
epoch 42    train auc: 0.9374  acc: 0.8373    eval auc: 0.7687  acc: 0.7007    test auc: 0.7659  acc: 0.6964, time: 0.7526
epoch 43    train auc: 0.9380  acc: 0.8389    eval auc: 0.7671  acc: 0.6981    test auc: 0.7644  acc: 0.6936, time: 0.4663
epoch 44    train auc: 0.9380  acc: 0.8378    eval auc: 0.7682  acc: 0.7020    test auc: 0.7654  acc: 0.6957, time: 0.7368
epoch 45    train auc: 0.9385  acc: 0.8392    eval auc: 0.7665  acc: 0.6985    test auc: 0.7637  acc: 0.6943, time: 0.4578
epoch 46    train auc: 0.9390  acc: 0.8397    eval auc: 0.7660  acc: 0.6976    test auc: 0.7635  acc: 0.6928, time: 0.7491
epoch 47    train auc: 0.9391  acc: 0.8400    eval auc: 0.7656  acc: 0.6980    test auc: 0.7630  acc: 0.6949, time: 0.4622
epoch 48    train auc: 0.9397  acc: 0.8412    eval auc: 0.7652  acc: 0.6976    test auc: 0.7629  acc: 0.6921, time: 0.7483
epoch 49    train auc: 0.9400  acc: 0.8415    eval auc: 0.7645  acc: 0.6978    test auc: 0.7623  acc: 0.6916, time: 0.4499
avg time per epoch : 0.6176741075515747
--- 36.76140522956848 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:07:53.888992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:07:53.889342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5112  acc: 0.5047    eval auc: 0.4907  acc: 0.4939    test auc: 0.4766  acc: 0.4925, time: 1.0404
epoch 1    train auc: 0.8563  acc: 0.7360    eval auc: 0.7798  acc: 0.7184    test auc: 0.7865  acc: 0.7275, time: 0.4683
epoch 2    train auc: 0.8910  acc: 0.7820    eval auc: 0.7931  acc: 0.7452    test auc: 0.7985  acc: 0.7540, time: 0.7542
epoch 3    train auc: 0.9019  acc: 0.8012    eval auc: 0.7941  acc: 0.7380    test auc: 0.7967  acc: 0.7385, time: 0.4509
epoch 4    train auc: 0.9087  acc: 0.8033    eval auc: 0.7952  acc: 0.7373    test auc: 0.7966  acc: 0.7362, time: 0.7565
epoch 5    train auc: 0.9177  acc: 0.8175    eval auc: 0.7855  acc: 0.7141    test auc: 0.7858  acc: 0.7066, time: 0.4589
epoch 6    train auc: 0.9189  acc: 0.8126    eval auc: 0.7895  acc: 0.7268    test auc: 0.7894  acc: 0.7215, time: 0.7541
epoch 7    train auc: 0.9279  acc: 0.8247    eval auc: 0.7762  acc: 0.7026    test auc: 0.7745  acc: 0.6969, time: 0.4539
epoch 8    train auc: 0.9247  acc: 0.8157    eval auc: 0.7850  acc: 0.7191    test auc: 0.7842  acc: 0.7148, time: 0.7606
epoch 9    train auc: 0.9325  acc: 0.8304    eval auc: 0.7715  acc: 0.6957    test auc: 0.7711  acc: 0.6932, time: 0.4654
epoch 10    train auc: 0.9282  acc: 0.8190    eval auc: 0.7820  acc: 0.7130    test auc: 0.7809  acc: 0.7111, time: 0.7591
epoch 11    train auc: 0.9349  acc: 0.8306    eval auc: 0.7723  acc: 0.6997    test auc: 0.7707  acc: 0.6971, time: 0.4539
epoch 12    train auc: 0.9297  acc: 0.8217    eval auc: 0.7805  acc: 0.7112    test auc: 0.7793  acc: 0.7107, time: 0.7388
epoch 13    train auc: 0.9370  acc: 0.8332    eval auc: 0.7706  acc: 0.6978    test auc: 0.7691  acc: 0.6964, time: 0.4682
epoch 14    train auc: 0.9330  acc: 0.8267    eval auc: 0.7775  acc: 0.7068    test auc: 0.7763  acc: 0.7066, time: 0.7579
epoch 15    train auc: 0.9394  acc: 0.8378    eval auc: 0.7625  acc: 0.6896    test auc: 0.7604  acc: 0.6872, time: 0.4637
epoch 16    train auc: 0.9349  acc: 0.8276    eval auc: 0.7744  acc: 0.7026    test auc: 0.7724  acc: 0.7027, time: 0.7582
epoch 17    train auc: 0.9406  acc: 0.8400    eval auc: 0.7625  acc: 0.6879    test auc: 0.7613  acc: 0.6865, time: 0.4633
epoch 18    train auc: 0.9361  acc: 0.8304    eval auc: 0.7726  acc: 0.7052    test auc: 0.7721  acc: 0.7034, time: 0.7484
epoch 19    train auc: 0.9416  acc: 0.8406    eval auc: 0.7612  acc: 0.6889    test auc: 0.7609  acc: 0.6883, time: 0.4600
epoch 20    train auc: 0.9387  acc: 0.8340    eval auc: 0.7688  acc: 0.6998    test auc: 0.7677  acc: 0.6981, time: 0.7546
epoch 21    train auc: 0.9432  acc: 0.8427    eval auc: 0.7596  acc: 0.6865    test auc: 0.7589  acc: 0.6869, time: 0.4610
epoch 22    train auc: 0.9382  acc: 0.8313    eval auc: 0.7684  acc: 0.6990    test auc: 0.7675  acc: 0.6976, time: 0.7418
epoch 23    train auc: 0.9435  acc: 0.8426    eval auc: 0.7604  acc: 0.6883    test auc: 0.7605  acc: 0.6891, time: 0.4635
epoch 24    train auc: 0.9411  acc: 0.8360    eval auc: 0.7639  acc: 0.6929    test auc: 0.7628  acc: 0.6935, time: 0.7851
epoch 25    train auc: 0.9453  acc: 0.8452    eval auc: 0.7569  acc: 0.6834    test auc: 0.7572  acc: 0.6844, time: 0.4609
epoch 26    train auc: 0.9411  acc: 0.8367    eval auc: 0.7643  acc: 0.6945    test auc: 0.7631  acc: 0.6937, time: 0.7535
epoch 27    train auc: 0.9462  acc: 0.8461    eval auc: 0.7534  acc: 0.6799    test auc: 0.7539  acc: 0.6813, time: 0.4592
epoch 28    train auc: 0.9431  acc: 0.8391    eval auc: 0.7617  acc: 0.6911    test auc: 0.7616  acc: 0.6910, time: 0.7388
epoch 29    train auc: 0.9483  acc: 0.8494    eval auc: 0.7503  acc: 0.6772    test auc: 0.7503  acc: 0.6802, time: 0.4599
epoch 30    train auc: 0.9447  acc: 0.8412    eval auc: 0.7590  acc: 0.6898    test auc: 0.7585  acc: 0.6885, time: 0.7441
epoch 31    train auc: 0.9494  acc: 0.8489    eval auc: 0.7521  acc: 0.6817    test auc: 0.7530  acc: 0.6827, time: 0.4611
epoch 32    train auc: 0.9470  acc: 0.8418    eval auc: 0.7557  acc: 0.6861    test auc: 0.7552  acc: 0.6872, time: 0.7288
epoch 33    train auc: 0.9518  acc: 0.8515    eval auc: 0.7507  acc: 0.6813    test auc: 0.7508  acc: 0.6795, time: 0.4360
epoch 34    train auc: 0.9502  acc: 0.8462    eval auc: 0.7544  acc: 0.6860    test auc: 0.7532  acc: 0.6832, time: 0.7351
epoch 35    train auc: 0.9563  acc: 0.8565    eval auc: 0.7456  acc: 0.6734    test auc: 0.7463  acc: 0.6752, time: 0.4516
epoch 36    train auc: 0.9562  acc: 0.8559    eval auc: 0.7503  acc: 0.6817    test auc: 0.7504  acc: 0.6819, time: 0.7262
epoch 37    train auc: 0.9613  acc: 0.8658    eval auc: 0.7448  acc: 0.6730    test auc: 0.7455  acc: 0.6749, time: 0.4350
epoch 38    train auc: 0.9619  acc: 0.8663    eval auc: 0.7490  acc: 0.6810    test auc: 0.7499  acc: 0.6799, time: 0.7107
epoch 39    train auc: 0.9671  acc: 0.8763    eval auc: 0.7399  acc: 0.6723    test auc: 0.7407  acc: 0.6695, time: 0.4576
epoch 40    train auc: 0.9669  acc: 0.8765    eval auc: 0.7465  acc: 0.6804    test auc: 0.7473  acc: 0.6769, time: 0.7200
epoch 41    train auc: 0.9717  acc: 0.8905    eval auc: 0.7390  acc: 0.6715    test auc: 0.7403  acc: 0.6734, time: 0.4418
epoch 42    train auc: 0.9710  acc: 0.8878    eval auc: 0.7450  acc: 0.6787    test auc: 0.7454  acc: 0.6820, time: 0.7186
epoch 43    train auc: 0.9750  acc: 0.9007    eval auc: 0.7385  acc: 0.6740    test auc: 0.7399  acc: 0.6771, time: 0.4270
epoch 44    train auc: 0.9743  acc: 0.8952    eval auc: 0.7423  acc: 0.6788    test auc: 0.7431  acc: 0.6798, time: 0.7169
epoch 45    train auc: 0.9782  acc: 0.9057    eval auc: 0.7360  acc: 0.6725    test auc: 0.7377  acc: 0.6806, time: 0.4420
epoch 46    train auc: 0.9783  acc: 0.9024    eval auc: 0.7384  acc: 0.6769    test auc: 0.7393  acc: 0.6795, time: 0.6997
epoch 47    train auc: 0.9803  acc: 0.9109    eval auc: 0.7315  acc: 0.6726    test auc: 0.7319  acc: 0.6747, time: 0.4429
epoch 48    train auc: 0.9802  acc: 0.9088    eval auc: 0.7374  acc: 0.6785    test auc: 0.7381  acc: 0.6820, time: 0.7182
epoch 49    train auc: 0.9822  acc: 0.9136    eval auc: 0.7350  acc: 0.6779    test auc: 0.7358  acc: 0.6820, time: 0.4457
avg time per epoch : 0.6034433031082154
--- 36.01492357254028 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:08:29.944100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:08:29.944452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5285  acc: 0.5190    eval auc: 0.5057  acc: 0.5077    test auc: 0.5142  acc: 0.5126, time: 1.0846
epoch 1    train auc: 0.5385  acc: 0.5163    eval auc: 0.4645  acc: 0.4763    test auc: 0.4760  acc: 0.4835, time: 0.4819
epoch 2    train auc: 0.7019  acc: 0.6348    eval auc: 0.5906  acc: 0.5702    test auc: 0.5979  acc: 0.5775, time: 0.7731
epoch 3    train auc: 0.7494  acc: 0.6155    eval auc: 0.6469  acc: 0.6033    test auc: 0.6522  acc: 0.6128, time: 0.4330
epoch 4    train auc: 0.8658  acc: 0.7374    eval auc: 0.7682  acc: 0.7147    test auc: 0.7697  acc: 0.7255, time: 0.6880
epoch 5    train auc: 0.8792  acc: 0.7513    eval auc: 0.7781  acc: 0.7239    test auc: 0.7791  acc: 0.7362, time: 0.4249
epoch 6    train auc: 0.8862  acc: 0.7794    eval auc: 0.7871  acc: 0.7479    test auc: 0.7890  acc: 0.7533, time: 0.7020
epoch 7    train auc: 0.8903  acc: 0.7844    eval auc: 0.7877  acc: 0.7480    test auc: 0.7894  acc: 0.7532, time: 0.4482
epoch 8    train auc: 0.8948  acc: 0.7883    eval auc: 0.7907  acc: 0.7500    test auc: 0.7926  acc: 0.7532, time: 0.7045
epoch 9    train auc: 0.8972  acc: 0.7967    eval auc: 0.7902  acc: 0.7452    test auc: 0.7921  acc: 0.7463, time: 0.4433
epoch 10    train auc: 0.9004  acc: 0.7965    eval auc: 0.7926  acc: 0.7434    test auc: 0.7945  acc: 0.7460, time: 0.7097
epoch 11    train auc: 0.9029  acc: 0.8018    eval auc: 0.7919  acc: 0.7420    test auc: 0.7933  acc: 0.7361, time: 0.4300
epoch 12    train auc: 0.9051  acc: 0.7974    eval auc: 0.7935  acc: 0.7396    test auc: 0.7946  acc: 0.7420, time: 0.7165
epoch 13    train auc: 0.9069  acc: 0.8077    eval auc: 0.7929  acc: 0.7347    test auc: 0.7941  acc: 0.7278, time: 0.4509
epoch 14    train auc: 0.9083  acc: 0.8022    eval auc: 0.7940  acc: 0.7374    test auc: 0.7948  acc: 0.7328, time: 0.6996
epoch 15    train auc: 0.9104  acc: 0.8103    eval auc: 0.7932  acc: 0.7305    test auc: 0.7937  acc: 0.7254, time: 0.4349
epoch 16    train auc: 0.9110  acc: 0.8050    eval auc: 0.7938  acc: 0.7342    test auc: 0.7940  acc: 0.7298, time: 0.7059
epoch 17    train auc: 0.9133  acc: 0.8151    eval auc: 0.7926  acc: 0.7239    test auc: 0.7930  acc: 0.7203, time: 0.4603
epoch 18    train auc: 0.9133  acc: 0.8070    eval auc: 0.7932  acc: 0.7323    test auc: 0.7933  acc: 0.7276, time: 0.7147
epoch 19    train auc: 0.9158  acc: 0.8171    eval auc: 0.7919  acc: 0.7202    test auc: 0.7924  acc: 0.7150, time: 0.4600
epoch 20    train auc: 0.9157  acc: 0.8133    eval auc: 0.7924  acc: 0.7290    test auc: 0.7923  acc: 0.7229, time: 0.7445
epoch 21    train auc: 0.9183  acc: 0.8169    eval auc: 0.7905  acc: 0.7213    test auc: 0.7901  acc: 0.7151, time: 0.4840
epoch 22    train auc: 0.9179  acc: 0.8150    eval auc: 0.7916  acc: 0.7282    test auc: 0.7913  acc: 0.7206, time: 0.7445
epoch 23    train auc: 0.9206  acc: 0.8192    eval auc: 0.7891  acc: 0.7186    test auc: 0.7886  acc: 0.7124, time: 0.4724
epoch 24    train auc: 0.9198  acc: 0.8158    eval auc: 0.7906  acc: 0.7269    test auc: 0.7901  acc: 0.7191, time: 0.7767
epoch 25    train auc: 0.9228  acc: 0.8214    eval auc: 0.7877  acc: 0.7166    test auc: 0.7869  acc: 0.7121, time: 0.4639
epoch 26    train auc: 0.9215  acc: 0.8173    eval auc: 0.7895  acc: 0.7248    test auc: 0.7889  acc: 0.7199, time: 0.7499
epoch 27    train auc: 0.9248  acc: 0.8232    eval auc: 0.7861  acc: 0.7140    test auc: 0.7851  acc: 0.7096, time: 0.4742
epoch 28    train auc: 0.9232  acc: 0.8192    eval auc: 0.7885  acc: 0.7209    test auc: 0.7879  acc: 0.7166, time: 0.7449
epoch 29    train auc: 0.9262  acc: 0.8232    eval auc: 0.7848  acc: 0.7140    test auc: 0.7834  acc: 0.7089, time: 0.4640
epoch 30    train auc: 0.9246  acc: 0.8206    eval auc: 0.7874  acc: 0.7190    test auc: 0.7866  acc: 0.7164, time: 0.7539
epoch 31    train auc: 0.9279  acc: 0.8255    eval auc: 0.7826  acc: 0.7111    test auc: 0.7811  acc: 0.7065, time: 0.4679
epoch 32    train auc: 0.9257  acc: 0.8205    eval auc: 0.7865  acc: 0.7204    test auc: 0.7855  acc: 0.7161, time: 0.7581
epoch 33    train auc: 0.9289  acc: 0.8254    eval auc: 0.7817  acc: 0.7117    test auc: 0.7799  acc: 0.7074, time: 0.4869
epoch 34    train auc: 0.9270  acc: 0.8219    eval auc: 0.7852  acc: 0.7172    test auc: 0.7845  acc: 0.7138, time: 0.7849
epoch 35    train auc: 0.9302  acc: 0.8273    eval auc: 0.7805  acc: 0.7086    test auc: 0.7791  acc: 0.7052, time: 0.4890
epoch 36    train auc: 0.9277  acc: 0.8219    eval auc: 0.7846  acc: 0.7179    test auc: 0.7838  acc: 0.7134, time: 0.7787
epoch 37    train auc: 0.9313  acc: 0.8292    eval auc: 0.7789  acc: 0.7065    test auc: 0.7777  acc: 0.7028, time: 0.4719
epoch 38    train auc: 0.9285  acc: 0.8225    eval auc: 0.7834  acc: 0.7161    test auc: 0.7827  acc: 0.7131, time: 0.7763
epoch 39    train auc: 0.9324  acc: 0.8297    eval auc: 0.7773  acc: 0.7042    test auc: 0.7759  acc: 0.7028, time: 0.4750
epoch 40    train auc: 0.9291  acc: 0.8223    eval auc: 0.7829  acc: 0.7159    test auc: 0.7822  acc: 0.7152, time: 0.7818
epoch 41    train auc: 0.9330  acc: 0.8301    eval auc: 0.7765  acc: 0.7036    test auc: 0.7754  acc: 0.7028, time: 0.4851
epoch 42    train auc: 0.9298  acc: 0.8233    eval auc: 0.7818  acc: 0.7145    test auc: 0.7811  acc: 0.7119, time: 0.7731
epoch 43    train auc: 0.9338  acc: 0.8315    eval auc: 0.7755  acc: 0.7042    test auc: 0.7738  acc: 0.7017, time: 0.4878
epoch 44    train auc: 0.9302  acc: 0.8238    eval auc: 0.7810  acc: 0.7144    test auc: 0.7804  acc: 0.7113, time: 0.7783
epoch 45    train auc: 0.9338  acc: 0.8293    eval auc: 0.7752  acc: 0.7047    test auc: 0.7732  acc: 0.7029, time: 0.4829
epoch 46    train auc: 0.9306  acc: 0.8235    eval auc: 0.7802  acc: 0.7139    test auc: 0.7797  acc: 0.7101, time: 0.7872
epoch 47    train auc: 0.9347  acc: 0.8313    eval auc: 0.7739  acc: 0.7037    test auc: 0.7720  acc: 0.7027, time: 0.4826
epoch 48    train auc: 0.9311  acc: 0.8245    eval auc: 0.7793  acc: 0.7124    test auc: 0.7789  acc: 0.7092, time: 0.7705
epoch 49    train auc: 0.9355  acc: 0.8322    eval auc: 0.7731  acc: 0.7021    test auc: 0.7715  acc: 0.7013, time: 0.4884
avg time per epoch : 0.6129149532318116
--- 36.18150448799133 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:09:06.121648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:09:06.121982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4923  acc: 0.4956    eval auc: 0.5069  acc: 0.4983    test auc: 0.5168  acc: 0.5149, time: 1.0939
epoch 1    train auc: 0.4951  acc: 0.4964    eval auc: 0.5094  acc: 0.5103    test auc: 0.5053  acc: 0.5005, time: 0.4789
epoch 2    train auc: 0.5010  acc: 0.4945    eval auc: 0.4953  acc: 0.5054    test auc: 0.5016  acc: 0.5113, time: 0.7927
epoch 3    train auc: 0.5432  acc: 0.5196    eval auc: 0.4380  acc: 0.4694    test auc: 0.4321  acc: 0.4717, time: 0.4809
epoch 4    train auc: 0.5789  acc: 0.5501    eval auc: 0.3832  acc: 0.4250    test auc: 0.3832  acc: 0.4246, time: 0.7790
epoch 5    train auc: 0.5862  acc: 0.5599    eval auc: 0.3731  acc: 0.4115    test auc: 0.3727  acc: 0.4088, time: 0.4790
epoch 6    train auc: 0.5897  acc: 0.5643    eval auc: 0.3684  acc: 0.4060    test auc: 0.3684  acc: 0.4012, time: 0.7846
epoch 7    train auc: 0.5923  acc: 0.5651    eval auc: 0.3660  acc: 0.4028    test auc: 0.3639  acc: 0.4018, time: 0.4830
epoch 8    train auc: 0.5936  acc: 0.5656    eval auc: 0.3646  acc: 0.4031    test auc: 0.3621  acc: 0.3999, time: 0.7729
epoch 9    train auc: 0.5945  acc: 0.5662    eval auc: 0.3641  acc: 0.4019    test auc: 0.3608  acc: 0.3995, time: 0.4958
epoch 10    train auc: 0.5951  acc: 0.5666    eval auc: 0.3634  acc: 0.4032    test auc: 0.3600  acc: 0.3971, time: 0.7463
epoch 11    train auc: 0.5956  acc: 0.5666    eval auc: 0.3630  acc: 0.4005    test auc: 0.3594  acc: 0.3996, time: 0.4722
epoch 12    train auc: 0.5959  acc: 0.5668    eval auc: 0.3627  acc: 0.4016    test auc: 0.3592  acc: 0.3980, time: 0.7679
epoch 13    train auc: 0.5961  acc: 0.5668    eval auc: 0.3629  acc: 0.4016    test auc: 0.3586  acc: 0.3979, time: 0.4735
epoch 14    train auc: 0.5963  acc: 0.5668    eval auc: 0.3627  acc: 0.4021    test auc: 0.3584  acc: 0.3974, time: 0.7702
epoch 15    train auc: 0.5965  acc: 0.5668    eval auc: 0.3627  acc: 0.4024    test auc: 0.3582  acc: 0.3971, time: 0.4761
epoch 16    train auc: 0.5966  acc: 0.5668    eval auc: 0.3627  acc: 0.4024    test auc: 0.3581  acc: 0.3971, time: 0.7642
epoch 17    train auc: 0.5967  acc: 0.5668    eval auc: 0.3625  acc: 0.4013    test auc: 0.3581  acc: 0.3982, time: 0.4745
epoch 18    train auc: 0.5968  acc: 0.5669    eval auc: 0.3625  acc: 0.4029    test auc: 0.3580  acc: 0.3965, time: 0.7560
epoch 19    train auc: 0.5969  acc: 0.5669    eval auc: 0.3624  acc: 0.4018    test auc: 0.3578  acc: 0.3976, time: 0.4661
epoch 20    train auc: 0.5969  acc: 0.5669    eval auc: 0.3625  acc: 0.4010    test auc: 0.3578  acc: 0.3984, time: 0.7605
epoch 21    train auc: 0.5969  acc: 0.5669    eval auc: 0.3626  acc: 0.4029    test auc: 0.3576  acc: 0.3965, time: 0.4634
epoch 22    train auc: 0.5970  acc: 0.5669    eval auc: 0.3628  acc: 0.4035    test auc: 0.3574  acc: 0.3959, time: 0.7570
epoch 23    train auc: 0.5970  acc: 0.5669    eval auc: 0.3629  acc: 0.4023    test auc: 0.3573  acc: 0.3971, time: 0.4703
epoch 24    train auc: 0.5971  acc: 0.5669    eval auc: 0.3627  acc: 0.4026    test auc: 0.3575  acc: 0.3967, time: 0.7586
epoch 25    train auc: 0.5971  acc: 0.5669    eval auc: 0.3628  acc: 0.4018    test auc: 0.3576  acc: 0.3976, time: 0.4519
epoch 26    train auc: 0.5971  acc: 0.5669    eval auc: 0.3627  acc: 0.4015    test auc: 0.3575  acc: 0.3979, time: 0.7453
epoch 27    train auc: 0.5971  acc: 0.5669    eval auc: 0.3628  acc: 0.4032    test auc: 0.3574  acc: 0.3962, time: 0.4500
epoch 28    train auc: 0.5971  acc: 0.5669    eval auc: 0.3628  acc: 0.4013    test auc: 0.3575  acc: 0.3980, time: 0.7448
epoch 29    train auc: 0.5972  acc: 0.5669    eval auc: 0.3628  acc: 0.4028    test auc: 0.3575  acc: 0.3966, time: 0.4670
epoch 30    train auc: 0.5972  acc: 0.5669    eval auc: 0.3630  acc: 0.4030    test auc: 0.3573  acc: 0.3964, time: 0.7518
epoch 31    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4031    test auc: 0.3573  acc: 0.3963, time: 0.4656
epoch 32    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4023    test auc: 0.3573  acc: 0.3971, time: 0.7625
epoch 33    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4038    test auc: 0.3571  acc: 0.3956, time: 0.4616
epoch 34    train auc: 0.5972  acc: 0.5669    eval auc: 0.3629  acc: 0.4032    test auc: 0.3574  acc: 0.3962, time: 0.7530
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3628  acc: 0.4016    test auc: 0.3575  acc: 0.3978, time: 0.4648
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4025    test auc: 0.3573  acc: 0.3969, time: 0.7430
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4041    test auc: 0.3573  acc: 0.3953, time: 0.4719
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3630  acc: 0.4018    test auc: 0.3574  acc: 0.3976, time: 0.7546
epoch 39    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4024    test auc: 0.3571  acc: 0.3970, time: 0.4470
epoch 40    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4043    test auc: 0.3571  acc: 0.3951, time: 0.7547
epoch 41    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4029    test auc: 0.3571  acc: 0.3965, time: 0.4654
epoch 42    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4039    test auc: 0.3571  acc: 0.3954, time: 0.7420
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4035    test auc: 0.3569  acc: 0.3959, time: 0.4630
epoch 44    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4029    test auc: 0.3571  acc: 0.3965, time: 0.7561
epoch 45    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4039    test auc: 0.3569  acc: 0.3954, time: 0.4527
epoch 46    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4028    test auc: 0.3571  acc: 0.3966, time: 0.7424
epoch 47    train auc: 0.5973  acc: 0.5669    eval auc: 0.3634  acc: 0.4022    test auc: 0.3570  acc: 0.3972, time: 0.4534
epoch 48    train auc: 0.5973  acc: 0.5669    eval auc: 0.3634  acc: 0.4048    test auc: 0.3571  acc: 0.3946, time: 0.7374
epoch 49    train auc: 0.5973  acc: 0.5669    eval auc: 0.3632  acc: 0.4018    test auc: 0.3573  acc: 0.3976, time: 0.4482
avg time per epoch : 0.6193590354919434
--- 36.81157350540161 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:09:42.943835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:09:42.944173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4957  acc: 0.4975    eval auc: 0.5060  acc: 0.5008    test auc: 0.5071  acc: 0.5068, time: 1.0843
epoch 1    train auc: 0.5090  acc: 0.4974    eval auc: 0.4864  acc: 0.5077    test auc: 0.4862  acc: 0.5002, time: 0.4369
epoch 2    train auc: 0.5371  acc: 0.5041    eval auc: 0.4445  acc: 0.4958    test auc: 0.4442  acc: 0.4918, time: 0.7325
epoch 3    train auc: 0.5515  acc: 0.5057    eval auc: 0.4280  acc: 0.4933    test auc: 0.4242  acc: 0.4897, time: 0.4389
epoch 4    train auc: 0.5806  acc: 0.5089    eval auc: 0.4302  acc: 0.4898    test auc: 0.4263  acc: 0.4834, time: 0.7200
epoch 5    train auc: 0.7473  acc: 0.6085    eval auc: 0.6173  acc: 0.5998    test auc: 0.6241  acc: 0.6060, time: 0.4340
epoch 6    train auc: 0.8684  acc: 0.7384    eval auc: 0.7547  acc: 0.7174    test auc: 0.7590  acc: 0.7277, time: 0.7079
epoch 7    train auc: 0.8848  acc: 0.7634    eval auc: 0.7769  acc: 0.7347    test auc: 0.7803  acc: 0.7432, time: 0.4424
epoch 8    train auc: 0.8917  acc: 0.7756    eval auc: 0.7838  acc: 0.7455    test auc: 0.7866  acc: 0.7525, time: 0.7040
epoch 9    train auc: 0.8958  acc: 0.7848    eval auc: 0.7874  acc: 0.7507    test auc: 0.7898  acc: 0.7572, time: 0.4350
epoch 10    train auc: 0.8982  acc: 0.7964    eval auc: 0.7898  acc: 0.7485    test auc: 0.7922  acc: 0.7481, time: 0.7028
epoch 11    train auc: 0.9024  acc: 0.7903    eval auc: 0.7907  acc: 0.7506    test auc: 0.7923  acc: 0.7539, time: 0.4397
epoch 12    train auc: 0.9048  acc: 0.7958    eval auc: 0.7915  acc: 0.7484    test auc: 0.7930  acc: 0.7484, time: 0.7227
epoch 13    train auc: 0.9072  acc: 0.7984    eval auc: 0.7916  acc: 0.7461    test auc: 0.7928  acc: 0.7434, time: 0.4456
epoch 14    train auc: 0.9093  acc: 0.8032    eval auc: 0.7910  acc: 0.7406    test auc: 0.7922  acc: 0.7342, time: 0.7061
epoch 15    train auc: 0.9117  acc: 0.8016    eval auc: 0.7907  acc: 0.7414    test auc: 0.7913  acc: 0.7355, time: 0.4300
epoch 16    train auc: 0.9141  acc: 0.8067    eval auc: 0.7890  acc: 0.7346    test auc: 0.7896  acc: 0.7275, time: 0.7112
epoch 17    train auc: 0.9163  acc: 0.8084    eval auc: 0.7873  acc: 0.7296    test auc: 0.7877  acc: 0.7229, time: 0.4413
epoch 18    train auc: 0.9183  acc: 0.8098    eval auc: 0.7857  acc: 0.7244    test auc: 0.7860  acc: 0.7203, time: 0.7163
epoch 19    train auc: 0.9202  acc: 0.8152    eval auc: 0.7827  acc: 0.7138    test auc: 0.7831  acc: 0.7080, time: 0.4642
epoch 20    train auc: 0.9220  acc: 0.8181    eval auc: 0.7808  acc: 0.7122    test auc: 0.7810  acc: 0.7066, time: 0.7519
epoch 21    train auc: 0.9234  acc: 0.8173    eval auc: 0.7803  acc: 0.7143    test auc: 0.7800  acc: 0.7107, time: 0.4640
epoch 22    train auc: 0.9246  acc: 0.8217    eval auc: 0.7791  acc: 0.7105    test auc: 0.7788  acc: 0.7052, time: 0.7356
epoch 23    train auc: 0.9259  acc: 0.8225    eval auc: 0.7783  acc: 0.7113    test auc: 0.7777  acc: 0.7060, time: 0.4419
epoch 24    train auc: 0.9271  acc: 0.8243    eval auc: 0.7767  acc: 0.7081    test auc: 0.7762  acc: 0.7022, time: 0.7419
epoch 25    train auc: 0.9280  acc: 0.8247    eval auc: 0.7772  acc: 0.7112    test auc: 0.7761  acc: 0.7043, time: 0.4449
epoch 26    train auc: 0.9290  acc: 0.8256    eval auc: 0.7758  acc: 0.7086    test auc: 0.7748  acc: 0.7039, time: 0.7424
epoch 27    train auc: 0.9300  acc: 0.8269    eval auc: 0.7744  acc: 0.7047    test auc: 0.7733  acc: 0.7011, time: 0.4469
epoch 28    train auc: 0.9307  acc: 0.8283    eval auc: 0.7740  acc: 0.7036    test auc: 0.7730  acc: 0.6991, time: 0.7219
epoch 29    train auc: 0.9316  acc: 0.8277    eval auc: 0.7742  acc: 0.7055    test auc: 0.7728  acc: 0.7008, time: 0.4430
epoch 30    train auc: 0.9324  acc: 0.8295    eval auc: 0.7730  acc: 0.7026    test auc: 0.7718  acc: 0.6996, time: 0.7280
epoch 31    train auc: 0.9333  acc: 0.8297    eval auc: 0.7716  acc: 0.7026    test auc: 0.7703  acc: 0.6995, time: 0.4573
epoch 32    train auc: 0.9338  acc: 0.8304    eval auc: 0.7725  acc: 0.7040    test auc: 0.7711  acc: 0.7008, time: 0.7367
epoch 33    train auc: 0.9343  acc: 0.8308    eval auc: 0.7719  acc: 0.7026    test auc: 0.7702  acc: 0.7009, time: 0.4330
epoch 34    train auc: 0.9353  acc: 0.8350    eval auc: 0.7695  acc: 0.6962    test auc: 0.7686  acc: 0.6954, time: 0.7299
epoch 35    train auc: 0.9360  acc: 0.8346    eval auc: 0.7700  acc: 0.7006    test auc: 0.7685  acc: 0.6983, time: 0.4380
epoch 36    train auc: 0.9365  acc: 0.8360    eval auc: 0.7700  acc: 0.7002    test auc: 0.7690  acc: 0.6978, time: 0.7114
epoch 37    train auc: 0.9372  acc: 0.8371    eval auc: 0.7694  acc: 0.6997    test auc: 0.7683  acc: 0.6972, time: 0.4479
epoch 38    train auc: 0.9379  acc: 0.8384    eval auc: 0.7683  acc: 0.6980    test auc: 0.7673  acc: 0.6956, time: 0.7059
epoch 39    train auc: 0.9386  acc: 0.8406    eval auc: 0.7677  acc: 0.6971    test auc: 0.7663  acc: 0.6963, time: 0.4431
epoch 40    train auc: 0.9389  acc: 0.8401    eval auc: 0.7684  acc: 0.6991    test auc: 0.7670  acc: 0.6971, time: 0.7205
epoch 41    train auc: 0.9397  acc: 0.8424    eval auc: 0.7661  acc: 0.6936    test auc: 0.7652  acc: 0.6930, time: 0.4434
epoch 42    train auc: 0.9403  acc: 0.8425    eval auc: 0.7660  acc: 0.6941    test auc: 0.7651  acc: 0.6930, time: 0.7028
epoch 43    train auc: 0.9408  acc: 0.8422    eval auc: 0.7659  acc: 0.6944    test auc: 0.7647  acc: 0.6936, time: 0.4396
epoch 44    train auc: 0.9412  acc: 0.8427    eval auc: 0.7659  acc: 0.6937    test auc: 0.7649  acc: 0.6937, time: 0.7160
epoch 45    train auc: 0.9413  acc: 0.8430    eval auc: 0.7659  acc: 0.6965    test auc: 0.7642  acc: 0.6924, time: 0.4344
epoch 46    train auc: 0.9422  acc: 0.8449    eval auc: 0.7644  acc: 0.6934    test auc: 0.7634  acc: 0.6916, time: 0.7167
epoch 47    train auc: 0.9426  acc: 0.8445    eval auc: 0.7642  acc: 0.6945    test auc: 0.7629  acc: 0.6909, time: 0.4447
epoch 48    train auc: 0.9430  acc: 0.8459    eval auc: 0.7633  acc: 0.6918    test auc: 0.7623  acc: 0.6911, time: 0.7134
epoch 49    train auc: 0.9434  acc: 0.8458    eval auc: 0.7639  acc: 0.6939    test auc: 0.7623  acc: 0.6913, time: 0.4408
avg time per epoch : 0.589085521697998
--- 35.184699296951294 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:10:18.235545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:10:18.235901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4913  acc: 0.4980    eval auc: 0.5200  acc: 0.5035    test auc: 0.5079  acc: 0.5027, time: 1.5766
epoch 1    train auc: 0.8027  acc: 0.5167    eval auc: 0.7502  acc: 0.5056    test auc: 0.7577  acc: 0.5093, time: 1.1508
epoch 2    train auc: 0.8513  acc: 0.6497    eval auc: 0.7702  acc: 0.5592    test auc: 0.7818  acc: 0.5671, time: 1.1299
epoch 3    train auc: 0.8726  acc: 0.7257    eval auc: 0.7726  acc: 0.6181    test auc: 0.7824  acc: 0.6146, time: 1.1301
epoch 4    train auc: 0.8893  acc: 0.7639    eval auc: 0.7775  acc: 0.6544    test auc: 0.7846  acc: 0.6530, time: 1.1049
epoch 5    train auc: 0.9043  acc: 0.7815    eval auc: 0.7795  acc: 0.6739    test auc: 0.7837  acc: 0.6694, time: 1.1032
epoch 6    train auc: 0.9072  acc: 0.7865    eval auc: 0.7755  acc: 0.6784    test auc: 0.7787  acc: 0.6723, time: 1.0965
epoch 7    train auc: 0.9086  acc: 0.7879    eval auc: 0.7692  acc: 0.6738    test auc: 0.7724  acc: 0.6682, time: 1.0909
epoch 8    train auc: 0.9174  acc: 0.8031    eval auc: 0.7683  acc: 0.6808    test auc: 0.7700  acc: 0.6762, time: 1.0973
epoch 9    train auc: 0.9212  acc: 0.8094    eval auc: 0.7678  acc: 0.6840    test auc: 0.7694  acc: 0.6815, time: 1.0810
epoch 10    train auc: 0.9246  acc: 0.8144    eval auc: 0.7678  acc: 0.6876    test auc: 0.7690  acc: 0.6860, time: 1.0937
epoch 11    train auc: 0.9283  acc: 0.8210    eval auc: 0.7665  acc: 0.6899    test auc: 0.7673  acc: 0.6912, time: 1.0837
epoch 12    train auc: 0.9254  acc: 0.8160    eval auc: 0.7607  acc: 0.6844    test auc: 0.7619  acc: 0.6866, time: 1.0826
epoch 13    train auc: 0.9256  acc: 0.8139    eval auc: 0.7628  acc: 0.6859    test auc: 0.7643  acc: 0.6858, time: 1.0759
epoch 14    train auc: 0.9267  acc: 0.8148    eval auc: 0.7589  acc: 0.6811    test auc: 0.7601  acc: 0.6806, time: 1.0747
epoch 15    train auc: 0.9317  acc: 0.8220    eval auc: 0.7611  acc: 0.6857    test auc: 0.7618  acc: 0.6834, time: 1.0799
epoch 16    train auc: 0.9306  acc: 0.8191    eval auc: 0.7603  acc: 0.6876    test auc: 0.7607  acc: 0.6815, time: 1.0809
epoch 17    train auc: 0.9335  acc: 0.8236    eval auc: 0.7590  acc: 0.6840    test auc: 0.7587  acc: 0.6804, time: 1.0800
epoch 18    train auc: 0.9312  acc: 0.8185    eval auc: 0.7590  acc: 0.6834    test auc: 0.7595  acc: 0.6807, time: 1.1292
epoch 19    train auc: 0.9333  acc: 0.8203    eval auc: 0.7598  acc: 0.6867    test auc: 0.7597  acc: 0.6812, time: 1.0989
epoch 20    train auc: 0.9314  acc: 0.8184    eval auc: 0.7570  acc: 0.6832    test auc: 0.7569  acc: 0.6785, time: 1.1390
epoch 21    train auc: 0.9367  acc: 0.8262    eval auc: 0.7582  acc: 0.6846    test auc: 0.7592  acc: 0.6827, time: 1.1059
epoch 22    train auc: 0.9335  acc: 0.8207    eval auc: 0.7576  acc: 0.6821    test auc: 0.7584  acc: 0.6819, time: 1.1913
epoch 23    train auc: 0.9334  acc: 0.8198    eval auc: 0.7580  acc: 0.6823    test auc: 0.7591  acc: 0.6827, time: 1.1039
epoch 24    train auc: 0.9339  acc: 0.8211    eval auc: 0.7585  acc: 0.6841    test auc: 0.7600  acc: 0.6844, time: 1.1563
epoch 25    train auc: 0.9351  acc: 0.8234    eval auc: 0.7584  acc: 0.6870    test auc: 0.7594  acc: 0.6860, time: 1.1727
epoch 26    train auc: 0.9396  acc: 0.8303    eval auc: 0.7567  acc: 0.6852    test auc: 0.7574  acc: 0.6844, time: 1.1515
epoch 27    train auc: 0.9411  acc: 0.8328    eval auc: 0.7566  acc: 0.6869    test auc: 0.7575  acc: 0.6837, time: 1.1176
epoch 28    train auc: 0.9476  acc: 0.8455    eval auc: 0.7566  acc: 0.6869    test auc: 0.7568  acc: 0.6847, time: 1.1285
epoch 29    train auc: 0.9520  acc: 0.8540    eval auc: 0.7571  acc: 0.6874    test auc: 0.7566  acc: 0.6863, time: 1.0929
epoch 30    train auc: 0.9548  acc: 0.8584    eval auc: 0.7564  acc: 0.6893    test auc: 0.7563  acc: 0.6866, time: 1.1412
epoch 31    train auc: 0.9564  acc: 0.8622    eval auc: 0.7550  acc: 0.6867    test auc: 0.7558  acc: 0.6887, time: 1.1069
epoch 32    train auc: 0.9601  acc: 0.8691    eval auc: 0.7537  acc: 0.6866    test auc: 0.7544  acc: 0.6908, time: 1.1053
epoch 33    train auc: 0.9634  acc: 0.8746    eval auc: 0.7499  acc: 0.6852    test auc: 0.7499  acc: 0.6858, time: 1.1079
epoch 34    train auc: 0.9658  acc: 0.8792    eval auc: 0.7502  acc: 0.6873    test auc: 0.7499  acc: 0.6878, time: 1.1771
epoch 35    train auc: 0.9669  acc: 0.8809    eval auc: 0.7484  acc: 0.6858    test auc: 0.7486  acc: 0.6879, time: 1.3820
epoch 36    train auc: 0.9681  acc: 0.8829    eval auc: 0.7472  acc: 0.6877    test auc: 0.7481  acc: 0.6896, time: 1.3820
epoch 37    train auc: 0.9696  acc: 0.8846    eval auc: 0.7461  acc: 0.6869    test auc: 0.7467  acc: 0.6898, time: 1.3370
epoch 38    train auc: 0.9721  acc: 0.8896    eval auc: 0.7438  acc: 0.6869    test auc: 0.7452  acc: 0.6916, time: 1.3419
epoch 39    train auc: 0.9718  acc: 0.8899    eval auc: 0.7428  acc: 0.6846    test auc: 0.7439  acc: 0.6882, time: 1.3560
epoch 40    train auc: 0.9720  acc: 0.8913    eval auc: 0.7423  acc: 0.6872    test auc: 0.7434  acc: 0.6890, time: 1.3410
epoch 41    train auc: 0.9731  acc: 0.8934    eval auc: 0.7419  acc: 0.6882    test auc: 0.7431  acc: 0.6904, time: 1.3390
epoch 42    train auc: 0.9739  acc: 0.8938    eval auc: 0.7404  acc: 0.6878    test auc: 0.7417  acc: 0.6918, time: 1.3320
epoch 43    train auc: 0.9756  acc: 0.8978    eval auc: 0.7400  acc: 0.6863    test auc: 0.7407  acc: 0.6890, time: 1.3640
epoch 44    train auc: 0.9756  acc: 0.8978    eval auc: 0.7392  acc: 0.6866    test auc: 0.7401  acc: 0.6905, time: 1.3550
epoch 45    train auc: 0.9754  acc: 0.8979    eval auc: 0.7383  acc: 0.6869    test auc: 0.7387  acc: 0.6885, time: 1.3190
epoch 46    train auc: 0.9764  acc: 0.8984    eval auc: 0.7380  acc: 0.6887    test auc: 0.7386  acc: 0.6886, time: 1.3440
epoch 47    train auc: 0.9770  acc: 0.9011    eval auc: 0.7367  acc: 0.6900    test auc: 0.7365  acc: 0.6886, time: 1.3260
epoch 48    train auc: 0.9787  acc: 0.9057    eval auc: 0.7337  acc: 0.6877    test auc: 0.7341  acc: 0.6874, time: 1.3620
epoch 49    train auc: 0.9777  acc: 0.9037    eval auc: 0.7328  acc: 0.6865    test auc: 0.7339  acc: 0.6854, time: 1.3150
avg time per epoch : 1.1926966619491577
--- 70.1227171421051 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:11:28.423298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:11:28.423639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5640  acc: 0.5323    eval auc: 0.5622  acc: 0.5301    test auc: 0.5599  acc: 0.5337, time: 1.6100
epoch 1    train auc: 0.6847  acc: 0.6329    eval auc: 0.6283  acc: 0.5945    test auc: 0.6339  acc: 0.5976, time: 1.3320
epoch 2    train auc: 0.6757  acc: 0.6094    eval auc: 0.5986  acc: 0.5739    test auc: 0.6023  acc: 0.5721, time: 1.3060
epoch 3    train auc: 0.7883  acc: 0.5072    eval auc: 0.7491  acc: 0.5022    test auc: 0.7581  acc: 0.5064, time: 1.3280
epoch 4    train auc: 0.8500  acc: 0.7543    eval auc: 0.7811  acc: 0.6918    test auc: 0.7833  acc: 0.6852, time: 1.3180
epoch 5    train auc: 0.8733  acc: 0.7845    eval auc: 0.7915  acc: 0.7416    test auc: 0.7908  acc: 0.7454, time: 1.3190
epoch 6    train auc: 0.8828  acc: 0.7882    eval auc: 0.7972  acc: 0.7463    test auc: 0.7970  acc: 0.7504, time: 1.3150
epoch 7    train auc: 0.8881  acc: 0.7914    eval auc: 0.7978  acc: 0.7446    test auc: 0.7991  acc: 0.7427, time: 1.3080
epoch 8    train auc: 0.8917  acc: 0.7926    eval auc: 0.7997  acc: 0.7450    test auc: 0.8007  acc: 0.7444, time: 1.3060
epoch 9    train auc: 0.8945  acc: 0.7941    eval auc: 0.8009  acc: 0.7483    test auc: 0.8015  acc: 0.7455, time: 1.3090
epoch 10    train auc: 0.8970  acc: 0.7952    eval auc: 0.8015  acc: 0.7484    test auc: 0.8019  acc: 0.7464, time: 1.2850
epoch 11    train auc: 0.8989  acc: 0.7960    eval auc: 0.8015  acc: 0.7484    test auc: 0.8020  acc: 0.7454, time: 1.3000
epoch 12    train auc: 0.9006  acc: 0.7971    eval auc: 0.8013  acc: 0.7481    test auc: 0.8017  acc: 0.7439, time: 1.2990
epoch 13    train auc: 0.9019  acc: 0.7981    eval auc: 0.8009  acc: 0.7468    test auc: 0.8012  acc: 0.7402, time: 1.2680
epoch 14    train auc: 0.9035  acc: 0.7988    eval auc: 0.8007  acc: 0.7474    test auc: 0.8012  acc: 0.7395, time: 1.2770
epoch 15    train auc: 0.9046  acc: 0.7994    eval auc: 0.8007  acc: 0.7497    test auc: 0.8015  acc: 0.7409, time: 1.3120
epoch 16    train auc: 0.9056  acc: 0.8002    eval auc: 0.8001  acc: 0.7478    test auc: 0.8011  acc: 0.7418, time: 1.2930
epoch 17    train auc: 0.9062  acc: 0.8003    eval auc: 0.7993  acc: 0.7454    test auc: 0.8003  acc: 0.7374, time: 1.3170
epoch 18    train auc: 0.9070  acc: 0.8012    eval auc: 0.7989  acc: 0.7453    test auc: 0.8000  acc: 0.7360, time: 1.2960
epoch 19    train auc: 0.9076  acc: 0.8016    eval auc: 0.7985  acc: 0.7452    test auc: 0.7995  acc: 0.7356, time: 1.3010
epoch 20    train auc: 0.9080  acc: 0.8018    eval auc: 0.7979  acc: 0.7450    test auc: 0.7990  acc: 0.7344, time: 1.2950
epoch 21    train auc: 0.9086  acc: 0.8025    eval auc: 0.7976  acc: 0.7438    test auc: 0.7988  acc: 0.7336, time: 1.2820
epoch 22    train auc: 0.9089  acc: 0.8022    eval auc: 0.7971  acc: 0.7434    test auc: 0.7982  acc: 0.7316, time: 1.2850
epoch 23    train auc: 0.9092  acc: 0.8026    eval auc: 0.7965  acc: 0.7424    test auc: 0.7977  acc: 0.7308, time: 1.2630
epoch 24    train auc: 0.9097  acc: 0.8020    eval auc: 0.7962  acc: 0.7419    test auc: 0.7975  acc: 0.7308, time: 1.2810
epoch 25    train auc: 0.9099  acc: 0.8025    eval auc: 0.7958  acc: 0.7418    test auc: 0.7970  acc: 0.7304, time: 1.2280
epoch 26    train auc: 0.9104  acc: 0.8025    eval auc: 0.7956  acc: 0.7412    test auc: 0.7966  acc: 0.7292, time: 1.2440
epoch 27    train auc: 0.9105  acc: 0.8027    eval auc: 0.7949  acc: 0.7385    test auc: 0.7960  acc: 0.7276, time: 1.2250
epoch 28    train auc: 0.9109  acc: 0.8031    eval auc: 0.7946  acc: 0.7382    test auc: 0.7957  acc: 0.7264, time: 1.2310
epoch 29    train auc: 0.9111  acc: 0.8029    eval auc: 0.7942  acc: 0.7373    test auc: 0.7951  acc: 0.7250, time: 1.2100
epoch 30    train auc: 0.9113  acc: 0.8028    eval auc: 0.7939  acc: 0.7360    test auc: 0.7949  acc: 0.7230, time: 1.2160
epoch 31    train auc: 0.9118  acc: 0.8027    eval auc: 0.7936  acc: 0.7356    test auc: 0.7945  acc: 0.7224, time: 1.2080
epoch 32    train auc: 0.9121  acc: 0.8030    eval auc: 0.7932  acc: 0.7355    test auc: 0.7941  acc: 0.7216, time: 1.2449
epoch 33    train auc: 0.9120  acc: 0.8038    eval auc: 0.7925  acc: 0.7323    test auc: 0.7937  acc: 0.7196, time: 1.3130
epoch 34    train auc: 0.9125  acc: 0.8044    eval auc: 0.7923  acc: 0.7314    test auc: 0.7933  acc: 0.7194, time: 1.3030
epoch 35    train auc: 0.9127  acc: 0.8058    eval auc: 0.7917  acc: 0.7282    test auc: 0.7927  acc: 0.7163, time: 1.2860
epoch 36    train auc: 0.9132  acc: 0.8055    eval auc: 0.7916  acc: 0.7292    test auc: 0.7925  acc: 0.7170, time: 1.2720
epoch 37    train auc: 0.9133  acc: 0.8067    eval auc: 0.7910  acc: 0.7258    test auc: 0.7920  acc: 0.7131, time: 1.2680
epoch 38    train auc: 0.9137  acc: 0.8067    eval auc: 0.7908  acc: 0.7257    test auc: 0.7917  acc: 0.7120, time: 1.2430
epoch 39    train auc: 0.9138  acc: 0.8073    eval auc: 0.7901  acc: 0.7211    test auc: 0.7910  acc: 0.7087, time: 1.2640
epoch 40    train auc: 0.9144  acc: 0.8080    eval auc: 0.7898  acc: 0.7196    test auc: 0.7907  acc: 0.7078, time: 1.2450
epoch 41    train auc: 0.9145  acc: 0.8080    eval auc: 0.7896  acc: 0.7205    test auc: 0.7905  acc: 0.7088, time: 1.2400
epoch 42    train auc: 0.9147  acc: 0.8074    eval auc: 0.7890  acc: 0.7179    test auc: 0.7900  acc: 0.7065, time: 1.2400
epoch 43    train auc: 0.9148  acc: 0.8071    eval auc: 0.7885  acc: 0.7151    test auc: 0.7895  acc: 0.7055, time: 1.2170
epoch 44    train auc: 0.9151  acc: 0.8076    eval auc: 0.7883  acc: 0.7166    test auc: 0.7893  acc: 0.7062, time: 1.2300
epoch 45    train auc: 0.9153  acc: 0.8068    eval auc: 0.7879  acc: 0.7146    test auc: 0.7889  acc: 0.7048, time: 1.2210
epoch 46    train auc: 0.9154  acc: 0.8063    eval auc: 0.7874  acc: 0.7141    test auc: 0.7884  acc: 0.7034, time: 1.2300
epoch 47    train auc: 0.9156  acc: 0.8065    eval auc: 0.7874  acc: 0.7143    test auc: 0.7882  acc: 0.7026, time: 1.2160
epoch 48    train auc: 0.9157  acc: 0.8064    eval auc: 0.7869  acc: 0.7122    test auc: 0.7877  acc: 0.7003, time: 1.2280
epoch 49    train auc: 0.9158  acc: 0.8061    eval auc: 0.7866  acc: 0.7118    test auc: 0.7874  acc: 0.7001, time: 1.2010
avg time per epoch : 1.2765545845031738
--- 75.15896344184875 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:12:43.549665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:12:43.550012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4999  acc: 0.4989    eval auc: 0.5028  acc: 0.5002    test auc: 0.4974  acc: 0.5031, time: 1.5340
epoch 1    train auc: 0.4821  acc: 0.4864    eval auc: 0.5270  acc: 0.5225    test auc: 0.5263  acc: 0.5182, time: 1.1890
epoch 2    train auc: 0.5481  acc: 0.5353    eval auc: 0.4288  acc: 0.4481    test auc: 0.4283  acc: 0.4460, time: 1.1820
epoch 3    train auc: 0.5765  acc: 0.5534    eval auc: 0.3943  acc: 0.4317    test auc: 0.3801  acc: 0.4080, time: 1.1770
epoch 4    train auc: 0.5855  acc: 0.5584    eval auc: 0.3794  acc: 0.4146    test auc: 0.3682  acc: 0.4101, time: 1.2000
epoch 5    train auc: 0.5900  acc: 0.5612    eval auc: 0.3742  acc: 0.4130    test auc: 0.3621  acc: 0.4034, time: 1.1750
epoch 6    train auc: 0.6812  acc: 0.6148    eval auc: 0.4859  acc: 0.4748    test auc: 0.4838  acc: 0.4711, time: 1.1660
epoch 7    train auc: 0.8599  acc: 0.7618    eval auc: 0.7499  acc: 0.7294    test auc: 0.7506  acc: 0.7357, time: 1.1770
epoch 8    train auc: 0.8919  acc: 0.7876    eval auc: 0.7825  acc: 0.7359    test auc: 0.7809  acc: 0.7407, time: 1.1700
epoch 9    train auc: 0.9009  acc: 0.7935    eval auc: 0.7904  acc: 0.7347    test auc: 0.7867  acc: 0.7350, time: 1.1500
epoch 10    train auc: 0.9072  acc: 0.7984    eval auc: 0.7893  acc: 0.7302    test auc: 0.7854  acc: 0.7295, time: 1.1420
epoch 11    train auc: 0.9124  acc: 0.8042    eval auc: 0.7874  acc: 0.7249    test auc: 0.7828  acc: 0.7194, time: 1.1490
epoch 12    train auc: 0.9173  acc: 0.8099    eval auc: 0.7834  acc: 0.7157    test auc: 0.7780  acc: 0.7104, time: 1.1540
epoch 13    train auc: 0.9203  acc: 0.8131    eval auc: 0.7857  acc: 0.7185    test auc: 0.7799  acc: 0.7121, time: 1.1440
epoch 14    train auc: 0.9250  acc: 0.8212    eval auc: 0.7782  acc: 0.7063    test auc: 0.7729  acc: 0.7024, time: 1.1220
epoch 15    train auc: 0.9240  acc: 0.8171    eval auc: 0.7822  acc: 0.7117    test auc: 0.7765  acc: 0.7054, time: 1.1520
epoch 16    train auc: 0.9279  acc: 0.8227    eval auc: 0.7787  acc: 0.7074    test auc: 0.7736  acc: 0.7046, time: 1.2420
epoch 17    train auc: 0.9272  acc: 0.8203    eval auc: 0.7777  acc: 0.7080    test auc: 0.7724  acc: 0.7019, time: 1.2670
epoch 18    train auc: 0.9302  acc: 0.8249    eval auc: 0.7769  acc: 0.7067    test auc: 0.7724  acc: 0.7019, time: 1.3280
epoch 19    train auc: 0.9300  acc: 0.8232    eval auc: 0.7786  acc: 0.7091    test auc: 0.7739  acc: 0.7056, time: 1.3480
epoch 20    train auc: 0.9345  acc: 0.8315    eval auc: 0.7714  acc: 0.6996    test auc: 0.7673  acc: 0.6964, time: 1.3240
epoch 21    train auc: 0.9340  acc: 0.8289    eval auc: 0.7709  acc: 0.7013    test auc: 0.7661  acc: 0.6970, time: 1.3100
epoch 22    train auc: 0.9342  acc: 0.8291    eval auc: 0.7739  acc: 0.7042    test auc: 0.7699  acc: 0.7014, time: 1.3570
epoch 23    train auc: 0.9375  acc: 0.8355    eval auc: 0.7683  acc: 0.6969    test auc: 0.7649  acc: 0.6916, time: 1.3400
epoch 24    train auc: 0.9372  acc: 0.8333    eval auc: 0.7693  acc: 0.6994    test auc: 0.7656  acc: 0.6959, time: 1.3180
epoch 25    train auc: 0.9392  acc: 0.8381    eval auc: 0.7647  acc: 0.6942    test auc: 0.7613  acc: 0.6877, time: 1.3180
epoch 26    train auc: 0.9378  acc: 0.8337    eval auc: 0.7663  acc: 0.6969    test auc: 0.7623  acc: 0.6923, time: 1.3489
epoch 27    train auc: 0.9385  acc: 0.8345    eval auc: 0.7663  acc: 0.6969    test auc: 0.7626  acc: 0.6924, time: 1.3530
epoch 28    train auc: 0.9390  acc: 0.8350    eval auc: 0.7651  acc: 0.6965    test auc: 0.7620  acc: 0.6931, time: 1.3240
epoch 29    train auc: 0.9394  acc: 0.8341    eval auc: 0.7648  acc: 0.6958    test auc: 0.7615  acc: 0.6917, time: 1.3430
epoch 30    train auc: 0.9424  acc: 0.8407    eval auc: 0.7615  acc: 0.6935    test auc: 0.7586  acc: 0.6879, time: 1.3090
epoch 31    train auc: 0.9432  acc: 0.8406    eval auc: 0.7592  acc: 0.6891    test auc: 0.7565  acc: 0.6834, time: 1.3610
epoch 32    train auc: 0.9401  acc: 0.8325    eval auc: 0.7625  acc: 0.6944    test auc: 0.7590  acc: 0.6885, time: 1.3160
epoch 33    train auc: 0.9453  acc: 0.8432    eval auc: 0.7584  acc: 0.6883    test auc: 0.7564  acc: 0.6864, time: 1.3390
epoch 34    train auc: 0.9440  acc: 0.8402    eval auc: 0.7565  acc: 0.6895    test auc: 0.7537  acc: 0.6851, time: 1.3160
epoch 35    train auc: 0.9477  acc: 0.8463    eval auc: 0.7577  acc: 0.6882    test auc: 0.7564  acc: 0.6850, time: 1.3390
epoch 36    train auc: 0.9507  acc: 0.8510    eval auc: 0.7533  acc: 0.6857    test auc: 0.7518  acc: 0.6810, time: 1.3160
epoch 37    train auc: 0.9536  acc: 0.8546    eval auc: 0.7535  acc: 0.6833    test auc: 0.7521  acc: 0.6800, time: 1.3340
epoch 38    train auc: 0.9541  acc: 0.8534    eval auc: 0.7552  acc: 0.6860    test auc: 0.7535  acc: 0.6820, time: 1.3270
epoch 39    train auc: 0.9594  acc: 0.8620    eval auc: 0.7512  acc: 0.6786    test auc: 0.7490  acc: 0.6760, time: 1.4600
epoch 40    train auc: 0.9627  acc: 0.8676    eval auc: 0.7496  acc: 0.6789    test auc: 0.7484  acc: 0.6767, time: 1.5100
epoch 41    train auc: 0.9639  acc: 0.8707    eval auc: 0.7520  acc: 0.6826    test auc: 0.7512  acc: 0.6808, time: 1.5080
epoch 42    train auc: 0.9665  acc: 0.8747    eval auc: 0.7518  acc: 0.6843    test auc: 0.7511  acc: 0.6832, time: 1.4950
epoch 43    train auc: 0.9714  acc: 0.8845    eval auc: 0.7494  acc: 0.6811    test auc: 0.7481  acc: 0.6794, time: 1.4760
epoch 44    train auc: 0.9739  acc: 0.8905    eval auc: 0.7488  acc: 0.6831    test auc: 0.7491  acc: 0.6830, time: 1.4370
epoch 45    train auc: 0.9756  acc: 0.8937    eval auc: 0.7474  acc: 0.6810    test auc: 0.7469  acc: 0.6808, time: 1.4220
epoch 46    train auc: 0.9782  acc: 0.9011    eval auc: 0.7438  acc: 0.6797    test auc: 0.7441  acc: 0.6774, time: 1.4000
epoch 47    train auc: 0.9803  acc: 0.9056    eval auc: 0.7427  acc: 0.6780    test auc: 0.7433  acc: 0.6782, time: 1.4080
epoch 48    train auc: 0.9833  acc: 0.9142    eval auc: 0.7414  acc: 0.6776    test auc: 0.7426  acc: 0.6781, time: 1.4260
epoch 49    train auc: 0.9854  acc: 0.9199    eval auc: 0.7384  acc: 0.6734    test auc: 0.7398  acc: 0.6763, time: 1.3210
avg time per epoch : 1.3064623165130616
--- 76.64899778366089 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:14:00.457319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:14:00.457808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4981  acc: 0.5039    eval auc: 0.5089  acc: 0.5031    test auc: 0.5120  acc: 0.5064, time: 1.5970
epoch 1    train auc: 0.5055  acc: 0.5042    eval auc: 0.4942  acc: 0.4925    test auc: 0.4940  acc: 0.4982, time: 1.2510
epoch 2    train auc: 0.5403  acc: 0.5248    eval auc: 0.4439  acc: 0.4631    test auc: 0.4385  acc: 0.4645, time: 1.3159
epoch 3    train auc: 0.5622  acc: 0.5390    eval auc: 0.4158  acc: 0.4474    test auc: 0.4064  acc: 0.4372, time: 1.3090
epoch 4    train auc: 0.5807  acc: 0.5546    eval auc: 0.4023  acc: 0.4289    test auc: 0.3933  acc: 0.4206, time: 1.3059
epoch 5    train auc: 0.6345  acc: 0.5844    eval auc: 0.4419  acc: 0.4574    test auc: 0.4351  acc: 0.4513, time: 1.2990
epoch 6    train auc: 0.8163  acc: 0.7217    eval auc: 0.6737  acc: 0.6658    test auc: 0.6805  acc: 0.6641, time: 1.2790
epoch 7    train auc: 0.8707  acc: 0.7711    eval auc: 0.7480  acc: 0.7211    test auc: 0.7514  acc: 0.7241, time: 1.2910
epoch 8    train auc: 0.8857  acc: 0.7874    eval auc: 0.7645  acc: 0.7296    test auc: 0.7670  acc: 0.7276, time: 1.2460
epoch 9    train auc: 0.8949  acc: 0.7880    eval auc: 0.7708  acc: 0.7359    test auc: 0.7724  acc: 0.7390, time: 1.3020
epoch 10    train auc: 0.9013  acc: 0.7938    eval auc: 0.7746  acc: 0.7350    test auc: 0.7757  acc: 0.7352, time: 1.3100
epoch 11    train auc: 0.9061  acc: 0.8008    eval auc: 0.7775  acc: 0.7309    test auc: 0.7780  acc: 0.7271, time: 1.2690
epoch 12    train auc: 0.9097  acc: 0.8021    eval auc: 0.7791  acc: 0.7318    test auc: 0.7791  acc: 0.7271, time: 1.2820
epoch 13    train auc: 0.9131  acc: 0.8079    eval auc: 0.7804  acc: 0.7271    test auc: 0.7800  acc: 0.7239, time: 1.2670
epoch 14    train auc: 0.9156  acc: 0.8089    eval auc: 0.7810  acc: 0.7284    test auc: 0.7803  acc: 0.7238, time: 1.2830
epoch 15    train auc: 0.9179  acc: 0.8125    eval auc: 0.7812  acc: 0.7248    test auc: 0.7802  acc: 0.7216, time: 1.2890
epoch 16    train auc: 0.9201  acc: 0.8177    eval auc: 0.7807  acc: 0.7187    test auc: 0.7794  acc: 0.7161, time: 1.2580
epoch 17    train auc: 0.9211  acc: 0.8129    eval auc: 0.7819  acc: 0.7243    test auc: 0.7803  acc: 0.7231, time: 1.2710
epoch 18    train auc: 0.9230  acc: 0.8191    eval auc: 0.7813  acc: 0.7219    test auc: 0.7794  acc: 0.7184, time: 1.2340
epoch 19    train auc: 0.9246  acc: 0.8227    eval auc: 0.7804  acc: 0.7166    test auc: 0.7783  acc: 0.7140, time: 1.2410
epoch 20    train auc: 0.9260  acc: 0.8251    eval auc: 0.7786  acc: 0.7107    test auc: 0.7763  acc: 0.7075, time: 1.2380
epoch 21    train auc: 0.9267  acc: 0.8230    eval auc: 0.7798  acc: 0.7166    test auc: 0.7775  acc: 0.7138, time: 1.2210
epoch 22    train auc: 0.9279  acc: 0.8268    eval auc: 0.7787  acc: 0.7107    test auc: 0.7762  acc: 0.7095, time: 1.2070
epoch 23    train auc: 0.9291  acc: 0.8277    eval auc: 0.7776  acc: 0.7088    test auc: 0.7750  acc: 0.7070, time: 1.2229
epoch 24    train auc: 0.9298  acc: 0.8287    eval auc: 0.7780  acc: 0.7107    test auc: 0.7753  acc: 0.7074, time: 1.2940
epoch 25    train auc: 0.9307  acc: 0.8299    eval auc: 0.7774  acc: 0.7092    test auc: 0.7746  acc: 0.7075, time: 1.3170
epoch 26    train auc: 0.9317  acc: 0.8321    eval auc: 0.7757  acc: 0.7059    test auc: 0.7727  acc: 0.7032, time: 1.3030
epoch 27    train auc: 0.9323  acc: 0.8327    eval auc: 0.7759  acc: 0.7062    test auc: 0.7729  acc: 0.7042, time: 1.2920
epoch 28    train auc: 0.9329  acc: 0.8327    eval auc: 0.7756  acc: 0.7070    test auc: 0.7726  acc: 0.7037, time: 1.2760
epoch 29    train auc: 0.9334  acc: 0.8323    eval auc: 0.7756  acc: 0.7083    test auc: 0.7727  acc: 0.7055, time: 1.2770
epoch 30    train auc: 0.9344  acc: 0.8347    eval auc: 0.7741  acc: 0.7039    test auc: 0.7715  acc: 0.7021, time: 1.2560
epoch 31    train auc: 0.9350  acc: 0.8350    eval auc: 0.7734  acc: 0.7037    test auc: 0.7708  acc: 0.7029, time: 1.2490
epoch 32    train auc: 0.9355  acc: 0.8350    eval auc: 0.7730  acc: 0.7029    test auc: 0.7706  acc: 0.7041, time: 1.2560
epoch 33    train auc: 0.9360  acc: 0.8359    eval auc: 0.7728  acc: 0.7030    test auc: 0.7708  acc: 0.7037, time: 1.2170
epoch 34    train auc: 0.9364  acc: 0.8352    eval auc: 0.7726  acc: 0.7047    test auc: 0.7702  acc: 0.7042, time: 1.2290
epoch 35    train auc: 0.9374  acc: 0.8378    eval auc: 0.7708  acc: 0.7009    test auc: 0.7689  acc: 0.6994, time: 1.2110
epoch 36    train auc: 0.9379  acc: 0.8389    eval auc: 0.7706  acc: 0.7020    test auc: 0.7687  acc: 0.6990, time: 1.2280
epoch 37    train auc: 0.9383  acc: 0.8397    eval auc: 0.7688  acc: 0.6987    test auc: 0.7670  acc: 0.6962, time: 1.2070
epoch 38    train auc: 0.9388  acc: 0.8389    eval auc: 0.7698  acc: 0.6997    test auc: 0.7677  acc: 0.6998, time: 1.1890
epoch 39    train auc: 0.9394  acc: 0.8407    eval auc: 0.7686  acc: 0.6991    test auc: 0.7667  acc: 0.6977, time: 1.1860
epoch 40    train auc: 0.9400  acc: 0.8407    eval auc: 0.7679  acc: 0.6978    test auc: 0.7661  acc: 0.6982, time: 1.1970
epoch 41    train auc: 0.9402  acc: 0.8406    eval auc: 0.7678  acc: 0.6985    test auc: 0.7662  acc: 0.6978, time: 1.1799
epoch 42    train auc: 0.9411  acc: 0.8430    eval auc: 0.7656  acc: 0.6935    test auc: 0.7639  acc: 0.6917, time: 1.1870
epoch 43    train auc: 0.9413  acc: 0.8434    eval auc: 0.7655  acc: 0.6939    test auc: 0.7639  acc: 0.6930, time: 1.1540
epoch 44    train auc: 0.9418  acc: 0.8430    eval auc: 0.7656  acc: 0.6949    test auc: 0.7641  acc: 0.6939, time: 1.1790
epoch 45    train auc: 0.9424  acc: 0.8442    eval auc: 0.7644  acc: 0.6934    test auc: 0.7628  acc: 0.6922, time: 1.1840
epoch 46    train auc: 0.9425  acc: 0.8436    eval auc: 0.7653  acc: 0.6943    test auc: 0.7636  acc: 0.6962, time: 1.1900
epoch 47    train auc: 0.9431  acc: 0.8445    eval auc: 0.7633  acc: 0.6903    test auc: 0.7620  acc: 0.6916, time: 1.2400
epoch 48    train auc: 0.9433  acc: 0.8451    eval auc: 0.7620  acc: 0.6850    test auc: 0.7607  acc: 0.6892, time: 1.3230
epoch 49    train auc: 0.9439  acc: 0.8450    eval auc: 0.7630  acc: 0.6928    test auc: 0.7619  acc: 0.6936, time: 1.3110
avg time per epoch : 1.2583917713165282
--- 74.00703716278076 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:15:14.336056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:15:14.336394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4991  acc: 0.4996    eval auc: 0.5023  acc: 0.4975    test auc: 0.5020  acc: 0.5036, time: 1.5790
epoch 1    train auc: 0.8605  acc: 0.7385    eval auc: 0.7830  acc: 0.7179    test auc: 0.7911  acc: 0.7292, time: 1.2910
epoch 2    train auc: 0.8903  acc: 0.7849    eval auc: 0.7942  acc: 0.7505    test auc: 0.7986  acc: 0.7581, time: 1.2930
epoch 3    train auc: 0.9028  acc: 0.7963    eval auc: 0.7985  acc: 0.7498    test auc: 0.8006  acc: 0.7504, time: 1.2440
epoch 4    train auc: 0.9095  acc: 0.8038    eval auc: 0.7974  acc: 0.7407    test auc: 0.7987  acc: 0.7407, time: 1.2670
epoch 5    train auc: 0.9151  acc: 0.8057    eval auc: 0.7948  acc: 0.7389    test auc: 0.7954  acc: 0.7356, time: 1.2320
epoch 6    train auc: 0.9177  acc: 0.8072    eval auc: 0.7928  acc: 0.7360    test auc: 0.7934  acc: 0.7314, time: 1.2750
epoch 7    train auc: 0.9202  acc: 0.8109    eval auc: 0.7904  acc: 0.7322    test auc: 0.7913  acc: 0.7284, time: 1.4540
epoch 8    train auc: 0.9244  acc: 0.8149    eval auc: 0.7869  acc: 0.7263    test auc: 0.7872  acc: 0.7230, time: 1.3610
epoch 9    train auc: 0.9251  acc: 0.8138    eval auc: 0.7866  acc: 0.7274    test auc: 0.7864  acc: 0.7233, time: 1.2970
epoch 10    train auc: 0.9264  acc: 0.8134    eval auc: 0.7848  acc: 0.7239    test auc: 0.7847  acc: 0.7212, time: 1.2650
epoch 11    train auc: 0.9277  acc: 0.8142    eval auc: 0.7842  acc: 0.7226    test auc: 0.7834  acc: 0.7232, time: 1.2860
epoch 12    train auc: 0.9295  acc: 0.8169    eval auc: 0.7810  acc: 0.7190    test auc: 0.7797  acc: 0.7160, time: 1.2800
epoch 13    train auc: 0.9300  acc: 0.8170    eval auc: 0.7812  acc: 0.7190    test auc: 0.7796  acc: 0.7161, time: 1.2350
epoch 14    train auc: 0.9329  acc: 0.8222    eval auc: 0.7778  acc: 0.7148    test auc: 0.7767  acc: 0.7132, time: 1.2750
epoch 15    train auc: 0.9325  acc: 0.8193    eval auc: 0.7753  acc: 0.7096    test auc: 0.7738  acc: 0.7108, time: 1.2710
epoch 16    train auc: 0.9336  acc: 0.8201    eval auc: 0.7749  acc: 0.7105    test auc: 0.7737  acc: 0.7130, time: 1.2330
epoch 17    train auc: 0.9350  acc: 0.8216    eval auc: 0.7720  acc: 0.7047    test auc: 0.7699  acc: 0.7059, time: 1.2090
epoch 18    train auc: 0.9372  acc: 0.8255    eval auc: 0.7707  acc: 0.7050    test auc: 0.7693  acc: 0.7081, time: 1.2240
epoch 19    train auc: 0.9398  acc: 0.8277    eval auc: 0.7702  acc: 0.7059    test auc: 0.7680  acc: 0.7072, time: 1.2030
epoch 20    train auc: 0.9443  acc: 0.8343    eval auc: 0.7669  acc: 0.7059    test auc: 0.7636  acc: 0.7019, time: 1.2299
epoch 21    train auc: 0.9479  acc: 0.8412    eval auc: 0.7621  acc: 0.7008    test auc: 0.7575  acc: 0.6964, time: 1.2070
epoch 22    train auc: 0.9517  acc: 0.8474    eval auc: 0.7594  acc: 0.7017    test auc: 0.7535  acc: 0.6945, time: 1.1860
epoch 23    train auc: 0.9556  acc: 0.8556    eval auc: 0.7539  acc: 0.6985    test auc: 0.7480  acc: 0.6941, time: 1.1910
epoch 24    train auc: 0.9577  acc: 0.8586    eval auc: 0.7516  acc: 0.6994    test auc: 0.7450  acc: 0.6922, time: 1.2010
epoch 25    train auc: 0.9603  acc: 0.8632    eval auc: 0.7493  acc: 0.6987    test auc: 0.7424  acc: 0.6912, time: 1.1770
epoch 26    train auc: 0.9593  acc: 0.8589    eval auc: 0.7484  acc: 0.6994    test auc: 0.7402  acc: 0.6930, time: 1.1790
epoch 27    train auc: 0.9621  acc: 0.8630    eval auc: 0.7451  acc: 0.6949    test auc: 0.7373  acc: 0.6890, time: 1.1790
epoch 28    train auc: 0.9646  acc: 0.8689    eval auc: 0.7406  acc: 0.6912    test auc: 0.7323  acc: 0.6847, time: 1.1730
epoch 29    train auc: 0.9656  acc: 0.8711    eval auc: 0.7400  acc: 0.6900    test auc: 0.7315  acc: 0.6839, time: 1.1710
epoch 30    train auc: 0.9697  acc: 0.8789    eval auc: 0.7410  acc: 0.6923    test auc: 0.7321  acc: 0.6853, time: 1.1610
epoch 31    train auc: 0.9704  acc: 0.8786    eval auc: 0.7421  acc: 0.6923    test auc: 0.7334  acc: 0.6846, time: 1.1630
epoch 32    train auc: 0.9718  acc: 0.8824    eval auc: 0.7415  acc: 0.6895    test auc: 0.7324  acc: 0.6821, time: 1.2850
epoch 33    train auc: 0.9729  acc: 0.8850    eval auc: 0.7367  acc: 0.6844    test auc: 0.7276  acc: 0.6797, time: 1.3410
epoch 34    train auc: 0.9757  acc: 0.8917    eval auc: 0.7365  acc: 0.6852    test auc: 0.7272  acc: 0.6804, time: 1.2780
epoch 35    train auc: 0.9780  acc: 0.8976    eval auc: 0.7367  acc: 0.6854    test auc: 0.7269  acc: 0.6819, time: 1.2830
epoch 36    train auc: 0.9775  acc: 0.8972    eval auc: 0.7343  acc: 0.6840    test auc: 0.7250  acc: 0.6806, time: 1.2920
epoch 37    train auc: 0.9798  acc: 0.9022    eval auc: 0.7353  acc: 0.6840    test auc: 0.7267  acc: 0.6823, time: 1.2720
epoch 38    train auc: 0.9819  acc: 0.9074    eval auc: 0.7346  acc: 0.6823    test auc: 0.7269  acc: 0.6815, time: 1.2380
epoch 39    train auc: 0.9840  acc: 0.9156    eval auc: 0.7334  acc: 0.6853    test auc: 0.7252  acc: 0.6795, time: 1.2470
epoch 40    train auc: 0.9844  acc: 0.9168    eval auc: 0.7348  acc: 0.6866    test auc: 0.7259  acc: 0.6807, time: 1.2380
epoch 41    train auc: 0.9849  acc: 0.9196    eval auc: 0.7344  acc: 0.6833    test auc: 0.7258  acc: 0.6789, time: 1.2360
epoch 42    train auc: 0.9863  acc: 0.9248    eval auc: 0.7316  acc: 0.6830    test auc: 0.7232  acc: 0.6799, time: 1.2780
epoch 43    train auc: 0.9877  acc: 0.9290    eval auc: 0.7326  acc: 0.6850    test auc: 0.7240  acc: 0.6792, time: 1.3010
epoch 44    train auc: 0.9883  acc: 0.9312    eval auc: 0.7315  acc: 0.6852    test auc: 0.7230  acc: 0.6801, time: 1.3110
epoch 45    train auc: 0.9883  acc: 0.9318    eval auc: 0.7317  acc: 0.6846    test auc: 0.7228  acc: 0.6788, time: 1.3080
epoch 46    train auc: 0.9895  acc: 0.9360    eval auc: 0.7302  acc: 0.6833    test auc: 0.7211  acc: 0.6789, time: 1.2660
epoch 47    train auc: 0.9887  acc: 0.9358    eval auc: 0.7283  acc: 0.6821    test auc: 0.7195  acc: 0.6766, time: 1.2980
epoch 48    train auc: 0.9894  acc: 0.9376    eval auc: 0.7281  acc: 0.6817    test auc: 0.7184  acc: 0.6758, time: 1.2740
epoch 49    train auc: 0.9907  acc: 0.9420    eval auc: 0.7302  acc: 0.6849    test auc: 0.7202  acc: 0.6778, time: 1.2620
avg time per epoch : 1.2599773359298707
--- 73.77500033378601 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:16:28.131721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:16:28.132063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5310  acc: 0.5131    eval auc: 0.5136  acc: 0.5063    test auc: 0.5066  acc: 0.5049, time: 1.6130
epoch 1    train auc: 0.5858  acc: 0.5479    eval auc: 0.5068  acc: 0.5070    test auc: 0.5078  acc: 0.5075, time: 1.3000
epoch 2    train auc: 0.6132  acc: 0.5678    eval auc: 0.4791  acc: 0.4900    test auc: 0.4816  acc: 0.4938, time: 1.2650
epoch 3    train auc: 0.6163  acc: 0.5498    eval auc: 0.4812  acc: 0.4802    test auc: 0.4848  acc: 0.4760, time: 1.2580
epoch 4    train auc: 0.8146  acc: 0.7321    eval auc: 0.7228  acc: 0.7023    test auc: 0.7297  acc: 0.7152, time: 1.2400
epoch 5    train auc: 0.8575  acc: 0.7662    eval auc: 0.7703  acc: 0.7333    test auc: 0.7727  acc: 0.7437, time: 1.3160
epoch 6    train auc: 0.8711  acc: 0.7800    eval auc: 0.7859  acc: 0.7406    test auc: 0.7874  acc: 0.7501, time: 1.2200
epoch 7    train auc: 0.8780  acc: 0.7870    eval auc: 0.7925  acc: 0.7452    test auc: 0.7949  acc: 0.7509, time: 1.2450
epoch 8    train auc: 0.8822  acc: 0.7890    eval auc: 0.7961  acc: 0.7454    test auc: 0.7990  acc: 0.7506, time: 1.2040
epoch 9    train auc: 0.8853  acc: 0.7909    eval auc: 0.7982  acc: 0.7450    test auc: 0.8014  acc: 0.7496, time: 1.2090
epoch 10    train auc: 0.8878  acc: 0.7924    eval auc: 0.7994  acc: 0.7457    test auc: 0.8023  acc: 0.7506, time: 1.1930
epoch 11    train auc: 0.8898  acc: 0.7926    eval auc: 0.8001  acc: 0.7440    test auc: 0.8032  acc: 0.7492, time: 1.2200
epoch 12    train auc: 0.8916  acc: 0.7944    eval auc: 0.8003  acc: 0.7427    test auc: 0.8032  acc: 0.7478, time: 1.1860
epoch 13    train auc: 0.8932  acc: 0.7943    eval auc: 0.8003  acc: 0.7431    test auc: 0.8030  acc: 0.7470, time: 1.2209
epoch 14    train auc: 0.8948  acc: 0.7958    eval auc: 0.8000  acc: 0.7419    test auc: 0.8026  acc: 0.7447, time: 1.1800
epoch 15    train auc: 0.8962  acc: 0.7963    eval auc: 0.7996  acc: 0.7418    test auc: 0.8019  acc: 0.7425, time: 1.1950
epoch 16    train auc: 0.8976  acc: 0.7970    eval auc: 0.7992  acc: 0.7403    test auc: 0.8010  acc: 0.7405, time: 1.1960
epoch 17    train auc: 0.8988  acc: 0.7971    eval auc: 0.7985  acc: 0.7395    test auc: 0.8001  acc: 0.7385, time: 1.1649
epoch 18    train auc: 0.9000  acc: 0.7983    eval auc: 0.7977  acc: 0.7392    test auc: 0.7989  acc: 0.7373, time: 1.1880
epoch 19    train auc: 0.9011  acc: 0.7988    eval auc: 0.7968  acc: 0.7385    test auc: 0.7979  acc: 0.7354, time: 1.2740
epoch 20    train auc: 0.9024  acc: 0.7996    eval auc: 0.7959  acc: 0.7368    test auc: 0.7965  acc: 0.7339, time: 1.2790
epoch 21    train auc: 0.9035  acc: 0.7996    eval auc: 0.7949  acc: 0.7359    test auc: 0.7955  acc: 0.7330, time: 1.2999
epoch 22    train auc: 0.9048  acc: 0.8008    eval auc: 0.7939  acc: 0.7347    test auc: 0.7941  acc: 0.7333, time: 1.2630
epoch 23    train auc: 0.9057  acc: 0.8001    eval auc: 0.7927  acc: 0.7311    test auc: 0.7931  acc: 0.7314, time: 1.2599
epoch 24    train auc: 0.9062  acc: 0.8003    eval auc: 0.7918  acc: 0.7302    test auc: 0.7920  acc: 0.7315, time: 1.2810
epoch 25    train auc: 0.9070  acc: 0.7995    eval auc: 0.7907  acc: 0.7274    test auc: 0.7909  acc: 0.7291, time: 1.2420
epoch 26    train auc: 0.9076  acc: 0.8003    eval auc: 0.7901  acc: 0.7261    test auc: 0.7901  acc: 0.7287, time: 1.2290
epoch 27    train auc: 0.9079  acc: 0.7997    eval auc: 0.7892  acc: 0.7256    test auc: 0.7890  acc: 0.7283, time: 1.2810
epoch 28    train auc: 0.9088  acc: 0.8002    eval auc: 0.7887  acc: 0.7254    test auc: 0.7883  acc: 0.7271, time: 1.2810
epoch 29    train auc: 0.9092  acc: 0.7996    eval auc: 0.7880  acc: 0.7239    test auc: 0.7874  acc: 0.7259, time: 1.2870
epoch 30    train auc: 0.9098  acc: 0.7996    eval auc: 0.7874  acc: 0.7231    test auc: 0.7867  acc: 0.7254, time: 1.2449
epoch 31    train auc: 0.9106  acc: 0.8007    eval auc: 0.7868  acc: 0.7215    test auc: 0.7860  acc: 0.7251, time: 1.2520
epoch 32    train auc: 0.9113  acc: 0.8010    eval auc: 0.7862  acc: 0.7216    test auc: 0.7852  acc: 0.7243, time: 1.2400
epoch 33    train auc: 0.9113  acc: 0.8006    eval auc: 0.7855  acc: 0.7207    test auc: 0.7847  acc: 0.7220, time: 1.2460
epoch 34    train auc: 0.9121  acc: 0.8016    eval auc: 0.7850  acc: 0.7196    test auc: 0.7841  acc: 0.7210, time: 1.2360
epoch 35    train auc: 0.9125  acc: 0.8011    eval auc: 0.7843  acc: 0.7184    test auc: 0.7835  acc: 0.7194, time: 1.2390
epoch 36    train auc: 0.9132  acc: 0.8011    eval auc: 0.7842  acc: 0.7185    test auc: 0.7833  acc: 0.7193, time: 1.2220
epoch 37    train auc: 0.9136  acc: 0.8012    eval auc: 0.7837  acc: 0.7184    test auc: 0.7828  acc: 0.7178, time: 1.2050
epoch 38    train auc: 0.9148  acc: 0.8027    eval auc: 0.7836  acc: 0.7196    test auc: 0.7825  acc: 0.7168, time: 1.2250
epoch 39    train auc: 0.9150  acc: 0.8027    eval auc: 0.7832  acc: 0.7184    test auc: 0.7822  acc: 0.7159, time: 1.2050
epoch 40    train auc: 0.9159  acc: 0.8033    eval auc: 0.7828  acc: 0.7181    test auc: 0.7818  acc: 0.7164, time: 1.1860
epoch 41    train auc: 0.9163  acc: 0.8036    eval auc: 0.7824  acc: 0.7177    test auc: 0.7817  acc: 0.7158, time: 1.1790
epoch 42    train auc: 0.9168  acc: 0.8040    eval auc: 0.7820  acc: 0.7174    test auc: 0.7812  acc: 0.7159, time: 1.1630
epoch 43    train auc: 0.9171  acc: 0.8045    eval auc: 0.7816  acc: 0.7161    test auc: 0.7808  acc: 0.7161, time: 1.1540
epoch 44    train auc: 0.9179  acc: 0.8053    eval auc: 0.7814  acc: 0.7172    test auc: 0.7804  acc: 0.7147, time: 1.2890
epoch 45    train auc: 0.9186  acc: 0.8059    eval auc: 0.7809  acc: 0.7166    test auc: 0.7799  acc: 0.7139, time: 1.2960
epoch 46    train auc: 0.9191  acc: 0.8064    eval auc: 0.7807  acc: 0.7180    test auc: 0.7795  acc: 0.7144, time: 1.2640
epoch 47    train auc: 0.9191  acc: 0.8066    eval auc: 0.7798  acc: 0.7160    test auc: 0.7789  acc: 0.7131, time: 1.2620
epoch 48    train auc: 0.9200  acc: 0.8079    eval auc: 0.7801  acc: 0.7173    test auc: 0.7789  acc: 0.7135, time: 1.2640
epoch 49    train auc: 0.9205  acc: 0.8083    eval auc: 0.7796  acc: 0.7178    test auc: 0.7785  acc: 0.7141, time: 1.2440
avg time per epoch : 1.2441158533096313
--- 72.36900115013123 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:17:40.544889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:17:40.545229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4968  acc: 0.4991    eval auc: 0.5126  acc: 0.4957    test auc: 0.4973  acc: 0.5071, time: 1.4800
epoch 1    train auc: 0.4936  acc: 0.4957    eval auc: 0.5045  acc: 0.5003    test auc: 0.5148  acc: 0.5126, time: 1.1300
epoch 2    train auc: 0.8621  acc: 0.7531    eval auc: 0.7831  acc: 0.7300    test auc: 0.7900  acc: 0.7408, time: 1.2450
epoch 3    train auc: 0.8963  acc: 0.7812    eval auc: 0.7935  acc: 0.7472    test auc: 0.7972  acc: 0.7540, time: 1.1150
epoch 4    train auc: 0.9101  acc: 0.8027    eval auc: 0.7933  acc: 0.7342    test auc: 0.7936  acc: 0.7313, time: 1.1660
epoch 5    train auc: 0.9186  acc: 0.8116    eval auc: 0.7881  acc: 0.7249    test auc: 0.7874  acc: 0.7218, time: 1.2250
epoch 6    train auc: 0.9231  acc: 0.8189    eval auc: 0.7853  acc: 0.7210    test auc: 0.7852  acc: 0.7135, time: 1.2120
epoch 7    train auc: 0.9271  acc: 0.8224    eval auc: 0.7808  acc: 0.7124    test auc: 0.7811  acc: 0.7080, time: 1.2200
epoch 8    train auc: 0.9305  acc: 0.8276    eval auc: 0.7718  acc: 0.6981    test auc: 0.7716  acc: 0.6972, time: 1.2060
epoch 9    train auc: 0.9311  acc: 0.8240    eval auc: 0.7764  acc: 0.7109    test auc: 0.7761  acc: 0.7079, time: 1.1830
epoch 10    train auc: 0.9320  acc: 0.8232    eval auc: 0.7761  acc: 0.7107    test auc: 0.7742  acc: 0.7078, time: 1.1120
epoch 11    train auc: 0.9340  acc: 0.8269    eval auc: 0.7747  acc: 0.7078    test auc: 0.7730  acc: 0.7075, time: 1.1940
epoch 12    train auc: 0.9363  acc: 0.8327    eval auc: 0.7691  acc: 0.7009    test auc: 0.7676  acc: 0.7015, time: 1.1909
epoch 13    train auc: 0.9378  acc: 0.8342    eval auc: 0.7704  acc: 0.7013    test auc: 0.7698  acc: 0.7043, time: 1.1299
epoch 14    train auc: 0.9401  acc: 0.8380    eval auc: 0.7640  acc: 0.6931    test auc: 0.7637  acc: 0.6950, time: 1.1400
epoch 15    train auc: 0.9408  acc: 0.8378    eval auc: 0.7658  acc: 0.6967    test auc: 0.7653  acc: 0.6991, time: 1.2919
epoch 16    train auc: 0.9418  acc: 0.8375    eval auc: 0.7632  acc: 0.6932    test auc: 0.7631  acc: 0.6958, time: 1.3140
epoch 17    train auc: 0.9430  acc: 0.8392    eval auc: 0.7617  acc: 0.6906    test auc: 0.7611  acc: 0.6943, time: 1.1800
epoch 18    train auc: 0.9441  acc: 0.8391    eval auc: 0.7609  acc: 0.6886    test auc: 0.7608  acc: 0.6942, time: 1.1940
epoch 19    train auc: 0.9452  acc: 0.8406    eval auc: 0.7613  acc: 0.6899    test auc: 0.7611  acc: 0.6943, time: 1.2809
epoch 20    train auc: 0.9472  acc: 0.8436    eval auc: 0.7571  acc: 0.6865    test auc: 0.7568  acc: 0.6893, time: 1.2100
epoch 21    train auc: 0.9482  acc: 0.8447    eval auc: 0.7569  acc: 0.6866    test auc: 0.7572  acc: 0.6879, time: 1.1789
epoch 22    train auc: 0.9505  acc: 0.8478    eval auc: 0.7553  acc: 0.6851    test auc: 0.7564  acc: 0.6878, time: 1.1420
epoch 23    train auc: 0.9527  acc: 0.8505    eval auc: 0.7535  acc: 0.6828    test auc: 0.7556  acc: 0.6854, time: 1.1550
epoch 24    train auc: 0.9546  acc: 0.8510    eval auc: 0.7533  acc: 0.6795    test auc: 0.7556  acc: 0.6872, time: 1.1430
epoch 25    train auc: 0.9574  acc: 0.8553    eval auc: 0.7497  acc: 0.6798    test auc: 0.7520  acc: 0.6854, time: 1.1440
epoch 26    train auc: 0.9603  acc: 0.8591    eval auc: 0.7476  acc: 0.6780    test auc: 0.7495  acc: 0.6817, time: 1.1020
epoch 27    train auc: 0.9628  acc: 0.8627    eval auc: 0.7468  acc: 0.6793    test auc: 0.7477  acc: 0.6828, time: 1.1280
epoch 28    train auc: 0.9649  acc: 0.8674    eval auc: 0.7457  acc: 0.6779    test auc: 0.7470  acc: 0.6812, time: 1.0910
epoch 29    train auc: 0.9667  acc: 0.8719    eval auc: 0.7473  acc: 0.6820    test auc: 0.7487  acc: 0.6853, time: 1.1240
epoch 30    train auc: 0.9704  acc: 0.8809    eval auc: 0.7461  acc: 0.6853    test auc: 0.7466  acc: 0.6861, time: 1.1190
epoch 31    train auc: 0.9730  acc: 0.8873    eval auc: 0.7446  acc: 0.6863    test auc: 0.7449  acc: 0.6882, time: 1.1050
epoch 32    train auc: 0.9750  acc: 0.8913    eval auc: 0.7457  acc: 0.6916    test auc: 0.7464  acc: 0.6924, time: 1.1340
epoch 33    train auc: 0.9784  acc: 0.8996    eval auc: 0.7420  acc: 0.6871    test auc: 0.7425  acc: 0.6892, time: 1.1230
epoch 34    train auc: 0.9803  acc: 0.9046    eval auc: 0.7405  acc: 0.6860    test auc: 0.7394  acc: 0.6866, time: 1.0860
epoch 35    train auc: 0.9826  acc: 0.9125    eval auc: 0.7408  acc: 0.6851    test auc: 0.7409  acc: 0.6872, time: 1.1750
epoch 36    train auc: 0.9846  acc: 0.9186    eval auc: 0.7382  acc: 0.6836    test auc: 0.7380  acc: 0.6874, time: 1.2140
epoch 37    train auc: 0.9870  acc: 0.9269    eval auc: 0.7384  acc: 0.6828    test auc: 0.7387  acc: 0.6877, time: 1.2020
epoch 38    train auc: 0.9888  acc: 0.9316    eval auc: 0.7365  acc: 0.6817    test auc: 0.7372  acc: 0.6873, time: 1.1939
epoch 39    train auc: 0.9903  acc: 0.9369    eval auc: 0.7331  acc: 0.6782    test auc: 0.7329  acc: 0.6819, time: 1.2163
epoch 40    train auc: 0.9916  acc: 0.9431    eval auc: 0.7354  acc: 0.6806    test auc: 0.7351  acc: 0.6878, time: 1.1720
epoch 41    train auc: 0.9926  acc: 0.9460    eval auc: 0.7379  acc: 0.6817    test auc: 0.7384  acc: 0.6895, time: 1.1660
epoch 42    train auc: 0.9932  acc: 0.9503    eval auc: 0.7366  acc: 0.6793    test auc: 0.7373  acc: 0.6895, time: 1.1680
epoch 43    train auc: 0.9947  acc: 0.9567    eval auc: 0.7320  acc: 0.6775    test auc: 0.7324  acc: 0.6839, time: 1.1520
epoch 44    train auc: 0.9956  acc: 0.9600    eval auc: 0.7328  acc: 0.6776    test auc: 0.7326  acc: 0.6832, time: 1.1530
epoch 45    train auc: 0.9958  acc: 0.9614    eval auc: 0.7328  acc: 0.6756    test auc: 0.7330  acc: 0.6820, time: 1.1490
epoch 46    train auc: 0.9961  acc: 0.9623    eval auc: 0.7314  acc: 0.6736    test auc: 0.7324  acc: 0.6807, time: 1.1380
epoch 47    train auc: 0.9971  acc: 0.9689    eval auc: 0.7287  acc: 0.6684    test auc: 0.7289  acc: 0.6771, time: 1.1320
epoch 48    train auc: 0.9975  acc: 0.9706    eval auc: 0.7305  acc: 0.6741    test auc: 0.7306  acc: 0.6795, time: 1.1360
epoch 49    train auc: 0.9979  acc: 0.9736    eval auc: 0.7299  acc: 0.6723    test auc: 0.7289  acc: 0.6767, time: 1.1170
avg time per epoch : 1.173560724258423
--- 68.29934430122375 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:18:48.953371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:18:48.953738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4894  acc: 0.4946    eval auc: 0.5206  acc: 0.5100    test auc: 0.5112  acc: 0.5063, time: 1.5760
epoch 1    train auc: 0.5259  acc: 0.5083    eval auc: 0.4561  acc: 0.4873    test auc: 0.4666  acc: 0.4877, time: 1.2570
epoch 2    train auc: 0.5976  acc: 0.5671    eval auc: 0.4960  acc: 0.4949    test auc: 0.5077  acc: 0.4983, time: 1.2450
epoch 3    train auc: 0.7582  acc: 0.6432    eval auc: 0.6359  acc: 0.6225    test auc: 0.6513  acc: 0.6283, time: 1.2350
epoch 4    train auc: 0.8610  acc: 0.7309    eval auc: 0.7404  acc: 0.7076    test auc: 0.7471  acc: 0.7171, time: 1.2060
epoch 5    train auc: 0.8834  acc: 0.7632    eval auc: 0.7641  acc: 0.7296    test auc: 0.7688  acc: 0.7396, time: 1.2210
epoch 6    train auc: 0.8929  acc: 0.7881    eval auc: 0.7731  acc: 0.7354    test auc: 0.7758  acc: 0.7353, time: 1.2140
epoch 7    train auc: 0.8990  acc: 0.7996    eval auc: 0.7767  acc: 0.7302    test auc: 0.7785  acc: 0.7301, time: 1.2160
epoch 8    train auc: 0.9041  acc: 0.8141    eval auc: 0.7799  acc: 0.7163    test auc: 0.7809  acc: 0.7096, time: 1.2160
epoch 9    train auc: 0.9079  acc: 0.8094    eval auc: 0.7818  acc: 0.7268    test auc: 0.7818  acc: 0.7249, time: 1.1950
epoch 10    train auc: 0.9114  acc: 0.8118    eval auc: 0.7826  acc: 0.7256    test auc: 0.7819  acc: 0.7230, time: 1.1850
epoch 11    train auc: 0.9145  acc: 0.8156    eval auc: 0.7833  acc: 0.7217    test auc: 0.7820  acc: 0.7194, time: 1.1930
epoch 12    train auc: 0.9171  acc: 0.8169    eval auc: 0.7825  acc: 0.7212    test auc: 0.7805  acc: 0.7183, time: 1.1570
epoch 13    train auc: 0.9196  acc: 0.8206    eval auc: 0.7829  acc: 0.7167    test auc: 0.7808  acc: 0.7132, time: 1.1780
epoch 14    train auc: 0.9217  acc: 0.8237    eval auc: 0.7819  acc: 0.7159    test auc: 0.7796  acc: 0.7108, time: 1.1570
epoch 15    train auc: 0.9233  acc: 0.8227    eval auc: 0.7820  acc: 0.7158    test auc: 0.7795  acc: 0.7143, time: 1.1810
epoch 16    train auc: 0.9249  acc: 0.8270    eval auc: 0.7807  acc: 0.7140    test auc: 0.7784  acc: 0.7069, time: 1.1570
epoch 17    train auc: 0.9261  acc: 0.8243    eval auc: 0.7806  acc: 0.7143    test auc: 0.7776  acc: 0.7139, time: 1.1540
epoch 18    train auc: 0.9274  acc: 0.8271    eval auc: 0.7800  acc: 0.7125    test auc: 0.7772  acc: 0.7092, time: 1.1390
epoch 19    train auc: 0.9285  acc: 0.8295    eval auc: 0.7793  acc: 0.7115    test auc: 0.7766  acc: 0.7076, time: 1.1640
epoch 20    train auc: 0.9294  acc: 0.8298    eval auc: 0.7767  acc: 0.7053    test auc: 0.7742  acc: 0.6988, time: 1.1390
epoch 21    train auc: 0.9303  acc: 0.8295    eval auc: 0.7783  acc: 0.7111    test auc: 0.7755  acc: 0.7082, time: 1.1410
epoch 22    train auc: 0.9311  acc: 0.8319    eval auc: 0.7769  acc: 0.7062    test auc: 0.7744  acc: 0.7036, time: 1.1180
epoch 23    train auc: 0.9317  acc: 0.8311    eval auc: 0.7738  acc: 0.7008    test auc: 0.7718  acc: 0.6988, time: 1.1420
epoch 24    train auc: 0.9327  acc: 0.8336    eval auc: 0.7750  acc: 0.7029    test auc: 0.7727  acc: 0.6993, time: 1.1290
epoch 25    train auc: 0.9331  acc: 0.8319    eval auc: 0.7734  acc: 0.6991    test auc: 0.7715  acc: 0.6972, time: 1.1150
epoch 26    train auc: 0.9343  acc: 0.8349    eval auc: 0.7728  acc: 0.7001    test auc: 0.7702  acc: 0.6982, time: 1.1260
epoch 27    train auc: 0.9347  acc: 0.8350    eval auc: 0.7730  acc: 0.7003    test auc: 0.7704  acc: 0.7001, time: 1.1320
epoch 28    train auc: 0.9354  acc: 0.8354    eval auc: 0.7722  acc: 0.7000    test auc: 0.7695  acc: 0.6998, time: 1.0990
epoch 29    train auc: 0.9357  acc: 0.8354    eval auc: 0.7726  acc: 0.7009    test auc: 0.7699  acc: 0.7023, time: 1.1050
epoch 30    train auc: 0.9362  acc: 0.8362    eval auc: 0.7711  acc: 0.6985    test auc: 0.7689  acc: 0.6980, time: 1.0930
epoch 31    train auc: 0.9371  acc: 0.8376    eval auc: 0.7693  acc: 0.6955    test auc: 0.7669  acc: 0.6965, time: 1.2020
epoch 32    train auc: 0.9368  acc: 0.8347    eval auc: 0.7701  acc: 0.6998    test auc: 0.7671  acc: 0.7009, time: 1.1980
epoch 33    train auc: 0.9376  acc: 0.8379    eval auc: 0.7697  acc: 0.6981    test auc: 0.7676  acc: 0.6976, time: 1.2500
epoch 34    train auc: 0.9383  acc: 0.8393    eval auc: 0.7683  acc: 0.6967    test auc: 0.7658  acc: 0.6978, time: 1.2640
epoch 35    train auc: 0.9385  acc: 0.8391    eval auc: 0.7676  acc: 0.6958    test auc: 0.7657  acc: 0.6959, time: 1.2810
epoch 36    train auc: 0.9389  acc: 0.8397    eval auc: 0.7679  acc: 0.6961    test auc: 0.7657  acc: 0.6970, time: 1.2440
epoch 37    train auc: 0.9391  acc: 0.8389    eval auc: 0.7657  acc: 0.6932    test auc: 0.7639  acc: 0.6947, time: 1.2670
epoch 38    train auc: 0.9396  acc: 0.8404    eval auc: 0.7673  acc: 0.6962    test auc: 0.7649  acc: 0.6977, time: 1.2730
epoch 39    train auc: 0.9400  acc: 0.8409    eval auc: 0.7653  acc: 0.6926    test auc: 0.7636  acc: 0.6947, time: 1.2690
epoch 40    train auc: 0.9401  acc: 0.8406    eval auc: 0.7641  acc: 0.6918    test auc: 0.7625  acc: 0.6919, time: 1.2550
epoch 41    train auc: 0.9403  acc: 0.8401    eval auc: 0.7652  acc: 0.6934    test auc: 0.7635  acc: 0.6936, time: 1.2580
epoch 42    train auc: 0.9411  acc: 0.8421    eval auc: 0.7641  acc: 0.6924    test auc: 0.7622  acc: 0.6931, time: 1.2550
epoch 43    train auc: 0.9408  acc: 0.8411    eval auc: 0.7633  acc: 0.6912    test auc: 0.7618  acc: 0.6922, time: 1.2620
epoch 44    train auc: 0.9413  acc: 0.8421    eval auc: 0.7636  acc: 0.6928    test auc: 0.7621  acc: 0.6926, time: 1.2420
epoch 45    train auc: 0.9418  acc: 0.8421    eval auc: 0.7636  acc: 0.6919    test auc: 0.7614  acc: 0.6945, time: 1.2510
epoch 46    train auc: 0.9415  acc: 0.8413    eval auc: 0.7638  acc: 0.6936    test auc: 0.7613  acc: 0.6957, time: 1.2300
epoch 47    train auc: 0.9424  acc: 0.8428    eval auc: 0.7622  acc: 0.6904    test auc: 0.7603  acc: 0.6923, time: 1.2530
epoch 48    train auc: 0.9427  acc: 0.8439    eval auc: 0.7616  acc: 0.6904    test auc: 0.7598  acc: 0.6911, time: 1.2560
epoch 49    train auc: 0.9428  acc: 0.8430    eval auc: 0.7621  acc: 0.6909    test auc: 0.7603  acc: 0.6922, time: 1.2490
avg time per epoch : 1.2068751907348634
--- 70.49300074577332 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:19:59.422045: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:19:59.422394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4992  acc: 0.4985    eval auc: 0.5072  acc: 0.5017    test auc: 0.4958  acc: 0.5042, time: 1.5820
epoch 1    train auc: 0.4840  acc: 0.4957    eval auc: 0.5206  acc: 0.5011    test auc: 0.5270  acc: 0.5117, time: 0.7640
epoch 2    train auc: 0.5191  acc: 0.5063    eval auc: 0.4722  acc: 0.4943    test auc: 0.4714  acc: 0.4867, time: 1.2490
epoch 3    train auc: 0.5510  acc: 0.5342    eval auc: 0.4249  acc: 0.4483    test auc: 0.4238  acc: 0.4490, time: 0.7760
epoch 4    train auc: 0.5827  acc: 0.5579    eval auc: 0.3813  acc: 0.4173    test auc: 0.3754  acc: 0.4089, time: 1.2460
epoch 5    train auc: 0.5873  acc: 0.5609    eval auc: 0.3756  acc: 0.4130    test auc: 0.3706  acc: 0.4051, time: 0.7790
epoch 6    train auc: 0.6081  acc: 0.5644    eval auc: 0.3817  acc: 0.4116    test auc: 0.3765  acc: 0.4085, time: 1.2500
epoch 7    train auc: 0.7873  acc: 0.7386    eval auc: 0.6894  acc: 0.6772    test auc: 0.7036  acc: 0.6858, time: 0.7610
epoch 8    train auc: 0.8452  acc: 0.7197    eval auc: 0.7748  acc: 0.6831    test auc: 0.7813  acc: 0.6913, time: 1.2490
epoch 9    train auc: 0.8789  acc: 0.7940    eval auc: 0.7483  acc: 0.7004    test auc: 0.7556  acc: 0.7065, time: 0.7840
epoch 10    train auc: 0.8658  acc: 0.7524    eval auc: 0.7951  acc: 0.7138    test auc: 0.7954  acc: 0.7206, time: 1.2690
epoch 11    train auc: 0.9072  acc: 0.8118    eval auc: 0.7652  acc: 0.6998    test auc: 0.7698  acc: 0.7074, time: 0.7760
epoch 12    train auc: 0.8695  acc: 0.7620    eval auc: 0.7974  acc: 0.7223    test auc: 0.7961  acc: 0.7265, time: 1.2660
epoch 13    train auc: 0.9177  acc: 0.8258    eval auc: 0.7616  acc: 0.6941    test auc: 0.7658  acc: 0.6995, time: 0.7720
epoch 14    train auc: 0.8649  acc: 0.7617    eval auc: 0.7998  acc: 0.7243    test auc: 0.7971  acc: 0.7264, time: 1.2400
epoch 15    train auc: 0.9272  acc: 0.8338    eval auc: 0.7587  acc: 0.6934    test auc: 0.7592  acc: 0.6913, time: 0.7680
epoch 16    train auc: 0.8737  acc: 0.7739    eval auc: 0.7997  acc: 0.7291    test auc: 0.7966  acc: 0.7302, time: 1.2350
epoch 17    train auc: 0.9357  acc: 0.8422    eval auc: 0.7566  acc: 0.6886    test auc: 0.7556  acc: 0.6891, time: 0.7710
epoch 18    train auc: 0.8854  acc: 0.7899    eval auc: 0.7934  acc: 0.7278    test auc: 0.7897  acc: 0.7255, time: 1.2600
epoch 19    train auc: 0.9443  acc: 0.8514    eval auc: 0.7512  acc: 0.6863    test auc: 0.7487  acc: 0.6882, time: 0.7470
epoch 20    train auc: 0.8911  acc: 0.7972    eval auc: 0.7884  acc: 0.7206    test auc: 0.7835  acc: 0.7186, time: 1.1960
epoch 21    train auc: 0.9528  acc: 0.8634    eval auc: 0.7531  acc: 0.6928    test auc: 0.7485  acc: 0.6908, time: 0.7440
epoch 22    train auc: 0.9028  acc: 0.8105    eval auc: 0.7836  acc: 0.7202    test auc: 0.7772  acc: 0.7133, time: 1.2080
epoch 23    train auc: 0.9618  acc: 0.8763    eval auc: 0.7451  acc: 0.6857    test auc: 0.7397  acc: 0.6838, time: 0.7450
epoch 24    train auc: 0.9159  acc: 0.8177    eval auc: 0.7767  acc: 0.7088    test auc: 0.7682  acc: 0.7034, time: 1.1870
epoch 25    train auc: 0.9712  acc: 0.8922    eval auc: 0.7398  acc: 0.6755    test auc: 0.7327  acc: 0.6759, time: 0.7350
epoch 26    train auc: 0.9310  acc: 0.8266    eval auc: 0.7704  acc: 0.7008    test auc: 0.7596  acc: 0.6934, time: 1.1850
epoch 27    train auc: 0.9757  acc: 0.8992    eval auc: 0.7495  acc: 0.6892    test auc: 0.7404  acc: 0.6815, time: 0.7290
epoch 28    train auc: 0.9469  acc: 0.8387    eval auc: 0.7628  acc: 0.6952    test auc: 0.7509  acc: 0.6874, time: 1.1680
epoch 29    train auc: 0.9805  acc: 0.9094    eval auc: 0.7420  acc: 0.6814    test auc: 0.7317  acc: 0.6739, time: 0.7170
epoch 30    train auc: 0.9565  acc: 0.8484    eval auc: 0.7554  acc: 0.6890    test auc: 0.7418  acc: 0.6748, time: 1.1610
epoch 31    train auc: 0.9834  acc: 0.9162    eval auc: 0.7374  acc: 0.6776    test auc: 0.7263  acc: 0.6733, time: 0.7120
epoch 32    train auc: 0.9623  acc: 0.8522    eval auc: 0.7522  acc: 0.6859    test auc: 0.7387  acc: 0.6736, time: 1.1620
epoch 33    train auc: 0.9851  acc: 0.9201    eval auc: 0.7337  acc: 0.6753    test auc: 0.7221  acc: 0.6699, time: 0.7130
epoch 34    train auc: 0.9668  acc: 0.8612    eval auc: 0.7499  acc: 0.6849    test auc: 0.7354  acc: 0.6696, time: 1.1440
epoch 35    train auc: 0.9867  acc: 0.9245    eval auc: 0.7376  acc: 0.6794    test auc: 0.7253  acc: 0.6729, time: 0.7190
epoch 36    train auc: 0.9716  acc: 0.8701    eval auc: 0.7443  acc: 0.6813    test auc: 0.7287  acc: 0.6650, time: 1.1360
epoch 37    train auc: 0.9880  acc: 0.9283    eval auc: 0.7326  acc: 0.6768    test auc: 0.7189  acc: 0.6690, time: 0.7020
epoch 38    train auc: 0.9743  acc: 0.8755    eval auc: 0.7441  acc: 0.6817    test auc: 0.7278  acc: 0.6640, time: 1.1130
epoch 39    train auc: 0.9891  acc: 0.9320    eval auc: 0.7323  acc: 0.6755    test auc: 0.7184  acc: 0.6676, time: 0.6900
epoch 40    train auc: 0.9783  acc: 0.8842    eval auc: 0.7398  acc: 0.6787    test auc: 0.7238  acc: 0.6635, time: 1.1980
epoch 41    train auc: 0.9903  acc: 0.9353    eval auc: 0.7323  acc: 0.6786    test auc: 0.7172  acc: 0.6654, time: 0.7710
epoch 42    train auc: 0.9797  acc: 0.8894    eval auc: 0.7397  acc: 0.6833    test auc: 0.7228  acc: 0.6609, time: 1.2930
epoch 43    train auc: 0.9910  acc: 0.9377    eval auc: 0.7300  acc: 0.6766    test auc: 0.7157  acc: 0.6650, time: 0.7630
epoch 44    train auc: 0.9806  acc: 0.8925    eval auc: 0.7383  acc: 0.6824    test auc: 0.7216  acc: 0.6614, time: 1.2410
epoch 45    train auc: 0.9915  acc: 0.9387    eval auc: 0.7316  acc: 0.6795    test auc: 0.7167  acc: 0.6667, time: 0.7680
epoch 46    train auc: 0.9817  acc: 0.8955    eval auc: 0.7372  acc: 0.6811    test auc: 0.7206  acc: 0.6604, time: 1.2680
epoch 47    train auc: 0.9921  acc: 0.9406    eval auc: 0.7260  acc: 0.6733    test auc: 0.7098  acc: 0.6593, time: 0.7810
epoch 48    train auc: 0.9850  acc: 0.9045    eval auc: 0.7338  acc: 0.6772    test auc: 0.7175  acc: 0.6596, time: 1.2520
epoch 49    train auc: 0.9926  acc: 0.9420    eval auc: 0.7294  acc: 0.6778    test auc: 0.7147  acc: 0.6632, time: 0.7560
avg time per epoch : 0.9900187635421753
--- 59.57996416091919 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:20:59.027918: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:20:59.028264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.6365  acc: 0.5910    eval auc: 0.5891  acc: 0.5569    test auc: 0.6032  acc: 0.5693, time: 1.5850
epoch 1    train auc: 0.5353  acc: 0.5192    eval auc: 0.5338  acc: 0.5174    test auc: 0.5352  acc: 0.5165, time: 0.7570
epoch 2    train auc: 0.8539  acc: 0.7802    eval auc: 0.7738  acc: 0.7118    test auc: 0.7814  acc: 0.7122, time: 1.2160
epoch 3    train auc: 0.8650  acc: 0.7293    eval auc: 0.7710  acc: 0.7093    test auc: 0.7756  acc: 0.7203, time: 0.7350
epoch 4    train auc: 0.8693  acc: 0.7506    eval auc: 0.7864  acc: 0.6551    test auc: 0.7923  acc: 0.6506, time: 1.2120
epoch 5    train auc: 0.8900  acc: 0.7702    eval auc: 0.7915  acc: 0.7421    test auc: 0.7942  acc: 0.7500, time: 0.7300
epoch 6    train auc: 0.8795  acc: 0.7800    eval auc: 0.7881  acc: 0.6982    test auc: 0.7938  acc: 0.6965, time: 1.1960
epoch 7    train auc: 0.8981  acc: 0.7866    eval auc: 0.7956  acc: 0.7525    test auc: 0.7983  acc: 0.7551, time: 0.7270
epoch 8    train auc: 0.8879  acc: 0.7884    eval auc: 0.7897  acc: 0.7132    test auc: 0.7951  acc: 0.7108, time: 1.1770
epoch 9    train auc: 0.9033  acc: 0.7922    eval auc: 0.7977  acc: 0.7517    test auc: 0.8004  acc: 0.7540, time: 0.7350
epoch 10    train auc: 0.8939  acc: 0.7928    eval auc: 0.7913  acc: 0.7174    test auc: 0.7967  acc: 0.7166, time: 1.0820
epoch 11    train auc: 0.9063  acc: 0.7924    eval auc: 0.7992  acc: 0.7493    test auc: 0.8011  acc: 0.7527, time: 0.6499
epoch 12    train auc: 0.8974  acc: 0.7950    eval auc: 0.7921  acc: 0.7228    test auc: 0.7973  acc: 0.7194, time: 1.0513
epoch 13    train auc: 0.9090  acc: 0.7982    eval auc: 0.7983  acc: 0.7478    test auc: 0.8001  acc: 0.7463, time: 0.6430
epoch 14    train auc: 0.9001  acc: 0.7966    eval auc: 0.7919  acc: 0.7137    test auc: 0.7971  acc: 0.7083, time: 1.0571
epoch 15    train auc: 0.9115  acc: 0.8019    eval auc: 0.7973  acc: 0.7426    test auc: 0.7984  acc: 0.7396, time: 0.6613
epoch 16    train auc: 0.9025  acc: 0.7977    eval auc: 0.7915  acc: 0.7062    test auc: 0.7965  acc: 0.7034, time: 1.0574
epoch 17    train auc: 0.9143  acc: 0.8064    eval auc: 0.7954  acc: 0.7380    test auc: 0.7963  acc: 0.7323, time: 0.6579
epoch 18    train auc: 0.9043  acc: 0.7959    eval auc: 0.7902  acc: 0.7013    test auc: 0.7953  acc: 0.6983, time: 1.0240
epoch 19    train auc: 0.9173  acc: 0.8114    eval auc: 0.7931  acc: 0.7336    test auc: 0.7936  acc: 0.7262, time: 0.6360
epoch 20    train auc: 0.9058  acc: 0.7959    eval auc: 0.7885  acc: 0.6978    test auc: 0.7934  acc: 0.6958, time: 1.0470
epoch 21    train auc: 0.9203  acc: 0.8147    eval auc: 0.7910  acc: 0.7295    test auc: 0.7902  acc: 0.7203, time: 0.6299
epoch 22    train auc: 0.9068  acc: 0.7950    eval auc: 0.7866  acc: 0.6941    test auc: 0.7910  acc: 0.6905, time: 1.0139
epoch 23    train auc: 0.9225  acc: 0.8156    eval auc: 0.7887  acc: 0.7268    test auc: 0.7871  acc: 0.7168, time: 0.6690
epoch 24    train auc: 0.9078  acc: 0.7949    eval auc: 0.7846  acc: 0.6937    test auc: 0.7889  acc: 0.6911, time: 1.0200
epoch 25    train auc: 0.9253  acc: 0.8215    eval auc: 0.7862  acc: 0.7229    test auc: 0.7845  acc: 0.7145, time: 0.6249
epoch 26    train auc: 0.9084  acc: 0.7947    eval auc: 0.7827  acc: 0.6937    test auc: 0.7868  acc: 0.6884, time: 1.0170
epoch 27    train auc: 0.9274  acc: 0.8237    eval auc: 0.7840  acc: 0.7185    test auc: 0.7819  acc: 0.7112, time: 0.6370
epoch 28    train auc: 0.9091  acc: 0.7947    eval auc: 0.7812  acc: 0.6898    test auc: 0.7848  acc: 0.6876, time: 1.0079
epoch 29    train auc: 0.9291  acc: 0.8260    eval auc: 0.7820  acc: 0.7147    test auc: 0.7798  acc: 0.7065, time: 0.6209
epoch 30    train auc: 0.9098  acc: 0.7956    eval auc: 0.7797  acc: 0.6884    test auc: 0.7831  acc: 0.6879, time: 1.0090
epoch 31    train auc: 0.9303  acc: 0.8262    eval auc: 0.7794  acc: 0.7122    test auc: 0.7769  acc: 0.7072, time: 0.6210
epoch 32    train auc: 0.9106  acc: 0.7962    eval auc: 0.7784  acc: 0.6887    test auc: 0.7815  acc: 0.6874, time: 1.0099
epoch 33    train auc: 0.9313  acc: 0.8271    eval auc: 0.7789  acc: 0.7121    test auc: 0.7765  acc: 0.7055, time: 0.6220
epoch 34    train auc: 0.9114  acc: 0.7965    eval auc: 0.7772  acc: 0.6883    test auc: 0.7802  acc: 0.6859, time: 1.0167
epoch 35    train auc: 0.9321  acc: 0.8304    eval auc: 0.7767  acc: 0.7054    test auc: 0.7751  acc: 0.7000, time: 0.6229
epoch 36    train auc: 0.9116  acc: 0.7949    eval auc: 0.7759  acc: 0.6867    test auc: 0.7788  acc: 0.6833, time: 1.0029
epoch 37    train auc: 0.9330  acc: 0.8299    eval auc: 0.7768  acc: 0.7076    test auc: 0.7744  acc: 0.7008, time: 0.6299
epoch 38    train auc: 0.9126  acc: 0.7958    eval auc: 0.7749  acc: 0.6860    test auc: 0.7774  acc: 0.6831, time: 0.9950
epoch 39    train auc: 0.9341  acc: 0.8321    eval auc: 0.7747  acc: 0.7041    test auc: 0.7722  acc: 0.6995, time: 0.6250
epoch 40    train auc: 0.9135  acc: 0.7971    eval auc: 0.7741  acc: 0.6856    test auc: 0.7767  acc: 0.6840, time: 1.0079
epoch 41    train auc: 0.9346  acc: 0.8318    eval auc: 0.7743  acc: 0.7032    test auc: 0.7721  acc: 0.6993, time: 0.6329
epoch 42    train auc: 0.9143  acc: 0.7979    eval auc: 0.7732  acc: 0.6844    test auc: 0.7755  acc: 0.6828, time: 0.9979
epoch 43    train auc: 0.9354  acc: 0.8331    eval auc: 0.7731  acc: 0.7022    test auc: 0.7706  acc: 0.6962, time: 0.6756
epoch 44    train auc: 0.9155  acc: 0.7996    eval auc: 0.7727  acc: 0.6860    test auc: 0.7748  acc: 0.6840, time: 1.0680
epoch 45    train auc: 0.9356  acc: 0.8330    eval auc: 0.7731  acc: 0.7055    test auc: 0.7702  acc: 0.6985, time: 0.6560
epoch 46    train auc: 0.9166  acc: 0.7999    eval auc: 0.7716  acc: 0.6836    test auc: 0.7735  acc: 0.6834, time: 1.0529
epoch 47    train auc: 0.9363  acc: 0.8343    eval auc: 0.7714  acc: 0.7026    test auc: 0.7683  acc: 0.6964, time: 0.6520
epoch 48    train auc: 0.9173  acc: 0.8002    eval auc: 0.7706  acc: 0.6844    test auc: 0.7724  acc: 0.6827, time: 1.0799
epoch 49    train auc: 0.9369  acc: 0.8356    eval auc: 0.7706  acc: 0.7004    test auc: 0.7684  acc: 0.6958, time: 0.6582
avg time per epoch : 0.8702632331848145
--- 52.69387459754944 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:21:51.749576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:21:51.749915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4901  acc: 0.4983    eval auc: 0.5158  acc: 0.4992    test auc: 0.5138  acc: 0.5058, time: 1.4540
epoch 1    train auc: 0.5015  acc: 0.5021    eval auc: 0.4937  acc: 0.4925    test auc: 0.5016  acc: 0.5012, time: 0.6459
epoch 2    train auc: 0.4877  acc: 0.4900    eval auc: 0.5223  acc: 0.5165    test auc: 0.5147  acc: 0.5135, time: 1.0700
epoch 3    train auc: 0.5706  acc: 0.5489    eval auc: 0.3988  acc: 0.4300    test auc: 0.3919  acc: 0.4232, time: 0.6550
epoch 4    train auc: 0.5847  acc: 0.5602    eval auc: 0.3802  acc: 0.4132    test auc: 0.3704  acc: 0.4062, time: 1.1459
epoch 5    train auc: 0.5891  acc: 0.5620    eval auc: 0.3734  acc: 0.4107    test auc: 0.3659  acc: 0.4034, time: 0.7190
epoch 6    train auc: 0.5926  acc: 0.5648    eval auc: 0.3681  acc: 0.4063    test auc: 0.3621  acc: 0.3992, time: 1.1571
epoch 7    train auc: 0.5936  acc: 0.5651    eval auc: 0.3673  acc: 0.4058    test auc: 0.3609  acc: 0.3987, time: 0.7150
epoch 8    train auc: 0.5947  acc: 0.5659    eval auc: 0.3655  acc: 0.4029    test auc: 0.3597  acc: 0.3993, time: 1.1510
epoch 9    train auc: 0.5952  acc: 0.5662    eval auc: 0.3651  acc: 0.4011    test auc: 0.3590  acc: 0.4002, time: 0.6960
epoch 10    train auc: 0.5956  acc: 0.5664    eval auc: 0.3645  acc: 0.4009    test auc: 0.3588  acc: 0.4000, time: 1.1289
epoch 11    train auc: 0.5960  acc: 0.5666    eval auc: 0.3641  acc: 0.4018    test auc: 0.3584  acc: 0.3984, time: 0.6939
epoch 12    train auc: 0.5961  acc: 0.5666    eval auc: 0.3639  acc: 0.4010    test auc: 0.3583  acc: 0.3991, time: 1.1496
epoch 13    train auc: 0.5964  acc: 0.5668    eval auc: 0.3637  acc: 0.4009    test auc: 0.3579  acc: 0.3989, time: 0.6999
epoch 14    train auc: 0.5965  acc: 0.5668    eval auc: 0.3635  acc: 0.4021    test auc: 0.3579  acc: 0.3976, time: 1.1220
epoch 15    train auc: 0.5966  acc: 0.5668    eval auc: 0.3634  acc: 0.4002    test auc: 0.3578  acc: 0.3993, time: 0.6869
epoch 16    train auc: 0.5967  acc: 0.5668    eval auc: 0.3634  acc: 0.4016    test auc: 0.3576  acc: 0.3979, time: 1.1445
epoch 17    train auc: 0.5968  acc: 0.5668    eval auc: 0.3633  acc: 0.4011    test auc: 0.3576  acc: 0.3984, time: 0.6859
epoch 18    train auc: 0.5969  acc: 0.5669    eval auc: 0.3633  acc: 0.4023    test auc: 0.3575  acc: 0.3971, time: 1.1547
epoch 19    train auc: 0.5969  acc: 0.5669    eval auc: 0.3634  acc: 0.4028    test auc: 0.3573  acc: 0.3966, time: 0.7250
epoch 20    train auc: 0.5970  acc: 0.5669    eval auc: 0.3631  acc: 0.4012    test auc: 0.3576  acc: 0.3982, time: 1.1331
epoch 21    train auc: 0.5970  acc: 0.5669    eval auc: 0.3634  acc: 0.4030    test auc: 0.3573  acc: 0.3964, time: 0.7038
epoch 22    train auc: 0.5970  acc: 0.5669    eval auc: 0.3633  acc: 0.4017    test auc: 0.3573  acc: 0.3977, time: 1.1499
epoch 23    train auc: 0.5971  acc: 0.5669    eval auc: 0.3635  acc: 0.4032    test auc: 0.3571  acc: 0.3962, time: 0.7106
epoch 24    train auc: 0.5970  acc: 0.5669    eval auc: 0.3633  acc: 0.4036    test auc: 0.3573  acc: 0.3958, time: 1.1260
epoch 25    train auc: 0.5971  acc: 0.5669    eval auc: 0.3633  acc: 0.4041    test auc: 0.3573  acc: 0.3953, time: 0.6949
epoch 26    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4017    test auc: 0.3573  acc: 0.3977, time: 1.1316
epoch 27    train auc: 0.5971  acc: 0.5669    eval auc: 0.3633  acc: 0.4022    test auc: 0.3573  acc: 0.3972, time: 0.7053
epoch 28    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4026    test auc: 0.3574  acc: 0.3967, time: 1.1212
epoch 29    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4032    test auc: 0.3574  acc: 0.3962, time: 0.7085
epoch 30    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4028    test auc: 0.3572  acc: 0.3966, time: 1.1494
epoch 31    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4031    test auc: 0.3574  acc: 0.3963, time: 0.6910
epoch 32    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4013    test auc: 0.3572  acc: 0.3980, time: 1.1490
epoch 33    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4041    test auc: 0.3571  acc: 0.3953, time: 0.7020
epoch 34    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4022    test auc: 0.3574  acc: 0.3972, time: 1.1169
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3629  acc: 0.4031    test auc: 0.3576  acc: 0.3963, time: 0.6979
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4028    test auc: 0.3573  acc: 0.3966, time: 1.1139
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4029    test auc: 0.3572  acc: 0.3965, time: 0.6850
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4015    test auc: 0.3574  acc: 0.3979, time: 1.1029
epoch 39    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4019    test auc: 0.3571  acc: 0.3974, time: 0.6899
epoch 40    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4026    test auc: 0.3572  acc: 0.3967, time: 1.1139
epoch 41    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4050    test auc: 0.3570  acc: 0.3944, time: 0.6849
epoch 42    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4048    test auc: 0.3570  acc: 0.3946, time: 1.1413
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4022    test auc: 0.3571  acc: 0.3972, time: 0.6809
epoch 44    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4009    test auc: 0.3572  acc: 0.3985, time: 1.1149
epoch 45    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4032    test auc: 0.3570  acc: 0.3962, time: 0.6729
epoch 46    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4009    test auc: 0.3574  acc: 0.3985, time: 1.0949
epoch 47    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4034    test auc: 0.3572  acc: 0.3960, time: 0.6979
epoch 48    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4013    test auc: 0.3574  acc: 0.3980, time: 1.1029
epoch 49    train auc: 0.5973  acc: 0.5669    eval auc: 0.3633  acc: 0.4003    test auc: 0.3574  acc: 0.3991, time: 0.6689
avg time per epoch : 0.9171479701995849
--- 55.42272996902466 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:22:47.111838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:22:47.112150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4957  acc: 0.5007    eval auc: 0.5128  acc: 0.5034    test auc: 0.5168  acc: 0.5106, time: 1.3760
epoch 1    train auc: 0.4989  acc: 0.4986    eval auc: 0.4973  acc: 0.5036    test auc: 0.5057  acc: 0.5005, time: 0.6759
epoch 2    train auc: 0.5432  acc: 0.5065    eval auc: 0.4361  acc: 0.4924    test auc: 0.4350  acc: 0.4879, time: 1.1042
epoch 3    train auc: 0.5559  acc: 0.5119    eval auc: 0.4190  acc: 0.4840    test auc: 0.4147  acc: 0.4802, time: 0.6793
epoch 4    train auc: 0.5669  acc: 0.5178    eval auc: 0.4032  acc: 0.4747    test auc: 0.3985  acc: 0.4721, time: 1.0559
epoch 5    train auc: 0.5747  acc: 0.5270    eval auc: 0.3913  acc: 0.4609    test auc: 0.3877  acc: 0.4583, time: 0.6620
epoch 6    train auc: 0.5809  acc: 0.5419    eval auc: 0.3823  acc: 0.4403    test auc: 0.3791  acc: 0.4341, time: 1.0639
epoch 7    train auc: 0.5848  acc: 0.5601    eval auc: 0.3786  acc: 0.4089    test auc: 0.3729  acc: 0.4109, time: 0.6539
epoch 8    train auc: 0.5888  acc: 0.5619    eval auc: 0.3737  acc: 0.4082    test auc: 0.3672  acc: 0.4065, time: 1.0596
epoch 9    train auc: 0.5911  acc: 0.5630    eval auc: 0.3715  acc: 0.4056    test auc: 0.3646  acc: 0.4058, time: 0.6479
epoch 10    train auc: 0.5939  acc: 0.5636    eval auc: 0.3697  acc: 0.4060    test auc: 0.3637  acc: 0.4047, time: 1.0541
epoch 11    train auc: 0.5971  acc: 0.5663    eval auc: 0.3699  acc: 0.4047    test auc: 0.3636  acc: 0.4024, time: 0.6410
epoch 12    train auc: 0.6147  acc: 0.5750    eval auc: 0.3810  acc: 0.4129    test auc: 0.3764  acc: 0.4103, time: 1.0479
epoch 13    train auc: 0.7506  acc: 0.6721    eval auc: 0.5553  acc: 0.5215    test auc: 0.5653  acc: 0.5264, time: 0.6419
epoch 14    train auc: 0.8601  acc: 0.7746    eval auc: 0.7168  acc: 0.6841    test auc: 0.7217  acc: 0.6827, time: 1.0558
epoch 15    train auc: 0.8778  acc: 0.7784    eval auc: 0.7403  acc: 0.7183    test auc: 0.7434  acc: 0.7178, time: 0.6400
epoch 16    train auc: 0.8898  acc: 0.7960    eval auc: 0.7552  acc: 0.7215    test auc: 0.7570  acc: 0.7207, time: 1.0279
epoch 17    train auc: 0.8965  acc: 0.8041    eval auc: 0.7601  acc: 0.7197    test auc: 0.7610  acc: 0.7154, time: 0.6300
epoch 18    train auc: 0.9024  acc: 0.8090    eval auc: 0.7646  acc: 0.7229    test auc: 0.7646  acc: 0.7168, time: 1.0513
epoch 19    train auc: 0.9075  acc: 0.8147    eval auc: 0.7684  acc: 0.7154    test auc: 0.7679  acc: 0.7122, time: 0.6290
epoch 20    train auc: 0.9120  acc: 0.8182    eval auc: 0.7698  acc: 0.7160    test auc: 0.7689  acc: 0.7130, time: 1.0209
epoch 21    train auc: 0.9156  acc: 0.8213    eval auc: 0.7683  acc: 0.7115    test auc: 0.7668  acc: 0.7079, time: 0.6497
epoch 22    train auc: 0.9193  acc: 0.8240    eval auc: 0.7717  acc: 0.7139    test auc: 0.7699  acc: 0.7121, time: 1.0229
epoch 23    train auc: 0.9223  acc: 0.8266    eval auc: 0.7711  acc: 0.7100    test auc: 0.7691  acc: 0.7085, time: 0.6259
epoch 24    train auc: 0.9249  acc: 0.8273    eval auc: 0.7740  acc: 0.7168    test auc: 0.7719  acc: 0.7127, time: 1.0159
epoch 25    train auc: 0.9276  acc: 0.8312    eval auc: 0.7713  acc: 0.7075    test auc: 0.7690  acc: 0.7076, time: 0.6250
epoch 26    train auc: 0.9299  acc: 0.8330    eval auc: 0.7714  acc: 0.7075    test auc: 0.7690  acc: 0.7080, time: 1.0212
epoch 27    train auc: 0.9322  acc: 0.8360    eval auc: 0.7690  acc: 0.7052    test auc: 0.7664  acc: 0.7032, time: 0.6269
epoch 28    train auc: 0.9335  acc: 0.8358    eval auc: 0.7723  acc: 0.7081    test auc: 0.7698  acc: 0.7068, time: 1.0244
epoch 29    train auc: 0.9357  acc: 0.8390    eval auc: 0.7657  acc: 0.7020    test auc: 0.7626  acc: 0.7016, time: 0.6599
epoch 30    train auc: 0.9373  acc: 0.8399    eval auc: 0.7684  acc: 0.7050    test auc: 0.7655  acc: 0.7046, time: 1.0403
epoch 31    train auc: 0.9393  acc: 0.8434    eval auc: 0.7624  acc: 0.6991    test auc: 0.7595  acc: 0.6970, time: 0.6359
epoch 32    train auc: 0.9399  acc: 0.8399    eval auc: 0.7685  acc: 0.7066    test auc: 0.7655  acc: 0.7066, time: 1.0244
epoch 33    train auc: 0.9421  acc: 0.8454    eval auc: 0.7622  acc: 0.6989    test auc: 0.7591  acc: 0.6984, time: 0.6499
epoch 34    train auc: 0.9436  acc: 0.8469    eval auc: 0.7610  acc: 0.6970    test auc: 0.7581  acc: 0.6975, time: 1.0389
epoch 35    train auc: 0.9449  acc: 0.8487    eval auc: 0.7562  acc: 0.6926    test auc: 0.7530  acc: 0.6937, time: 0.6579
epoch 36    train auc: 0.9458  acc: 0.8473    eval auc: 0.7620  acc: 0.6995    test auc: 0.7586  acc: 0.6998, time: 1.0996
epoch 37    train auc: 0.9474  acc: 0.8512    eval auc: 0.7564  acc: 0.6919    test auc: 0.7533  acc: 0.6938, time: 0.6490
epoch 38    train auc: 0.9484  acc: 0.8517    eval auc: 0.7592  acc: 0.6970    test auc: 0.7559  acc: 0.6974, time: 1.0744
epoch 39    train auc: 0.9500  acc: 0.8549    eval auc: 0.7536  acc: 0.6906    test auc: 0.7504  acc: 0.6915, time: 0.6580
epoch 40    train auc: 0.9508  acc: 0.8539    eval auc: 0.7570  acc: 0.6955    test auc: 0.7538  acc: 0.6963, time: 1.0970
epoch 41    train auc: 0.9523  acc: 0.8576    eval auc: 0.7518  acc: 0.6900    test auc: 0.7489  acc: 0.6912, time: 0.6870
epoch 42    train auc: 0.9525  acc: 0.8562    eval auc: 0.7572  acc: 0.6991    test auc: 0.7542  acc: 0.6976, time: 1.1640
epoch 43    train auc: 0.9545  acc: 0.8585    eval auc: 0.7517  acc: 0.6925    test auc: 0.7484  acc: 0.6932, time: 0.7139
epoch 44    train auc: 0.9551  acc: 0.8594    eval auc: 0.7538  acc: 0.6976    test auc: 0.7508  acc: 0.6964, time: 1.1300
epoch 45    train auc: 0.9566  acc: 0.8608    eval auc: 0.7500  acc: 0.6925    test auc: 0.7467  acc: 0.6908, time: 0.7009
epoch 46    train auc: 0.9577  acc: 0.8628    eval auc: 0.7492  acc: 0.6929    test auc: 0.7459  acc: 0.6905, time: 1.1382
epoch 47    train auc: 0.9587  acc: 0.8634    eval auc: 0.7472  acc: 0.6909    test auc: 0.7441  acc: 0.6873, time: 0.7209
epoch 48    train auc: 0.9595  acc: 0.8645    eval auc: 0.7485  acc: 0.6945    test auc: 0.7455  acc: 0.6915, time: 1.1703
epoch 49    train auc: 0.9605  acc: 0.8651    eval auc: 0.7468  acc: 0.6923    test auc: 0.7437  acc: 0.6876, time: 0.7079
avg time per epoch : 0.868985276222229
--- 52.48804759979248 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:23:39.654388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:23:39.654737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5653  acc: 0.4989    eval auc: 0.5540  acc: 0.4995    test auc: 0.5432  acc: 0.5038, time: 1.4525
epoch 1    train auc: 0.8779  acc: 0.7694    eval auc: 0.7945  acc: 0.7437    test auc: 0.8002  acc: 0.7520, time: 0.7940
epoch 2    train auc: 0.8990  acc: 0.7930    eval auc: 0.8009  acc: 0.7509    test auc: 0.8037  acc: 0.7550, time: 1.3080
epoch 3    train auc: 0.9133  acc: 0.8109    eval auc: 0.7935  acc: 0.7334    test auc: 0.7942  acc: 0.7298, time: 0.7890
epoch 4    train auc: 0.9149  acc: 0.8060    eval auc: 0.7961  acc: 0.7429    test auc: 0.7967  acc: 0.7401, time: 1.2819
epoch 5    train auc: 0.9254  acc: 0.8229    eval auc: 0.7791  acc: 0.7034    test auc: 0.7799  acc: 0.7037, time: 0.7740
epoch 6    train auc: 0.9196  acc: 0.8099    eval auc: 0.7913  acc: 0.7326    test auc: 0.7906  acc: 0.7318, time: 1.2820
epoch 7    train auc: 0.9312  acc: 0.8288    eval auc: 0.7732  acc: 0.7003    test auc: 0.7717  acc: 0.6969, time: 0.7760
epoch 8    train auc: 0.9231  acc: 0.8119    eval auc: 0.7875  acc: 0.7271    test auc: 0.7853  acc: 0.7255, time: 1.2520
epoch 9    train auc: 0.9344  acc: 0.8312    eval auc: 0.7694  acc: 0.6954    test auc: 0.7684  acc: 0.6942, time: 0.7600
epoch 10    train auc: 0.9244  acc: 0.8130    eval auc: 0.7846  acc: 0.7245    test auc: 0.7831  acc: 0.7218, time: 1.2829
epoch 11    train auc: 0.9363  acc: 0.8332    eval auc: 0.7678  acc: 0.6937    test auc: 0.7667  acc: 0.6961, time: 0.7659
epoch 12    train auc: 0.9247  acc: 0.8121    eval auc: 0.7834  acc: 0.7243    test auc: 0.7818  acc: 0.7206, time: 1.2560
epoch 13    train auc: 0.9381  acc: 0.8346    eval auc: 0.7676  acc: 0.6965    test auc: 0.7656  acc: 0.6951, time: 0.7570
epoch 14    train auc: 0.9254  acc: 0.8114    eval auc: 0.7818  acc: 0.7225    test auc: 0.7800  acc: 0.7198, time: 1.2240
epoch 15    train auc: 0.9405  acc: 0.8393    eval auc: 0.7584  acc: 0.6854    test auc: 0.7554  acc: 0.6852, time: 0.6996
epoch 16    train auc: 0.9281  acc: 0.8135    eval auc: 0.7778  acc: 0.7159    test auc: 0.7748  acc: 0.7134, time: 1.1310
epoch 17    train auc: 0.9414  acc: 0.8389    eval auc: 0.7601  acc: 0.6871    test auc: 0.7581  acc: 0.6893, time: 0.6949
epoch 18    train auc: 0.9285  acc: 0.8134    eval auc: 0.7757  acc: 0.7151    test auc: 0.7736  acc: 0.7125, time: 1.1419
epoch 19    train auc: 0.9419  acc: 0.8406    eval auc: 0.7594  acc: 0.6898    test auc: 0.7585  acc: 0.6876, time: 0.6799
epoch 20    train auc: 0.9303  acc: 0.8138    eval auc: 0.7712  acc: 0.7062    test auc: 0.7690  acc: 0.7072, time: 1.1189
epoch 21    train auc: 0.9439  acc: 0.8434    eval auc: 0.7558  acc: 0.6838    test auc: 0.7544  acc: 0.6852, time: 0.6809
epoch 22    train auc: 0.9300  acc: 0.8117    eval auc: 0.7698  acc: 0.7054    test auc: 0.7677  acc: 0.7028, time: 1.1161
epoch 23    train auc: 0.9448  acc: 0.8439    eval auc: 0.7558  acc: 0.6833    test auc: 0.7545  acc: 0.6814, time: 0.6729
epoch 24    train auc: 0.9317  acc: 0.8114    eval auc: 0.7645  acc: 0.6988    test auc: 0.7639  acc: 0.6987, time: 1.1029
epoch 25    train auc: 0.9476  acc: 0.8493    eval auc: 0.7525  acc: 0.6813    test auc: 0.7519  acc: 0.6785, time: 0.6880
epoch 26    train auc: 0.9309  acc: 0.8099    eval auc: 0.7632  acc: 0.6977    test auc: 0.7625  acc: 0.6954, time: 1.0949
epoch 27    train auc: 0.9523  acc: 0.8554    eval auc: 0.7467  acc: 0.6695    test auc: 0.7469  acc: 0.6694, time: 0.6770
epoch 28    train auc: 0.9341  acc: 0.8196    eval auc: 0.7605  acc: 0.6948    test auc: 0.7616  acc: 0.6952, time: 1.1250
epoch 29    train auc: 0.9561  acc: 0.8611    eval auc: 0.7417  acc: 0.6647    test auc: 0.7415  acc: 0.6650, time: 0.6879
epoch 30    train auc: 0.9372  acc: 0.8245    eval auc: 0.7567  acc: 0.6918    test auc: 0.7574  acc: 0.6890, time: 1.1149
epoch 31    train auc: 0.9599  acc: 0.8688    eval auc: 0.7410  acc: 0.6699    test auc: 0.7419  acc: 0.6689, time: 0.6970
epoch 32    train auc: 0.9456  acc: 0.8402    eval auc: 0.7518  acc: 0.6882    test auc: 0.7532  acc: 0.6847, time: 1.1463
epoch 33    train auc: 0.9622  acc: 0.8718    eval auc: 0.7431  acc: 0.6756    test auc: 0.7423  acc: 0.6712, time: 0.6730
epoch 34    train auc: 0.9495  acc: 0.8487    eval auc: 0.7515  acc: 0.6908    test auc: 0.7526  acc: 0.6895, time: 1.1039
epoch 35    train auc: 0.9702  acc: 0.8881    eval auc: 0.7373  acc: 0.6749    test auc: 0.7382  acc: 0.6728, time: 0.6889
epoch 36    train auc: 0.9590  acc: 0.8662    eval auc: 0.7482  acc: 0.6906    test auc: 0.7498  acc: 0.6876, time: 1.0889
epoch 37    train auc: 0.9757  acc: 0.9020    eval auc: 0.7346  acc: 0.6708    test auc: 0.7362  acc: 0.6726, time: 0.6649
epoch 38    train auc: 0.9639  acc: 0.8737    eval auc: 0.7479  acc: 0.6958    test auc: 0.7494  acc: 0.6943, time: 1.1066
epoch 39    train auc: 0.9789  acc: 0.9088    eval auc: 0.7345  acc: 0.6760    test auc: 0.7364  acc: 0.6795, time: 0.6640
epoch 40    train auc: 0.9664  acc: 0.8765    eval auc: 0.7462  acc: 0.6969    test auc: 0.7483  acc: 0.6932, time: 1.1022
epoch 41    train auc: 0.9809  acc: 0.9115    eval auc: 0.7292  acc: 0.6721    test auc: 0.7307  acc: 0.6748, time: 0.6580
epoch 42    train auc: 0.9706  acc: 0.8816    eval auc: 0.7448  acc: 0.6929    test auc: 0.7456  acc: 0.6915, time: 1.0610
epoch 43    train auc: 0.9833  acc: 0.9180    eval auc: 0.7328  acc: 0.6785    test auc: 0.7337  acc: 0.6794, time: 0.6709
epoch 44    train auc: 0.9732  acc: 0.8876    eval auc: 0.7432  acc: 0.6938    test auc: 0.7448  acc: 0.6926, time: 1.0679
epoch 45    train auc: 0.9850  acc: 0.9222    eval auc: 0.7282  acc: 0.6781    test auc: 0.7299  acc: 0.6767, time: 0.6460
epoch 46    train auc: 0.9768  acc: 0.8949    eval auc: 0.7400  acc: 0.6930    test auc: 0.7423  acc: 0.6895, time: 1.0639
epoch 47    train auc: 0.9864  acc: 0.9230    eval auc: 0.7278  acc: 0.6761    test auc: 0.7283  acc: 0.6720, time: 0.6399
epoch 48    train auc: 0.9785  acc: 0.8974    eval auc: 0.7377  acc: 0.6898    test auc: 0.7396  acc: 0.6866, time: 1.0439
epoch 49    train auc: 0.9879  acc: 0.9296    eval auc: 0.7268  acc: 0.6773    test auc: 0.7274  acc: 0.6754, time: 0.6389
avg time per epoch : 0.9321681642532349
--- 56.33441781997681 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:24:36.079158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:24:36.079503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5124  acc: 0.5011    eval auc: 0.4982  acc: 0.4926    test auc: 0.4911  acc: 0.4956, time: 1.4729
epoch 1    train auc: 0.4978  acc: 0.4992    eval auc: 0.4990  acc: 0.4975    test auc: 0.5094  acc: 0.5064, time: 0.6609
epoch 2    train auc: 0.6221  acc: 0.5652    eval auc: 0.5733  acc: 0.5241    test auc: 0.5878  acc: 0.5386, time: 1.0566
epoch 3    train auc: 0.5719  acc: 0.5298    eval auc: 0.4127  acc: 0.4579    test auc: 0.4120  acc: 0.4557, time: 0.6320
epoch 4    train auc: 0.7241  acc: 0.6431    eval auc: 0.5658  acc: 0.5613    test auc: 0.5745  acc: 0.5617, time: 1.0339
epoch 5    train auc: 0.8578  acc: 0.7369    eval auc: 0.7395  acc: 0.7109    test auc: 0.7518  acc: 0.7207, time: 0.6369
epoch 6    train auc: 0.8832  acc: 0.7875    eval auc: 0.7752  acc: 0.7419    test auc: 0.7807  acc: 0.7441, time: 1.0336
epoch 7    train auc: 0.8897  acc: 0.7809    eval auc: 0.7756  acc: 0.7418    test auc: 0.7807  acc: 0.7464, time: 0.6480
epoch 8    train auc: 0.8965  acc: 0.7896    eval auc: 0.7829  acc: 0.7460    test auc: 0.7867  acc: 0.7473, time: 1.0278
epoch 9    train auc: 0.9007  acc: 0.7990    eval auc: 0.7829  acc: 0.7335    test auc: 0.7864  acc: 0.7326, time: 0.6469
epoch 10    train auc: 0.9035  acc: 0.7953    eval auc: 0.7875  acc: 0.7426    test auc: 0.7905  acc: 0.7419, time: 1.0180
epoch 11    train auc: 0.9068  acc: 0.7972    eval auc: 0.7860  acc: 0.7339    test auc: 0.7889  acc: 0.7327, time: 0.6369
epoch 12    train auc: 0.9077  acc: 0.8004    eval auc: 0.7904  acc: 0.7382    test auc: 0.7924  acc: 0.7373, time: 1.0230
epoch 13    train auc: 0.9118  acc: 0.8081    eval auc: 0.7879  acc: 0.7274    test auc: 0.7895  acc: 0.7229, time: 0.6289
epoch 14    train auc: 0.9109  acc: 0.8035    eval auc: 0.7912  acc: 0.7359    test auc: 0.7928  acc: 0.7335, time: 1.0136
epoch 15    train auc: 0.9154  acc: 0.8106    eval auc: 0.7877  acc: 0.7250    test auc: 0.7885  acc: 0.7209, time: 0.6320
epoch 16    train auc: 0.9136  acc: 0.8068    eval auc: 0.7909  acc: 0.7355    test auc: 0.7918  acc: 0.7330, time: 1.0120
epoch 17    train auc: 0.9191  acc: 0.8167    eval auc: 0.7864  acc: 0.7185    test auc: 0.7865  acc: 0.7133, time: 0.6340
epoch 18    train auc: 0.9157  acc: 0.8092    eval auc: 0.7902  acc: 0.7366    test auc: 0.7911  acc: 0.7308, time: 1.1290
epoch 19    train auc: 0.9219  acc: 0.8187    eval auc: 0.7849  acc: 0.7145    test auc: 0.7848  acc: 0.7122, time: 0.7170
epoch 20    train auc: 0.9177  acc: 0.8116    eval auc: 0.7890  acc: 0.7326    test auc: 0.7898  acc: 0.7291, time: 1.0930
epoch 21    train auc: 0.9242  acc: 0.8206    eval auc: 0.7834  acc: 0.7156    test auc: 0.7826  acc: 0.7128, time: 0.6900
epoch 22    train auc: 0.9188  acc: 0.8125    eval auc: 0.7883  acc: 0.7287    test auc: 0.7891  acc: 0.7250, time: 1.0960
epoch 23    train auc: 0.9260  acc: 0.8212    eval auc: 0.7826  acc: 0.7157    test auc: 0.7813  acc: 0.7122, time: 0.6680
epoch 24    train auc: 0.9198  acc: 0.8135    eval auc: 0.7873  acc: 0.7281    test auc: 0.7882  acc: 0.7236, time: 1.0840
epoch 25    train auc: 0.9280  acc: 0.8243    eval auc: 0.7809  acc: 0.7100    test auc: 0.7796  acc: 0.7083, time: 0.6740
epoch 26    train auc: 0.9207  acc: 0.8141    eval auc: 0.7863  acc: 0.7263    test auc: 0.7871  acc: 0.7222, time: 1.1180
epoch 27    train auc: 0.9297  acc: 0.8264    eval auc: 0.7790  acc: 0.7082    test auc: 0.7777  acc: 0.7062, time: 0.6860
epoch 28    train auc: 0.9207  acc: 0.8136    eval auc: 0.7857  acc: 0.7236    test auc: 0.7867  acc: 0.7200, time: 1.0940
epoch 29    train auc: 0.9309  acc: 0.8276    eval auc: 0.7784  acc: 0.7080    test auc: 0.7768  acc: 0.7058, time: 0.7130
epoch 30    train auc: 0.9210  acc: 0.8136    eval auc: 0.7849  acc: 0.7223    test auc: 0.7860  acc: 0.7185, time: 1.1550
epoch 31    train auc: 0.9320  acc: 0.8283    eval auc: 0.7763  acc: 0.7078    test auc: 0.7749  acc: 0.7047, time: 0.7930
epoch 32    train auc: 0.9211  acc: 0.8131    eval auc: 0.7839  acc: 0.7207    test auc: 0.7852  acc: 0.7159, time: 1.2700
epoch 33    train auc: 0.9329  acc: 0.8295    eval auc: 0.7757  acc: 0.7081    test auc: 0.7742  acc: 0.7046, time: 0.7680
epoch 34    train auc: 0.9212  acc: 0.8126    eval auc: 0.7831  acc: 0.7197    test auc: 0.7844  acc: 0.7141, time: 1.2610
epoch 35    train auc: 0.9340  acc: 0.8318    eval auc: 0.7732  acc: 0.6994    test auc: 0.7721  acc: 0.6971, time: 0.7830
epoch 36    train auc: 0.9211  acc: 0.8112    eval auc: 0.7822  acc: 0.7185    test auc: 0.7835  acc: 0.7109, time: 1.2440
epoch 37    train auc: 0.9346  acc: 0.8321    eval auc: 0.7741  acc: 0.7055    test auc: 0.7728  acc: 0.7014, time: 0.7870
epoch 38    train auc: 0.9210  acc: 0.8103    eval auc: 0.7817  acc: 0.7186    test auc: 0.7828  acc: 0.7096, time: 1.2750
epoch 39    train auc: 0.9356  acc: 0.8337    eval auc: 0.7725  acc: 0.7032    test auc: 0.7710  acc: 0.6980, time: 0.7820
epoch 40    train auc: 0.9211  acc: 0.8093    eval auc: 0.7810  acc: 0.7167    test auc: 0.7821  acc: 0.7098, time: 1.2600
epoch 41    train auc: 0.9361  acc: 0.8326    eval auc: 0.7723  acc: 0.7041    test auc: 0.7711  acc: 0.6996, time: 0.7870
epoch 42    train auc: 0.9209  acc: 0.8084    eval auc: 0.7802  acc: 0.7148    test auc: 0.7812  acc: 0.7074, time: 1.2820
epoch 43    train auc: 0.9369  acc: 0.8337    eval auc: 0.7709  acc: 0.7009    test auc: 0.7694  acc: 0.6959, time: 0.7920
epoch 44    train auc: 0.9210  acc: 0.8074    eval auc: 0.7796  acc: 0.7130    test auc: 0.7804  acc: 0.7067, time: 1.2820
epoch 45    train auc: 0.9367  acc: 0.8321    eval auc: 0.7720  acc: 0.7042    test auc: 0.7701  acc: 0.6984, time: 0.8060
epoch 46    train auc: 0.9213  acc: 0.8077    eval auc: 0.7793  acc: 0.7131    test auc: 0.7800  acc: 0.7062, time: 1.2760
epoch 47    train auc: 0.9376  acc: 0.8341    eval auc: 0.7704  acc: 0.7007    test auc: 0.7681  acc: 0.6951, time: 0.7920
epoch 48    train auc: 0.9213  acc: 0.8068    eval auc: 0.7789  acc: 0.7134    test auc: 0.7797  acc: 0.7060, time: 1.2570
epoch 49    train auc: 0.9384  acc: 0.8357    eval auc: 0.7692  acc: 0.6984    test auc: 0.7673  acc: 0.6932, time: 0.7800
avg time per epoch : 0.93284010887146
--- 56.43053984642029 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:25:32.610793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:25:32.611138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4972  acc: 0.4994    eval auc: 0.5119  acc: 0.4981    test auc: 0.4969  acc: 0.5038, time: 1.5560
epoch 1    train auc: 0.5020  acc: 0.5000    eval auc: 0.4910  acc: 0.4986    test auc: 0.5029  acc: 0.5015, time: 0.7550
epoch 2    train auc: 0.5085  acc: 0.5002    eval auc: 0.4949  acc: 0.5092    test auc: 0.4804  acc: 0.4901, time: 1.2420
epoch 3    train auc: 0.5595  acc: 0.5419    eval auc: 0.4133  acc: 0.4370    test auc: 0.4088  acc: 0.4374, time: 0.7700
epoch 4    train auc: 0.5862  acc: 0.5610    eval auc: 0.3804  acc: 0.4136    test auc: 0.3659  acc: 0.4035, time: 1.2330
epoch 5    train auc: 0.5893  acc: 0.5635    eval auc: 0.3736  acc: 0.4070    test auc: 0.3647  acc: 0.4025, time: 0.7810
epoch 6    train auc: 0.5928  acc: 0.5652    eval auc: 0.3691  acc: 0.4024    test auc: 0.3603  acc: 0.4021, time: 1.2329
epoch 7    train auc: 0.5939  acc: 0.5660    eval auc: 0.3681  acc: 0.4028    test auc: 0.3589  acc: 0.3991, time: 0.7510
epoch 8    train auc: 0.5948  acc: 0.5663    eval auc: 0.3664  acc: 0.4024    test auc: 0.3582  acc: 0.3987, time: 1.2370
epoch 9    train auc: 0.5954  acc: 0.5665    eval auc: 0.3660  acc: 0.4022    test auc: 0.3575  acc: 0.3984, time: 0.7540
epoch 10    train auc: 0.5957  acc: 0.5665    eval auc: 0.3654  acc: 0.4024    test auc: 0.3576  acc: 0.3980, time: 1.2270
epoch 11    train auc: 0.5960  acc: 0.5667    eval auc: 0.3649  acc: 0.4028    test auc: 0.3572  acc: 0.3972, time: 0.7690
epoch 12    train auc: 0.5960  acc: 0.5668    eval auc: 0.3647  acc: 0.4017    test auc: 0.3576  acc: 0.3980, time: 1.2570
epoch 13    train auc: 0.5964  acc: 0.5668    eval auc: 0.3645  acc: 0.4017    test auc: 0.3570  acc: 0.3979, time: 0.7600
epoch 14    train auc: 0.5966  acc: 0.5668    eval auc: 0.3642  acc: 0.4028    test auc: 0.3570  acc: 0.3967, time: 1.2540
epoch 15    train auc: 0.5967  acc: 0.5669    eval auc: 0.3641  acc: 0.4023    test auc: 0.3570  acc: 0.3971, time: 0.7540
epoch 16    train auc: 0.5968  acc: 0.5668    eval auc: 0.3640  acc: 0.4023    test auc: 0.3570  acc: 0.3972, time: 1.2340
epoch 17    train auc: 0.5968  acc: 0.5669    eval auc: 0.3637  acc: 0.4005    test auc: 0.3570  acc: 0.3989, time: 0.7590
epoch 18    train auc: 0.5969  acc: 0.5669    eval auc: 0.3638  acc: 0.4013    test auc: 0.3571  acc: 0.3980, time: 1.2250
epoch 19    train auc: 0.5969  acc: 0.5668    eval auc: 0.3638  acc: 0.4023    test auc: 0.3570  acc: 0.3972, time: 0.7780
epoch 20    train auc: 0.5970  acc: 0.5669    eval auc: 0.3637  acc: 0.4018    test auc: 0.3570  acc: 0.3976, time: 1.2560
epoch 21    train auc: 0.5970  acc: 0.5669    eval auc: 0.3639  acc: 0.4023    test auc: 0.3569  acc: 0.3971, time: 0.7620
epoch 22    train auc: 0.5970  acc: 0.5669    eval auc: 0.3636  acc: 0.4010    test auc: 0.3570  acc: 0.3984, time: 1.2500
epoch 23    train auc: 0.5971  acc: 0.5669    eval auc: 0.3638  acc: 0.4004    test auc: 0.3569  acc: 0.3990, time: 0.7610
epoch 24    train auc: 0.5971  acc: 0.5669    eval auc: 0.3635  acc: 0.4021    test auc: 0.3571  acc: 0.3973, time: 1.2340
epoch 25    train auc: 0.5971  acc: 0.5669    eval auc: 0.3636  acc: 0.4012    test auc: 0.3569  acc: 0.3982, time: 0.7500
epoch 26    train auc: 0.5971  acc: 0.5669    eval auc: 0.3635  acc: 0.4018    test auc: 0.3570  acc: 0.3976, time: 1.2320
epoch 27    train auc: 0.5971  acc: 0.5669    eval auc: 0.3634  acc: 0.4004    test auc: 0.3572  acc: 0.3990, time: 0.7860
epoch 28    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4022    test auc: 0.3571  acc: 0.3972, time: 1.2440
epoch 29    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4012    test auc: 0.3574  acc: 0.3982, time: 0.7680
epoch 30    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4021    test auc: 0.3571  acc: 0.3973, time: 1.2370
epoch 31    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4019    test auc: 0.3572  acc: 0.3974, time: 0.7610
epoch 32    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4011    test auc: 0.3572  acc: 0.3983, time: 1.1950
epoch 33    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4037    test auc: 0.3569  acc: 0.3957, time: 0.7300
epoch 34    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4026    test auc: 0.3572  acc: 0.3967, time: 1.1760
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4017    test auc: 0.3573  acc: 0.3977, time: 0.7370
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4021    test auc: 0.3572  acc: 0.3973, time: 1.1900
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4015    test auc: 0.3571  acc: 0.3979, time: 0.7410
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4016    test auc: 0.3572  acc: 0.3978, time: 1.2420
epoch 39    train auc: 0.5973  acc: 0.5669    eval auc: 0.3637  acc: 0.4008    test auc: 0.3569  acc: 0.3986, time: 0.8250
epoch 40    train auc: 0.5973  acc: 0.5669    eval auc: 0.3636  acc: 0.4018    test auc: 0.3569  acc: 0.3976, time: 1.4920
epoch 41    train auc: 0.5973  acc: 0.5669    eval auc: 0.3636  acc: 0.4003    test auc: 0.3571  acc: 0.3991, time: 0.7950
epoch 42    train auc: 0.5973  acc: 0.5669    eval auc: 0.3635  acc: 0.4017    test auc: 0.3570  acc: 0.3977, time: 1.2690
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.3996    test auc: 0.3573  acc: 0.3998, time: 0.8560
epoch 44    train auc: 0.5973  acc: 0.5669    eval auc: 0.3634  acc: 0.4010    test auc: 0.3572  acc: 0.3984, time: 1.3800
epoch 45    train auc: 0.5973  acc: 0.5669    eval auc: 0.3634  acc: 0.4028    test auc: 0.3573  acc: 0.3966, time: 0.8390
epoch 46    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4010    test auc: 0.3574  acc: 0.3984, time: 1.2640
epoch 47    train auc: 0.5973  acc: 0.5669    eval auc: 0.3634  acc: 0.4017    test auc: 0.3572  acc: 0.3977, time: 0.7620
epoch 48    train auc: 0.5973  acc: 0.5669    eval auc: 0.3633  acc: 0.3996    test auc: 0.3573  acc: 0.3998, time: 1.2280
epoch 49    train auc: 0.5973  acc: 0.5669    eval auc: 0.3633  acc: 0.4012    test auc: 0.3574  acc: 0.3982, time: 0.7560
avg time per epoch : 1.0169372081756591
--- 61.50899791717529 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 128, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:26:34.210950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:26:34.211299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5167  acc: 0.5134    eval auc: 0.4941  acc: 0.4971    test auc: 0.4788  acc: 0.4821, time: 1.5550
epoch 1    train auc: 0.5435  acc: 0.5222    eval auc: 0.4727  acc: 0.4887    test auc: 0.4700  acc: 0.4821, time: 0.7350
epoch 2    train auc: 0.7841  acc: 0.7152    eval auc: 0.6933  acc: 0.6366    test auc: 0.7036  acc: 0.6497, time: 1.2190
epoch 3    train auc: 0.8503  acc: 0.7552    eval auc: 0.8016  acc: 0.7288    test auc: 0.8087  acc: 0.7363, time: 0.7560
epoch 4    train auc: 0.8348  acc: 0.7525    eval auc: 0.8000  acc: 0.7285    test auc: 0.8076  acc: 0.7359, time: 1.1920
epoch 5    train auc: 0.8832  acc: 0.7733    eval auc: 0.8017  acc: 0.7440    test auc: 0.8072  acc: 0.7498, time: 0.7340
epoch 6    train auc: 0.8702  acc: 0.7658    eval auc: 0.8052  acc: 0.7387    test auc: 0.8095  acc: 0.7478, time: 1.1650
epoch 7    train auc: 0.8930  acc: 0.7850    eval auc: 0.8015  acc: 0.7494    test auc: 0.8061  acc: 0.7537, time: 0.7250
epoch 8    train auc: 0.8843  acc: 0.7722    eval auc: 0.8054  acc: 0.7402    test auc: 0.8084  acc: 0.7471, time: 1.1790
epoch 9    train auc: 0.8997  acc: 0.7935    eval auc: 0.7982  acc: 0.7488    test auc: 0.8022  acc: 0.7513, time: 0.7740
epoch 10    train auc: 0.8971  acc: 0.7824    eval auc: 0.8031  acc: 0.7407    test auc: 0.8055  acc: 0.7464, time: 1.2930
epoch 11    train auc: 0.9049  acc: 0.7925    eval auc: 0.7986  acc: 0.7435    test auc: 0.8006  acc: 0.7471, time: 0.7920
epoch 12    train auc: 0.9030  acc: 0.7871    eval auc: 0.8003  acc: 0.7348    test auc: 0.8016  acc: 0.7426, time: 1.2540
epoch 13    train auc: 0.9120  acc: 0.7987    eval auc: 0.7923  acc: 0.7437    test auc: 0.7937  acc: 0.7414, time: 0.7540
epoch 14    train auc: 0.9132  acc: 0.7973    eval auc: 0.7942  acc: 0.7353    test auc: 0.7941  acc: 0.7390, time: 1.1910
epoch 15    train auc: 0.9200  acc: 0.8099    eval auc: 0.7862  acc: 0.7316    test auc: 0.7859  acc: 0.7276, time: 0.7520
epoch 16    train auc: 0.9207  acc: 0.8060    eval auc: 0.7867  acc: 0.7250    test auc: 0.7852  acc: 0.7250, time: 1.1990
epoch 17    train auc: 0.9254  acc: 0.8234    eval auc: 0.7780  acc: 0.7120    test auc: 0.7772  acc: 0.7108, time: 0.7300
epoch 18    train auc: 0.9250  acc: 0.8128    eval auc: 0.7830  acc: 0.7206    test auc: 0.7808  acc: 0.7186, time: 1.1650
epoch 19    train auc: 0.9290  acc: 0.8252    eval auc: 0.7758  acc: 0.7060    test auc: 0.7740  acc: 0.7050, time: 0.7220
epoch 20    train auc: 0.9280  acc: 0.8171    eval auc: 0.7797  acc: 0.7174    test auc: 0.7764  acc: 0.7107, time: 1.1880
epoch 21    train auc: 0.9317  acc: 0.8285    eval auc: 0.7738  acc: 0.7052    test auc: 0.7713  acc: 0.7027, time: 0.6950
epoch 22    train auc: 0.9312  acc: 0.8247    eval auc: 0.7776  acc: 0.7128    test auc: 0.7742  acc: 0.7080, time: 1.1470
epoch 23    train auc: 0.9333  acc: 0.8299    eval auc: 0.7743  acc: 0.7076    test auc: 0.7710  acc: 0.7045, time: 0.7120
epoch 24    train auc: 0.9318  acc: 0.8228    eval auc: 0.7763  acc: 0.7099    test auc: 0.7721  acc: 0.7042, time: 1.1400
epoch 25    train auc: 0.9351  acc: 0.8329    eval auc: 0.7723  acc: 0.7034    test auc: 0.7690  acc: 0.6998, time: 0.6980
epoch 26    train auc: 0.9337  acc: 0.8273    eval auc: 0.7754  acc: 0.7073    test auc: 0.7712  acc: 0.7041, time: 1.1540
epoch 27    train auc: 0.9367  acc: 0.8360    eval auc: 0.7690  acc: 0.6974    test auc: 0.7657  acc: 0.6931, time: 0.7130
epoch 28    train auc: 0.9358  acc: 0.8333    eval auc: 0.7736  acc: 0.7074    test auc: 0.7692  acc: 0.7010, time: 1.1240
epoch 29    train auc: 0.9380  acc: 0.8393    eval auc: 0.7696  acc: 0.7004    test auc: 0.7659  acc: 0.6954, time: 0.6960
epoch 30    train auc: 0.9366  acc: 0.8349    eval auc: 0.7724  acc: 0.7039    test auc: 0.7680  acc: 0.7002, time: 1.1270
epoch 31    train auc: 0.9393  acc: 0.8411    eval auc: 0.7675  acc: 0.6989    test auc: 0.7635  acc: 0.6925, time: 0.7040
epoch 32    train auc: 0.9363  acc: 0.8327    eval auc: 0.7714  acc: 0.7020    test auc: 0.7667  acc: 0.6987, time: 1.1220
epoch 33    train auc: 0.9403  acc: 0.8423    eval auc: 0.7672  acc: 0.6991    test auc: 0.7631  acc: 0.6931, time: 0.6840
epoch 34    train auc: 0.9380  acc: 0.8360    eval auc: 0.7694  acc: 0.7010    test auc: 0.7647  acc: 0.6959, time: 1.1190
epoch 35    train auc: 0.9407  acc: 0.8425    eval auc: 0.7630  acc: 0.6924    test auc: 0.7595  acc: 0.6880, time: 0.6940
epoch 36    train auc: 0.9411  acc: 0.8419    eval auc: 0.7676  acc: 0.6990    test auc: 0.7636  acc: 0.6967, time: 1.1130
epoch 37    train auc: 0.9425  acc: 0.8436    eval auc: 0.7649  acc: 0.6954    test auc: 0.7610  acc: 0.6893, time: 0.6750
epoch 38    train auc: 0.9424  acc: 0.8436    eval auc: 0.7658  acc: 0.6965    test auc: 0.7616  acc: 0.6919, time: 1.0890
epoch 39    train auc: 0.9437  acc: 0.8451    eval auc: 0.7629  acc: 0.6935    test auc: 0.7588  acc: 0.6880, time: 0.7060
epoch 40    train auc: 0.9418  acc: 0.8412    eval auc: 0.7656  acc: 0.6958    test auc: 0.7611  acc: 0.6931, time: 1.0830
epoch 41    train auc: 0.9446  acc: 0.8467    eval auc: 0.7621  acc: 0.6931    test auc: 0.7581  acc: 0.6891, time: 0.7120
epoch 42    train auc: 0.9445  acc: 0.8459    eval auc: 0.7632  acc: 0.6924    test auc: 0.7588  acc: 0.6896, time: 1.2240
epoch 43    train auc: 0.9456  acc: 0.8476    eval auc: 0.7613  acc: 0.6921    test auc: 0.7570  acc: 0.6872, time: 0.7410
epoch 44    train auc: 0.9440  acc: 0.8438    eval auc: 0.7633  acc: 0.6939    test auc: 0.7584  acc: 0.6905, time: 1.2050
epoch 45    train auc: 0.9463  acc: 0.8489    eval auc: 0.7609  acc: 0.6928    test auc: 0.7567  acc: 0.6885, time: 0.7370
epoch 46    train auc: 0.9464  acc: 0.8488    eval auc: 0.7610  acc: 0.6935    test auc: 0.7565  acc: 0.6864, time: 1.1980
epoch 47    train auc: 0.9467  acc: 0.8491    eval auc: 0.7600  acc: 0.6911    test auc: 0.7554  acc: 0.6854, time: 0.7480
epoch 48    train auc: 0.9470  acc: 0.8490    eval auc: 0.7596  acc: 0.6912    test auc: 0.7549  acc: 0.6854, time: 1.1950
epoch 49    train auc: 0.9478  acc: 0.8508    eval auc: 0.7580  acc: 0.6892    test auc: 0.7539  acc: 0.6843, time: 0.7250
avg time per epoch : 0.955076904296875
--- 57.82796382904053 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:27:32.034209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:27:32.034539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4887  acc: 0.5004    eval auc: 0.5182  acc: 0.5023    test auc: 0.5168  acc: 0.4995, time: 0.7950
epoch 1    train auc: 0.5142  acc: 0.5018    eval auc: 0.4790  acc: 0.4992    test auc: 0.4827  acc: 0.4956, time: 0.5090
epoch 2    train auc: 0.5566  acc: 0.5359    eval auc: 0.4190  acc: 0.4479    test auc: 0.4119  acc: 0.4443, time: 0.4880
epoch 3    train auc: 0.5724  acc: 0.5486    eval auc: 0.3989  acc: 0.4304    test auc: 0.3872  acc: 0.4239, time: 0.5039
epoch 4    train auc: 0.5835  acc: 0.5556    eval auc: 0.3846  acc: 0.4195    test auc: 0.3749  acc: 0.4135, time: 0.4900
epoch 5    train auc: 0.6044  acc: 0.5602    eval auc: 0.3836  acc: 0.4155    test auc: 0.3737  acc: 0.4069, time: 0.5050
epoch 6    train auc: 0.7021  acc: 0.6500    eval auc: 0.4780  acc: 0.5080    test auc: 0.4620  acc: 0.5023, time: 0.4960
epoch 7    train auc: 0.8230  acc: 0.7273    eval auc: 0.6637  acc: 0.5915    test auc: 0.6650  acc: 0.5912, time: 0.4850
epoch 8    train auc: 0.8457  acc: 0.7180    eval auc: 0.7286  acc: 0.6051    test auc: 0.7275  acc: 0.5995, time: 0.4970
epoch 9    train auc: 0.8666  acc: 0.7419    eval auc: 0.7401  acc: 0.6240    test auc: 0.7378  acc: 0.6220, time: 0.4950
epoch 10    train auc: 0.8767  acc: 0.7629    eval auc: 0.7487  acc: 0.6409    test auc: 0.7457  acc: 0.6361, time: 0.4900
epoch 11    train auc: 0.8811  acc: 0.7540    eval auc: 0.7547  acc: 0.6407    test auc: 0.7528  acc: 0.6360, time: 0.4860
epoch 12    train auc: 0.8871  acc: 0.7588    eval auc: 0.7576  acc: 0.6433    test auc: 0.7564  acc: 0.6403, time: 0.4840
epoch 13    train auc: 0.8880  acc: 0.7599    eval auc: 0.7603  acc: 0.6472    test auc: 0.7600  acc: 0.6439, time: 0.5020
epoch 14    train auc: 0.8955  acc: 0.7672    eval auc: 0.7634  acc: 0.6569    test auc: 0.7618  acc: 0.6505, time: 0.4840
epoch 15    train auc: 0.8999  acc: 0.7823    eval auc: 0.7644  acc: 0.6686    test auc: 0.7627  acc: 0.6634, time: 0.4820
epoch 16    train auc: 0.8980  acc: 0.7683    eval auc: 0.7641  acc: 0.6593    test auc: 0.7638  acc: 0.6529, time: 0.4919
epoch 17    train auc: 0.9036  acc: 0.7758    eval auc: 0.7643  acc: 0.6630    test auc: 0.7624  acc: 0.6545, time: 0.5380
epoch 18    train auc: 0.9049  acc: 0.7749    eval auc: 0.7646  acc: 0.6654    test auc: 0.7634  acc: 0.6553, time: 0.5270
epoch 19    train auc: 0.9070  acc: 0.7772    eval auc: 0.7647  acc: 0.6680    test auc: 0.7633  acc: 0.6558, time: 0.5250
epoch 20    train auc: 0.9070  acc: 0.7770    eval auc: 0.7629  acc: 0.6667    test auc: 0.7621  acc: 0.6554, time: 0.5320
epoch 21    train auc: 0.9122  acc: 0.7890    eval auc: 0.7649  acc: 0.6756    test auc: 0.7635  acc: 0.6636, time: 0.5290
epoch 22    train auc: 0.9141  acc: 0.7920    eval auc: 0.7652  acc: 0.6778    test auc: 0.7634  acc: 0.6658, time: 0.5260
epoch 23    train auc: 0.9158  acc: 0.7916    eval auc: 0.7611  acc: 0.6700    test auc: 0.7602  acc: 0.6592, time: 0.5190
epoch 24    train auc: 0.9234  acc: 0.8070    eval auc: 0.7641  acc: 0.6830    test auc: 0.7630  acc: 0.6710, time: 0.5280
epoch 25    train auc: 0.9272  acc: 0.8115    eval auc: 0.7607  acc: 0.6794    test auc: 0.7607  acc: 0.6713, time: 0.5270
epoch 26    train auc: 0.9330  acc: 0.8206    eval auc: 0.7564  acc: 0.6746    test auc: 0.7573  acc: 0.6709, time: 0.5270
epoch 27    train auc: 0.9352  acc: 0.8223    eval auc: 0.7530  acc: 0.6741    test auc: 0.7545  acc: 0.6709, time: 0.5330
epoch 28    train auc: 0.9408  acc: 0.8308    eval auc: 0.7498  acc: 0.6751    test auc: 0.7528  acc: 0.6721, time: 0.5270
epoch 29    train auc: 0.9445  acc: 0.8368    eval auc: 0.7483  acc: 0.6787    test auc: 0.7519  acc: 0.6774, time: 0.5400
epoch 30    train auc: 0.9467  acc: 0.8397    eval auc: 0.7454  acc: 0.6772    test auc: 0.7492  acc: 0.6768, time: 0.5259
epoch 31    train auc: 0.9514  acc: 0.8467    eval auc: 0.7416  acc: 0.6793    test auc: 0.7468  acc: 0.6772, time: 0.5200
epoch 32    train auc: 0.9521  acc: 0.8456    eval auc: 0.7376  acc: 0.6785    test auc: 0.7431  acc: 0.6762, time: 0.5250
epoch 33    train auc: 0.9538  acc: 0.8497    eval auc: 0.7350  acc: 0.6786    test auc: 0.7407  acc: 0.6767, time: 0.5280
epoch 34    train auc: 0.9551  acc: 0.8526    eval auc: 0.7331  acc: 0.6792    test auc: 0.7384  acc: 0.6797, time: 0.5200
epoch 35    train auc: 0.9566  acc: 0.8543    eval auc: 0.7306  acc: 0.6786    test auc: 0.7369  acc: 0.6778, time: 0.5130
epoch 36    train auc: 0.9598  acc: 0.8622    eval auc: 0.7297  acc: 0.6794    test auc: 0.7358  acc: 0.6806, time: 0.5290
epoch 37    train auc: 0.9604  acc: 0.8641    eval auc: 0.7275  acc: 0.6772    test auc: 0.7336  acc: 0.6788, time: 0.5290
epoch 38    train auc: 0.9640  acc: 0.8713    eval auc: 0.7285  acc: 0.6815    test auc: 0.7345  acc: 0.6836, time: 0.5264
epoch 39    train auc: 0.9667  acc: 0.8778    eval auc: 0.7308  acc: 0.6830    test auc: 0.7365  acc: 0.6857, time: 0.5260
epoch 40    train auc: 0.9680  acc: 0.8812    eval auc: 0.7318  acc: 0.6853    test auc: 0.7377  acc: 0.6884, time: 0.5220
epoch 41    train auc: 0.9696  acc: 0.8836    eval auc: 0.7279  acc: 0.6839    test auc: 0.7339  acc: 0.6856, time: 0.5150
epoch 42    train auc: 0.9708  acc: 0.8855    eval auc: 0.7294  acc: 0.6857    test auc: 0.7347  acc: 0.6878, time: 0.5259
epoch 43    train auc: 0.9717  acc: 0.8881    eval auc: 0.7299  acc: 0.6887    test auc: 0.7357  acc: 0.6890, time: 0.5310
epoch 44    train auc: 0.9734  acc: 0.8926    eval auc: 0.7296  acc: 0.6884    test auc: 0.7350  acc: 0.6902, time: 0.5170
epoch 45    train auc: 0.9747  acc: 0.8966    eval auc: 0.7305  acc: 0.6902    test auc: 0.7354  acc: 0.6915, time: 0.5370
epoch 46    train auc: 0.9749  acc: 0.8953    eval auc: 0.7296  acc: 0.6903    test auc: 0.7339  acc: 0.6898, time: 0.5170
epoch 47    train auc: 0.9766  acc: 0.8998    eval auc: 0.7270  acc: 0.6902    test auc: 0.7316  acc: 0.6886, time: 0.5120
epoch 48    train auc: 0.9772  acc: 0.9007    eval auc: 0.7273  acc: 0.6895    test auc: 0.7317  acc: 0.6899, time: 0.5140
epoch 49    train auc: 0.9788  acc: 0.9058    eval auc: 0.7274  acc: 0.6899    test auc: 0.7315  acc: 0.6903, time: 0.4990
avg time per epoch : 0.5198726749420166
--- 31.973421812057495 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:28:03.942504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:28:03.942850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5182  acc: 0.5116    eval auc: 0.5127  acc: 0.5107    test auc: 0.5123  acc: 0.5060, time: 0.7780
epoch 1    train auc: 0.5235  acc: 0.5185    eval auc: 0.5128  acc: 0.5110    test auc: 0.5099  acc: 0.5042, time: 0.5250
epoch 2    train auc: 0.5300  acc: 0.5130    eval auc: 0.4940  acc: 0.4951    test auc: 0.5029  acc: 0.5016, time: 0.4930
epoch 3    train auc: 0.5453  acc: 0.5198    eval auc: 0.4593  acc: 0.4812    test auc: 0.4548  acc: 0.4671, time: 0.5080
epoch 4    train auc: 0.5531  acc: 0.5278    eval auc: 0.4588  acc: 0.4753    test auc: 0.4501  acc: 0.4626, time: 0.5020
epoch 5    train auc: 0.5550  acc: 0.5334    eval auc: 0.4264  acc: 0.4537    test auc: 0.4175  acc: 0.4460, time: 0.4900
epoch 6    train auc: 0.5630  acc: 0.5409    eval auc: 0.4121  acc: 0.4427    test auc: 0.4052  acc: 0.4355, time: 0.4890
epoch 7    train auc: 0.5696  acc: 0.5474    eval auc: 0.4033  acc: 0.4330    test auc: 0.3960  acc: 0.4251, time: 0.4960
epoch 8    train auc: 0.5751  acc: 0.5516    eval auc: 0.3954  acc: 0.4252    test auc: 0.3890  acc: 0.4215, time: 0.4980
epoch 9    train auc: 0.5802  acc: 0.5543    eval auc: 0.3902  acc: 0.4217    test auc: 0.3829  acc: 0.4162, time: 0.5050
epoch 10    train auc: 0.5847  acc: 0.5563    eval auc: 0.3859  acc: 0.4175    test auc: 0.3794  acc: 0.4137, time: 0.4967
epoch 11    train auc: 0.5889  acc: 0.5577    eval auc: 0.3832  acc: 0.4182    test auc: 0.3767  acc: 0.4095, time: 0.4850
epoch 12    train auc: 0.5933  acc: 0.5588    eval auc: 0.3818  acc: 0.4162    test auc: 0.3751  acc: 0.4085, time: 0.4930
epoch 13    train auc: 0.5992  acc: 0.5596    eval auc: 0.3815  acc: 0.4147    test auc: 0.3750  acc: 0.4080, time: 0.4920
epoch 14    train auc: 0.6062  acc: 0.5610    eval auc: 0.3825  acc: 0.4135    test auc: 0.3762  acc: 0.4074, time: 0.4950
epoch 15    train auc: 0.6168  acc: 0.5612    eval auc: 0.3873  acc: 0.4139    test auc: 0.3806  acc: 0.4054, time: 0.4850
epoch 16    train auc: 0.6327  acc: 0.5594    eval auc: 0.3983  acc: 0.4162    test auc: 0.3915  acc: 0.4130, time: 0.4910
epoch 17    train auc: 0.6548  acc: 0.5623    eval auc: 0.4164  acc: 0.4250    test auc: 0.4091  acc: 0.4193, time: 0.4900
epoch 18    train auc: 0.6872  acc: 0.5871    eval auc: 0.4491  acc: 0.4532    test auc: 0.4424  acc: 0.4506, time: 0.5070
epoch 19    train auc: 0.7266  acc: 0.6311    eval auc: 0.4966  acc: 0.5152    test auc: 0.4906  acc: 0.5077, time: 0.4840
epoch 20    train auc: 0.7637  acc: 0.6822    eval auc: 0.5486  acc: 0.5676    test auc: 0.5423  acc: 0.5612, time: 0.4890
epoch 21    train auc: 0.7895  acc: 0.7107    eval auc: 0.5893  acc: 0.5919    test auc: 0.5849  acc: 0.5932, time: 0.4830
epoch 22    train auc: 0.8089  acc: 0.7340    eval auc: 0.6216  acc: 0.6135    test auc: 0.6183  acc: 0.6122, time: 0.5030
epoch 23    train auc: 0.8220  acc: 0.7432    eval auc: 0.6427  acc: 0.6229    test auc: 0.6409  acc: 0.6213, time: 0.4800
epoch 24    train auc: 0.8325  acc: 0.7490    eval auc: 0.6584  acc: 0.6288    test auc: 0.6584  acc: 0.6278, time: 0.4760
epoch 25    train auc: 0.8418  acc: 0.7514    eval auc: 0.6747  acc: 0.6290    test auc: 0.6760  acc: 0.6323, time: 0.4860
epoch 26    train auc: 0.8492  acc: 0.7532    eval auc: 0.6877  acc: 0.6311    test auc: 0.6902  acc: 0.6309, time: 0.4870
epoch 27    train auc: 0.8558  acc: 0.7568    eval auc: 0.6980  acc: 0.6333    test auc: 0.7013  acc: 0.6335, time: 0.4899
epoch 28    train auc: 0.8616  acc: 0.7584    eval auc: 0.7084  acc: 0.6368    test auc: 0.7122  acc: 0.6341, time: 0.4830
epoch 29    train auc: 0.8667  acc: 0.7618    eval auc: 0.7184  acc: 0.6390    test auc: 0.7227  acc: 0.6369, time: 0.4730
epoch 30    train auc: 0.8714  acc: 0.7639    eval auc: 0.7257  acc: 0.6414    test auc: 0.7301  acc: 0.6354, time: 0.4880
epoch 31    train auc: 0.8762  acc: 0.7681    eval auc: 0.7330  acc: 0.6416    test auc: 0.7370  acc: 0.6390, time: 0.4750
epoch 32    train auc: 0.8805  acc: 0.7698    eval auc: 0.7387  acc: 0.6419    test auc: 0.7424  acc: 0.6399, time: 0.4650
epoch 33    train auc: 0.8845  acc: 0.7732    eval auc: 0.7447  acc: 0.6443    test auc: 0.7484  acc: 0.6440, time: 0.4720
epoch 34    train auc: 0.8889  acc: 0.7765    eval auc: 0.7493  acc: 0.6477    test auc: 0.7527  acc: 0.6446, time: 0.4700
epoch 35    train auc: 0.8928  acc: 0.7804    eval auc: 0.7532  acc: 0.6505    test auc: 0.7565  acc: 0.6465, time: 0.4660
epoch 36    train auc: 0.8961  acc: 0.7825    eval auc: 0.7564  acc: 0.6510    test auc: 0.7596  acc: 0.6490, time: 0.4720
epoch 37    train auc: 0.8988  acc: 0.7848    eval auc: 0.7595  acc: 0.6533    test auc: 0.7624  acc: 0.6503, time: 0.4640
epoch 38    train auc: 0.9013  acc: 0.7905    eval auc: 0.7613  acc: 0.6583    test auc: 0.7640  acc: 0.6526, time: 0.4730
epoch 39    train auc: 0.9034  acc: 0.7912    eval auc: 0.7634  acc: 0.6591    test auc: 0.7660  acc: 0.6537, time: 0.4890
epoch 40    train auc: 0.9055  acc: 0.7936    eval auc: 0.7645  acc: 0.6604    test auc: 0.7669  acc: 0.6545, time: 0.4650
epoch 41    train auc: 0.9070  acc: 0.7966    eval auc: 0.7659  acc: 0.6641    test auc: 0.7680  acc: 0.6596, time: 0.4610
epoch 42    train auc: 0.9092  acc: 0.7979    eval auc: 0.7665  acc: 0.6624    test auc: 0.7685  acc: 0.6567, time: 0.4720
epoch 43    train auc: 0.9103  acc: 0.8002    eval auc: 0.7676  acc: 0.6673    test auc: 0.7692  acc: 0.6608, time: 0.4879
epoch 44    train auc: 0.9116  acc: 0.8027    eval auc: 0.7682  acc: 0.6716    test auc: 0.7696  acc: 0.6638, time: 0.4700
epoch 45    train auc: 0.9131  acc: 0.8043    eval auc: 0.7684  acc: 0.6717    test auc: 0.7696  acc: 0.6632, time: 0.4770
epoch 46    train auc: 0.9142  acc: 0.8058    eval auc: 0.7689  acc: 0.6719    test auc: 0.7700  acc: 0.6638, time: 0.4640
epoch 47    train auc: 0.9152  acc: 0.8073    eval auc: 0.7692  acc: 0.6719    test auc: 0.7702  acc: 0.6643, time: 0.4830
epoch 48    train auc: 0.9162  acc: 0.8102    eval auc: 0.7693  acc: 0.6760    test auc: 0.7699  acc: 0.6668, time: 0.4550
epoch 49    train auc: 0.9170  acc: 0.8108    eval auc: 0.7694  acc: 0.6773    test auc: 0.7701  acc: 0.6680, time: 0.4560
avg time per epoch : 0.4895396423339844
--- 30.00772261619568 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:28:33.994550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:28:33.994925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5056  acc: 0.5001    eval auc: 0.5449  acc: 0.5010    test auc: 0.5352  acc: 0.5005, time: 0.8510
epoch 1    train auc: 0.8216  acc: 0.6461    eval auc: 0.7270  acc: 0.6344    test auc: 0.7452  acc: 0.6467, time: 0.4970
epoch 2    train auc: 0.8855  acc: 0.7656    eval auc: 0.7846  acc: 0.7388    test auc: 0.7912  acc: 0.7494, time: 0.5060
epoch 3    train auc: 0.8987  acc: 0.7959    eval auc: 0.7908  acc: 0.7471    test auc: 0.7949  acc: 0.7453, time: 0.5200
epoch 4    train auc: 0.9056  acc: 0.8036    eval auc: 0.7926  acc: 0.7393    test auc: 0.7949  acc: 0.7348, time: 0.4920
epoch 5    train auc: 0.9100  acc: 0.8055    eval auc: 0.7923  acc: 0.7357    test auc: 0.7941  acc: 0.7301, time: 0.4960
epoch 6    train auc: 0.9137  acc: 0.8114    eval auc: 0.7912  acc: 0.7259    test auc: 0.7929  acc: 0.7216, time: 0.4970
epoch 7    train auc: 0.9173  acc: 0.8134    eval auc: 0.7890  acc: 0.7255    test auc: 0.7908  acc: 0.7192, time: 0.5049
epoch 8    train auc: 0.9213  acc: 0.8179    eval auc: 0.7871  acc: 0.7163    test auc: 0.7884  acc: 0.7117, time: 0.4840
epoch 9    train auc: 0.9247  acc: 0.8211    eval auc: 0.7847  acc: 0.7153    test auc: 0.7851  acc: 0.7125, time: 0.4940
epoch 10    train auc: 0.9268  acc: 0.8203    eval auc: 0.7825  acc: 0.7147    test auc: 0.7820  acc: 0.7126, time: 0.5020
epoch 11    train auc: 0.9294  acc: 0.8249    eval auc: 0.7806  acc: 0.7091    test auc: 0.7798  acc: 0.7066, time: 0.5080
epoch 12    train auc: 0.9313  acc: 0.8283    eval auc: 0.7784  acc: 0.7041    test auc: 0.7775  acc: 0.7050, time: 0.4930
epoch 13    train auc: 0.9327  acc: 0.8295    eval auc: 0.7772  acc: 0.7002    test auc: 0.7763  acc: 0.7014, time: 0.5020
epoch 14    train auc: 0.9339  acc: 0.8303    eval auc: 0.7757  acc: 0.6998    test auc: 0.7748  acc: 0.7015, time: 0.4900
epoch 15    train auc: 0.9348  acc: 0.8315    eval auc: 0.7749  acc: 0.6998    test auc: 0.7747  acc: 0.7003, time: 0.5130
epoch 16    train auc: 0.9358  acc: 0.8337    eval auc: 0.7735  acc: 0.7008    test auc: 0.7727  acc: 0.7002, time: 0.4860
epoch 17    train auc: 0.9366  acc: 0.8346    eval auc: 0.7736  acc: 0.7009    test auc: 0.7725  acc: 0.7009, time: 0.4930
epoch 18    train auc: 0.9371  acc: 0.8347    eval auc: 0.7734  acc: 0.7024    test auc: 0.7720  acc: 0.7007, time: 0.4860
epoch 19    train auc: 0.9379  acc: 0.8353    eval auc: 0.7729  acc: 0.7015    test auc: 0.7714  acc: 0.6996, time: 0.5340
epoch 20    train auc: 0.9392  acc: 0.8380    eval auc: 0.7697  acc: 0.6995    test auc: 0.7684  acc: 0.6981, time: 0.5290
epoch 21    train auc: 0.9393  acc: 0.8381    eval auc: 0.7711  acc: 0.7002    test auc: 0.7698  acc: 0.7000, time: 0.5140
epoch 22    train auc: 0.9403  acc: 0.8396    eval auc: 0.7695  acc: 0.6983    test auc: 0.7681  acc: 0.7003, time: 0.5100
epoch 23    train auc: 0.9412  acc: 0.8411    eval auc: 0.7668  acc: 0.6939    test auc: 0.7657  acc: 0.6951, time: 0.5380
epoch 24    train auc: 0.9420  acc: 0.8418    eval auc: 0.7665  acc: 0.6944    test auc: 0.7653  acc: 0.6964, time: 0.5280
epoch 25    train auc: 0.9425  acc: 0.8425    eval auc: 0.7657  acc: 0.6943    test auc: 0.7644  acc: 0.6952, time: 0.5180
epoch 26    train auc: 0.9436  acc: 0.8449    eval auc: 0.7617  acc: 0.6872    test auc: 0.7608  acc: 0.6903, time: 0.5240
epoch 27    train auc: 0.9437  acc: 0.8439    eval auc: 0.7642  acc: 0.6944    test auc: 0.7625  acc: 0.6945, time: 0.5300
epoch 28    train auc: 0.9447  acc: 0.8452    eval auc: 0.7619  acc: 0.6897    test auc: 0.7605  acc: 0.6909, time: 0.5000
epoch 29    train auc: 0.9454  acc: 0.8464    eval auc: 0.7610  acc: 0.6904    test auc: 0.7595  acc: 0.6912, time: 0.5110
epoch 30    train auc: 0.9458  acc: 0.8475    eval auc: 0.7615  acc: 0.6922    test auc: 0.7600  acc: 0.6916, time: 0.5080
epoch 31    train auc: 0.9466  acc: 0.8475    eval auc: 0.7596  acc: 0.6902    test auc: 0.7582  acc: 0.6906, time: 0.5070
epoch 32    train auc: 0.9476  acc: 0.8497    eval auc: 0.7557  acc: 0.6856    test auc: 0.7553  acc: 0.6891, time: 0.5030
epoch 33    train auc: 0.9479  acc: 0.8490    eval auc: 0.7569  acc: 0.6877    test auc: 0.7568  acc: 0.6896, time: 0.5090
epoch 34    train auc: 0.9483  acc: 0.8497    eval auc: 0.7574  acc: 0.6887    test auc: 0.7566  acc: 0.6898, time: 0.5210
epoch 35    train auc: 0.9498  acc: 0.8522    eval auc: 0.7539  acc: 0.6837    test auc: 0.7544  acc: 0.6889, time: 0.5300
epoch 36    train auc: 0.9502  acc: 0.8522    eval auc: 0.7546  acc: 0.6856    test auc: 0.7547  acc: 0.6900, time: 0.5200
epoch 37    train auc: 0.9512  acc: 0.8545    eval auc: 0.7509  acc: 0.6823    test auc: 0.7516  acc: 0.6873, time: 0.5160
epoch 38    train auc: 0.9521  acc: 0.8548    eval auc: 0.7514  acc: 0.6814    test auc: 0.7516  acc: 0.6853, time: 0.5200
epoch 39    train auc: 0.9528  acc: 0.8556    eval auc: 0.7503  acc: 0.6811    test auc: 0.7508  acc: 0.6876, time: 0.5040
epoch 40    train auc: 0.9536  acc: 0.8570    eval auc: 0.7495  acc: 0.6813    test auc: 0.7502  acc: 0.6866, time: 0.5190
epoch 41    train auc: 0.9542  acc: 0.8567    eval auc: 0.7500  acc: 0.6832    test auc: 0.7507  acc: 0.6887, time: 0.5130
epoch 42    train auc: 0.9559  acc: 0.8586    eval auc: 0.7460  acc: 0.6781    test auc: 0.7477  acc: 0.6846, time: 0.5330
epoch 43    train auc: 0.9570  acc: 0.8605    eval auc: 0.7471  acc: 0.6801    test auc: 0.7485  acc: 0.6870, time: 0.5230
epoch 44    train auc: 0.9585  acc: 0.8622    eval auc: 0.7448  acc: 0.6805    test auc: 0.7468  acc: 0.6857, time: 0.5240
epoch 45    train auc: 0.9598  acc: 0.8652    eval auc: 0.7454  acc: 0.6817    test auc: 0.7474  acc: 0.6880, time: 0.5200
epoch 46    train auc: 0.9609  acc: 0.8667    eval auc: 0.7457  acc: 0.6831    test auc: 0.7472  acc: 0.6871, time: 0.5200
epoch 47    train auc: 0.9626  acc: 0.8685    eval auc: 0.7436  acc: 0.6830    test auc: 0.7457  acc: 0.6873, time: 0.5140
epoch 48    train auc: 0.9636  acc: 0.8702    eval auc: 0.7411  acc: 0.6791    test auc: 0.7433  acc: 0.6858, time: 0.5150
epoch 49    train auc: 0.9654  acc: 0.8751    eval auc: 0.7433  acc: 0.6827    test auc: 0.7455  acc: 0.6876, time: 0.5130
avg time per epoch : 0.5176520872116089
--- 31.680999755859375 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:29:05.763192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:29:05.763534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5283  acc: 0.5159    eval auc: 0.5243  acc: 0.5094    test auc: 0.5296  acc: 0.5147, time: 0.8330
epoch 1    train auc: 0.6070  acc: 0.5431    eval auc: 0.5634  acc: 0.5331    test auc: 0.5656  acc: 0.5344, time: 0.5210
epoch 2    train auc: 0.7025  acc: 0.6410    eval auc: 0.6430  acc: 0.6210    test auc: 0.6449  acc: 0.6141, time: 0.5330
epoch 3    train auc: 0.7274  acc: 0.5878    eval auc: 0.6548  acc: 0.5800    test auc: 0.6595  acc: 0.5861, time: 0.5300
epoch 4    train auc: 0.8044  acc: 0.6429    eval auc: 0.7117  acc: 0.6329    test auc: 0.7135  acc: 0.6441, time: 0.5180
epoch 5    train auc: 0.8428  acc: 0.6839    eval auc: 0.7416  acc: 0.6701    test auc: 0.7435  acc: 0.6825, time: 0.5280
epoch 6    train auc: 0.8639  acc: 0.7060    eval auc: 0.7625  acc: 0.6915    test auc: 0.7631  acc: 0.7008, time: 0.5230
epoch 7    train auc: 0.8769  acc: 0.7221    eval auc: 0.7762  acc: 0.7049    test auc: 0.7764  acc: 0.7137, time: 0.5320
epoch 8    train auc: 0.8874  acc: 0.7384    eval auc: 0.7859  acc: 0.7181    test auc: 0.7864  acc: 0.7267, time: 0.5290
epoch 9    train auc: 0.8919  acc: 0.7500    eval auc: 0.7899  acc: 0.7225    test auc: 0.7906  acc: 0.7347, time: 0.5210
epoch 10    train auc: 0.8947  acc: 0.7589    eval auc: 0.7922  acc: 0.7295    test auc: 0.7929  acc: 0.7406, time: 0.5230
epoch 11    train auc: 0.8974  acc: 0.7717    eval auc: 0.7940  acc: 0.7422    test auc: 0.7949  acc: 0.7501, time: 0.5160
epoch 12    train auc: 0.8991  acc: 0.7761    eval auc: 0.7949  acc: 0.7464    test auc: 0.7960  acc: 0.7520, time: 0.5210
epoch 13    train auc: 0.9008  acc: 0.7827    eval auc: 0.7957  acc: 0.7466    test auc: 0.7969  acc: 0.7544, time: 0.5220
epoch 14    train auc: 0.9017  acc: 0.7825    eval auc: 0.7961  acc: 0.7463    test auc: 0.7970  acc: 0.7539, time: 0.5190
epoch 15    train auc: 0.9030  acc: 0.7869    eval auc: 0.7965  acc: 0.7461    test auc: 0.7974  acc: 0.7500, time: 0.5110
epoch 16    train auc: 0.9043  acc: 0.7936    eval auc: 0.7970  acc: 0.7467    test auc: 0.7979  acc: 0.7451, time: 0.5190
epoch 17    train auc: 0.9050  acc: 0.7928    eval auc: 0.7973  acc: 0.7445    test auc: 0.7978  acc: 0.7445, time: 0.5110
epoch 18    train auc: 0.9061  acc: 0.7960    eval auc: 0.7975  acc: 0.7452    test auc: 0.7979  acc: 0.7429, time: 0.5150
epoch 19    train auc: 0.9069  acc: 0.7975    eval auc: 0.7975  acc: 0.7438    test auc: 0.7976  acc: 0.7412, time: 0.5020
epoch 20    train auc: 0.9079  acc: 0.7998    eval auc: 0.7976  acc: 0.7422    test auc: 0.7975  acc: 0.7367, time: 0.5320
epoch 21    train auc: 0.9084  acc: 0.7994    eval auc: 0.7975  acc: 0.7400    test auc: 0.7970  acc: 0.7365, time: 0.5340
epoch 22    train auc: 0.9092  acc: 0.8007    eval auc: 0.7973  acc: 0.7386    test auc: 0.7967  acc: 0.7357, time: 0.5100
epoch 23    train auc: 0.9106  acc: 0.8061    eval auc: 0.7975  acc: 0.7377    test auc: 0.7970  acc: 0.7292, time: 0.5360
epoch 24    train auc: 0.9110  acc: 0.8042    eval auc: 0.7970  acc: 0.7363    test auc: 0.7961  acc: 0.7308, time: 0.5360
epoch 25    train auc: 0.9120  acc: 0.8057    eval auc: 0.7968  acc: 0.7375    test auc: 0.7958  acc: 0.7294, time: 0.5180
epoch 26    train auc: 0.9132  acc: 0.8074    eval auc: 0.7965  acc: 0.7350    test auc: 0.7955  acc: 0.7254, time: 0.5240
epoch 27    train auc: 0.9141  acc: 0.8086    eval auc: 0.7961  acc: 0.7352    test auc: 0.7949  acc: 0.7244, time: 0.5180
epoch 28    train auc: 0.9150  acc: 0.8097    eval auc: 0.7957  acc: 0.7344    test auc: 0.7942  acc: 0.7233, time: 0.5190
epoch 29    train auc: 0.9160  acc: 0.8102    eval auc: 0.7951  acc: 0.7336    test auc: 0.7935  acc: 0.7231, time: 0.5200
epoch 30    train auc: 0.9168  acc: 0.8110    eval auc: 0.7944  acc: 0.7322    test auc: 0.7927  acc: 0.7235, time: 0.5130
epoch 31    train auc: 0.9177  acc: 0.8112    eval auc: 0.7937  acc: 0.7328    test auc: 0.7917  acc: 0.7225, time: 0.5060
epoch 32    train auc: 0.9191  acc: 0.8143    eval auc: 0.7932  acc: 0.7314    test auc: 0.7912  acc: 0.7204, time: 0.5130
epoch 33    train auc: 0.9200  acc: 0.8149    eval auc: 0.7924  acc: 0.7300    test auc: 0.7903  acc: 0.7205, time: 0.5100
epoch 34    train auc: 0.9210  acc: 0.8155    eval auc: 0.7915  acc: 0.7289    test auc: 0.7891  acc: 0.7198, time: 0.5120
epoch 35    train auc: 0.9225  acc: 0.8193    eval auc: 0.7908  acc: 0.7262    test auc: 0.7888  acc: 0.7154, time: 0.5020
epoch 36    train auc: 0.9234  acc: 0.8203    eval auc: 0.7900  acc: 0.7258    test auc: 0.7876  acc: 0.7147, time: 0.5220
epoch 37    train auc: 0.9244  acc: 0.8217    eval auc: 0.7891  acc: 0.7256    test auc: 0.7868  acc: 0.7131, time: 0.5010
epoch 38    train auc: 0.9249  acc: 0.8208    eval auc: 0.7880  acc: 0.7241    test auc: 0.7853  acc: 0.7140, time: 0.5070
epoch 39    train auc: 0.9256  acc: 0.8212    eval auc: 0.7871  acc: 0.7219    test auc: 0.7842  acc: 0.7131, time: 0.5100
epoch 40    train auc: 0.9260  acc: 0.8207    eval auc: 0.7862  acc: 0.7222    test auc: 0.7830  acc: 0.7147, time: 0.5140
epoch 41    train auc: 0.9271  acc: 0.8226    eval auc: 0.7855  acc: 0.7215    test auc: 0.7825  acc: 0.7122, time: 0.4970
epoch 42    train auc: 0.9281  acc: 0.8246    eval auc: 0.7848  acc: 0.7191    test auc: 0.7821  acc: 0.7099, time: 0.5320
epoch 43    train auc: 0.9288  acc: 0.8259    eval auc: 0.7842  acc: 0.7166    test auc: 0.7814  acc: 0.7080, time: 0.5010
epoch 44    train auc: 0.9289  acc: 0.8244    eval auc: 0.7834  acc: 0.7190    test auc: 0.7801  acc: 0.7108, time: 0.5190
epoch 45    train auc: 0.9293  acc: 0.8241    eval auc: 0.7829  acc: 0.7187    test auc: 0.7794  acc: 0.7107, time: 0.4890
epoch 46    train auc: 0.9297  acc: 0.8243    eval auc: 0.7822  acc: 0.7173    test auc: 0.7786  acc: 0.7104, time: 0.4900
epoch 47    train auc: 0.9306  acc: 0.8266    eval auc: 0.7818  acc: 0.7160    test auc: 0.7784  acc: 0.7082, time: 0.4960
epoch 48    train auc: 0.9313  acc: 0.8278    eval auc: 0.7811  acc: 0.7127    test auc: 0.7780  acc: 0.7070, time: 0.5020
epoch 49    train auc: 0.9308  acc: 0.8256    eval auc: 0.7803  acc: 0.7173    test auc: 0.7765  acc: 0.7081, time: 0.4949
avg time per epoch : 0.5220961618423462
--- 32.05896520614624 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:29:37.878482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:29:37.878847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4846  acc: 0.4908    eval auc: 0.5268  acc: 0.5153    test auc: 0.5199  acc: 0.5126, time: 0.7950
epoch 1    train auc: 0.5034  acc: 0.5006    eval auc: 0.4913  acc: 0.4945    test auc: 0.4984  acc: 0.5041, time: 0.4790
epoch 2    train auc: 0.5155  acc: 0.5080    eval auc: 0.4827  acc: 0.4904    test auc: 0.4705  acc: 0.4849, time: 0.4870
epoch 3    train auc: 0.5621  acc: 0.5432    eval auc: 0.4098  acc: 0.4372    test auc: 0.4064  acc: 0.4331, time: 0.4810
epoch 4    train auc: 0.5786  acc: 0.5561    eval auc: 0.3884  acc: 0.4231    test auc: 0.3814  acc: 0.4089, time: 0.4820
epoch 5    train auc: 0.5936  acc: 0.5602    eval auc: 0.3801  acc: 0.4136    test auc: 0.3727  acc: 0.4069, time: 0.4840
epoch 6    train auc: 0.6269  acc: 0.5668    eval auc: 0.3882  acc: 0.4154    test auc: 0.3737  acc: 0.4042, time: 0.4710
epoch 7    train auc: 0.7373  acc: 0.6575    eval auc: 0.5302  acc: 0.5093    test auc: 0.5256  acc: 0.5043, time: 0.4820
epoch 8    train auc: 0.8067  acc: 0.7035    eval auc: 0.6461  acc: 0.5667    test auc: 0.6550  acc: 0.5665, time: 0.4850
epoch 9    train auc: 0.8336  acc: 0.7209    eval auc: 0.6847  acc: 0.5894    test auc: 0.6907  acc: 0.5852, time: 0.4750
epoch 10    train auc: 0.8490  acc: 0.7408    eval auc: 0.7056  acc: 0.6158    test auc: 0.7097  acc: 0.6105, time: 0.4730
epoch 11    train auc: 0.8608  acc: 0.7503    eval auc: 0.7168  acc: 0.6273    test auc: 0.7200  acc: 0.6240, time: 0.4730
epoch 12    train auc: 0.8659  acc: 0.7375    eval auc: 0.7230  acc: 0.6217    test auc: 0.7282  acc: 0.6174, time: 0.4780
epoch 13    train auc: 0.8723  acc: 0.7485    eval auc: 0.7270  acc: 0.6322    test auc: 0.7313  acc: 0.6277, time: 0.4630
epoch 14    train auc: 0.8787  acc: 0.7655    eval auc: 0.7309  acc: 0.6510    test auc: 0.7347  acc: 0.6545, time: 0.4759
epoch 15    train auc: 0.8839  acc: 0.7727    eval auc: 0.7313  acc: 0.6570    test auc: 0.7355  acc: 0.6624, time: 0.4640
epoch 16    train auc: 0.8877  acc: 0.7768    eval auc: 0.7334  acc: 0.6584    test auc: 0.7378  acc: 0.6627, time: 0.4690
epoch 17    train auc: 0.8951  acc: 0.7886    eval auc: 0.7348  acc: 0.6662    test auc: 0.7392  acc: 0.6714, time: 0.4650
epoch 18    train auc: 0.9040  acc: 0.8042    eval auc: 0.7338  acc: 0.6797    test auc: 0.7374  acc: 0.6795, time: 0.4730
epoch 19    train auc: 0.9175  acc: 0.8170    eval auc: 0.7354  acc: 0.6781    test auc: 0.7385  acc: 0.6773, time: 0.4650
epoch 20    train auc: 0.9296  acc: 0.8314    eval auc: 0.7294  acc: 0.6814    test auc: 0.7322  acc: 0.6799, time: 0.4750
epoch 21    train auc: 0.9371  acc: 0.8432    eval auc: 0.7251  acc: 0.6859    test auc: 0.7268  acc: 0.6873, time: 0.4669
epoch 22    train auc: 0.9433  acc: 0.8539    eval auc: 0.7225  acc: 0.6867    test auc: 0.7241  acc: 0.6899, time: 0.4580
epoch 23    train auc: 0.9465  acc: 0.8553    eval auc: 0.7123  acc: 0.6767    test auc: 0.7146  acc: 0.6823, time: 0.4660
epoch 24    train auc: 0.9501  acc: 0.8607    eval auc: 0.7130  acc: 0.6832    test auc: 0.7148  acc: 0.6847, time: 0.4679
epoch 25    train auc: 0.9544  acc: 0.8683    eval auc: 0.7066  acc: 0.6789    test auc: 0.7079  acc: 0.6825, time: 0.4620
epoch 26    train auc: 0.9566  acc: 0.8707    eval auc: 0.7035  acc: 0.6760    test auc: 0.7049  acc: 0.6800, time: 0.4610
epoch 27    train auc: 0.9581  acc: 0.8709    eval auc: 0.7033  acc: 0.6779    test auc: 0.7039  acc: 0.6771, time: 0.4680
epoch 28    train auc: 0.9613  acc: 0.8783    eval auc: 0.7038  acc: 0.6801    test auc: 0.7030  acc: 0.6789, time: 0.4670
epoch 29    train auc: 0.9639  acc: 0.8854    eval auc: 0.7063  acc: 0.6834    test auc: 0.7046  acc: 0.6812, time: 0.4640
epoch 30    train auc: 0.9651  acc: 0.8829    eval auc: 0.7006  acc: 0.6768    test auc: 0.6993  acc: 0.6758, time: 0.4600
epoch 31    train auc: 0.9663  acc: 0.8882    eval auc: 0.7064  acc: 0.6817    test auc: 0.7045  acc: 0.6824, time: 0.4640
epoch 32    train auc: 0.9663  acc: 0.8859    eval auc: 0.7013  acc: 0.6760    test auc: 0.6989  acc: 0.6778, time: 0.4560
epoch 33    train auc: 0.9687  acc: 0.8918    eval auc: 0.7061  acc: 0.6797    test auc: 0.7021  acc: 0.6799, time: 0.4850
epoch 34    train auc: 0.9683  acc: 0.8898    eval auc: 0.7030  acc: 0.6766    test auc: 0.6997  acc: 0.6778, time: 0.4630
epoch 35    train auc: 0.9700  acc: 0.8907    eval auc: 0.7043  acc: 0.6781    test auc: 0.7002  acc: 0.6765, time: 0.4520
epoch 36    train auc: 0.9721  acc: 0.8954    eval auc: 0.7052  acc: 0.6787    test auc: 0.7005  acc: 0.6793, time: 0.4650
epoch 37    train auc: 0.9711  acc: 0.8938    eval auc: 0.7054  acc: 0.6776    test auc: 0.7006  acc: 0.6780, time: 0.4890
epoch 38    train auc: 0.9739  acc: 0.9002    eval auc: 0.7063  acc: 0.6815    test auc: 0.7008  acc: 0.6800, time: 0.4770
epoch 39    train auc: 0.9740  acc: 0.8992    eval auc: 0.7001  acc: 0.6765    test auc: 0.6951  acc: 0.6751, time: 0.4640
epoch 40    train auc: 0.9755  acc: 0.9034    eval auc: 0.7055  acc: 0.6813    test auc: 0.6992  acc: 0.6779, time: 0.4490
epoch 41    train auc: 0.9764  acc: 0.9054    eval auc: 0.7041  acc: 0.6798    test auc: 0.6979  acc: 0.6787, time: 0.5060
epoch 42    train auc: 0.9761  acc: 0.9035    eval auc: 0.7041  acc: 0.6788    test auc: 0.6974  acc: 0.6785, time: 0.4719
epoch 43    train auc: 0.9770  acc: 0.9066    eval auc: 0.7038  acc: 0.6784    test auc: 0.6972  acc: 0.6765, time: 0.4590
epoch 44    train auc: 0.9786  acc: 0.9105    eval auc: 0.7047  acc: 0.6797    test auc: 0.6971  acc: 0.6785, time: 0.4580
epoch 45    train auc: 0.9791  acc: 0.9109    eval auc: 0.7032  acc: 0.6785    test auc: 0.6957  acc: 0.6761, time: 0.4690
epoch 46    train auc: 0.9786  acc: 0.9111    eval auc: 0.7045  acc: 0.6789    test auc: 0.6970  acc: 0.6771, time: 0.4750
epoch 47    train auc: 0.9787  acc: 0.9104    eval auc: 0.7040  acc: 0.6799    test auc: 0.6960  acc: 0.6755, time: 0.4550
epoch 48    train auc: 0.9787  acc: 0.9117    eval auc: 0.7084  acc: 0.6806    test auc: 0.6995  acc: 0.6782, time: 0.4780
epoch 49    train auc: 0.9809  acc: 0.9170    eval auc: 0.7063  acc: 0.6806    test auc: 0.6977  acc: 0.6784, time: 0.4620
avg time per epoch : 0.47667425632476806
--- 29.424036741256714 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:30:07.267354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:30:07.267725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5026  acc: 0.5014    eval auc: 0.5074  acc: 0.5075    test auc: 0.5068  acc: 0.5094, time: 0.8340
epoch 1    train auc: 0.5801  acc: 0.5457    eval auc: 0.5578  acc: 0.5380    test auc: 0.5625  acc: 0.5396, time: 0.5150
epoch 2    train auc: 0.7007  acc: 0.6393    eval auc: 0.6584  acc: 0.6180    test auc: 0.6647  acc: 0.6193, time: 0.5300
epoch 3    train auc: 0.7086  acc: 0.5226    eval auc: 0.7125  acc: 0.5086    test auc: 0.7286  acc: 0.5128, time: 0.4960
epoch 4    train auc: 0.8602  acc: 0.7497    eval auc: 0.7704  acc: 0.7250    test auc: 0.7756  acc: 0.7322, time: 0.4830
epoch 5    train auc: 0.8619  acc: 0.7118    eval auc: 0.7592  acc: 0.6928    test auc: 0.7637  acc: 0.7058, time: 0.5160
epoch 6    train auc: 0.8738  acc: 0.7278    eval auc: 0.7676  acc: 0.7048    test auc: 0.7720  acc: 0.7172, time: 0.4869
epoch 7    train auc: 0.8828  acc: 0.7417    eval auc: 0.7770  acc: 0.7206    test auc: 0.7809  acc: 0.7301, time: 0.4860
epoch 8    train auc: 0.8883  acc: 0.7539    eval auc: 0.7836  acc: 0.7285    test auc: 0.7872  acc: 0.7375, time: 0.4880
epoch 9    train auc: 0.8920  acc: 0.7624    eval auc: 0.7881  acc: 0.7328    test auc: 0.7914  acc: 0.7438, time: 0.5150
epoch 10    train auc: 0.8945  acc: 0.7716    eval auc: 0.7914  acc: 0.7445    test auc: 0.7942  acc: 0.7499, time: 0.4850
epoch 11    train auc: 0.8964  acc: 0.7794    eval auc: 0.7935  acc: 0.7486    test auc: 0.7961  acc: 0.7552, time: 0.4890
epoch 12    train auc: 0.8978  acc: 0.7848    eval auc: 0.7948  acc: 0.7506    test auc: 0.7973  acc: 0.7559, time: 0.4940
epoch 13    train auc: 0.8992  acc: 0.7881    eval auc: 0.7959  acc: 0.7518    test auc: 0.7981  acc: 0.7558, time: 0.4970
epoch 14    train auc: 0.9007  acc: 0.7908    eval auc: 0.7967  acc: 0.7507    test auc: 0.7986  acc: 0.7561, time: 0.5010
epoch 15    train auc: 0.9017  acc: 0.7930    eval auc: 0.7972  acc: 0.7513    test auc: 0.7991  acc: 0.7549, time: 0.4780
epoch 16    train auc: 0.9026  acc: 0.7951    eval auc: 0.7978  acc: 0.7507    test auc: 0.7996  acc: 0.7536, time: 0.4800
epoch 17    train auc: 0.9034  acc: 0.7972    eval auc: 0.7982  acc: 0.7490    test auc: 0.8000  acc: 0.7493, time: 0.4740
epoch 18    train auc: 0.9040  acc: 0.7987    eval auc: 0.7984  acc: 0.7483    test auc: 0.8003  acc: 0.7459, time: 0.4970
epoch 19    train auc: 0.9048  acc: 0.7986    eval auc: 0.7987  acc: 0.7468    test auc: 0.8004  acc: 0.7448, time: 0.5000
epoch 20    train auc: 0.9053  acc: 0.8016    eval auc: 0.7989  acc: 0.7457    test auc: 0.8006  acc: 0.7421, time: 0.4980
epoch 21    train auc: 0.9058  acc: 0.8028    eval auc: 0.7991  acc: 0.7453    test auc: 0.8007  acc: 0.7396, time: 0.4740
epoch 22    train auc: 0.9064  acc: 0.8028    eval auc: 0.7992  acc: 0.7455    test auc: 0.8008  acc: 0.7374, time: 0.4970
epoch 23    train auc: 0.9066  acc: 0.8034    eval auc: 0.7993  acc: 0.7424    test auc: 0.8009  acc: 0.7348, time: 0.4820
epoch 24    train auc: 0.9073  acc: 0.8034    eval auc: 0.7995  acc: 0.7431    test auc: 0.8009  acc: 0.7350, time: 0.4800
epoch 25    train auc: 0.9078  acc: 0.8033    eval auc: 0.7996  acc: 0.7426    test auc: 0.8009  acc: 0.7348, time: 0.4760
epoch 26    train auc: 0.9081  acc: 0.8045    eval auc: 0.7995  acc: 0.7399    test auc: 0.8009  acc: 0.7322, time: 0.5100
epoch 27    train auc: 0.9084  acc: 0.8055    eval auc: 0.7995  acc: 0.7398    test auc: 0.8009  acc: 0.7321, time: 0.4850
epoch 28    train auc: 0.9087  acc: 0.8048    eval auc: 0.7995  acc: 0.7390    test auc: 0.8008  acc: 0.7318, time: 0.5200
epoch 29    train auc: 0.9091  acc: 0.8042    eval auc: 0.7995  acc: 0.7388    test auc: 0.8007  acc: 0.7320, time: 0.5381
epoch 30    train auc: 0.9093  acc: 0.8056    eval auc: 0.7994  acc: 0.7388    test auc: 0.8007  acc: 0.7308, time: 0.5610
epoch 31    train auc: 0.9097  acc: 0.8057    eval auc: 0.7994  acc: 0.7387    test auc: 0.8006  acc: 0.7304, time: 0.5300
epoch 32    train auc: 0.9100  acc: 0.8057    eval auc: 0.7992  acc: 0.7376    test auc: 0.8005  acc: 0.7302, time: 0.5320
epoch 33    train auc: 0.9101  acc: 0.8069    eval auc: 0.7990  acc: 0.7373    test auc: 0.8004  acc: 0.7292, time: 0.5290
epoch 34    train auc: 0.9104  acc: 0.8069    eval auc: 0.7989  acc: 0.7373    test auc: 0.8002  acc: 0.7295, time: 0.5460
epoch 35    train auc: 0.9106  acc: 0.8074    eval auc: 0.7987  acc: 0.7374    test auc: 0.8001  acc: 0.7279, time: 0.5240
epoch 36    train auc: 0.9108  acc: 0.8074    eval auc: 0.7986  acc: 0.7357    test auc: 0.7999  acc: 0.7271, time: 0.5200
epoch 37    train auc: 0.9110  acc: 0.8077    eval auc: 0.7985  acc: 0.7367    test auc: 0.7998  acc: 0.7270, time: 0.5250
epoch 38    train auc: 0.9115  acc: 0.8075    eval auc: 0.7984  acc: 0.7376    test auc: 0.7995  acc: 0.7282, time: 0.5360
epoch 39    train auc: 0.9117  acc: 0.8082    eval auc: 0.7982  acc: 0.7373    test auc: 0.7994  acc: 0.7290, time: 0.5190
epoch 40    train auc: 0.9119  acc: 0.8083    eval auc: 0.7981  acc: 0.7362    test auc: 0.7991  acc: 0.7268, time: 0.5280
epoch 41    train auc: 0.9122  acc: 0.8082    eval auc: 0.7979  acc: 0.7354    test auc: 0.7990  acc: 0.7267, time: 0.5240
epoch 42    train auc: 0.9123  acc: 0.8094    eval auc: 0.7977  acc: 0.7337    test auc: 0.7989  acc: 0.7244, time: 0.5370
epoch 43    train auc: 0.9123  acc: 0.8092    eval auc: 0.7974  acc: 0.7333    test auc: 0.7987  acc: 0.7225, time: 0.5140
epoch 44    train auc: 0.9128  acc: 0.8093    eval auc: 0.7973  acc: 0.7335    test auc: 0.7985  acc: 0.7238, time: 0.5250
epoch 45    train auc: 0.9131  acc: 0.8092    eval auc: 0.7972  acc: 0.7337    test auc: 0.7983  acc: 0.7233, time: 0.5280
epoch 46    train auc: 0.9132  acc: 0.8092    eval auc: 0.7970  acc: 0.7324    test auc: 0.7981  acc: 0.7225, time: 0.5270
epoch 47    train auc: 0.9133  acc: 0.8098    eval auc: 0.7967  acc: 0.7313    test auc: 0.7979  acc: 0.7215, time: 0.5189
epoch 48    train auc: 0.9137  acc: 0.8093    eval auc: 0.7966  acc: 0.7318    test auc: 0.7977  acc: 0.7211, time: 0.5240
epoch 49    train auc: 0.9142  acc: 0.8096    eval auc: 0.7963  acc: 0.7323    test auc: 0.7973  acc: 0.7215, time: 0.5220
avg time per epoch : 0.5154947662353515
--- 31.654121160507202 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:30:39.013395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:30:39.013730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4938  acc: 0.4983    eval auc: 0.5251  acc: 0.5037    test auc: 0.5232  acc: 0.5037, time: 0.8260
epoch 1    train auc: 0.7931  acc: 0.6535    eval auc: 0.7062  acc: 0.6374    test auc: 0.7200  acc: 0.6543, time: 0.5260
epoch 2    train auc: 0.8854  acc: 0.7545    eval auc: 0.7857  acc: 0.7308    test auc: 0.7881  acc: 0.7387, time: 0.5420
epoch 3    train auc: 0.8983  acc: 0.7789    eval auc: 0.7955  acc: 0.7459    test auc: 0.7966  acc: 0.7539, time: 0.5220
epoch 4    train auc: 0.9048  acc: 0.7914    eval auc: 0.7981  acc: 0.7480    test auc: 0.7984  acc: 0.7522, time: 0.5350
epoch 5    train auc: 0.9105  acc: 0.8007    eval auc: 0.7966  acc: 0.7385    test auc: 0.7961  acc: 0.7349, time: 0.5270
epoch 6    train auc: 0.9166  acc: 0.8131    eval auc: 0.7930  acc: 0.7272    test auc: 0.7918  acc: 0.7181, time: 0.5310
epoch 7    train auc: 0.9212  acc: 0.8164    eval auc: 0.7891  acc: 0.7230    test auc: 0.7875  acc: 0.7148, time: 0.5190
epoch 8    train auc: 0.9258  acc: 0.8221    eval auc: 0.7840  acc: 0.7121    test auc: 0.7824  acc: 0.7058, time: 0.5240
epoch 9    train auc: 0.9283  acc: 0.8234    eval auc: 0.7820  acc: 0.7101    test auc: 0.7796  acc: 0.7061, time: 0.5280
epoch 10    train auc: 0.9301  acc: 0.8249    eval auc: 0.7802  acc: 0.7112    test auc: 0.7777  acc: 0.7065, time: 0.5429
epoch 11    train auc: 0.9322  acc: 0.8283    eval auc: 0.7776  acc: 0.7049    test auc: 0.7754  acc: 0.7014, time: 0.5233
epoch 12    train auc: 0.9336  acc: 0.8309    eval auc: 0.7745  acc: 0.7030    test auc: 0.7724  acc: 0.6985, time: 0.5300
epoch 13    train auc: 0.9349  acc: 0.8320    eval auc: 0.7749  acc: 0.7024    test auc: 0.7729  acc: 0.7004, time: 0.5170
epoch 14    train auc: 0.9361  acc: 0.8339    eval auc: 0.7720  acc: 0.6988    test auc: 0.7707  acc: 0.6949, time: 0.5390
epoch 15    train auc: 0.9369  acc: 0.8344    eval auc: 0.7723  acc: 0.7009    test auc: 0.7712  acc: 0.6981, time: 0.5119
epoch 16    train auc: 0.9379  acc: 0.8358    eval auc: 0.7703  acc: 0.7002    test auc: 0.7691  acc: 0.6962, time: 0.5270
epoch 17    train auc: 0.9381  acc: 0.8354    eval auc: 0.7707  acc: 0.7011    test auc: 0.7691  acc: 0.6988, time: 0.5310
epoch 18    train auc: 0.9386  acc: 0.8363    eval auc: 0.7702  acc: 0.7001    test auc: 0.7687  acc: 0.6987, time: 0.5410
epoch 19    train auc: 0.9396  acc: 0.8369    eval auc: 0.7694  acc: 0.6995    test auc: 0.7678  acc: 0.6965, time: 0.5249
epoch 20    train auc: 0.9405  acc: 0.8387    eval auc: 0.7644  acc: 0.6932    test auc: 0.7635  acc: 0.6889, time: 0.5300
epoch 21    train auc: 0.9408  acc: 0.8383    eval auc: 0.7668  acc: 0.6972    test auc: 0.7658  acc: 0.6952, time: 0.5250
epoch 22    train auc: 0.9422  acc: 0.8409    eval auc: 0.7645  acc: 0.6959    test auc: 0.7634  acc: 0.6917, time: 0.5400
epoch 23    train auc: 0.9428  acc: 0.8417    eval auc: 0.7630  acc: 0.6938    test auc: 0.7620  acc: 0.6911, time: 0.5160
epoch 24    train auc: 0.9436  acc: 0.8437    eval auc: 0.7608  acc: 0.6913    test auc: 0.7598  acc: 0.6887, time: 0.5320
epoch 25    train auc: 0.9441  acc: 0.8438    eval auc: 0.7599  acc: 0.6896    test auc: 0.7595  acc: 0.6895, time: 0.5250
epoch 26    train auc: 0.9447  acc: 0.8449    eval auc: 0.7582  acc: 0.6876    test auc: 0.7581  acc: 0.6877, time: 0.5320
epoch 27    train auc: 0.9449  acc: 0.8449    eval auc: 0.7594  acc: 0.6902    test auc: 0.7590  acc: 0.6897, time: 0.5180
epoch 28    train auc: 0.9453  acc: 0.8449    eval auc: 0.7578  acc: 0.6880    test auc: 0.7574  acc: 0.6864, time: 0.5320
epoch 29    train auc: 0.9460  acc: 0.8458    eval auc: 0.7571  acc: 0.6891    test auc: 0.7566  acc: 0.6866, time: 0.5220
epoch 30    train auc: 0.9464  acc: 0.8466    eval auc: 0.7568  acc: 0.6883    test auc: 0.7563  acc: 0.6878, time: 0.5150
epoch 31    train auc: 0.9470  acc: 0.8476    eval auc: 0.7549  acc: 0.6854    test auc: 0.7548  acc: 0.6865, time: 0.5140
epoch 32    train auc: 0.9473  acc: 0.8479    eval auc: 0.7541  acc: 0.6844    test auc: 0.7547  acc: 0.6870, time: 0.5220
epoch 33    train auc: 0.9476  acc: 0.8482    eval auc: 0.7538  acc: 0.6840    test auc: 0.7545  acc: 0.6859, time: 0.5250
epoch 34    train auc: 0.9477  acc: 0.8483    eval auc: 0.7525  acc: 0.6817    test auc: 0.7527  acc: 0.6845, time: 0.5310
epoch 35    train auc: 0.9489  acc: 0.8503    eval auc: 0.7509  acc: 0.6802    test auc: 0.7517  acc: 0.6836, time: 0.5300
epoch 36    train auc: 0.9492  acc: 0.8509    eval auc: 0.7518  acc: 0.6810    test auc: 0.7523  acc: 0.6838, time: 0.5270
epoch 37    train auc: 0.9494  acc: 0.8513    eval auc: 0.7494  acc: 0.6804    test auc: 0.7497  acc: 0.6810, time: 0.5280
epoch 38    train auc: 0.9494  acc: 0.8511    eval auc: 0.7510  acc: 0.6802    test auc: 0.7519  acc: 0.6828, time: 0.5220
epoch 39    train auc: 0.9503  acc: 0.8525    eval auc: 0.7485  acc: 0.6797    test auc: 0.7494  acc: 0.6806, time: 0.5160
epoch 40    train auc: 0.9502  acc: 0.8518    eval auc: 0.7494  acc: 0.6799    test auc: 0.7499  acc: 0.6813, time: 0.5196
epoch 41    train auc: 0.9504  acc: 0.8518    eval auc: 0.7497  acc: 0.6782    test auc: 0.7507  acc: 0.6833, time: 0.5210
epoch 42    train auc: 0.9514  acc: 0.8539    eval auc: 0.7472  acc: 0.6775    test auc: 0.7479  acc: 0.6804, time: 0.5160
epoch 43    train auc: 0.9513  acc: 0.8531    eval auc: 0.7469  acc: 0.6767    test auc: 0.7477  acc: 0.6799, time: 0.5260
epoch 44    train auc: 0.9518  acc: 0.8547    eval auc: 0.7468  acc: 0.6775    test auc: 0.7476  acc: 0.6799, time: 0.5220
epoch 45    train auc: 0.9517  acc: 0.8535    eval auc: 0.7473  acc: 0.6780    test auc: 0.7477  acc: 0.6807, time: 0.5229
epoch 46    train auc: 0.9514  acc: 0.8529    eval auc: 0.7472  acc: 0.6772    test auc: 0.7480  acc: 0.6810, time: 0.5304
epoch 47    train auc: 0.9527  acc: 0.8551    eval auc: 0.7450  acc: 0.6761    test auc: 0.7460  acc: 0.6806, time: 0.5340
epoch 48    train auc: 0.9530  acc: 0.8549    eval auc: 0.7452  acc: 0.6778    test auc: 0.7460  acc: 0.6801, time: 0.5150
epoch 49    train auc: 0.9531  acc: 0.8546    eval auc: 0.7447  acc: 0.6766    test auc: 0.7457  acc: 0.6798, time: 0.5290
avg time per epoch : 0.5321111631393433
--- 32.63230586051941 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:31:11.738529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:31:11.738867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5115  acc: 0.5086    eval auc: 0.4779  acc: 0.4870    test auc: 0.4873  acc: 0.4872, time: 0.8430
epoch 1    train auc: 0.5224  acc: 0.5139    eval auc: 0.4618  acc: 0.4792    test auc: 0.4711  acc: 0.4793, time: 0.5150
epoch 2    train auc: 0.5352  acc: 0.5202    eval auc: 0.4505  acc: 0.4701    test auc: 0.4591  acc: 0.4785, time: 0.5260
epoch 3    train auc: 0.5547  acc: 0.5362    eval auc: 0.4354  acc: 0.4526    test auc: 0.4413  acc: 0.4614, time: 0.5110
epoch 4    train auc: 0.5730  acc: 0.5481    eval auc: 0.4266  acc: 0.4431    test auc: 0.4300  acc: 0.4544, time: 0.5150
epoch 5    train auc: 0.6037  acc: 0.5688    eval auc: 0.4322  acc: 0.4474    test auc: 0.4360  acc: 0.4548, time: 0.5240
epoch 6    train auc: 0.6692  acc: 0.6191    eval auc: 0.4886  acc: 0.4937    test auc: 0.4953  acc: 0.4952, time: 0.5250
epoch 7    train auc: 0.7478  acc: 0.6839    eval auc: 0.5852  acc: 0.5704    test auc: 0.5980  acc: 0.5782, time: 0.5099
epoch 8    train auc: 0.8138  acc: 0.7272    eval auc: 0.6630  acc: 0.6545    test auc: 0.6752  acc: 0.6610, time: 0.5190
epoch 9    train auc: 0.8539  acc: 0.7530    eval auc: 0.7109  acc: 0.6928    test auc: 0.7206  acc: 0.7009, time: 0.5040
epoch 10    train auc: 0.8726  acc: 0.7688    eval auc: 0.7366  acc: 0.7137    test auc: 0.7443  acc: 0.7197, time: 0.5170
epoch 11    train auc: 0.8816  acc: 0.7804    eval auc: 0.7492  acc: 0.7236    test auc: 0.7557  acc: 0.7269, time: 0.5070
epoch 12    train auc: 0.8872  acc: 0.7880    eval auc: 0.7553  acc: 0.7294    test auc: 0.7612  acc: 0.7277, time: 0.5140
epoch 13    train auc: 0.8912  acc: 0.7946    eval auc: 0.7582  acc: 0.7259    test auc: 0.7636  acc: 0.7255, time: 0.5040
epoch 14    train auc: 0.8950  acc: 0.7939    eval auc: 0.7605  acc: 0.7318    test auc: 0.7655  acc: 0.7303, time: 0.5150
epoch 15    train auc: 0.8980  acc: 0.8007    eval auc: 0.7609  acc: 0.7243    test auc: 0.7656  acc: 0.7236, time: 0.5030
epoch 16    train auc: 0.9010  acc: 0.8025    eval auc: 0.7619  acc: 0.7235    test auc: 0.7660  acc: 0.7248, time: 0.5010
epoch 17    train auc: 0.9036  acc: 0.8073    eval auc: 0.7625  acc: 0.7210    test auc: 0.7661  acc: 0.7190, time: 0.4940
epoch 18    train auc: 0.9059  acc: 0.8113    eval auc: 0.7627  acc: 0.7191    test auc: 0.7658  acc: 0.7165, time: 0.5190
epoch 19    train auc: 0.9083  acc: 0.8122    eval auc: 0.7634  acc: 0.7196    test auc: 0.7659  acc: 0.7168, time: 0.4890
epoch 20    train auc: 0.9103  acc: 0.8154    eval auc: 0.7634  acc: 0.7173    test auc: 0.7655  acc: 0.7147, time: 0.5190
epoch 21    train auc: 0.9122  acc: 0.8181    eval auc: 0.7645  acc: 0.7176    test auc: 0.7661  acc: 0.7147, time: 0.5520
epoch 22    train auc: 0.9140  acc: 0.8169    eval auc: 0.7654  acc: 0.7199    test auc: 0.7665  acc: 0.7154, time: 0.5020
epoch 23    train auc: 0.9155  acc: 0.8217    eval auc: 0.7649  acc: 0.7152    test auc: 0.7659  acc: 0.7106, time: 0.5000
epoch 24    train auc: 0.9172  acc: 0.8201    eval auc: 0.7665  acc: 0.7196    test auc: 0.7670  acc: 0.7150, time: 0.4990
epoch 25    train auc: 0.9185  acc: 0.8224    eval auc: 0.7667  acc: 0.7178    test auc: 0.7670  acc: 0.7138, time: 0.4940
epoch 26    train auc: 0.9197  acc: 0.8252    eval auc: 0.7663  acc: 0.7146    test auc: 0.7664  acc: 0.7101, time: 0.4900
epoch 27    train auc: 0.9208  acc: 0.8269    eval auc: 0.7659  acc: 0.7125    test auc: 0.7657  acc: 0.7073, time: 0.4890
epoch 28    train auc: 0.9220  acc: 0.8264    eval auc: 0.7667  acc: 0.7144    test auc: 0.7663  acc: 0.7093, time: 0.4910
epoch 29    train auc: 0.9230  acc: 0.8264    eval auc: 0.7677  acc: 0.7167    test auc: 0.7672  acc: 0.7119, time: 0.4940
epoch 30    train auc: 0.9239  acc: 0.8288    eval auc: 0.7669  acc: 0.7118    test auc: 0.7665  acc: 0.7079, time: 0.4920
epoch 31    train auc: 0.9249  acc: 0.8282    eval auc: 0.7677  acc: 0.7143    test auc: 0.7670  acc: 0.7088, time: 0.5020
epoch 32    train auc: 0.9257  acc: 0.8288    eval auc: 0.7676  acc: 0.7143    test auc: 0.7668  acc: 0.7083, time: 0.4820
epoch 33    train auc: 0.9265  acc: 0.8291    eval auc: 0.7676  acc: 0.7126    test auc: 0.7669  acc: 0.7070, time: 0.4870
epoch 34    train auc: 0.9272  acc: 0.8299    eval auc: 0.7676  acc: 0.7118    test auc: 0.7668  acc: 0.7070, time: 0.4870
epoch 35    train auc: 0.9279  acc: 0.8317    eval auc: 0.7663  acc: 0.7060    test auc: 0.7656  acc: 0.7050, time: 0.5069
epoch 36    train auc: 0.9286  acc: 0.8323    eval auc: 0.7666  acc: 0.7054    test auc: 0.7659  acc: 0.7054, time: 0.4900
epoch 37    train auc: 0.9293  acc: 0.8328    eval auc: 0.7665  acc: 0.7058    test auc: 0.7656  acc: 0.7053, time: 0.4820
epoch 38    train auc: 0.9299  acc: 0.8326    eval auc: 0.7669  acc: 0.7068    test auc: 0.7659  acc: 0.7065, time: 0.4930
epoch 39    train auc: 0.9304  acc: 0.8331    eval auc: 0.7666  acc: 0.7065    test auc: 0.7658  acc: 0.7062, time: 0.4879
epoch 40    train auc: 0.9310  acc: 0.8331    eval auc: 0.7668  acc: 0.7083    test auc: 0.7659  acc: 0.7067, time: 0.4740
epoch 41    train auc: 0.9315  acc: 0.8334    eval auc: 0.7667  acc: 0.7068    test auc: 0.7659  acc: 0.7072, time: 0.4780
epoch 42    train auc: 0.9321  acc: 0.8353    eval auc: 0.7648  acc: 0.7022    test auc: 0.7642  acc: 0.7022, time: 0.4810
epoch 43    train auc: 0.9325  acc: 0.8358    eval auc: 0.7644  acc: 0.7014    test auc: 0.7639  acc: 0.7016, time: 0.4860
epoch 44    train auc: 0.9330  acc: 0.8352    eval auc: 0.7655  acc: 0.7035    test auc: 0.7649  acc: 0.7061, time: 0.4720
epoch 45    train auc: 0.9335  acc: 0.8351    eval auc: 0.7655  acc: 0.7039    test auc: 0.7649  acc: 0.7061, time: 0.4820
epoch 46    train auc: 0.9340  acc: 0.8371    eval auc: 0.7643  acc: 0.7019    test auc: 0.7638  acc: 0.7033, time: 0.4770
epoch 47    train auc: 0.9344  acc: 0.8372    eval auc: 0.7644  acc: 0.7009    test auc: 0.7639  acc: 0.7033, time: 0.4860
epoch 48    train auc: 0.9348  acc: 0.8372    eval auc: 0.7641  acc: 0.7009    test auc: 0.7636  acc: 0.7026, time: 0.4790
epoch 49    train auc: 0.9349  acc: 0.8362    eval auc: 0.7651  acc: 0.7047    test auc: 0.7646  acc: 0.7060, time: 0.4710
avg time per epoch : 0.5056104850769043
--- 31.15700125694275 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:31:42.803903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:31:42.804258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5055  acc: 0.5035    eval auc: 0.4902  acc: 0.4923    test auc: 0.4938  acc: 0.4960, time: 0.8110
epoch 1    train auc: 0.4845  acc: 0.4943    eval auc: 0.5148  acc: 0.5037    test auc: 0.5313  acc: 0.5134, time: 0.3190
epoch 2    train auc: 0.5529  acc: 0.5335    eval auc: 0.4253  acc: 0.4515    test auc: 0.4172  acc: 0.4479, time: 0.4880
epoch 3    train auc: 0.5721  acc: 0.5509    eval auc: 0.3999  acc: 0.4233    test auc: 0.3918  acc: 0.4263, time: 0.3040
epoch 4    train auc: 0.5955  acc: 0.5577    eval auc: 0.3970  acc: 0.4237    test auc: 0.3877  acc: 0.4179, time: 0.4819
epoch 5    train auc: 0.8165  acc: 0.7229    eval auc: 0.6900  acc: 0.6540    test auc: 0.6952  acc: 0.6602, time: 0.2900
epoch 6    train auc: 0.8739  acc: 0.7769    eval auc: 0.7578  acc: 0.6939    test auc: 0.7585  acc: 0.6869, time: 0.4690
epoch 7    train auc: 0.8928  acc: 0.7927    eval auc: 0.7722  acc: 0.7023    test auc: 0.7718  acc: 0.6944, time: 0.2900
epoch 8    train auc: 0.9032  acc: 0.8008    eval auc: 0.7795  acc: 0.7066    test auc: 0.7794  acc: 0.6956, time: 0.4810
epoch 9    train auc: 0.9104  acc: 0.8051    eval auc: 0.7790  acc: 0.7068    test auc: 0.7774  acc: 0.6950, time: 0.2900
epoch 10    train auc: 0.9146  acc: 0.8116    eval auc: 0.7811  acc: 0.6937    test auc: 0.7810  acc: 0.6876, time: 0.4730
epoch 11    train auc: 0.9208  acc: 0.8146    eval auc: 0.7795  acc: 0.7068    test auc: 0.7776  acc: 0.6975, time: 0.2950
epoch 12    train auc: 0.9232  acc: 0.8172    eval auc: 0.7805  acc: 0.7035    test auc: 0.7791  acc: 0.6977, time: 0.4810
epoch 13    train auc: 0.9295  acc: 0.8265    eval auc: 0.7730  acc: 0.6958    test auc: 0.7700  acc: 0.6897, time: 0.3080
epoch 14    train auc: 0.9319  acc: 0.8290    eval auc: 0.7750  acc: 0.6951    test auc: 0.7733  acc: 0.6898, time: 0.4700
epoch 15    train auc: 0.9362  acc: 0.8346    eval auc: 0.7687  acc: 0.6925    test auc: 0.7655  acc: 0.6896, time: 0.2940
epoch 16    train auc: 0.9392  acc: 0.8375    eval auc: 0.7689  acc: 0.6913    test auc: 0.7672  acc: 0.6844, time: 0.4700
epoch 17    train auc: 0.9426  acc: 0.8441    eval auc: 0.7650  acc: 0.6908    test auc: 0.7624  acc: 0.6845, time: 0.2850
epoch 18    train auc: 0.9454  acc: 0.8456    eval auc: 0.7641  acc: 0.6898    test auc: 0.7631  acc: 0.6856, time: 0.4740
epoch 19    train auc: 0.9480  acc: 0.8486    eval auc: 0.7606  acc: 0.6867    test auc: 0.7599  acc: 0.6819, time: 0.2930
epoch 20    train auc: 0.9512  acc: 0.8516    eval auc: 0.7551  acc: 0.6821    test auc: 0.7548  acc: 0.6775, time: 0.4810
epoch 21    train auc: 0.9533  acc: 0.8565    eval auc: 0.7543  acc: 0.6863    test auc: 0.7529  acc: 0.6805, time: 0.2880
epoch 22    train auc: 0.9561  acc: 0.8597    eval auc: 0.7517  acc: 0.6834    test auc: 0.7513  acc: 0.6779, time: 0.4740
epoch 23    train auc: 0.9582  acc: 0.8629    eval auc: 0.7523  acc: 0.6853    test auc: 0.7514  acc: 0.6820, time: 0.3060
epoch 24    train auc: 0.9605  acc: 0.8666    eval auc: 0.7484  acc: 0.6840    test auc: 0.7483  acc: 0.6807, time: 0.4670
epoch 25    train auc: 0.9621  acc: 0.8696    eval auc: 0.7498  acc: 0.6871    test auc: 0.7484  acc: 0.6824, time: 0.3000
epoch 26    train auc: 0.9643  acc: 0.8731    eval auc: 0.7447  acc: 0.6851    test auc: 0.7437  acc: 0.6813, time: 0.4770
epoch 27    train auc: 0.9660  acc: 0.8764    eval auc: 0.7454  acc: 0.6876    test auc: 0.7435  acc: 0.6833, time: 0.3010
epoch 28    train auc: 0.9675  acc: 0.8796    eval auc: 0.7439  acc: 0.6859    test auc: 0.7415  acc: 0.6808, time: 0.4849
epoch 29    train auc: 0.9686  acc: 0.8801    eval auc: 0.7434  acc: 0.6870    test auc: 0.7399  acc: 0.6825, time: 0.3100
epoch 30    train auc: 0.9701  acc: 0.8834    eval auc: 0.7400  acc: 0.6849    test auc: 0.7367  acc: 0.6805, time: 0.4760
epoch 31    train auc: 0.9711  acc: 0.8846    eval auc: 0.7396  acc: 0.6878    test auc: 0.7362  acc: 0.6819, time: 0.3080
epoch 32    train auc: 0.9722  acc: 0.8888    eval auc: 0.7400  acc: 0.6891    test auc: 0.7367  acc: 0.6815, time: 0.5240
epoch 33    train auc: 0.9726  acc: 0.8870    eval auc: 0.7379  acc: 0.6882    test auc: 0.7339  acc: 0.6795, time: 0.3150
epoch 34    train auc: 0.9742  acc: 0.8927    eval auc: 0.7363  acc: 0.6877    test auc: 0.7331  acc: 0.6797, time: 0.5060
epoch 35    train auc: 0.9748  acc: 0.8921    eval auc: 0.7354  acc: 0.6867    test auc: 0.7319  acc: 0.6794, time: 0.3140
epoch 36    train auc: 0.9759  acc: 0.8968    eval auc: 0.7362  acc: 0.6897    test auc: 0.7332  acc: 0.6795, time: 0.4840
epoch 37    train auc: 0.9766  acc: 0.8972    eval auc: 0.7358  acc: 0.6871    test auc: 0.7324  acc: 0.6808, time: 0.3180
epoch 38    train auc: 0.9777  acc: 0.9002    eval auc: 0.7311  acc: 0.6839    test auc: 0.7277  acc: 0.6760, time: 0.4930
epoch 39    train auc: 0.9783  acc: 0.9024    eval auc: 0.7341  acc: 0.6865    test auc: 0.7311  acc: 0.6802, time: 0.3040
epoch 40    train auc: 0.9789  acc: 0.9042    eval auc: 0.7311  acc: 0.6847    test auc: 0.7286  acc: 0.6774, time: 0.5030
epoch 41    train auc: 0.9798  acc: 0.9056    eval auc: 0.7305  acc: 0.6836    test auc: 0.7274  acc: 0.6769, time: 0.3070
epoch 42    train auc: 0.9803  acc: 0.9081    eval auc: 0.7307  acc: 0.6837    test auc: 0.7283  acc: 0.6801, time: 0.5050
epoch 43    train auc: 0.9809  acc: 0.9081    eval auc: 0.7307  acc: 0.6841    test auc: 0.7281  acc: 0.6810, time: 0.3060
epoch 44    train auc: 0.9817  acc: 0.9127    eval auc: 0.7297  acc: 0.6824    test auc: 0.7277  acc: 0.6812, time: 0.4960
epoch 45    train auc: 0.9822  acc: 0.9126    eval auc: 0.7304  acc: 0.6820    test auc: 0.7280  acc: 0.6830, time: 0.2970
epoch 46    train auc: 0.9826  acc: 0.9138    eval auc: 0.7276  acc: 0.6821    test auc: 0.7262  acc: 0.6788, time: 0.4940
epoch 47    train auc: 0.9831  acc: 0.9147    eval auc: 0.7302  acc: 0.6843    test auc: 0.7282  acc: 0.6851, time: 0.3010
epoch 48    train auc: 0.9836  acc: 0.9163    eval auc: 0.7265  acc: 0.6828    test auc: 0.7249  acc: 0.6792, time: 0.4850
epoch 49    train auc: 0.9841  acc: 0.9177    eval auc: 0.7285  acc: 0.6845    test auc: 0.7264  acc: 0.6819, time: 0.3040
avg time per epoch : 0.39991286277771
--- 25.519001245498657 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:32:08.418405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:32:08.418743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5163  acc: 0.5063    eval auc: 0.5179  acc: 0.5097    test auc: 0.5185  acc: 0.5147, time: 0.8340
epoch 1    train auc: 0.5083  acc: 0.5065    eval auc: 0.4862  acc: 0.4897    test auc: 0.4935  acc: 0.4921, time: 0.3250
epoch 2    train auc: 0.5222  acc: 0.5137    eval auc: 0.5147  acc: 0.5090    test auc: 0.5156  acc: 0.5093, time: 0.5400
epoch 3    train auc: 0.5282  acc: 0.5182    eval auc: 0.4636  acc: 0.4806    test auc: 0.4571  acc: 0.4675, time: 0.3310
epoch 4    train auc: 0.5094  acc: 0.5111    eval auc: 0.5193  acc: 0.4991    test auc: 0.5122  acc: 0.4957, time: 0.5339
epoch 5    train auc: 0.5458  acc: 0.5282    eval auc: 0.4358  acc: 0.4605    test auc: 0.4303  acc: 0.4559, time: 0.3290
epoch 6    train auc: 0.5565  acc: 0.5360    eval auc: 0.4251  acc: 0.4511    test auc: 0.4198  acc: 0.4430, time: 0.5390
epoch 7    train auc: 0.5635  acc: 0.5441    eval auc: 0.4099  acc: 0.4370    test auc: 0.4027  acc: 0.4309, time: 0.3310
epoch 8    train auc: 0.5730  acc: 0.5512    eval auc: 0.3975  acc: 0.4292    test auc: 0.3885  acc: 0.4172, time: 0.5520
epoch 9    train auc: 0.5779  acc: 0.5549    eval auc: 0.3905  acc: 0.4253    test auc: 0.3817  acc: 0.4111, time: 0.3230
epoch 10    train auc: 0.5833  acc: 0.5585    eval auc: 0.3848  acc: 0.4194    test auc: 0.3765  acc: 0.4096, time: 0.5340
epoch 11    train auc: 0.5866  acc: 0.5596    eval auc: 0.3821  acc: 0.4186    test auc: 0.3734  acc: 0.4063, time: 0.3220
epoch 12    train auc: 0.5928  acc: 0.5624    eval auc: 0.3811  acc: 0.4175    test auc: 0.3729  acc: 0.4061, time: 0.5310
epoch 13    train auc: 0.5973  acc: 0.5646    eval auc: 0.3814  acc: 0.4166    test auc: 0.3732  acc: 0.4057, time: 0.3350
epoch 14    train auc: 0.6148  acc: 0.5723    eval auc: 0.3926  acc: 0.4233    test auc: 0.3848  acc: 0.4142, time: 0.5370
epoch 15    train auc: 0.6351  acc: 0.5850    eval auc: 0.4091  acc: 0.4320    test auc: 0.4017  acc: 0.4276, time: 0.3180
epoch 16    train auc: 0.6878  acc: 0.6154    eval auc: 0.4626  acc: 0.4751    test auc: 0.4589  acc: 0.4691, time: 0.5410
epoch 17    train auc: 0.7352  acc: 0.6577    eval auc: 0.5183  acc: 0.5246    test auc: 0.5177  acc: 0.5215, time: 0.3270
epoch 18    train auc: 0.7976  acc: 0.6982    eval auc: 0.6153  acc: 0.6043    test auc: 0.6193  acc: 0.6040, time: 0.5340
epoch 19    train auc: 0.8246  acc: 0.7230    eval auc: 0.6640  acc: 0.6289    test auc: 0.6686  acc: 0.6307, time: 0.3280
epoch 20    train auc: 0.8504  acc: 0.7407    eval auc: 0.7062  acc: 0.6814    test auc: 0.7104  acc: 0.6854, time: 0.5360
epoch 21    train auc: 0.8595  acc: 0.7592    eval auc: 0.7243  acc: 0.6776    test auc: 0.7276  acc: 0.6784, time: 0.3230
epoch 22    train auc: 0.8710  acc: 0.7639    eval auc: 0.7392  acc: 0.7034    test auc: 0.7415  acc: 0.7020, time: 0.5340
epoch 23    train auc: 0.8752  acc: 0.7750    eval auc: 0.7466  acc: 0.6932    test auc: 0.7487  acc: 0.6934, time: 0.3190
epoch 24    train auc: 0.8821  acc: 0.7744    eval auc: 0.7530  acc: 0.7107    test auc: 0.7547  acc: 0.7119, time: 0.5330
epoch 25    train auc: 0.8848  acc: 0.7838    eval auc: 0.7577  acc: 0.7011    test auc: 0.7596  acc: 0.7006, time: 0.3210
epoch 26    train auc: 0.8896  acc: 0.7848    eval auc: 0.7615  acc: 0.7098    test auc: 0.7629  acc: 0.7121, time: 0.5160
epoch 27    train auc: 0.8916  acc: 0.7894    eval auc: 0.7643  acc: 0.7045    test auc: 0.7657  acc: 0.7035, time: 0.3280
epoch 28    train auc: 0.8951  acc: 0.7925    eval auc: 0.7672  acc: 0.7085    test auc: 0.7682  acc: 0.7083, time: 0.5210
epoch 29    train auc: 0.8966  acc: 0.7938    eval auc: 0.7688  acc: 0.7042    test auc: 0.7698  acc: 0.7034, time: 0.3250
epoch 30    train auc: 0.8992  acc: 0.7960    eval auc: 0.7710  acc: 0.7075    test auc: 0.7716  acc: 0.7066, time: 0.5290
epoch 31    train auc: 0.9005  acc: 0.7990    eval auc: 0.7721  acc: 0.7052    test auc: 0.7727  acc: 0.7023, time: 0.3220
epoch 32    train auc: 0.9024  acc: 0.7988    eval auc: 0.7738  acc: 0.7104    test auc: 0.7742  acc: 0.7070, time: 0.5520
epoch 33    train auc: 0.9036  acc: 0.8025    eval auc: 0.7747  acc: 0.7068    test auc: 0.7750  acc: 0.7027, time: 0.3240
epoch 34    train auc: 0.9052  acc: 0.8015    eval auc: 0.7761  acc: 0.7109    test auc: 0.7762  acc: 0.7079, time: 0.5300
epoch 35    train auc: 0.9063  acc: 0.8049    eval auc: 0.7767  acc: 0.7091    test auc: 0.7769  acc: 0.7040, time: 0.3360
epoch 36    train auc: 0.9075  acc: 0.8033    eval auc: 0.7778  acc: 0.7140    test auc: 0.7779  acc: 0.7107, time: 0.5380
epoch 37    train auc: 0.9086  acc: 0.8071    eval auc: 0.7779  acc: 0.7093    test auc: 0.7779  acc: 0.7048, time: 0.3359
epoch 38    train auc: 0.9098  acc: 0.8070    eval auc: 0.7788  acc: 0.7119    test auc: 0.7786  acc: 0.7082, time: 0.5210
epoch 39    train auc: 0.9108  acc: 0.8094    eval auc: 0.7787  acc: 0.7081    test auc: 0.7786  acc: 0.7039, time: 0.3160
epoch 40    train auc: 0.9115  acc: 0.8073    eval auc: 0.7795  acc: 0.7131    test auc: 0.7792  acc: 0.7115, time: 0.5345
epoch 41    train auc: 0.9126  acc: 0.8103    eval auc: 0.7791  acc: 0.7088    test auc: 0.7787  acc: 0.7043, time: 0.3220
epoch 42    train auc: 0.9134  acc: 0.8097    eval auc: 0.7802  acc: 0.7118    test auc: 0.7796  acc: 0.7082, time: 0.5179
epoch 43    train auc: 0.9144  acc: 0.8112    eval auc: 0.7794  acc: 0.7088    test auc: 0.7787  acc: 0.7040, time: 0.3190
epoch 44    train auc: 0.9150  acc: 0.8109    eval auc: 0.7803  acc: 0.7127    test auc: 0.7794  acc: 0.7093, time: 0.5370
epoch 45    train auc: 0.9160  acc: 0.8133    eval auc: 0.7795  acc: 0.7089    test auc: 0.7787  acc: 0.7041, time: 0.3180
epoch 46    train auc: 0.9166  acc: 0.8132    eval auc: 0.7805  acc: 0.7120    test auc: 0.7794  acc: 0.7070, time: 0.5450
epoch 47    train auc: 0.9175  acc: 0.8148    eval auc: 0.7793  acc: 0.7089    test auc: 0.7782  acc: 0.7033, time: 0.3219
epoch 48    train auc: 0.9182  acc: 0.8151    eval auc: 0.7804  acc: 0.7098    test auc: 0.7791  acc: 0.7029, time: 0.5480
epoch 49    train auc: 0.9189  acc: 0.8172    eval auc: 0.7791  acc: 0.7083    test auc: 0.7778  acc: 0.7022, time: 0.3210
avg time per epoch : 0.4357743310928345
--- 27.899479866027832 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:32:36.387190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:32:36.387542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4989  acc: 0.5026    eval auc: 0.5048  acc: 0.4979    test auc: 0.4987  acc: 0.4943, time: 0.8290
epoch 1    train auc: 0.4828  acc: 0.4909    eval auc: 0.5225  acc: 0.5102    test auc: 0.5288  acc: 0.5172, time: 0.3260
epoch 2    train auc: 0.5408  acc: 0.5259    eval auc: 0.4402  acc: 0.4632    test auc: 0.4379  acc: 0.4590, time: 0.5260
epoch 3    train auc: 0.5685  acc: 0.5422    eval auc: 0.4001  acc: 0.4382    test auc: 0.3952  acc: 0.4351, time: 0.3340
epoch 4    train auc: 0.5827  acc: 0.5583    eval auc: 0.3805  acc: 0.4156    test auc: 0.3747  acc: 0.4095, time: 0.5170
epoch 5    train auc: 0.5889  acc: 0.5627    eval auc: 0.3710  acc: 0.4088    test auc: 0.3674  acc: 0.4032, time: 0.3220
epoch 6    train auc: 0.5917  acc: 0.5643    eval auc: 0.3677  acc: 0.4064    test auc: 0.3635  acc: 0.4008, time: 0.5250
epoch 7    train auc: 0.5933  acc: 0.5653    eval auc: 0.3665  acc: 0.4058    test auc: 0.3610  acc: 0.3984, time: 0.3280
epoch 8    train auc: 0.5944  acc: 0.5663    eval auc: 0.3653  acc: 0.4039    test auc: 0.3597  acc: 0.3971, time: 0.5470
epoch 9    train auc: 0.5950  acc: 0.5665    eval auc: 0.3648  acc: 0.4035    test auc: 0.3588  acc: 0.3970, time: 0.3210
epoch 10    train auc: 0.5955  acc: 0.5666    eval auc: 0.3643  acc: 0.4018    test auc: 0.3585  acc: 0.3984, time: 0.5370
epoch 11    train auc: 0.5958  acc: 0.5667    eval auc: 0.3641  acc: 0.4025    test auc: 0.3578  acc: 0.3974, time: 0.3260
epoch 12    train auc: 0.5961  acc: 0.5667    eval auc: 0.3639  acc: 0.4028    test auc: 0.3577  acc: 0.3971, time: 0.5470
epoch 13    train auc: 0.5963  acc: 0.5668    eval auc: 0.3638  acc: 0.4038    test auc: 0.3574  acc: 0.3958, time: 0.3290
epoch 14    train auc: 0.5964  acc: 0.5668    eval auc: 0.3637  acc: 0.4034    test auc: 0.3573  acc: 0.3962, time: 0.5270
epoch 15    train auc: 0.5966  acc: 0.5669    eval auc: 0.3636  acc: 0.4026    test auc: 0.3572  acc: 0.3967, time: 0.3180
epoch 16    train auc: 0.5967  acc: 0.5669    eval auc: 0.3635  acc: 0.4026    test auc: 0.3572  acc: 0.3967, time: 0.5260
epoch 17    train auc: 0.5967  acc: 0.5669    eval auc: 0.3633  acc: 0.4031    test auc: 0.3573  acc: 0.3963, time: 0.3330
epoch 18    train auc: 0.5968  acc: 0.5669    eval auc: 0.3636  acc: 0.4028    test auc: 0.3570  acc: 0.3966, time: 0.5290
epoch 19    train auc: 0.5969  acc: 0.5669    eval auc: 0.3635  acc: 0.4021    test auc: 0.3569  acc: 0.3973, time: 0.3300
epoch 20    train auc: 0.5969  acc: 0.5669    eval auc: 0.3634  acc: 0.4023    test auc: 0.3570  acc: 0.3971, time: 0.5360
epoch 21    train auc: 0.5970  acc: 0.5669    eval auc: 0.3637  acc: 0.4030    test auc: 0.3567  acc: 0.3964, time: 0.3210
epoch 22    train auc: 0.5970  acc: 0.5669    eval auc: 0.3637  acc: 0.4034    test auc: 0.3567  acc: 0.3960, time: 0.5490
epoch 23    train auc: 0.5970  acc: 0.5669    eval auc: 0.3637  acc: 0.4042    test auc: 0.3566  acc: 0.3952, time: 0.3300
epoch 24    train auc: 0.5971  acc: 0.5669    eval auc: 0.3638  acc: 0.4025    test auc: 0.3565  acc: 0.3969, time: 0.5350
epoch 25    train auc: 0.5971  acc: 0.5669    eval auc: 0.3637  acc: 0.4044    test auc: 0.3567  acc: 0.3950, time: 0.3310
epoch 26    train auc: 0.5971  acc: 0.5669    eval auc: 0.3636  acc: 0.4035    test auc: 0.3567  acc: 0.3959, time: 0.5280
epoch 27    train auc: 0.5971  acc: 0.5669    eval auc: 0.3636  acc: 0.4026    test auc: 0.3568  acc: 0.3967, time: 0.3280
epoch 28    train auc: 0.5971  acc: 0.5669    eval auc: 0.3635  acc: 0.4037    test auc: 0.3569  acc: 0.3957, time: 0.5410
epoch 29    train auc: 0.5971  acc: 0.5669    eval auc: 0.3634  acc: 0.4019    test auc: 0.3570  acc: 0.3974, time: 0.3290
epoch 30    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4041    test auc: 0.3567  acc: 0.3953, time: 0.5240
epoch 31    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4030    test auc: 0.3568  acc: 0.3964, time: 0.3210
epoch 32    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4035    test auc: 0.3568  acc: 0.3959, time: 0.5240
epoch 33    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4030    test auc: 0.3566  acc: 0.3964, time: 0.3220
epoch 34    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4026    test auc: 0.3568  acc: 0.3967, time: 0.5190
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4045    test auc: 0.3569  acc: 0.3949, time: 0.3140
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4049    test auc: 0.3566  acc: 0.3945, time: 0.5300
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4034    test auc: 0.3567  acc: 0.3960, time: 0.3080
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4022    test auc: 0.3568  acc: 0.3972, time: 0.5160
epoch 39    train auc: 0.5972  acc: 0.5669    eval auc: 0.3639  acc: 0.4038    test auc: 0.3567  acc: 0.3956, time: 0.3200
epoch 40    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4028    test auc: 0.3568  acc: 0.3966, time: 0.5300
epoch 41    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4047    test auc: 0.3567  acc: 0.3947, time: 0.3220
epoch 42    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4025    test auc: 0.3568  acc: 0.3969, time: 0.5060
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4031    test auc: 0.3569  acc: 0.3963, time: 0.3130
epoch 44    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4010    test auc: 0.3570  acc: 0.3984, time: 0.5190
epoch 45    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4038    test auc: 0.3570  acc: 0.3956, time: 0.3160
epoch 46    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4013    test auc: 0.3572  acc: 0.3980, time: 0.5260
epoch 47    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4032    test auc: 0.3570  acc: 0.3962, time: 0.3070
epoch 48    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4029    test auc: 0.3570  acc: 0.3965, time: 0.5050
epoch 49    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4000    test auc: 0.3572  acc: 0.3993, time: 0.3160
avg time per epoch : 0.43125338554382325
--- 27.627498626708984 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:33:03.942409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:33:03.942722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5082  acc: 0.5030    eval auc: 0.4917  acc: 0.4999    test auc: 0.4934  acc: 0.4951, time: 0.9260
epoch 1    train auc: 0.5228  acc: 0.5025    eval auc: 0.4720  acc: 0.4970    test auc: 0.4761  acc: 0.4955, time: 0.3250
epoch 2    train auc: 0.5355  acc: 0.5051    eval auc: 0.4555  acc: 0.4924    test auc: 0.4573  acc: 0.4905, time: 0.5030
epoch 3    train auc: 0.5498  acc: 0.5079    eval auc: 0.4419  acc: 0.4896    test auc: 0.4374  acc: 0.4867, time: 0.3060
epoch 4    train auc: 0.5677  acc: 0.5077    eval auc: 0.4328  acc: 0.4917    test auc: 0.4272  acc: 0.4845, time: 0.4940
epoch 5    train auc: 0.5898  acc: 0.5050    eval auc: 0.4381  acc: 0.4971    test auc: 0.4329  acc: 0.4886, time: 0.2990
epoch 6    train auc: 0.6733  acc: 0.5329    eval auc: 0.5215  acc: 0.5254    test auc: 0.5275  acc: 0.5214, time: 0.4820
epoch 7    train auc: 0.7710  acc: 0.6158    eval auc: 0.6391  acc: 0.6015    test auc: 0.6518  acc: 0.6127, time: 0.3000
epoch 8    train auc: 0.8390  acc: 0.6844    eval auc: 0.7132  acc: 0.6661    test auc: 0.7212  acc: 0.6843, time: 0.4869
epoch 9    train auc: 0.8705  acc: 0.7213    eval auc: 0.7500  acc: 0.7032    test auc: 0.7555  acc: 0.7138, time: 0.2930
epoch 10    train auc: 0.8840  acc: 0.7465    eval auc: 0.7697  acc: 0.7198    test auc: 0.7742  acc: 0.7314, time: 0.4830
epoch 11    train auc: 0.8897  acc: 0.7556    eval auc: 0.7776  acc: 0.7276    test auc: 0.7809  acc: 0.7392, time: 0.2960
epoch 12    train auc: 0.8937  acc: 0.7699    eval auc: 0.7823  acc: 0.7400    test auc: 0.7854  acc: 0.7467, time: 0.4920
epoch 13    train auc: 0.8964  acc: 0.7802    eval auc: 0.7848  acc: 0.7467    test auc: 0.7879  acc: 0.7552, time: 0.2909
epoch 14    train auc: 0.8989  acc: 0.7842    eval auc: 0.7865  acc: 0.7473    test auc: 0.7894  acc: 0.7517, time: 0.4820
epoch 15    train auc: 0.9011  acc: 0.7898    eval auc: 0.7876  acc: 0.7478    test auc: 0.7903  acc: 0.7478, time: 0.2920
epoch 16    train auc: 0.9032  acc: 0.7938    eval auc: 0.7883  acc: 0.7453    test auc: 0.7907  acc: 0.7448, time: 0.4870
epoch 17    train auc: 0.9051  acc: 0.7975    eval auc: 0.7886  acc: 0.7431    test auc: 0.7908  acc: 0.7398, time: 0.3070
epoch 18    train auc: 0.9068  acc: 0.8016    eval auc: 0.7887  acc: 0.7388    test auc: 0.7906  acc: 0.7331, time: 0.4789
epoch 19    train auc: 0.9084  acc: 0.8046    eval auc: 0.7886  acc: 0.7348    test auc: 0.7901  acc: 0.7304, time: 0.2910
epoch 20    train auc: 0.9104  acc: 0.8095    eval auc: 0.7881  acc: 0.7307    test auc: 0.7895  acc: 0.7245, time: 0.4810
epoch 21    train auc: 0.9121  acc: 0.8114    eval auc: 0.7876  acc: 0.7277    test auc: 0.7888  acc: 0.7211, time: 0.2910
epoch 22    train auc: 0.9137  acc: 0.8134    eval auc: 0.7872  acc: 0.7256    test auc: 0.7880  acc: 0.7178, time: 0.4940
epoch 23    train auc: 0.9153  acc: 0.8156    eval auc: 0.7863  acc: 0.7210    test auc: 0.7870  acc: 0.7150, time: 0.2860
epoch 24    train auc: 0.9167  acc: 0.8158    eval auc: 0.7857  acc: 0.7222    test auc: 0.7861  acc: 0.7154, time: 0.4840
epoch 25    train auc: 0.9182  acc: 0.8184    eval auc: 0.7848  acc: 0.7197    test auc: 0.7852  acc: 0.7144, time: 0.2920
epoch 26    train auc: 0.9195  acc: 0.8193    eval auc: 0.7840  acc: 0.7174    test auc: 0.7843  acc: 0.7133, time: 0.4760
epoch 27    train auc: 0.9207  acc: 0.8203    eval auc: 0.7831  acc: 0.7163    test auc: 0.7833  acc: 0.7125, time: 0.2910
epoch 28    train auc: 0.9220  acc: 0.8225    eval auc: 0.7820  acc: 0.7118    test auc: 0.7821  acc: 0.7088, time: 0.4640
epoch 29    train auc: 0.9230  acc: 0.8220    eval auc: 0.7815  acc: 0.7133    test auc: 0.7814  acc: 0.7107, time: 0.2890
epoch 30    train auc: 0.9241  acc: 0.8240    eval auc: 0.7801  acc: 0.7105    test auc: 0.7802  acc: 0.7061, time: 0.4720
epoch 31    train auc: 0.9251  acc: 0.8249    eval auc: 0.7786  acc: 0.7069    test auc: 0.7787  acc: 0.7036, time: 0.2870
epoch 32    train auc: 0.9258  acc: 0.8253    eval auc: 0.7788  acc: 0.7088    test auc: 0.7787  acc: 0.7054, time: 0.4849
epoch 33    train auc: 0.9267  acc: 0.8266    eval auc: 0.7777  acc: 0.7053    test auc: 0.7777  acc: 0.7046, time: 0.2900
epoch 34    train auc: 0.9275  acc: 0.8277    eval auc: 0.7769  acc: 0.7040    test auc: 0.7770  acc: 0.7026, time: 0.4700
epoch 35    train auc: 0.9281  acc: 0.8278    eval auc: 0.7767  acc: 0.7039    test auc: 0.7767  acc: 0.7032, time: 0.2860
epoch 36    train auc: 0.9286  acc: 0.8280    eval auc: 0.7770  acc: 0.7062    test auc: 0.7769  acc: 0.7047, time: 0.4850
epoch 37    train auc: 0.9294  acc: 0.8284    eval auc: 0.7756  acc: 0.7033    test auc: 0.7755  acc: 0.7020, time: 0.3400
epoch 38    train auc: 0.9301  acc: 0.8299    eval auc: 0.7745  acc: 0.7019    test auc: 0.7745  acc: 0.7003, time: 0.4720
epoch 39    train auc: 0.9306  acc: 0.8307    eval auc: 0.7741  acc: 0.7008    test auc: 0.7740  acc: 0.6990, time: 0.2840
epoch 40    train auc: 0.9310  acc: 0.8305    eval auc: 0.7746  acc: 0.7033    test auc: 0.7743  acc: 0.7035, time: 0.4990
epoch 41    train auc: 0.9316  acc: 0.8310    eval auc: 0.7738  acc: 0.7013    test auc: 0.7735  acc: 0.7019, time: 0.2850
epoch 42    train auc: 0.9321  acc: 0.8319    eval auc: 0.7730  acc: 0.7016    test auc: 0.7728  acc: 0.6997, time: 0.4710
epoch 43    train auc: 0.9326  acc: 0.8323    eval auc: 0.7729  acc: 0.7008    test auc: 0.7726  acc: 0.7004, time: 0.2910
epoch 44    train auc: 0.9330  acc: 0.8327    eval auc: 0.7725  acc: 0.7004    test auc: 0.7722  acc: 0.7011, time: 0.4590
epoch 45    train auc: 0.9334  acc: 0.8333    eval auc: 0.7721  acc: 0.7003    test auc: 0.7717  acc: 0.7003, time: 0.2910
epoch 46    train auc: 0.9338  acc: 0.8335    eval auc: 0.7721  acc: 0.7011    test auc: 0.7717  acc: 0.7010, time: 0.4690
epoch 47    train auc: 0.9342  acc: 0.8335    eval auc: 0.7716  acc: 0.7006    test auc: 0.7712  acc: 0.7014, time: 0.2910
epoch 48    train auc: 0.9347  acc: 0.8340    eval auc: 0.7705  acc: 0.6990    test auc: 0.7702  acc: 0.6983, time: 0.4590
epoch 49    train auc: 0.9350  acc: 0.8343    eval auc: 0.7705  acc: 0.6997    test auc: 0.7702  acc: 0.6994, time: 0.2860
avg time per epoch : 0.3966876649856567
--- 25.471967458724976 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:33:29.491015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:33:29.491372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5026  acc: 0.5134    eval auc: 0.5299  acc: 0.5155    test auc: 0.5384  acc: 0.5198, time: 0.8490
epoch 1    train auc: 0.8490  acc: 0.6983    eval auc: 0.7548  acc: 0.6857    test auc: 0.7660  acc: 0.6944, time: 0.3110
epoch 2    train auc: 0.8892  acc: 0.7681    eval auc: 0.7887  acc: 0.7398    test auc: 0.7929  acc: 0.7493, time: 0.4980
epoch 3    train auc: 0.8997  acc: 0.7833    eval auc: 0.7938  acc: 0.7497    test auc: 0.7968  acc: 0.7571, time: 0.3340
epoch 4    train auc: 0.9061  acc: 0.7960    eval auc: 0.7962  acc: 0.7455    test auc: 0.7981  acc: 0.7487, time: 0.4980
epoch 5    train auc: 0.9122  acc: 0.8107    eval auc: 0.7928  acc: 0.7322    test auc: 0.7940  acc: 0.7261, time: 0.3030
epoch 6    train auc: 0.9177  acc: 0.8153    eval auc: 0.7904  acc: 0.7272    test auc: 0.7901  acc: 0.7224, time: 0.5030
epoch 7    train auc: 0.9235  acc: 0.8223    eval auc: 0.7841  acc: 0.7154    test auc: 0.7826  acc: 0.7088, time: 0.3120
epoch 8    train auc: 0.9256  acc: 0.8200    eval auc: 0.7842  acc: 0.7209    test auc: 0.7824  acc: 0.7165, time: 0.5050
epoch 9    train auc: 0.9297  acc: 0.8276    eval auc: 0.7770  acc: 0.7062    test auc: 0.7752  acc: 0.7006, time: 0.3080
epoch 10    train auc: 0.9301  acc: 0.8263    eval auc: 0.7797  acc: 0.7115    test auc: 0.7783  acc: 0.7054, time: 0.5030
epoch 11    train auc: 0.9326  acc: 0.8288    eval auc: 0.7754  acc: 0.7066    test auc: 0.7734  acc: 0.7028, time: 0.3110
epoch 12    train auc: 0.9312  acc: 0.8241    eval auc: 0.7807  acc: 0.7150    test auc: 0.7787  acc: 0.7102, time: 0.5190
epoch 13    train auc: 0.9357  acc: 0.8327    eval auc: 0.7700  acc: 0.6965    test auc: 0.7681  acc: 0.6924, time: 0.3169
epoch 14    train auc: 0.9348  acc: 0.8301    eval auc: 0.7758  acc: 0.7075    test auc: 0.7744  acc: 0.7061, time: 0.4980
epoch 15    train auc: 0.9373  acc: 0.8357    eval auc: 0.7680  acc: 0.6944    test auc: 0.7660  acc: 0.6948, time: 0.3100
epoch 16    train auc: 0.9368  acc: 0.8319    eval auc: 0.7720  acc: 0.7008    test auc: 0.7701  acc: 0.7016, time: 0.5130
epoch 17    train auc: 0.9393  acc: 0.8381    eval auc: 0.7658  acc: 0.6903    test auc: 0.7644  acc: 0.6918, time: 0.3180
epoch 18    train auc: 0.9379  acc: 0.8338    eval auc: 0.7719  acc: 0.7030    test auc: 0.7702  acc: 0.7013, time: 0.5090
epoch 19    train auc: 0.9401  acc: 0.8384    eval auc: 0.7640  acc: 0.6887    test auc: 0.7630  acc: 0.6918, time: 0.3000
epoch 20    train auc: 0.9405  acc: 0.8379    eval auc: 0.7666  acc: 0.6943    test auc: 0.7651  acc: 0.6939, time: 0.4920
epoch 21    train auc: 0.9419  acc: 0.8416    eval auc: 0.7623  acc: 0.6890    test auc: 0.7608  acc: 0.6887, time: 0.3050
epoch 22    train auc: 0.9410  acc: 0.8385    eval auc: 0.7664  acc: 0.6967    test auc: 0.7647  acc: 0.6942, time: 0.5140
epoch 23    train auc: 0.9423  acc: 0.8411    eval auc: 0.7631  acc: 0.6924    test auc: 0.7614  acc: 0.6915, time: 0.3260
epoch 24    train auc: 0.9423  acc: 0.8404    eval auc: 0.7640  acc: 0.6935    test auc: 0.7623  acc: 0.6908, time: 0.5530
epoch 25    train auc: 0.9437  acc: 0.8431    eval auc: 0.7605  acc: 0.6879    test auc: 0.7592  acc: 0.6897, time: 0.3350
epoch 26    train auc: 0.9428  acc: 0.8402    eval auc: 0.7635  acc: 0.6948    test auc: 0.7619  acc: 0.6921, time: 0.5490
epoch 27    train auc: 0.9445  acc: 0.8435    eval auc: 0.7590  acc: 0.6886    test auc: 0.7579  acc: 0.6900, time: 0.3730
epoch 28    train auc: 0.9438  acc: 0.8419    eval auc: 0.7619  acc: 0.6931    test auc: 0.7607  acc: 0.6917, time: 0.5890
epoch 29    train auc: 0.9455  acc: 0.8454    eval auc: 0.7571  acc: 0.6865    test auc: 0.7564  acc: 0.6869, time: 0.3630
epoch 30    train auc: 0.9435  acc: 0.8408    eval auc: 0.7616  acc: 0.6935    test auc: 0.7606  acc: 0.6924, time: 0.5620
epoch 31    train auc: 0.9460  acc: 0.8452    eval auc: 0.7564  acc: 0.6882    test auc: 0.7565  acc: 0.6872, time: 0.3550
epoch 32    train auc: 0.9434  acc: 0.8396    eval auc: 0.7600  acc: 0.6936    test auc: 0.7594  acc: 0.6913, time: 0.6020
epoch 33    train auc: 0.9470  acc: 0.8467    eval auc: 0.7531  acc: 0.6844    test auc: 0.7529  acc: 0.6854, time: 0.3540
epoch 34    train auc: 0.9457  acc: 0.8448    eval auc: 0.7586  acc: 0.6919    test auc: 0.7580  acc: 0.6904, time: 0.5810
epoch 35    train auc: 0.9476  acc: 0.8478    eval auc: 0.7524  acc: 0.6828    test auc: 0.7529  acc: 0.6845, time: 0.3610
epoch 36    train auc: 0.9470  acc: 0.8465    eval auc: 0.7565  acc: 0.6891    test auc: 0.7563  acc: 0.6880, time: 0.6000
epoch 37    train auc: 0.9482  acc: 0.8480    eval auc: 0.7541  acc: 0.6871    test auc: 0.7540  acc: 0.6851, time: 0.3650
epoch 38    train auc: 0.9480  acc: 0.8472    eval auc: 0.7549  acc: 0.6883    test auc: 0.7546  acc: 0.6872, time: 0.5740
epoch 39    train auc: 0.9486  acc: 0.8490    eval auc: 0.7528  acc: 0.6857    test auc: 0.7528  acc: 0.6857, time: 0.3510
epoch 40    train auc: 0.9475  acc: 0.8456    eval auc: 0.7557  acc: 0.6893    test auc: 0.7559  acc: 0.6891, time: 0.5750
epoch 41    train auc: 0.9498  acc: 0.8503    eval auc: 0.7505  acc: 0.6834    test auc: 0.7513  acc: 0.6830, time: 0.3490
epoch 42    train auc: 0.9496  acc: 0.8491    eval auc: 0.7536  acc: 0.6893    test auc: 0.7540  acc: 0.6877, time: 0.5780
epoch 43    train auc: 0.9502  acc: 0.8507    eval auc: 0.7519  acc: 0.6863    test auc: 0.7527  acc: 0.6858, time: 0.3560
epoch 44    train auc: 0.9498  acc: 0.8487    eval auc: 0.7541  acc: 0.6882    test auc: 0.7546  acc: 0.6870, time: 0.5810
epoch 45    train auc: 0.9516  acc: 0.8514    eval auc: 0.7500  acc: 0.6845    test auc: 0.7510  acc: 0.6846, time: 0.3590
epoch 46    train auc: 0.9523  acc: 0.8524    eval auc: 0.7502  acc: 0.6846    test auc: 0.7508  acc: 0.6843, time: 0.5850
epoch 47    train auc: 0.9518  acc: 0.8511    eval auc: 0.7501  acc: 0.6838    test auc: 0.7505  acc: 0.6843, time: 0.3590
epoch 48    train auc: 0.9530  acc: 0.8528    eval auc: 0.7508  acc: 0.6849    test auc: 0.7513  acc: 0.6843, time: 0.5880
epoch 49    train auc: 0.9547  acc: 0.8555    eval auc: 0.7464  acc: 0.6805    test auc: 0.7475  acc: 0.6813, time: 0.3290
avg time per epoch : 0.4456342697143555
--- 28.447000980377197 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:33:58.038414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:33:58.038754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5113  acc: 0.5057    eval auc: 0.5019  acc: 0.4981    test auc: 0.5031  acc: 0.5029, time: 0.8030
epoch 1    train auc: 0.5593  acc: 0.5221    eval auc: 0.4958  acc: 0.4988    test auc: 0.5016  acc: 0.4995, time: 0.3090
epoch 2    train auc: 0.7458  acc: 0.6764    eval auc: 0.6552  acc: 0.6119    test auc: 0.6548  acc: 0.6204, time: 0.5110
epoch 3    train auc: 0.6852  acc: 0.5262    eval auc: 0.5828  acc: 0.5211    test auc: 0.5849  acc: 0.5151, time: 0.3270
epoch 4    train auc: 0.7969  acc: 0.6468    eval auc: 0.6945  acc: 0.6331    test auc: 0.6986  acc: 0.6436, time: 0.5029
epoch 5    train auc: 0.7949  acc: 0.6140    eval auc: 0.6796  acc: 0.6010    test auc: 0.6841  acc: 0.6119, time: 0.3070
epoch 6    train auc: 0.8379  acc: 0.7347    eval auc: 0.7332  acc: 0.7078    test auc: 0.7370  acc: 0.7191, time: 0.5100
epoch 7    train auc: 0.8482  acc: 0.7261    eval auc: 0.7370  acc: 0.7014    test auc: 0.7399  acc: 0.7114, time: 0.3140
epoch 8    train auc: 0.8676  acc: 0.7614    eval auc: 0.7616  acc: 0.7274    test auc: 0.7627  acc: 0.7362, time: 0.5350
epoch 9    train auc: 0.8774  acc: 0.7613    eval auc: 0.7664  acc: 0.7249    test auc: 0.7672  acc: 0.7343, time: 0.3150
epoch 10    train auc: 0.8844  acc: 0.7788    eval auc: 0.7781  acc: 0.7376    test auc: 0.7779  acc: 0.7431, time: 0.5290
epoch 11    train auc: 0.8912  acc: 0.7770    eval auc: 0.7800  acc: 0.7347    test auc: 0.7798  acc: 0.7401, time: 0.3140
epoch 12    train auc: 0.8930  acc: 0.7775    eval auc: 0.7860  acc: 0.7409    test auc: 0.7849  acc: 0.7478, time: 0.5370
epoch 13    train auc: 0.8993  acc: 0.7907    eval auc: 0.7878  acc: 0.7398    test auc: 0.7872  acc: 0.7420, time: 0.3210
epoch 14    train auc: 0.8997  acc: 0.7864    eval auc: 0.7912  acc: 0.7442    test auc: 0.7899  acc: 0.7480, time: 0.5180
epoch 15    train auc: 0.9037  acc: 0.7980    eval auc: 0.7910  acc: 0.7388    test auc: 0.7904  acc: 0.7393, time: 0.3180
epoch 16    train auc: 0.9037  acc: 0.7901    eval auc: 0.7931  acc: 0.7437    test auc: 0.7917  acc: 0.7467, time: 0.5080
epoch 17    train auc: 0.9069  acc: 0.8040    eval auc: 0.7923  acc: 0.7359    test auc: 0.7916  acc: 0.7320, time: 0.3170
epoch 18    train auc: 0.9067  acc: 0.7954    eval auc: 0.7937  acc: 0.7418    test auc: 0.7923  acc: 0.7432, time: 0.5239
epoch 19    train auc: 0.9094  acc: 0.8042    eval auc: 0.7927  acc: 0.7346    test auc: 0.7916  acc: 0.7305, time: 0.3140
epoch 20    train auc: 0.9094  acc: 0.8001    eval auc: 0.7935  acc: 0.7386    test auc: 0.7921  acc: 0.7387, time: 0.5210
epoch 21    train auc: 0.9117  acc: 0.8078    eval auc: 0.7926  acc: 0.7340    test auc: 0.7914  acc: 0.7256, time: 0.3130
epoch 22    train auc: 0.9117  acc: 0.8026    eval auc: 0.7931  acc: 0.7359    test auc: 0.7915  acc: 0.7331, time: 0.5190
epoch 23    train auc: 0.9138  acc: 0.8125    eval auc: 0.7920  acc: 0.7317    test auc: 0.7906  acc: 0.7249, time: 0.3120
epoch 24    train auc: 0.9138  acc: 0.8063    eval auc: 0.7922  acc: 0.7356    test auc: 0.7905  acc: 0.7289, time: 0.5130
epoch 25    train auc: 0.9158  acc: 0.8144    eval auc: 0.7911  acc: 0.7291    test auc: 0.7896  acc: 0.7236, time: 0.3140
epoch 26    train auc: 0.9159  acc: 0.8091    eval auc: 0.7913  acc: 0.7352    test auc: 0.7895  acc: 0.7261, time: 0.5110
epoch 27    train auc: 0.9176  acc: 0.8159    eval auc: 0.7900  acc: 0.7275    test auc: 0.7883  acc: 0.7223, time: 0.3160
epoch 28    train auc: 0.9179  acc: 0.8135    eval auc: 0.7902  acc: 0.7302    test auc: 0.7883  acc: 0.7236, time: 0.5010
epoch 29    train auc: 0.9192  acc: 0.8173    eval auc: 0.7889  acc: 0.7255    test auc: 0.7870  acc: 0.7193, time: 0.3070
epoch 30    train auc: 0.9195  acc: 0.8147    eval auc: 0.7888  acc: 0.7271    test auc: 0.7868  acc: 0.7224, time: 0.5090
epoch 31    train auc: 0.9209  acc: 0.8204    eval auc: 0.7873  acc: 0.7219    test auc: 0.7856  acc: 0.7156, time: 0.3040
epoch 32    train auc: 0.9210  acc: 0.8152    eval auc: 0.7874  acc: 0.7262    test auc: 0.7852  acc: 0.7203, time: 0.5240
epoch 33    train auc: 0.9224  acc: 0.8217    eval auc: 0.7862  acc: 0.7198    test auc: 0.7844  acc: 0.7137, time: 0.3030
epoch 34    train auc: 0.9227  acc: 0.8194    eval auc: 0.7863  acc: 0.7229    test auc: 0.7844  acc: 0.7176, time: 0.5060
epoch 35    train auc: 0.9237  acc: 0.8231    eval auc: 0.7852  acc: 0.7179    test auc: 0.7834  acc: 0.7118, time: 0.3100
epoch 36    train auc: 0.9237  acc: 0.8186    eval auc: 0.7852  acc: 0.7230    test auc: 0.7831  acc: 0.7170, time: 0.5150
epoch 37    train auc: 0.9249  acc: 0.8248    eval auc: 0.7840  acc: 0.7147    test auc: 0.7822  acc: 0.7106, time: 0.3310
epoch 38    train auc: 0.9251  acc: 0.8223    eval auc: 0.7840  acc: 0.7178    test auc: 0.7819  acc: 0.7160, time: 0.5140
epoch 39    train auc: 0.9260  acc: 0.8258    eval auc: 0.7827  acc: 0.7150    test auc: 0.7810  acc: 0.7065, time: 0.3190
epoch 40    train auc: 0.9262  acc: 0.8230    eval auc: 0.7829  acc: 0.7151    test auc: 0.7809  acc: 0.7153, time: 0.5220
epoch 41    train auc: 0.9270  acc: 0.8258    eval auc: 0.7819  acc: 0.7138    test auc: 0.7799  acc: 0.7111, time: 0.3204
epoch 42    train auc: 0.9273  acc: 0.8261    eval auc: 0.7819  acc: 0.7122    test auc: 0.7800  acc: 0.7112, time: 0.5140
epoch 43    train auc: 0.9280  acc: 0.8266    eval auc: 0.7809  acc: 0.7135    test auc: 0.7789  acc: 0.7085, time: 0.3130
epoch 44    train auc: 0.9282  acc: 0.8261    eval auc: 0.7810  acc: 0.7125    test auc: 0.7789  acc: 0.7107, time: 0.5040
epoch 45    train auc: 0.9286  acc: 0.8256    eval auc: 0.7802  acc: 0.7131    test auc: 0.7779  acc: 0.7114, time: 0.3180
epoch 46    train auc: 0.9290  acc: 0.8273    eval auc: 0.7802  acc: 0.7118    test auc: 0.7783  acc: 0.7088, time: 0.5110
epoch 47    train auc: 0.9294  acc: 0.8263    eval auc: 0.7793  acc: 0.7112    test auc: 0.7769  acc: 0.7086, time: 0.3050
epoch 48    train auc: 0.9300  acc: 0.8281    eval auc: 0.7792  acc: 0.7093    test auc: 0.7773  acc: 0.7049, time: 0.4930
epoch 49    train auc: 0.9303  acc: 0.8275    eval auc: 0.7786  acc: 0.7101    test auc: 0.7763  acc: 0.7076, time: 0.3140
avg time per epoch : 0.4202027463912964
--- 27.13232111930847 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:34:25.101871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:34:25.102212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4972  acc: 0.4964    eval auc: 0.5093  acc: 0.5082    test auc: 0.4992  acc: 0.5027, time: 0.7900
epoch 1    train auc: 0.5061  acc: 0.5024    eval auc: 0.4865  acc: 0.4942    test auc: 0.4950  acc: 0.4985, time: 0.3220
epoch 2    train auc: 0.5511  acc: 0.5241    eval auc: 0.4320  acc: 0.4703    test auc: 0.4153  acc: 0.4573, time: 0.5430
epoch 3    train auc: 0.5763  acc: 0.5362    eval auc: 0.3938  acc: 0.4509    test auc: 0.3799  acc: 0.4405, time: 0.3310
epoch 4    train auc: 0.5829  acc: 0.5566    eval auc: 0.3830  acc: 0.4234    test auc: 0.3725  acc: 0.4069, time: 0.5190
epoch 5    train auc: 0.5883  acc: 0.5623    eval auc: 0.3736  acc: 0.4110    test auc: 0.3672  acc: 0.4022, time: 0.3210
epoch 6    train auc: 0.5911  acc: 0.5640    eval auc: 0.3697  acc: 0.4054    test auc: 0.3638  acc: 0.4028, time: 0.5220
epoch 7    train auc: 0.5929  acc: 0.5655    eval auc: 0.3681  acc: 0.4041    test auc: 0.3611  acc: 0.3996, time: 0.3240
epoch 8    train auc: 0.5940  acc: 0.5658    eval auc: 0.3666  acc: 0.4039    test auc: 0.3597  acc: 0.3986, time: 0.5300
epoch 9    train auc: 0.5948  acc: 0.5663    eval auc: 0.3659  acc: 0.4029    test auc: 0.3588  acc: 0.3983, time: 0.3160
epoch 10    train auc: 0.5953  acc: 0.5666    eval auc: 0.3651  acc: 0.4030    test auc: 0.3584  acc: 0.3972, time: 0.5110
epoch 11    train auc: 0.5957  acc: 0.5666    eval auc: 0.3648  acc: 0.4023    test auc: 0.3577  acc: 0.3978, time: 0.3120
epoch 12    train auc: 0.5960  acc: 0.5668    eval auc: 0.3644  acc: 0.4016    test auc: 0.3577  acc: 0.3982, time: 0.5120
epoch 13    train auc: 0.5962  acc: 0.5668    eval auc: 0.3643  acc: 0.4017    test auc: 0.3572  acc: 0.3980, time: 0.3210
epoch 14    train auc: 0.5964  acc: 0.5668    eval auc: 0.3642  acc: 0.4012    test auc: 0.3572  acc: 0.3983, time: 0.5099
epoch 15    train auc: 0.5965  acc: 0.5668    eval auc: 0.3639  acc: 0.4021    test auc: 0.3571  acc: 0.3974, time: 0.3100
epoch 16    train auc: 0.5966  acc: 0.5668    eval auc: 0.3639  acc: 0.4031    test auc: 0.3569  acc: 0.3964, time: 0.5100
epoch 17    train auc: 0.5967  acc: 0.5669    eval auc: 0.3635  acc: 0.4018    test auc: 0.3571  acc: 0.3976, time: 0.3120
epoch 18    train auc: 0.5968  acc: 0.5669    eval auc: 0.3636  acc: 0.4025    test auc: 0.3571  acc: 0.3969, time: 0.5220
epoch 19    train auc: 0.5969  acc: 0.5669    eval auc: 0.3636  acc: 0.4025    test auc: 0.3570  acc: 0.3969, time: 0.3110
epoch 20    train auc: 0.5969  acc: 0.5669    eval auc: 0.3633  acc: 0.4013    test auc: 0.3573  acc: 0.3980, time: 0.5040
epoch 21    train auc: 0.5970  acc: 0.5669    eval auc: 0.3638  acc: 0.4031    test auc: 0.3568  acc: 0.3963, time: 0.3080
epoch 22    train auc: 0.5970  acc: 0.5669    eval auc: 0.3636  acc: 0.4028    test auc: 0.3569  acc: 0.3966, time: 0.5050
epoch 23    train auc: 0.5970  acc: 0.5669    eval auc: 0.3637  acc: 0.4029    test auc: 0.3568  acc: 0.3965, time: 0.3189
epoch 24    train auc: 0.5970  acc: 0.5669    eval auc: 0.3634  acc: 0.4045    test auc: 0.3570  acc: 0.3949, time: 0.4970
epoch 25    train auc: 0.5971  acc: 0.5669    eval auc: 0.3636  acc: 0.4025    test auc: 0.3570  acc: 0.3969, time: 0.3020
epoch 26    train auc: 0.5971  acc: 0.5669    eval auc: 0.3634  acc: 0.4018    test auc: 0.3570  acc: 0.3976, time: 0.5000
epoch 27    train auc: 0.5971  acc: 0.5669    eval auc: 0.3633  acc: 0.4021    test auc: 0.3572  acc: 0.3973, time: 0.3100
epoch 28    train auc: 0.5971  acc: 0.5669    eval auc: 0.3634  acc: 0.4004    test auc: 0.3572  acc: 0.3990, time: 0.5000
epoch 29    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4022    test auc: 0.3573  acc: 0.3972, time: 0.3080
epoch 30    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4015    test auc: 0.3569  acc: 0.3979, time: 0.4920
epoch 31    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4019    test auc: 0.3570  acc: 0.3974, time: 0.2960
epoch 32    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4028    test auc: 0.3568  acc: 0.3966, time: 0.5010
epoch 33    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4026    test auc: 0.3566  acc: 0.3967, time: 0.3020
epoch 34    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4031    test auc: 0.3570  acc: 0.3963, time: 0.4940
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4029    test auc: 0.3571  acc: 0.3965, time: 0.3040
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4036    test auc: 0.3570  acc: 0.3958, time: 0.4930
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4025    test auc: 0.3569  acc: 0.3969, time: 0.3070
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4026    test auc: 0.3568  acc: 0.3967, time: 0.4840
epoch 39    train auc: 0.5972  acc: 0.5669    eval auc: 0.3639  acc: 0.4032    test auc: 0.3567  acc: 0.3962, time: 0.3020
epoch 40    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4029    test auc: 0.3568  acc: 0.3965, time: 0.4850
epoch 41    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4030    test auc: 0.3568  acc: 0.3964, time: 0.3140
epoch 42    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4037    test auc: 0.3569  acc: 0.3957, time: 0.4870
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4052    test auc: 0.3568  acc: 0.3941, time: 0.2940
epoch 44    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4008    test auc: 0.3568  acc: 0.3986, time: 0.4910
epoch 45    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4060    test auc: 0.3568  acc: 0.3934, time: 0.2980
epoch 46    train auc: 0.5973  acc: 0.5669    eval auc: 0.3636  acc: 0.4022    test auc: 0.3570  acc: 0.3972, time: 0.4850
epoch 47    train auc: 0.5973  acc: 0.5669    eval auc: 0.3639  acc: 0.4044    test auc: 0.3568  acc: 0.3950, time: 0.3050
epoch 48    train auc: 0.5973  acc: 0.5669    eval auc: 0.3638  acc: 0.4045    test auc: 0.3569  acc: 0.3949, time: 0.4751
epoch 49    train auc: 0.5973  acc: 0.5669    eval auc: 0.3635  acc: 0.4019    test auc: 0.3572  acc: 0.3974, time: 0.2920
avg time per epoch : 0.41204401969909665
--- 26.325046062469482 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:34:51.445132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:34:51.445609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5081  acc: 0.5021    eval auc: 0.4860  acc: 0.4983    test auc: 0.4900  acc: 0.4953, time: 0.8170
epoch 1    train auc: 0.5189  acc: 0.5057    eval auc: 0.4703  acc: 0.4924    test auc: 0.4738  acc: 0.4905, time: 0.2790
epoch 2    train auc: 0.5299  acc: 0.5069    eval auc: 0.4546  acc: 0.4924    test auc: 0.4568  acc: 0.4870, time: 0.4700
epoch 3    train auc: 0.5410  acc: 0.5095    eval auc: 0.4390  acc: 0.4911    test auc: 0.4393  acc: 0.4803, time: 0.2850
epoch 4    train auc: 0.5511  acc: 0.5120    eval auc: 0.4244  acc: 0.4833    test auc: 0.4244  acc: 0.4806, time: 0.4744
epoch 5    train auc: 0.5592  acc: 0.5158    eval auc: 0.4130  acc: 0.4789    test auc: 0.4119  acc: 0.4736, time: 0.2800
epoch 6    train auc: 0.5668  acc: 0.5214    eval auc: 0.4021  acc: 0.4707    test auc: 0.4007  acc: 0.4652, time: 0.4630
epoch 7    train auc: 0.5722  acc: 0.5290    eval auc: 0.3948  acc: 0.4577    test auc: 0.3922  acc: 0.4554, time: 0.2940
epoch 8    train auc: 0.5768  acc: 0.5365    eval auc: 0.3885  acc: 0.4456    test auc: 0.3855  acc: 0.4449, time: 0.4679
epoch 9    train auc: 0.5801  acc: 0.5423    eval auc: 0.3841  acc: 0.4361    test auc: 0.3803  acc: 0.4369, time: 0.2796
epoch 10    train auc: 0.5828  acc: 0.5482    eval auc: 0.3803  acc: 0.4299    test auc: 0.3764  acc: 0.4256, time: 0.4473
epoch 11    train auc: 0.5848  acc: 0.5530    eval auc: 0.3777  acc: 0.4219    test auc: 0.3734  acc: 0.4191, time: 0.2826
epoch 12    train auc: 0.5865  acc: 0.5564    eval auc: 0.3754  acc: 0.4172    test auc: 0.3710  acc: 0.4135, time: 0.4536
epoch 13    train auc: 0.5878  acc: 0.5582    eval auc: 0.3737  acc: 0.4142    test auc: 0.3691  acc: 0.4111, time: 0.2759
epoch 14    train auc: 0.5889  acc: 0.5601    eval auc: 0.3723  acc: 0.4123    test auc: 0.3675  acc: 0.4075, time: 0.4486
epoch 15    train auc: 0.5898  acc: 0.5619    eval auc: 0.3710  acc: 0.4107    test auc: 0.3663  acc: 0.4036, time: 0.2773
epoch 16    train auc: 0.5906  acc: 0.5631    eval auc: 0.3700  acc: 0.4107    test auc: 0.3652  acc: 0.4000, time: 0.4603
epoch 17    train auc: 0.5912  acc: 0.5638    eval auc: 0.3690  acc: 0.4088    test auc: 0.3644  acc: 0.3998, time: 0.2779
epoch 18    train auc: 0.5918  acc: 0.5645    eval auc: 0.3685  acc: 0.4075    test auc: 0.3636  acc: 0.3990, time: 0.4540
epoch 19    train auc: 0.5924  acc: 0.5650    eval auc: 0.3680  acc: 0.4064    test auc: 0.3631  acc: 0.3986, time: 0.2780
epoch 20    train auc: 0.5931  acc: 0.5654    eval auc: 0.3676  acc: 0.4043    test auc: 0.3627  acc: 0.3997, time: 0.4542
epoch 21    train auc: 0.5949  acc: 0.5660    eval auc: 0.3686  acc: 0.4074    test auc: 0.3632  acc: 0.3976, time: 0.2759
epoch 22    train auc: 0.6002  acc: 0.5693    eval auc: 0.3724  acc: 0.4077    test auc: 0.3674  acc: 0.4028, time: 0.4553
epoch 23    train auc: 0.6194  acc: 0.5779    eval auc: 0.3890  acc: 0.4171    test auc: 0.3860  acc: 0.4132, time: 0.2846
epoch 24    train auc: 0.6988  acc: 0.6266    eval auc: 0.4824  acc: 0.4709    test auc: 0.4853  acc: 0.4702, time: 0.4571
epoch 25    train auc: 0.7960  acc: 0.7051    eval auc: 0.6436  acc: 0.5612    test auc: 0.6544  acc: 0.5670, time: 0.2843
epoch 26    train auc: 0.8229  acc: 0.7559    eval auc: 0.6839  acc: 0.6329    test auc: 0.6916  acc: 0.6354, time: 0.4581
epoch 27    train auc: 0.8432  acc: 0.7745    eval auc: 0.7077  acc: 0.6687    test auc: 0.7142  acc: 0.6725, time: 0.2815
epoch 28    train auc: 0.8536  acc: 0.7787    eval auc: 0.7204  acc: 0.6935    test auc: 0.7254  acc: 0.6959, time: 0.4502
epoch 29    train auc: 0.8637  acc: 0.7833    eval auc: 0.7319  acc: 0.7042    test auc: 0.7357  acc: 0.7086, time: 0.2833
epoch 30    train auc: 0.8699  acc: 0.7853    eval auc: 0.7392  acc: 0.7121    test auc: 0.7418  acc: 0.7185, time: 0.4591
epoch 31    train auc: 0.8773  acc: 0.7886    eval auc: 0.7467  acc: 0.7134    test auc: 0.7486  acc: 0.7196, time: 0.2885
epoch 32    train auc: 0.8799  acc: 0.7883    eval auc: 0.7509  acc: 0.7202    test auc: 0.7519  acc: 0.7251, time: 0.4635
epoch 33    train auc: 0.8882  acc: 0.7953    eval auc: 0.7595  acc: 0.7211    test auc: 0.7598  acc: 0.7197, time: 0.2813
epoch 34    train auc: 0.8914  acc: 0.7951    eval auc: 0.7635  acc: 0.7277    test auc: 0.7633  acc: 0.7276, time: 0.4556
epoch 35    train auc: 0.8957  acc: 0.8030    eval auc: 0.7675  acc: 0.7243    test auc: 0.7672  acc: 0.7154, time: 0.2787
epoch 36    train auc: 0.8977  acc: 0.8003    eval auc: 0.7701  acc: 0.7288    test auc: 0.7691  acc: 0.7261, time: 0.4622
epoch 37    train auc: 0.9008  acc: 0.8085    eval auc: 0.7716  acc: 0.7219    test auc: 0.7711  acc: 0.7118, time: 0.2796
epoch 38    train auc: 0.9027  acc: 0.8081    eval auc: 0.7722  acc: 0.7236    test auc: 0.7712  acc: 0.7135, time: 0.4499
epoch 39    train auc: 0.9047  acc: 0.8132    eval auc: 0.7727  acc: 0.7168    test auc: 0.7720  acc: 0.7112, time: 0.2790
epoch 40    train auc: 0.9062  acc: 0.8090    eval auc: 0.7742  acc: 0.7255    test auc: 0.7727  acc: 0.7163, time: 0.4540
epoch 41    train auc: 0.9080  acc: 0.8145    eval auc: 0.7738  acc: 0.7176    test auc: 0.7725  acc: 0.7115, time: 0.2810
epoch 42    train auc: 0.9096  acc: 0.8146    eval auc: 0.7735  acc: 0.7199    test auc: 0.7719  acc: 0.7106, time: 0.4598
epoch 43    train auc: 0.9110  acc: 0.8159    eval auc: 0.7740  acc: 0.7158    test auc: 0.7724  acc: 0.7118, time: 0.2818
epoch 44    train auc: 0.9123  acc: 0.8153    eval auc: 0.7742  acc: 0.7197    test auc: 0.7721  acc: 0.7124, time: 0.4565
epoch 45    train auc: 0.9136  acc: 0.8183    eval auc: 0.7742  acc: 0.7145    test auc: 0.7722  acc: 0.7095, time: 0.2818
epoch 46    train auc: 0.9148  acc: 0.8173    eval auc: 0.7743  acc: 0.7159    test auc: 0.7718  acc: 0.7107, time: 0.4559
epoch 47    train auc: 0.9159  acc: 0.8196    eval auc: 0.7742  acc: 0.7137    test auc: 0.7718  acc: 0.7088, time: 0.2800
epoch 48    train auc: 0.9170  acc: 0.8204    eval auc: 0.7731  acc: 0.7100    test auc: 0.7705  acc: 0.7066, time: 0.4587
epoch 49    train auc: 0.9179  acc: 0.8207    eval auc: 0.7739  acc: 0.7096    test auc: 0.7712  acc: 0.7065, time: 0.2769
avg time per epoch : 0.3766790914535523
--- 23.973032236099243 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:35:15.450473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:35:15.450828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5035  acc: 0.5028    eval auc: 0.4959  acc: 0.4956    test auc: 0.4934  acc: 0.4958, time: 1.0282
epoch 1    train auc: 0.4787  acc: 0.4877    eval auc: 0.5303  acc: 0.5154    test auc: 0.5338  acc: 0.5214, time: 0.7009
epoch 2    train auc: 0.5510  acc: 0.5318    eval auc: 0.4263  acc: 0.4521    test auc: 0.4212  acc: 0.4526, time: 0.6730
epoch 3    train auc: 0.5744  acc: 0.5537    eval auc: 0.3945  acc: 0.4221    test auc: 0.3848  acc: 0.4167, time: 0.6679
epoch 4    train auc: 0.5829  acc: 0.5594    eval auc: 0.3830  acc: 0.4187    test auc: 0.3727  acc: 0.4030, time: 0.6230
epoch 5    train auc: 0.5892  acc: 0.5620    eval auc: 0.3778  acc: 0.4136    test auc: 0.3681  acc: 0.4019, time: 0.6562
epoch 6    train auc: 0.6543  acc: 0.5824    eval auc: 0.4225  acc: 0.4310    test auc: 0.4065  acc: 0.4174, time: 0.6380
epoch 7    train auc: 0.7701  acc: 0.6617    eval auc: 0.6905  acc: 0.5628    test auc: 0.6933  acc: 0.5566, time: 0.6497
epoch 8    train auc: 0.8427  acc: 0.7179    eval auc: 0.7299  acc: 0.6020    test auc: 0.7349  acc: 0.6014, time: 0.6529
epoch 9    train auc: 0.8715  acc: 0.7526    eval auc: 0.7448  acc: 0.6435    test auc: 0.7473  acc: 0.6342, time: 0.6440
epoch 10    train auc: 0.8840  acc: 0.7679    eval auc: 0.7520  acc: 0.6624    test auc: 0.7546  acc: 0.6595, time: 0.6219
epoch 11    train auc: 0.8923  acc: 0.7768    eval auc: 0.7596  acc: 0.6758    test auc: 0.7626  acc: 0.6728, time: 0.6440
epoch 12    train auc: 0.9010  acc: 0.7881    eval auc: 0.7579  acc: 0.6876    test auc: 0.7609  acc: 0.6798, time: 0.6410
epoch 13    train auc: 0.9063  acc: 0.7921    eval auc: 0.7583  acc: 0.6846    test auc: 0.7614  acc: 0.6793, time: 0.6956
epoch 14    train auc: 0.9134  acc: 0.8020    eval auc: 0.7620  acc: 0.6937    test auc: 0.7660  acc: 0.6905, time: 0.6860
epoch 15    train auc: 0.9201  acc: 0.8082    eval auc: 0.7563  acc: 0.6891    test auc: 0.7605  acc: 0.6854, time: 0.6860
epoch 16    train auc: 0.9294  acc: 0.8172    eval auc: 0.7607  acc: 0.6977    test auc: 0.7638  acc: 0.6923, time: 0.6901
epoch 17    train auc: 0.9371  acc: 0.8290    eval auc: 0.7546  acc: 0.7009    test auc: 0.7568  acc: 0.6949, time: 0.6780
epoch 18    train auc: 0.9407  acc: 0.8338    eval auc: 0.7480  acc: 0.6941    test auc: 0.7516  acc: 0.6925, time: 0.6904
epoch 19    train auc: 0.9441  acc: 0.8397    eval auc: 0.7490  acc: 0.6961    test auc: 0.7528  acc: 0.6939, time: 0.6742
epoch 20    train auc: 0.9473  acc: 0.8449    eval auc: 0.7460  acc: 0.6938    test auc: 0.7498  acc: 0.6906, time: 0.6779
epoch 21    train auc: 0.9502  acc: 0.8503    eval auc: 0.7485  acc: 0.6990    test auc: 0.7519  acc: 0.6944, time: 0.7056
epoch 22    train auc: 0.9528  acc: 0.8544    eval auc: 0.7449  acc: 0.6961    test auc: 0.7481  acc: 0.6936, time: 0.6825
epoch 23    train auc: 0.9553  acc: 0.8592    eval auc: 0.7453  acc: 0.6991    test auc: 0.7477  acc: 0.6956, time: 0.6981
epoch 24    train auc: 0.9575  acc: 0.8624    eval auc: 0.7444  acc: 0.6988    test auc: 0.7452  acc: 0.6935, time: 0.6720
epoch 25    train auc: 0.9597  acc: 0.8656    eval auc: 0.7453  acc: 0.6990    test auc: 0.7465  acc: 0.6929, time: 0.6730
epoch 26    train auc: 0.9616  acc: 0.8717    eval auc: 0.7412  acc: 0.6950    test auc: 0.7423  acc: 0.6909, time: 0.6740
epoch 27    train auc: 0.9634  acc: 0.8763    eval auc: 0.7402  acc: 0.6930    test auc: 0.7411  acc: 0.6890, time: 0.6942
epoch 28    train auc: 0.9654  acc: 0.8814    eval auc: 0.7404  acc: 0.6934    test auc: 0.7402  acc: 0.6906, time: 0.6952
epoch 29    train auc: 0.9665  acc: 0.8839    eval auc: 0.7368  acc: 0.6893    test auc: 0.7364  acc: 0.6889, time: 0.6977
epoch 30    train auc: 0.9680  acc: 0.8879    eval auc: 0.7397  acc: 0.6906    test auc: 0.7389  acc: 0.6896, time: 0.6918
epoch 31    train auc: 0.9693  acc: 0.8913    eval auc: 0.7365  acc: 0.6911    test auc: 0.7355  acc: 0.6887, time: 0.6709
epoch 32    train auc: 0.9697  acc: 0.8919    eval auc: 0.7356  acc: 0.6879    test auc: 0.7340  acc: 0.6858, time: 0.6710
epoch 33    train auc: 0.9715  acc: 0.8964    eval auc: 0.7352  acc: 0.6880    test auc: 0.7330  acc: 0.6845, time: 0.6834
epoch 34    train auc: 0.9720  acc: 0.8974    eval auc: 0.7343  acc: 0.6880    test auc: 0.7314  acc: 0.6846, time: 0.6831
epoch 35    train auc: 0.9723  acc: 0.8961    eval auc: 0.7328  acc: 0.6860    test auc: 0.7295  acc: 0.6815, time: 0.6806
epoch 36    train auc: 0.9728  acc: 0.8984    eval auc: 0.7291  acc: 0.6823    test auc: 0.7245  acc: 0.6785, time: 0.6712
epoch 37    train auc: 0.9743  acc: 0.9022    eval auc: 0.7329  acc: 0.6847    test auc: 0.7288  acc: 0.6815, time: 0.6770
epoch 38    train auc: 0.9754  acc: 0.9036    eval auc: 0.7328  acc: 0.6858    test auc: 0.7285  acc: 0.6825, time: 0.6630
epoch 39    train auc: 0.9756  acc: 0.9036    eval auc: 0.7310  acc: 0.6850    test auc: 0.7266  acc: 0.6810, time: 0.6732
epoch 40    train auc: 0.9764  acc: 0.9054    eval auc: 0.7284  acc: 0.6819    test auc: 0.7245  acc: 0.6788, time: 0.6741
epoch 41    train auc: 0.9771  acc: 0.9062    eval auc: 0.7281  acc: 0.6826    test auc: 0.7245  acc: 0.6788, time: 0.6726
epoch 42    train auc: 0.9773  acc: 0.9077    eval auc: 0.7290  acc: 0.6804    test auc: 0.7250  acc: 0.6788, time: 0.6543
epoch 43    train auc: 0.9782  acc: 0.9088    eval auc: 0.7285  acc: 0.6806    test auc: 0.7241  acc: 0.6779, time: 0.6480
epoch 44    train auc: 0.9787  acc: 0.9086    eval auc: 0.7296  acc: 0.6804    test auc: 0.7250  acc: 0.6792, time: 0.6419
epoch 45    train auc: 0.9789  acc: 0.9107    eval auc: 0.7280  acc: 0.6798    test auc: 0.7225  acc: 0.6759, time: 0.6570
epoch 46    train auc: 0.9796  acc: 0.9130    eval auc: 0.7282  acc: 0.6805    test auc: 0.7231  acc: 0.6765, time: 0.6445
epoch 47    train auc: 0.9795  acc: 0.9115    eval auc: 0.7249  acc: 0.6762    test auc: 0.7192  acc: 0.6739, time: 0.6472
epoch 48    train auc: 0.9804  acc: 0.9141    eval auc: 0.7295  acc: 0.6813    test auc: 0.7236  acc: 0.6778, time: 0.6445
epoch 49    train auc: 0.9808  acc: 0.9162    eval auc: 0.7298  acc: 0.6800    test auc: 0.7231  acc: 0.6779, time: 0.6510
avg time per epoch : 0.6762308597564697
--- 42.15528750419617 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:35:57.686686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:35:57.687033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5109  acc: 0.5065    eval auc: 0.5116  acc: 0.5024    test auc: 0.5139  acc: 0.5090, time: 0.9841
epoch 1    train auc: 0.5366  acc: 0.5205    eval auc: 0.4978  acc: 0.5051    test auc: 0.4995  acc: 0.5016, time: 0.7147
epoch 2    train auc: 0.5619  acc: 0.5361    eval auc: 0.5104  acc: 0.5003    test auc: 0.5223  acc: 0.5128, time: 0.7029
epoch 3    train auc: 0.5686  acc: 0.5389    eval auc: 0.5023  acc: 0.5017    test auc: 0.5177  acc: 0.5143, time: 0.7310
epoch 4    train auc: 0.5744  acc: 0.5338    eval auc: 0.4088  acc: 0.4511    test auc: 0.4148  acc: 0.4489, time: 0.6973
epoch 5    train auc: 0.5857  acc: 0.5415    eval auc: 0.4034  acc: 0.4384    test auc: 0.4090  acc: 0.4383, time: 0.6974
epoch 6    train auc: 0.6041  acc: 0.5488    eval auc: 0.4086  acc: 0.4277    test auc: 0.4141  acc: 0.4298, time: 0.6790
epoch 7    train auc: 0.6449  acc: 0.5540    eval auc: 0.4448  acc: 0.4375    test auc: 0.4491  acc: 0.4326, time: 0.7005
epoch 8    train auc: 0.7359  acc: 0.6359    eval auc: 0.5478  acc: 0.5502    test auc: 0.5569  acc: 0.5527, time: 0.6962
epoch 9    train auc: 0.8149  acc: 0.7230    eval auc: 0.6726  acc: 0.6602    test auc: 0.6804  acc: 0.6707, time: 0.6936
epoch 10    train auc: 0.8427  acc: 0.7612    eval auc: 0.7293  acc: 0.6934    test auc: 0.7328  acc: 0.7010, time: 0.6862
epoch 11    train auc: 0.8498  acc: 0.7730    eval auc: 0.7509  acc: 0.6871    test auc: 0.7542  acc: 0.6929, time: 0.6837
epoch 12    train auc: 0.8492  acc: 0.7685    eval auc: 0.7581  acc: 0.6601    test auc: 0.7598  acc: 0.6560, time: 0.6884
epoch 13    train auc: 0.8453  acc: 0.7348    eval auc: 0.7585  acc: 0.6114    test auc: 0.7598  acc: 0.6105, time: 0.6811
epoch 14    train auc: 0.8456  acc: 0.7158    eval auc: 0.7581  acc: 0.5963    test auc: 0.7593  acc: 0.5942, time: 0.6817
epoch 15    train auc: 0.8431  acc: 0.6777    eval auc: 0.7558  acc: 0.5747    test auc: 0.7569  acc: 0.5704, time: 0.6723
epoch 16    train auc: 0.8413  acc: 0.6473    eval auc: 0.7536  acc: 0.5584    test auc: 0.7544  acc: 0.5559, time: 0.6599
epoch 17    train auc: 0.8412  acc: 0.6466    eval auc: 0.7519  acc: 0.5592    test auc: 0.7524  acc: 0.5563, time: 0.6680
epoch 18    train auc: 0.8393  acc: 0.6411    eval auc: 0.7489  acc: 0.5571    test auc: 0.7493  acc: 0.5553, time: 0.6754
epoch 19    train auc: 0.8411  acc: 0.6514    eval auc: 0.7484  acc: 0.5651    test auc: 0.7489  acc: 0.5604, time: 0.6771
epoch 20    train auc: 0.8380  acc: 0.6463    eval auc: 0.7447  acc: 0.5618    test auc: 0.7455  acc: 0.5584, time: 0.6520
epoch 21    train auc: 0.8385  acc: 0.6526    eval auc: 0.7435  acc: 0.5655    test auc: 0.7442  acc: 0.5632, time: 0.6630
epoch 22    train auc: 0.8385  acc: 0.6540    eval auc: 0.7420  acc: 0.5657    test auc: 0.7425  acc: 0.5646, time: 0.6609
epoch 23    train auc: 0.8363  acc: 0.6540    eval auc: 0.7394  acc: 0.5670    test auc: 0.7401  acc: 0.5663, time: 0.6546
epoch 24    train auc: 0.8390  acc: 0.6624    eval auc: 0.7396  acc: 0.5719    test auc: 0.7404  acc: 0.5704, time: 0.6530
epoch 25    train auc: 0.8386  acc: 0.6648    eval auc: 0.7386  acc: 0.5739    test auc: 0.7393  acc: 0.5728, time: 0.6460
epoch 26    train auc: 0.8351  acc: 0.6616    eval auc: 0.7352  acc: 0.5737    test auc: 0.7361  acc: 0.5716, time: 0.6489
epoch 27    train auc: 0.8360  acc: 0.6670    eval auc: 0.7346  acc: 0.5767    test auc: 0.7354  acc: 0.5746, time: 0.6446
epoch 28    train auc: 0.8334  acc: 0.6674    eval auc: 0.7323  acc: 0.5761    test auc: 0.7330  acc: 0.5755, time: 0.6596
epoch 29    train auc: 0.8330  acc: 0.6697    eval auc: 0.7312  acc: 0.5796    test auc: 0.7319  acc: 0.5776, time: 0.6429
epoch 30    train auc: 0.8284  acc: 0.6687    eval auc: 0.7282  acc: 0.5792    test auc: 0.7292  acc: 0.5779, time: 0.6536
epoch 31    train auc: 0.8293  acc: 0.6720    eval auc: 0.7279  acc: 0.5829    test auc: 0.7288  acc: 0.5794, time: 0.6471
epoch 32    train auc: 0.8269  acc: 0.6731    eval auc: 0.7260  acc: 0.5834    test auc: 0.7272  acc: 0.5799, time: 0.6895
epoch 33    train auc: 0.8227  acc: 0.6734    eval auc: 0.7233  acc: 0.5833    test auc: 0.7248  acc: 0.5802, time: 0.6820
epoch 34    train auc: 0.8236  acc: 0.6768    eval auc: 0.7229  acc: 0.5852    test auc: 0.7243  acc: 0.5827, time: 0.6400
epoch 35    train auc: 0.8209  acc: 0.6768    eval auc: 0.7207  acc: 0.5844    test auc: 0.7222  acc: 0.5817, time: 0.6469
epoch 36    train auc: 0.8200  acc: 0.6790    eval auc: 0.7193  acc: 0.5852    test auc: 0.7209  acc: 0.5831, time: 0.6584
epoch 37    train auc: 0.8184  acc: 0.6801    eval auc: 0.7176  acc: 0.5863    test auc: 0.7191  acc: 0.5835, time: 0.6360
epoch 38    train auc: 0.8221  acc: 0.6855    eval auc: 0.7189  acc: 0.5893    test auc: 0.7202  acc: 0.5864, time: 0.6358
epoch 39    train auc: 0.8198  acc: 0.6856    eval auc: 0.7168  acc: 0.5903    test auc: 0.7180  acc: 0.5866, time: 0.6499
epoch 40    train auc: 0.8162  acc: 0.6852    eval auc: 0.7136  acc: 0.5899    test auc: 0.7151  acc: 0.5855, time: 0.6340
epoch 41    train auc: 0.8171  acc: 0.6878    eval auc: 0.7133  acc: 0.5915    test auc: 0.7146  acc: 0.5871, time: 0.6436
epoch 42    train auc: 0.8114  acc: 0.6857    eval auc: 0.7090  acc: 0.5903    test auc: 0.7104  acc: 0.5859, time: 0.6776
epoch 43    train auc: 0.8124  acc: 0.6879    eval auc: 0.7084  acc: 0.5906    test auc: 0.7099  acc: 0.5874, time: 0.6920
epoch 44    train auc: 0.8152  acc: 0.6908    eval auc: 0.7091  acc: 0.5926    test auc: 0.7105  acc: 0.5897, time: 0.7057
epoch 45    train auc: 0.8127  acc: 0.6914    eval auc: 0.7068  acc: 0.5925    test auc: 0.7080  acc: 0.5903, time: 0.6910
epoch 46    train auc: 0.8087  acc: 0.6898    eval auc: 0.7031  acc: 0.5917    test auc: 0.7042  acc: 0.5899, time: 0.7100
epoch 47    train auc: 0.8091  acc: 0.6915    eval auc: 0.7021  acc: 0.5935    test auc: 0.7034  acc: 0.5902, time: 0.6990
epoch 48    train auc: 0.8111  acc: 0.6942    eval auc: 0.7023  acc: 0.5962    test auc: 0.7034  acc: 0.5925, time: 0.7030
epoch 49    train auc: 0.8131  acc: 0.6965    eval auc: 0.7026  acc: 0.5966    test auc: 0.7036  acc: 0.5936, time: 0.7136
avg time per epoch : 0.6800984907150268
--- 42.299885988235474 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:36:39.956995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:36:39.957320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4826  acc: 0.4941    eval auc: 0.5319  acc: 0.5063    test auc: 0.5205  acc: 0.5114, time: 0.9899
epoch 1    train auc: 0.5095  acc: 0.5084    eval auc: 0.4810  acc: 0.4860    test auc: 0.4905  acc: 0.4887, time: 0.7062
epoch 2    train auc: 0.5149  acc: 0.4976    eval auc: 0.4769  acc: 0.5038    test auc: 0.4773  acc: 0.5035, time: 0.7221
epoch 3    train auc: 0.5582  acc: 0.5381    eval auc: 0.4148  acc: 0.4437    test auc: 0.4126  acc: 0.4420, time: 0.7159
epoch 4    train auc: 0.5823  acc: 0.5558    eval auc: 0.3833  acc: 0.4217    test auc: 0.3743  acc: 0.4109, time: 0.7094
epoch 5    train auc: 0.5888  acc: 0.5628    eval auc: 0.3732  acc: 0.4109    test auc: 0.3669  acc: 0.4006, time: 0.7268
epoch 6    train auc: 0.5920  acc: 0.5645    eval auc: 0.3695  acc: 0.4054    test auc: 0.3622  acc: 0.4012, time: 0.7290
epoch 7    train auc: 0.5936  acc: 0.5651    eval auc: 0.3673  acc: 0.4064    test auc: 0.3604  acc: 0.3984, time: 0.7204
epoch 8    train auc: 0.5946  acc: 0.5656    eval auc: 0.3657  acc: 0.4039    test auc: 0.3598  acc: 0.3991, time: 0.7100
epoch 9    train auc: 0.5952  acc: 0.5657    eval auc: 0.3655  acc: 0.4049    test auc: 0.3589  acc: 0.3979, time: 0.7130
epoch 10    train auc: 0.5956  acc: 0.5659    eval auc: 0.3650  acc: 0.4055    test auc: 0.3585  acc: 0.3969, time: 0.7141
epoch 11    train auc: 0.5958  acc: 0.5660    eval auc: 0.3650  acc: 0.4052    test auc: 0.3580  acc: 0.3966, time: 0.7100
epoch 12    train auc: 0.5961  acc: 0.5662    eval auc: 0.3649  acc: 0.4041    test auc: 0.3576  acc: 0.3974, time: 0.7110
epoch 13    train auc: 0.5962  acc: 0.5662    eval auc: 0.3647  acc: 0.4047    test auc: 0.3575  acc: 0.3967, time: 0.7210
epoch 14    train auc: 0.5964  acc: 0.5664    eval auc: 0.3644  acc: 0.4055    test auc: 0.3576  acc: 0.3952, time: 0.7170
epoch 15    train auc: 0.5965  acc: 0.5663    eval auc: 0.3645  acc: 0.4064    test auc: 0.3574  acc: 0.3946, time: 0.7158
epoch 16    train auc: 0.5966  acc: 0.5663    eval auc: 0.3644  acc: 0.4060    test auc: 0.3574  acc: 0.3952, time: 0.7248
epoch 17    train auc: 0.5967  acc: 0.5664    eval auc: 0.3642  acc: 0.4078    test auc: 0.3573  acc: 0.3931, time: 0.7159
epoch 18    train auc: 0.5967  acc: 0.5666    eval auc: 0.3642  acc: 0.4045    test auc: 0.3573  acc: 0.3957, time: 0.7232
epoch 19    train auc: 0.5968  acc: 0.5666    eval auc: 0.3641  acc: 0.4063    test auc: 0.3573  acc: 0.3940, time: 0.7119
epoch 20    train auc: 0.5968  acc: 0.5666    eval auc: 0.3639  acc: 0.4047    test auc: 0.3574  acc: 0.3957, time: 0.7225
epoch 21    train auc: 0.5969  acc: 0.5667    eval auc: 0.3642  acc: 0.4055    test auc: 0.3570  acc: 0.3945, time: 0.7036
epoch 22    train auc: 0.5969  acc: 0.5666    eval auc: 0.3638  acc: 0.4051    test auc: 0.3574  acc: 0.3952, time: 0.7099
epoch 23    train auc: 0.5970  acc: 0.5666    eval auc: 0.3637  acc: 0.4050    test auc: 0.3574  acc: 0.3951, time: 0.7053
epoch 24    train auc: 0.5970  acc: 0.5667    eval auc: 0.3636  acc: 0.4060    test auc: 0.3575  acc: 0.3939, time: 0.6869
epoch 25    train auc: 0.5970  acc: 0.5667    eval auc: 0.3637  acc: 0.4047    test auc: 0.3573  acc: 0.3953, time: 0.7087
epoch 26    train auc: 0.5970  acc: 0.5667    eval auc: 0.3636  acc: 0.4022    test auc: 0.3574  acc: 0.3977, time: 0.6849
epoch 27    train auc: 0.5970  acc: 0.5667    eval auc: 0.3634  acc: 0.4028    test auc: 0.3576  acc: 0.3971, time: 0.7036
epoch 28    train auc: 0.5970  acc: 0.5668    eval auc: 0.3632  acc: 0.4025    test auc: 0.3578  acc: 0.3971, time: 0.6969
epoch 29    train auc: 0.5971  acc: 0.5668    eval auc: 0.3632  acc: 0.4048    test auc: 0.3578  acc: 0.3950, time: 0.6790
epoch 30    train auc: 0.5970  acc: 0.5668    eval auc: 0.3632  acc: 0.4017    test auc: 0.3579  acc: 0.3979, time: 0.6926
epoch 31    train auc: 0.5970  acc: 0.5668    eval auc: 0.3632  acc: 0.4021    test auc: 0.3578  acc: 0.3974, time: 0.6729
epoch 32    train auc: 0.5971  acc: 0.5668    eval auc: 0.3627  acc: 0.4002    test auc: 0.3582  acc: 0.3995, time: 0.6759
epoch 33    train auc: 0.5971  acc: 0.5668    eval auc: 0.3633  acc: 0.4026    test auc: 0.3577  acc: 0.3969, time: 0.6794
epoch 34    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4030    test auc: 0.3577  acc: 0.3964, time: 0.6840
epoch 35    train auc: 0.5971  acc: 0.5668    eval auc: 0.3630  acc: 0.4021    test auc: 0.3579  acc: 0.3976, time: 0.6730
epoch 36    train auc: 0.5971  acc: 0.5669    eval auc: 0.3633  acc: 0.4037    test auc: 0.3577  acc: 0.3957, time: 0.6680
epoch 37    train auc: 0.5971  acc: 0.5669    eval auc: 0.3631  acc: 0.4026    test auc: 0.3578  acc: 0.3967, time: 0.6826
epoch 38    train auc: 0.5971  acc: 0.5668    eval auc: 0.3630  acc: 0.4015    test auc: 0.3580  acc: 0.3982, time: 0.6580
epoch 39    train auc: 0.5971  acc: 0.5668    eval auc: 0.3630  acc: 0.4025    test auc: 0.3580  acc: 0.3970, time: 0.6935
epoch 40    train auc: 0.5971  acc: 0.5669    eval auc: 0.3630  acc: 0.4029    test auc: 0.3580  acc: 0.3965, time: 0.6799
epoch 41    train auc: 0.5971  acc: 0.5669    eval auc: 0.3629  acc: 0.4024    test auc: 0.3580  acc: 0.3970, time: 0.6794
epoch 42    train auc: 0.5971  acc: 0.5669    eval auc: 0.3629  acc: 0.4016    test auc: 0.3580  acc: 0.3978, time: 0.6620
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3630  acc: 0.4024    test auc: 0.3578  acc: 0.3970, time: 0.6590
epoch 44    train auc: 0.5972  acc: 0.5668    eval auc: 0.3628  acc: 0.4026    test auc: 0.3580  acc: 0.3969, time: 0.6540
epoch 45    train auc: 0.5971  acc: 0.5668    eval auc: 0.3632  acc: 0.4044    test auc: 0.3577  acc: 0.3951, time: 0.6786
epoch 46    train auc: 0.5971  acc: 0.5668    eval auc: 0.3634  acc: 0.4039    test auc: 0.3576  acc: 0.3956, time: 0.6646
epoch 47    train auc: 0.5971  acc: 0.5668    eval auc: 0.3634  acc: 0.4044    test auc: 0.3575  acc: 0.3951, time: 0.6697
epoch 48    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4029    test auc: 0.3576  acc: 0.3965, time: 0.6525
epoch 49    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4048    test auc: 0.3577  acc: 0.3946, time: 0.6667
avg time per epoch : 0.7011059141159057
--- 43.26768398284912 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:37:23.242927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:37:23.243256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5173  acc: 0.5080    eval auc: 0.4980  acc: 0.5017    test auc: 0.5151  acc: 0.5063, time: 1.0610
epoch 1    train auc: 0.5568  acc: 0.5092    eval auc: 0.5193  acc: 0.4979    test auc: 0.5330  acc: 0.5054, time: 0.7430
epoch 2    train auc: 0.7292  acc: 0.5251    eval auc: 0.6596  acc: 0.5086    test auc: 0.6753  acc: 0.5185, time: 0.7142
epoch 3    train auc: 0.8022  acc: 0.6789    eval auc: 0.7285  acc: 0.6585    test auc: 0.7295  acc: 0.6766, time: 0.6670
epoch 4    train auc: 0.8476  acc: 0.7189    eval auc: 0.7556  acc: 0.7008    test auc: 0.7573  acc: 0.7093, time: 0.6656
epoch 5    train auc: 0.8683  acc: 0.7287    eval auc: 0.7715  acc: 0.7079    test auc: 0.7754  acc: 0.7173, time: 0.6480
epoch 6    train auc: 0.8822  acc: 0.7516    eval auc: 0.7812  acc: 0.7210    test auc: 0.7845  acc: 0.7341, time: 0.6815
epoch 7    train auc: 0.8881  acc: 0.7566    eval auc: 0.7846  acc: 0.7243    test auc: 0.7873  acc: 0.7349, time: 0.6579
epoch 8    train auc: 0.8957  acc: 0.7771    eval auc: 0.7858  acc: 0.7346    test auc: 0.7884  acc: 0.7403, time: 0.6630
epoch 9    train auc: 0.8995  acc: 0.7837    eval auc: 0.7870  acc: 0.7326    test auc: 0.7887  acc: 0.7368, time: 0.6760
epoch 10    train auc: 0.9027  acc: 0.7870    eval auc: 0.7873  acc: 0.7318    test auc: 0.7883  acc: 0.7349, time: 0.6498
epoch 11    train auc: 0.9067  acc: 0.7988    eval auc: 0.7878  acc: 0.7317    test auc: 0.7883  acc: 0.7304, time: 0.7002
epoch 12    train auc: 0.9096  acc: 0.8034    eval auc: 0.7875  acc: 0.7272    test auc: 0.7877  acc: 0.7259, time: 0.6999
epoch 13    train auc: 0.9127  acc: 0.8095    eval auc: 0.7871  acc: 0.7290    test auc: 0.7872  acc: 0.7241, time: 0.6960
epoch 14    train auc: 0.9146  acc: 0.8095    eval auc: 0.7867  acc: 0.7269    test auc: 0.7864  acc: 0.7236, time: 0.6919
epoch 15    train auc: 0.9170  acc: 0.8130    eval auc: 0.7862  acc: 0.7256    test auc: 0.7859  acc: 0.7211, time: 0.6913
epoch 16    train auc: 0.9192  acc: 0.8176    eval auc: 0.7854  acc: 0.7212    test auc: 0.7850  acc: 0.7172, time: 0.6830
epoch 17    train auc: 0.9206  acc: 0.8174    eval auc: 0.7849  acc: 0.7218    test auc: 0.7842  acc: 0.7184, time: 0.6919
epoch 18    train auc: 0.9220  acc: 0.8182    eval auc: 0.7841  acc: 0.7202    test auc: 0.7832  acc: 0.7163, time: 0.6889
epoch 19    train auc: 0.9237  acc: 0.8224    eval auc: 0.7829  acc: 0.7157    test auc: 0.7820  acc: 0.7127, time: 0.6879
epoch 20    train auc: 0.9250  acc: 0.8247    eval auc: 0.7817  acc: 0.7131    test auc: 0.7807  acc: 0.7114, time: 0.6832
epoch 21    train auc: 0.9257  acc: 0.8237    eval auc: 0.7821  acc: 0.7159    test auc: 0.7808  acc: 0.7117, time: 0.6817
epoch 22    train auc: 0.9263  acc: 0.8225    eval auc: 0.7814  acc: 0.7147    test auc: 0.7796  acc: 0.7102, time: 0.6629
epoch 23    train auc: 0.9280  acc: 0.8284    eval auc: 0.7795  acc: 0.7091    test auc: 0.7784  acc: 0.7079, time: 0.6790
epoch 24    train auc: 0.9285  acc: 0.8268    eval auc: 0.7795  acc: 0.7109    test auc: 0.7779  acc: 0.7106, time: 0.6826
epoch 25    train auc: 0.9294  acc: 0.8288    eval auc: 0.7789  acc: 0.7100    test auc: 0.7774  acc: 0.7092, time: 0.6854
epoch 26    train auc: 0.9303  acc: 0.8309    eval auc: 0.7774  acc: 0.7068    test auc: 0.7760  acc: 0.7050, time: 0.6619
epoch 27    train auc: 0.9309  acc: 0.8307    eval auc: 0.7771  acc: 0.7074    test auc: 0.7754  acc: 0.7055, time: 0.6580
epoch 28    train auc: 0.9316  acc: 0.8315    eval auc: 0.7762  acc: 0.7059    test auc: 0.7745  acc: 0.7040, time: 0.6696
epoch 29    train auc: 0.9321  acc: 0.8315    eval auc: 0.7761  acc: 0.7060    test auc: 0.7742  acc: 0.7045, time: 0.6682
epoch 30    train auc: 0.9324  acc: 0.8311    eval auc: 0.7760  acc: 0.7066    test auc: 0.7740  acc: 0.7043, time: 0.6919
epoch 31    train auc: 0.9332  acc: 0.8333    eval auc: 0.7747  acc: 0.7042    test auc: 0.7728  acc: 0.7037, time: 0.6750
epoch 32    train auc: 0.9339  acc: 0.8343    eval auc: 0.7739  acc: 0.7030    test auc: 0.7720  acc: 0.7035, time: 0.6729
epoch 33    train auc: 0.9342  acc: 0.8345    eval auc: 0.7739  acc: 0.7035    test auc: 0.7721  acc: 0.7027, time: 0.7314
epoch 34    train auc: 0.9343  acc: 0.8343    eval auc: 0.7738  acc: 0.7036    test auc: 0.7714  acc: 0.7029, time: 0.7344
epoch 35    train auc: 0.9353  acc: 0.8368    eval auc: 0.7722  acc: 0.7008    test auc: 0.7706  acc: 0.6997, time: 0.7339
epoch 36    train auc: 0.9357  acc: 0.8369    eval auc: 0.7722  acc: 0.7019    test auc: 0.7703  acc: 0.7011, time: 0.7250
epoch 37    train auc: 0.9361  acc: 0.8386    eval auc: 0.7711  acc: 0.7002    test auc: 0.7694  acc: 0.7001, time: 0.7273
epoch 38    train auc: 0.9363  acc: 0.8372    eval auc: 0.7716  acc: 0.7008    test auc: 0.7693  acc: 0.6994, time: 0.7000
epoch 39    train auc: 0.9361  acc: 0.8358    eval auc: 0.7715  acc: 0.7019    test auc: 0.7688  acc: 0.6988, time: 0.7112
epoch 40    train auc: 0.9368  acc: 0.8373    eval auc: 0.7707  acc: 0.7021    test auc: 0.7682  acc: 0.6991, time: 0.7150
epoch 41    train auc: 0.9373  acc: 0.8388    eval auc: 0.7705  acc: 0.6997    test auc: 0.7681  acc: 0.7000, time: 0.7244
epoch 42    train auc: 0.9380  acc: 0.8408    eval auc: 0.7691  acc: 0.6985    test auc: 0.7672  acc: 0.6982, time: 0.7336
epoch 43    train auc: 0.9381  acc: 0.8402    eval auc: 0.7696  acc: 0.6984    test auc: 0.7673  acc: 0.6984, time: 0.7371
epoch 44    train auc: 0.9386  acc: 0.8406    eval auc: 0.7687  acc: 0.6987    test auc: 0.7666  acc: 0.6982, time: 0.7217
epoch 45    train auc: 0.9386  acc: 0.8404    eval auc: 0.7687  acc: 0.6976    test auc: 0.7662  acc: 0.6977, time: 0.7178
epoch 46    train auc: 0.9381  acc: 0.8378    eval auc: 0.7687  acc: 0.6996    test auc: 0.7659  acc: 0.6977, time: 0.7274
epoch 47    train auc: 0.9390  acc: 0.8407    eval auc: 0.7684  acc: 0.6982    test auc: 0.7659  acc: 0.6975, time: 0.7115
epoch 48    train auc: 0.9399  acc: 0.8435    eval auc: 0.7670  acc: 0.6969    test auc: 0.7649  acc: 0.6957, time: 0.7030
epoch 49    train auc: 0.9394  acc: 0.8408    eval auc: 0.7675  acc: 0.6981    test auc: 0.7649  acc: 0.6959, time: 0.7157
avg time per epoch : 0.7020165252685547
--- 43.36662244796753 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:38:06.707896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:38:06.708236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4973  acc: 0.4993    eval auc: 0.5076  acc: 0.4986    test auc: 0.5006  acc: 0.5034, time: 0.9916
epoch 1    train auc: 0.4911  acc: 0.5022    eval auc: 0.5099  acc: 0.4978    test auc: 0.5182  acc: 0.4975, time: 0.7128
epoch 2    train auc: 0.5254  acc: 0.5141    eval auc: 0.4631  acc: 0.4775    test auc: 0.4599  acc: 0.4806, time: 0.7063
epoch 3    train auc: 0.5609  acc: 0.5333    eval auc: 0.4125  acc: 0.4527    test auc: 0.4086  acc: 0.4475, time: 0.7281
epoch 4    train auc: 0.5968  acc: 0.5664    eval auc: 0.4142  acc: 0.4396    test auc: 0.4068  acc: 0.4337, time: 0.7045
epoch 5    train auc: 0.8604  acc: 0.7781    eval auc: 0.7585  acc: 0.7255    test auc: 0.7613  acc: 0.7314, time: 0.7119
epoch 6    train auc: 0.8897  acc: 0.7976    eval auc: 0.7785  acc: 0.7225    test auc: 0.7798  acc: 0.7262, time: 0.6969
epoch 7    train auc: 0.9046  acc: 0.8035    eval auc: 0.7833  acc: 0.7258    test auc: 0.7830  acc: 0.7285, time: 0.6830
epoch 8    train auc: 0.9132  acc: 0.8105    eval auc: 0.7810  acc: 0.7179    test auc: 0.7804  acc: 0.7186, time: 0.7052
epoch 9    train auc: 0.9180  acc: 0.8079    eval auc: 0.7810  acc: 0.7210    test auc: 0.7787  acc: 0.7216, time: 0.7182
epoch 10    train auc: 0.9220  acc: 0.8119    eval auc: 0.7802  acc: 0.7179    test auc: 0.7777  acc: 0.7184, time: 0.7168
epoch 11    train auc: 0.9238  acc: 0.8109    eval auc: 0.7799  acc: 0.7171    test auc: 0.7770  acc: 0.7160, time: 0.7167
epoch 12    train auc: 0.9251  acc: 0.8092    eval auc: 0.7765  acc: 0.7145    test auc: 0.7729  acc: 0.7114, time: 0.6989
epoch 13    train auc: 0.9279  acc: 0.8155    eval auc: 0.7773  acc: 0.7148    test auc: 0.7736  acc: 0.7102, time: 0.7087
epoch 14    train auc: 0.9303  acc: 0.8191    eval auc: 0.7745  acc: 0.7095    test auc: 0.7714  acc: 0.7037, time: 0.6979
epoch 15    train auc: 0.9304  acc: 0.8163    eval auc: 0.7746  acc: 0.7104    test auc: 0.7720  acc: 0.7053, time: 0.7072
epoch 16    train auc: 0.9328  acc: 0.8226    eval auc: 0.7722  acc: 0.7039    test auc: 0.7707  acc: 0.7050, time: 0.6940
epoch 17    train auc: 0.9303  acc: 0.8139    eval auc: 0.7717  acc: 0.7069    test auc: 0.7685  acc: 0.7023, time: 0.7369
epoch 18    train auc: 0.9336  acc: 0.8217    eval auc: 0.7701  acc: 0.7029    test auc: 0.7679  acc: 0.7008, time: 0.7850
epoch 19    train auc: 0.9337  acc: 0.8213    eval auc: 0.7703  acc: 0.7039    test auc: 0.7682  acc: 0.7028, time: 0.7480
epoch 20    train auc: 0.9370  acc: 0.8290    eval auc: 0.7667  acc: 0.6954    test auc: 0.7652  acc: 0.6938, time: 0.7080
epoch 21    train auc: 0.9340  acc: 0.8206    eval auc: 0.7685  acc: 0.7022    test auc: 0.7661  acc: 0.7001, time: 0.6779
epoch 22    train auc: 0.9373  acc: 0.8285    eval auc: 0.7665  acc: 0.6962    test auc: 0.7652  acc: 0.6945, time: 0.6689
epoch 23    train auc: 0.9378  acc: 0.8295    eval auc: 0.7652  acc: 0.6949    test auc: 0.7642  acc: 0.6948, time: 0.6784
epoch 24    train auc: 0.9384  acc: 0.8292    eval auc: 0.7643  acc: 0.6930    test auc: 0.7630  acc: 0.6929, time: 0.6750
epoch 25    train auc: 0.9386  acc: 0.8297    eval auc: 0.7625  acc: 0.6918    test auc: 0.7614  acc: 0.6921, time: 0.6720
epoch 26    train auc: 0.9397  acc: 0.8305    eval auc: 0.7606  acc: 0.6872    test auc: 0.7599  acc: 0.6899, time: 0.6670
epoch 27    train auc: 0.9401  acc: 0.8310    eval auc: 0.7603  acc: 0.6867    test auc: 0.7594  acc: 0.6896, time: 0.6685
epoch 28    train auc: 0.9398  acc: 0.8297    eval auc: 0.7602  acc: 0.6891    test auc: 0.7591  acc: 0.6893, time: 0.6870
epoch 29    train auc: 0.9401  acc: 0.8296    eval auc: 0.7605  acc: 0.6898    test auc: 0.7594  acc: 0.6899, time: 0.6690
epoch 30    train auc: 0.9409  acc: 0.8319    eval auc: 0.7596  acc: 0.6867    test auc: 0.7583  acc: 0.6872, time: 0.6956
epoch 31    train auc: 0.9409  acc: 0.8299    eval auc: 0.7585  acc: 0.6874    test auc: 0.7574  acc: 0.6876, time: 0.6650
epoch 32    train auc: 0.9420  acc: 0.8317    eval auc: 0.7577  acc: 0.6854    test auc: 0.7570  acc: 0.6884, time: 0.6660
epoch 33    train auc: 0.9436  acc: 0.8357    eval auc: 0.7573  acc: 0.6846    test auc: 0.7568  acc: 0.6864, time: 0.6701
epoch 34    train auc: 0.9436  acc: 0.8334    eval auc: 0.7555  acc: 0.6857    test auc: 0.7542  acc: 0.6850, time: 0.6629
epoch 35    train auc: 0.9466  acc: 0.8410    eval auc: 0.7557  acc: 0.6826    test auc: 0.7561  acc: 0.6856, time: 0.6574
epoch 36    train auc: 0.9480  acc: 0.8421    eval auc: 0.7544  acc: 0.6826    test auc: 0.7545  acc: 0.6853, time: 0.6560
epoch 37    train auc: 0.9502  acc: 0.8456    eval auc: 0.7536  acc: 0.6812    test auc: 0.7539  acc: 0.6838, time: 0.6469
epoch 38    train auc: 0.9513  acc: 0.8471    eval auc: 0.7535  acc: 0.6827    test auc: 0.7544  acc: 0.6865, time: 0.6607
epoch 39    train auc: 0.9538  acc: 0.8513    eval auc: 0.7509  acc: 0.6800    test auc: 0.7523  acc: 0.6845, time: 0.6525
epoch 40    train auc: 0.9550  acc: 0.8531    eval auc: 0.7512  acc: 0.6845    test auc: 0.7525  acc: 0.6854, time: 0.6526
epoch 41    train auc: 0.9575  acc: 0.8571    eval auc: 0.7508  acc: 0.6856    test auc: 0.7528  acc: 0.6876, time: 0.6494
epoch 42    train auc: 0.9594  acc: 0.8613    eval auc: 0.7508  acc: 0.6885    test auc: 0.7534  acc: 0.6922, time: 0.6492
epoch 43    train auc: 0.9613  acc: 0.8643    eval auc: 0.7503  acc: 0.6917    test auc: 0.7530  acc: 0.6911, time: 0.6579
epoch 44    train auc: 0.9630  acc: 0.8672    eval auc: 0.7497  acc: 0.6913    test auc: 0.7520  acc: 0.6926, time: 0.6668
epoch 45    train auc: 0.9651  acc: 0.8711    eval auc: 0.7474  acc: 0.6892    test auc: 0.7502  acc: 0.6937, time: 0.6474
epoch 46    train auc: 0.9663  acc: 0.8731    eval auc: 0.7474  acc: 0.6932    test auc: 0.7497  acc: 0.6944, time: 0.6591
epoch 47    train auc: 0.9682  acc: 0.8773    eval auc: 0.7463  acc: 0.6906    test auc: 0.7484  acc: 0.6926, time: 0.6423
epoch 48    train auc: 0.9691  acc: 0.8791    eval auc: 0.7461  acc: 0.6905    test auc: 0.7482  acc: 0.6932, time: 0.6430
epoch 49    train auc: 0.9708  acc: 0.8839    eval auc: 0.7451  acc: 0.6889    test auc: 0.7467  acc: 0.6910, time: 0.6512
avg time per epoch : 0.6898463106155396
--- 42.82873225212097 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:38:49.495068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:38:49.495394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5201  acc: 0.5163    eval auc: 0.5070  acc: 0.5012    test auc: 0.5056  acc: 0.5029, time: 1.0314
epoch 1    train auc: 0.6173  acc: 0.5763    eval auc: 0.5701  acc: 0.5458    test auc: 0.5702  acc: 0.5474, time: 0.7445
epoch 2    train auc: 0.7478  acc: 0.6746    eval auc: 0.6840  acc: 0.6349    test auc: 0.6942  acc: 0.6451, time: 0.6819
epoch 3    train auc: 0.6983  acc: 0.6349    eval auc: 0.5743  acc: 0.5623    test auc: 0.5724  acc: 0.5615, time: 0.6949
epoch 4    train auc: 0.7383  acc: 0.6518    eval auc: 0.6105  acc: 0.5531    test auc: 0.6159  acc: 0.5498, time: 0.6449
epoch 5    train auc: 0.8040  acc: 0.7304    eval auc: 0.6784  acc: 0.6472    test auc: 0.6838  acc: 0.6506, time: 0.6370
epoch 6    train auc: 0.8486  acc: 0.7513    eval auc: 0.7263  acc: 0.7002    test auc: 0.7298  acc: 0.7063, time: 0.6443
epoch 7    train auc: 0.8743  acc: 0.7661    eval auc: 0.7574  acc: 0.7257    test auc: 0.7602  acc: 0.7310, time: 0.6694
epoch 8    train auc: 0.8846  acc: 0.7824    eval auc: 0.7700  acc: 0.7368    test auc: 0.7730  acc: 0.7380, time: 0.6440
epoch 9    train auc: 0.8904  acc: 0.7895    eval auc: 0.7759  acc: 0.7407    test auc: 0.7789  acc: 0.7398, time: 0.7079
epoch 10    train auc: 0.8948  acc: 0.7909    eval auc: 0.7798  acc: 0.7420    test auc: 0.7822  acc: 0.7422, time: 0.7107
epoch 11    train auc: 0.8979  acc: 0.7977    eval auc: 0.7815  acc: 0.7375    test auc: 0.7838  acc: 0.7350, time: 0.6869
epoch 12    train auc: 0.9008  acc: 0.8014    eval auc: 0.7826  acc: 0.7337    test auc: 0.7848  acc: 0.7316, time: 0.7205
epoch 13    train auc: 0.9035  acc: 0.8054    eval auc: 0.7833  acc: 0.7290    test auc: 0.7853  acc: 0.7284, time: 0.6907
epoch 14    train auc: 0.9060  acc: 0.8060    eval auc: 0.7843  acc: 0.7301    test auc: 0.7860  acc: 0.7296, time: 0.6900
epoch 15    train auc: 0.9080  acc: 0.8086    eval auc: 0.7847  acc: 0.7285    test auc: 0.7863  acc: 0.7294, time: 0.6821
epoch 16    train auc: 0.9096  acc: 0.8130    eval auc: 0.7848  acc: 0.7226    test auc: 0.7864  acc: 0.7218, time: 0.6728
epoch 17    train auc: 0.9114  acc: 0.8129    eval auc: 0.7857  acc: 0.7267    test auc: 0.7870  acc: 0.7257, time: 0.6833
epoch 18    train auc: 0.9129  acc: 0.8138    eval auc: 0.7858  acc: 0.7255    test auc: 0.7869  acc: 0.7249, time: 0.6709
epoch 19    train auc: 0.9142  acc: 0.8143    eval auc: 0.7858  acc: 0.7261    test auc: 0.7866  acc: 0.7254, time: 0.6660
epoch 20    train auc: 0.9154  acc: 0.8167    eval auc: 0.7852  acc: 0.7212    test auc: 0.7860  acc: 0.7211, time: 0.6550
epoch 21    train auc: 0.9165  acc: 0.8156    eval auc: 0.7861  acc: 0.7265    test auc: 0.7867  acc: 0.7256, time: 0.6800
epoch 22    train auc: 0.9175  acc: 0.8155    eval auc: 0.7862  acc: 0.7259    test auc: 0.7864  acc: 0.7246, time: 0.6690
epoch 23    train auc: 0.9183  acc: 0.8193    eval auc: 0.7846  acc: 0.7174    test auc: 0.7853  acc: 0.7187, time: 0.6706
epoch 24    train auc: 0.9193  acc: 0.8187    eval auc: 0.7852  acc: 0.7219    test auc: 0.7856  acc: 0.7211, time: 0.6868
epoch 25    train auc: 0.9199  acc: 0.8197    eval auc: 0.7850  acc: 0.7204    test auc: 0.7855  acc: 0.7200, time: 0.6601
epoch 26    train auc: 0.9207  acc: 0.8208    eval auc: 0.7843  acc: 0.7183    test auc: 0.7847  acc: 0.7183, time: 0.6634
epoch 27    train auc: 0.9214  acc: 0.8206    eval auc: 0.7840  acc: 0.7190    test auc: 0.7843  acc: 0.7178, time: 0.7201
epoch 28    train auc: 0.9221  acc: 0.8207    eval auc: 0.7838  acc: 0.7191    test auc: 0.7840  acc: 0.7174, time: 0.7145
epoch 29    train auc: 0.9225  acc: 0.8206    eval auc: 0.7839  acc: 0.7181    test auc: 0.7840  acc: 0.7174, time: 0.7129
epoch 30    train auc: 0.9231  acc: 0.8212    eval auc: 0.7840  acc: 0.7184    test auc: 0.7840  acc: 0.7185, time: 0.7070
epoch 31    train auc: 0.9238  acc: 0.8220    eval auc: 0.7835  acc: 0.7183    test auc: 0.7834  acc: 0.7179, time: 0.7247
epoch 32    train auc: 0.9243  acc: 0.8224    eval auc: 0.7831  acc: 0.7172    test auc: 0.7830  acc: 0.7164, time: 0.7090
epoch 33    train auc: 0.9246  acc: 0.8216    eval auc: 0.7833  acc: 0.7180    test auc: 0.7832  acc: 0.7168, time: 0.7225
epoch 34    train auc: 0.9251  acc: 0.8225    eval auc: 0.7833  acc: 0.7179    test auc: 0.7829  acc: 0.7173, time: 0.7040
epoch 35    train auc: 0.9252  acc: 0.8233    eval auc: 0.7821  acc: 0.7146    test auc: 0.7822  acc: 0.7135, time: 0.7135
epoch 36    train auc: 0.9257  acc: 0.8239    eval auc: 0.7823  acc: 0.7160    test auc: 0.7821  acc: 0.7145, time: 0.7038
epoch 37    train auc: 0.9261  acc: 0.8238    eval auc: 0.7817  acc: 0.7141    test auc: 0.7816  acc: 0.7137, time: 0.6919
epoch 38    train auc: 0.9266  acc: 0.8237    eval auc: 0.7821  acc: 0.7164    test auc: 0.7818  acc: 0.7145, time: 0.6947
epoch 39    train auc: 0.9270  acc: 0.8227    eval auc: 0.7822  acc: 0.7168    test auc: 0.7817  acc: 0.7143, time: 0.7102
epoch 40    train auc: 0.9273  acc: 0.8232    eval auc: 0.7823  acc: 0.7168    test auc: 0.7816  acc: 0.7137, time: 0.6960
epoch 41    train auc: 0.9274  acc: 0.8233    eval auc: 0.7822  acc: 0.7171    test auc: 0.7818  acc: 0.7139, time: 0.6962
epoch 42    train auc: 0.9279  acc: 0.8254    eval auc: 0.7812  acc: 0.7145    test auc: 0.7808  acc: 0.7131, time: 0.6882
epoch 43    train auc: 0.9279  acc: 0.8250    eval auc: 0.7814  acc: 0.7120    test auc: 0.7810  acc: 0.7132, time: 0.6809
epoch 44    train auc: 0.9283  acc: 0.8249    eval auc: 0.7814  acc: 0.7146    test auc: 0.7810  acc: 0.7135, time: 0.6936
epoch 45    train auc: 0.9286  acc: 0.8241    eval auc: 0.7815  acc: 0.7156    test auc: 0.7808  acc: 0.7144, time: 0.6650
epoch 46    train auc: 0.9289  acc: 0.8236    eval auc: 0.7816  acc: 0.7172    test auc: 0.7806  acc: 0.7166, time: 0.6934
epoch 47    train auc: 0.9290  acc: 0.8240    eval auc: 0.7816  acc: 0.7158    test auc: 0.7807  acc: 0.7153, time: 0.6857
epoch 48    train auc: 0.9293  acc: 0.8253    eval auc: 0.7808  acc: 0.7132    test auc: 0.7800  acc: 0.7134, time: 0.6743
epoch 49    train auc: 0.9293  acc: 0.8239    eval auc: 0.7816  acc: 0.7166    test auc: 0.7806  acc: 0.7171, time: 0.6800
avg time per epoch : 0.6948219299316406
--- 42.95669746398926 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:39:32.465258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:39:32.465621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4910  acc: 0.4978    eval auc: 0.5265  acc: 0.5075    test auc: 0.5102  acc: 0.5054, time: 1.0312
epoch 1    train auc: 0.7913  acc: 0.6252    eval auc: 0.7266  acc: 0.6141    test auc: 0.7442  acc: 0.6264, time: 0.7260
epoch 2    train auc: 0.8893  acc: 0.7686    eval auc: 0.7914  acc: 0.7403    test auc: 0.7952  acc: 0.7471, time: 0.7160
epoch 3    train auc: 0.9003  acc: 0.7873    eval auc: 0.7962  acc: 0.7448    test auc: 0.7967  acc: 0.7458, time: 0.7175
epoch 4    train auc: 0.9096  acc: 0.8017    eval auc: 0.7947  acc: 0.7370    test auc: 0.7936  acc: 0.7330, time: 0.7344
epoch 5    train auc: 0.9177  acc: 0.8117    eval auc: 0.7899  acc: 0.7278    test auc: 0.7876  acc: 0.7220, time: 0.7120
epoch 6    train auc: 0.9230  acc: 0.8186    eval auc: 0.7858  acc: 0.7224    test auc: 0.7828  acc: 0.7130, time: 0.7330
epoch 7    train auc: 0.9271  acc: 0.8245    eval auc: 0.7822  acc: 0.7174    test auc: 0.7796  acc: 0.7101, time: 0.7336
epoch 8    train auc: 0.9306  acc: 0.8294    eval auc: 0.7765  acc: 0.7029    test auc: 0.7739  acc: 0.6977, time: 0.7180
epoch 9    train auc: 0.9323  acc: 0.8291    eval auc: 0.7775  acc: 0.7067    test auc: 0.7742  acc: 0.7033, time: 0.7120
epoch 10    train auc: 0.9340  acc: 0.8314    eval auc: 0.7760  acc: 0.7074    test auc: 0.7729  acc: 0.7015, time: 0.6989
epoch 11    train auc: 0.9351  acc: 0.8315    eval auc: 0.7755  acc: 0.7068    test auc: 0.7719  acc: 0.7020, time: 0.7113
epoch 12    train auc: 0.9376  acc: 0.8364    eval auc: 0.7724  acc: 0.7013    test auc: 0.7691  acc: 0.6985, time: 0.6979
epoch 13    train auc: 0.9383  acc: 0.8370    eval auc: 0.7736  acc: 0.7045    test auc: 0.7698  acc: 0.7008, time: 0.7093
epoch 14    train auc: 0.9408  acc: 0.8410    eval auc: 0.7691  acc: 0.6958    test auc: 0.7666  acc: 0.6924, time: 0.6939
epoch 15    train auc: 0.9406  acc: 0.8408    eval auc: 0.7714  acc: 0.7014    test auc: 0.7686  acc: 0.7003, time: 0.7120
epoch 16    train auc: 0.9425  acc: 0.8430    eval auc: 0.7665  acc: 0.6955    test auc: 0.7646  acc: 0.6917, time: 0.6921
epoch 17    train auc: 0.9413  acc: 0.8400    eval auc: 0.7682  acc: 0.6980    test auc: 0.7646  acc: 0.6957, time: 0.7003
epoch 18    train auc: 0.9446  acc: 0.8446    eval auc: 0.7658  acc: 0.6928    test auc: 0.7630  acc: 0.6929, time: 0.7047
epoch 19    train auc: 0.9454  acc: 0.8454    eval auc: 0.7659  acc: 0.6950    test auc: 0.7635  acc: 0.6934, time: 0.6987
epoch 20    train auc: 0.9468  acc: 0.8474    eval auc: 0.7596  acc: 0.6887    test auc: 0.7580  acc: 0.6895, time: 0.6879
epoch 21    train auc: 0.9485  acc: 0.8511    eval auc: 0.7609  acc: 0.6870    test auc: 0.7596  acc: 0.6869, time: 0.6910
epoch 22    train auc: 0.9506  acc: 0.8539    eval auc: 0.7568  acc: 0.6817    test auc: 0.7559  acc: 0.6841, time: 0.6764
epoch 23    train auc: 0.9528  acc: 0.8582    eval auc: 0.7546  acc: 0.6792    test auc: 0.7539  acc: 0.6802, time: 0.6965
epoch 24    train auc: 0.9546  acc: 0.8629    eval auc: 0.7550  acc: 0.6814    test auc: 0.7545  acc: 0.6810, time: 0.6919
epoch 25    train auc: 0.9568  acc: 0.8646    eval auc: 0.7503  acc: 0.6766    test auc: 0.7498  acc: 0.6756, time: 0.6968
epoch 26    train auc: 0.9591  acc: 0.8697    eval auc: 0.7508  acc: 0.6768    test auc: 0.7505  acc: 0.6774, time: 0.6700
epoch 27    train auc: 0.9611  acc: 0.8719    eval auc: 0.7490  acc: 0.6748    test auc: 0.7490  acc: 0.6759, time: 0.6883
epoch 28    train auc: 0.9627  acc: 0.8757    eval auc: 0.7479  acc: 0.6749    test auc: 0.7481  acc: 0.6755, time: 0.6842
epoch 29    train auc: 0.9652  acc: 0.8796    eval auc: 0.7466  acc: 0.6729    test auc: 0.7473  acc: 0.6754, time: 0.6811
epoch 30    train auc: 0.9675  acc: 0.8837    eval auc: 0.7464  acc: 0.6721    test auc: 0.7470  acc: 0.6747, time: 0.6847
epoch 31    train auc: 0.9698  acc: 0.8887    eval auc: 0.7427  acc: 0.6683    test auc: 0.7432  acc: 0.6716, time: 0.6913
epoch 32    train auc: 0.9704  acc: 0.8894    eval auc: 0.7452  acc: 0.6730    test auc: 0.7458  acc: 0.6722, time: 0.6805
epoch 33    train auc: 0.9731  acc: 0.8950    eval auc: 0.7437  acc: 0.6729    test auc: 0.7443  acc: 0.6730, time: 0.6619
epoch 34    train auc: 0.9742  acc: 0.8966    eval auc: 0.7393  acc: 0.6726    test auc: 0.7388  acc: 0.6696, time: 0.6540
epoch 35    train auc: 0.9769  acc: 0.9029    eval auc: 0.7402  acc: 0.6740    test auc: 0.7400  acc: 0.6738, time: 0.6599
epoch 36    train auc: 0.9781  acc: 0.9038    eval auc: 0.7384  acc: 0.6755    test auc: 0.7372  acc: 0.6725, time: 0.6623
epoch 37    train auc: 0.9798  acc: 0.9121    eval auc: 0.7406  acc: 0.6769    test auc: 0.7396  acc: 0.6768, time: 0.6550
epoch 38    train auc: 0.9819  acc: 0.9168    eval auc: 0.7387  acc: 0.6742    test auc: 0.7377  acc: 0.6729, time: 0.6604
epoch 39    train auc: 0.9834  acc: 0.9209    eval auc: 0.7370  acc: 0.6747    test auc: 0.7360  acc: 0.6716, time: 0.6688
epoch 40    train auc: 0.9843  acc: 0.9225    eval auc: 0.7378  acc: 0.6795    test auc: 0.7359  acc: 0.6729, time: 0.6470
epoch 41    train auc: 0.9858  acc: 0.9271    eval auc: 0.7353  acc: 0.6745    test auc: 0.7333  acc: 0.6717, time: 0.6599
epoch 42    train auc: 0.9873  acc: 0.9320    eval auc: 0.7349  acc: 0.6747    test auc: 0.7322  acc: 0.6706, time: 0.6560
epoch 43    train auc: 0.9876  acc: 0.9314    eval auc: 0.7328  acc: 0.6748    test auc: 0.7305  acc: 0.6702, time: 0.6760
epoch 44    train auc: 0.9890  acc: 0.9357    eval auc: 0.7365  acc: 0.6784    test auc: 0.7337  acc: 0.6747, time: 0.7229
epoch 45    train auc: 0.9901  acc: 0.9402    eval auc: 0.7349  acc: 0.6769    test auc: 0.7316  acc: 0.6716, time: 0.7209
epoch 46    train auc: 0.9905  acc: 0.9413    eval auc: 0.7346  acc: 0.6772    test auc: 0.7313  acc: 0.6717, time: 0.7356
epoch 47    train auc: 0.9914  acc: 0.9442    eval auc: 0.7323  acc: 0.6763    test auc: 0.7289  acc: 0.6720, time: 0.7060
epoch 48    train auc: 0.9919  acc: 0.9449    eval auc: 0.7325  acc: 0.6767    test auc: 0.7291  acc: 0.6716, time: 0.7109
epoch 49    train auc: 0.9928  acc: 0.9497    eval auc: 0.7318  acc: 0.6776    test auc: 0.7279  acc: 0.6699, time: 0.7172
avg time per epoch : 0.700960283279419
--- 43.30178880691528 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:40:15.860690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:40:15.861008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5079  acc: 0.5035    eval auc: 0.4896  acc: 0.4923    test auc: 0.4868  acc: 0.4971, time: 0.9863
epoch 1    train auc: 0.5205  acc: 0.5125    eval auc: 0.4664  acc: 0.4772    test auc: 0.4720  acc: 0.4851, time: 0.6971
epoch 2    train auc: 0.5448  acc: 0.5240    eval auc: 0.4600  acc: 0.4751    test auc: 0.4662  acc: 0.4822, time: 0.6760
epoch 3    train auc: 0.5973  acc: 0.5638    eval auc: 0.4657  acc: 0.4734    test auc: 0.4703  acc: 0.4857, time: 0.6989
epoch 4    train auc: 0.6164  acc: 0.5789    eval auc: 0.4543  acc: 0.4674    test auc: 0.4568  acc: 0.4785, time: 0.6860
epoch 5    train auc: 0.6701  acc: 0.6171    eval auc: 0.4915  acc: 0.4905    test auc: 0.4971  acc: 0.4900, time: 0.6740
epoch 6    train auc: 0.7620  acc: 0.6930    eval auc: 0.5998  acc: 0.5714    test auc: 0.6103  acc: 0.5714, time: 0.6700
epoch 7    train auc: 0.8289  acc: 0.7360    eval auc: 0.6825  acc: 0.6643    test auc: 0.6933  acc: 0.6673, time: 0.6743
epoch 8    train auc: 0.8636  acc: 0.7645    eval auc: 0.7242  acc: 0.6934    test auc: 0.7325  acc: 0.6987, time: 0.6740
epoch 9    train auc: 0.8789  acc: 0.7785    eval auc: 0.7434  acc: 0.7059    test auc: 0.7495  acc: 0.7099, time: 0.6839
epoch 10    train auc: 0.8881  acc: 0.7820    eval auc: 0.7548  acc: 0.7151    test auc: 0.7589  acc: 0.7216, time: 0.6650
epoch 11    train auc: 0.8941  acc: 0.7979    eval auc: 0.7605  acc: 0.7113    test auc: 0.7636  acc: 0.7133, time: 0.6719
epoch 12    train auc: 0.8987  acc: 0.8020    eval auc: 0.7645  acc: 0.7148    test auc: 0.7667  acc: 0.7144, time: 0.6520
epoch 13    train auc: 0.9025  acc: 0.8095    eval auc: 0.7671  acc: 0.7113    test auc: 0.7685  acc: 0.7113, time: 0.6649
epoch 14    train auc: 0.9059  acc: 0.8081    eval auc: 0.7704  acc: 0.7168    test auc: 0.7710  acc: 0.7180, time: 0.6691
epoch 15    train auc: 0.9087  acc: 0.8136    eval auc: 0.7717  acc: 0.7148    test auc: 0.7719  acc: 0.7127, time: 0.6519
epoch 16    train auc: 0.9111  acc: 0.8176    eval auc: 0.7724  acc: 0.7122    test auc: 0.7722  acc: 0.7072, time: 0.6560
epoch 17    train auc: 0.9134  acc: 0.8169    eval auc: 0.7744  acc: 0.7173    test auc: 0.7736  acc: 0.7126, time: 0.6571
epoch 18    train auc: 0.9153  acc: 0.8192    eval auc: 0.7747  acc: 0.7168    test auc: 0.7736  acc: 0.7128, time: 0.6582
epoch 19    train auc: 0.9171  acc: 0.8216    eval auc: 0.7750  acc: 0.7156    test auc: 0.7734  acc: 0.7146, time: 0.6540
epoch 20    train auc: 0.9186  acc: 0.8235    eval auc: 0.7746  acc: 0.7120    test auc: 0.7728  acc: 0.7106, time: 0.6615
epoch 21    train auc: 0.9201  acc: 0.8225    eval auc: 0.7761  acc: 0.7161    test auc: 0.7740  acc: 0.7156, time: 0.6639
epoch 22    train auc: 0.9213  acc: 0.8219    eval auc: 0.7766  acc: 0.7189    test auc: 0.7742  acc: 0.7163, time: 0.6461
epoch 23    train auc: 0.9225  acc: 0.8278    eval auc: 0.7740  acc: 0.7115    test auc: 0.7718  acc: 0.7083, time: 0.6467
epoch 24    train auc: 0.9236  acc: 0.8257    eval auc: 0.7755  acc: 0.7144    test auc: 0.7729  acc: 0.7127, time: 0.6400
epoch 25    train auc: 0.9246  acc: 0.8273    eval auc: 0.7753  acc: 0.7135    test auc: 0.7728  acc: 0.7124, time: 0.6502
epoch 26    train auc: 0.9255  acc: 0.8298    eval auc: 0.7739  acc: 0.7111    test auc: 0.7713  acc: 0.7081, time: 0.6581
epoch 27    train auc: 0.9263  acc: 0.8288    eval auc: 0.7739  acc: 0.7115    test auc: 0.7711  acc: 0.7098, time: 0.6540
epoch 28    train auc: 0.9272  acc: 0.8290    eval auc: 0.7736  acc: 0.7093    test auc: 0.7708  acc: 0.7076, time: 0.6340
epoch 29    train auc: 0.9279  acc: 0.8293    eval auc: 0.7734  acc: 0.7104    test auc: 0.7706  acc: 0.7076, time: 0.6519
epoch 30    train auc: 0.9285  acc: 0.8297    eval auc: 0.7739  acc: 0.7112    test auc: 0.7711  acc: 0.7094, time: 0.6474
epoch 31    train auc: 0.9292  acc: 0.8319    eval auc: 0.7726  acc: 0.7074    test auc: 0.7698  acc: 0.7065, time: 0.6548
epoch 32    train auc: 0.9299  acc: 0.8320    eval auc: 0.7718  acc: 0.7075    test auc: 0.7691  acc: 0.7050, time: 0.6301
epoch 33    train auc: 0.9303  acc: 0.8315    eval auc: 0.7724  acc: 0.7088    test auc: 0.7697  acc: 0.7072, time: 0.6319
epoch 34    train auc: 0.9309  acc: 0.8315    eval auc: 0.7721  acc: 0.7086    test auc: 0.7692  acc: 0.7065, time: 0.6409
epoch 35    train auc: 0.9314  acc: 0.8345    eval auc: 0.7701  acc: 0.7021    test auc: 0.7675  acc: 0.7024, time: 0.6533
epoch 36    train auc: 0.9319  acc: 0.8345    eval auc: 0.7700  acc: 0.7032    test auc: 0.7674  acc: 0.7033, time: 0.6763
epoch 37    train auc: 0.9323  acc: 0.8344    eval auc: 0.7687  acc: 0.7000    test auc: 0.7662  acc: 0.7019, time: 0.6919
epoch 38    train auc: 0.9329  acc: 0.8345    eval auc: 0.7702  acc: 0.7046    test auc: 0.7674  acc: 0.7034, time: 0.7064
epoch 39    train auc: 0.9332  acc: 0.8335    eval auc: 0.7702  acc: 0.7049    test auc: 0.7674  acc: 0.7048, time: 0.6980
epoch 40    train auc: 0.9336  acc: 0.8345    eval auc: 0.7699  acc: 0.7037    test auc: 0.7671  acc: 0.7032, time: 0.6921
epoch 41    train auc: 0.9341  acc: 0.8351    eval auc: 0.7690  acc: 0.7011    test auc: 0.7665  acc: 0.7021, time: 0.7127
epoch 42    train auc: 0.9346  acc: 0.8367    eval auc: 0.7673  acc: 0.6984    test auc: 0.7649  acc: 0.6997, time: 0.7005
epoch 43    train auc: 0.9349  acc: 0.8371    eval auc: 0.7677  acc: 0.6976    test auc: 0.7654  acc: 0.7009, time: 0.6760
epoch 44    train auc: 0.9353  acc: 0.8377    eval auc: 0.7671  acc: 0.6980    test auc: 0.7648  acc: 0.6997, time: 0.6958
epoch 45    train auc: 0.9356  acc: 0.8376    eval auc: 0.7673  acc: 0.6988    test auc: 0.7649  acc: 0.7002, time: 0.6799
epoch 46    train auc: 0.9355  acc: 0.8357    eval auc: 0.7681  acc: 0.7010    test auc: 0.7654  acc: 0.7019, time: 0.6919
epoch 47    train auc: 0.9361  acc: 0.8366    eval auc: 0.7675  acc: 0.6993    test auc: 0.7651  acc: 0.7009, time: 0.6794
epoch 48    train auc: 0.9366  acc: 0.8392    eval auc: 0.7652  acc: 0.6954    test auc: 0.7629  acc: 0.6965, time: 0.6700
epoch 49    train auc: 0.9366  acc: 0.8374    eval auc: 0.7669  acc: 0.6984    test auc: 0.7645  acc: 0.6997, time: 0.6630
avg time per epoch : 0.6743804454803467
--- 41.932584285736084 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:40:57.808304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:40:57.808625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4906  acc: 0.4915    eval auc: 0.5090  acc: 0.5104    test auc: 0.5193  acc: 0.5140, time: 1.0164
epoch 1    train auc: 0.4747  acc: 0.4944    eval auc: 0.5394  acc: 0.5067    test auc: 0.5383  acc: 0.5128, time: 0.4030
epoch 2    train auc: 0.6922  acc: 0.4989    eval auc: 0.6741  acc: 0.4995    test auc: 0.6907  acc: 0.5038, time: 0.6920
epoch 3    train auc: 0.8854  acc: 0.7875    eval auc: 0.7873  acc: 0.7470    test auc: 0.7960  acc: 0.7539, time: 0.4164
epoch 4    train auc: 0.8718  acc: 0.7179    eval auc: 0.7629  acc: 0.6133    test auc: 0.7749  acc: 0.6132, time: 0.6639
epoch 5    train auc: 0.9121  acc: 0.8112    eval auc: 0.7868  acc: 0.7151    test auc: 0.7912  acc: 0.7118, time: 0.4100
epoch 6    train auc: 0.8915  acc: 0.7546    eval auc: 0.7542  acc: 0.6425    test auc: 0.7612  acc: 0.6368, time: 0.6732
epoch 7    train auc: 0.9234  acc: 0.8201    eval auc: 0.7795  acc: 0.7041    test auc: 0.7801  acc: 0.6994, time: 0.4019
epoch 8    train auc: 0.9088  acc: 0.7838    eval auc: 0.7573  acc: 0.6629    test auc: 0.7601  acc: 0.6588, time: 0.6600
epoch 9    train auc: 0.9291  acc: 0.8272    eval auc: 0.7730  acc: 0.6937    test auc: 0.7730  acc: 0.6921, time: 0.4101
epoch 10    train auc: 0.9137  acc: 0.7953    eval auc: 0.7558  acc: 0.6669    test auc: 0.7582  acc: 0.6662, time: 0.6962
epoch 11    train auc: 0.9304  acc: 0.8223    eval auc: 0.7766  acc: 0.7056    test auc: 0.7758  acc: 0.7021, time: 0.5250
epoch 12    train auc: 0.9142  acc: 0.7964    eval auc: 0.7563  acc: 0.6732    test auc: 0.7586  acc: 0.6708, time: 0.7410
epoch 13    train auc: 0.9345  acc: 0.8306    eval auc: 0.7697  acc: 0.6908    test auc: 0.7701  acc: 0.6936, time: 0.4410
epoch 14    train auc: 0.9175  acc: 0.8021    eval auc: 0.7543  acc: 0.6738    test auc: 0.7577  acc: 0.6735, time: 0.7190
epoch 15    train auc: 0.9364  acc: 0.8350    eval auc: 0.7681  acc: 0.6922    test auc: 0.7678  acc: 0.6935, time: 0.4420
epoch 16    train auc: 0.9242  acc: 0.8143    eval auc: 0.7553  acc: 0.6820    test auc: 0.7583  acc: 0.6824, time: 0.7170
epoch 17    train auc: 0.9380  acc: 0.8364    eval auc: 0.7654  acc: 0.6887    test auc: 0.7663  acc: 0.6893, time: 0.4370
epoch 18    train auc: 0.9197  acc: 0.8071    eval auc: 0.7531  acc: 0.6794    test auc: 0.7569  acc: 0.6800, time: 0.7120
epoch 19    train auc: 0.9392  acc: 0.8382    eval auc: 0.7640  acc: 0.6872    test auc: 0.7655  acc: 0.6898, time: 0.4359
epoch 20    train auc: 0.9223  acc: 0.8112    eval auc: 0.7525  acc: 0.6795    test auc: 0.7561  acc: 0.6808, time: 0.7130
epoch 21    train auc: 0.9409  acc: 0.8403    eval auc: 0.7631  acc: 0.6872    test auc: 0.7636  acc: 0.6895, time: 0.4310
epoch 22    train auc: 0.9229  acc: 0.8117    eval auc: 0.7515  acc: 0.6785    test auc: 0.7543  acc: 0.6794, time: 0.7140
epoch 23    train auc: 0.9415  acc: 0.8398    eval auc: 0.7649  acc: 0.6886    test auc: 0.7653  acc: 0.6934, time: 0.4320
epoch 24    train auc: 0.9248  acc: 0.8141    eval auc: 0.7520  acc: 0.6823    test auc: 0.7550  acc: 0.6839, time: 0.7060
epoch 25    train auc: 0.9439  acc: 0.8436    eval auc: 0.7626  acc: 0.6871    test auc: 0.7625  acc: 0.6904, time: 0.4500
epoch 26    train auc: 0.9271  acc: 0.8179    eval auc: 0.7525  acc: 0.6823    test auc: 0.7553  acc: 0.6836, time: 0.7000
epoch 27    train auc: 0.9463  acc: 0.8455    eval auc: 0.7591  acc: 0.6847    test auc: 0.7596  acc: 0.6886, time: 0.4400
epoch 28    train auc: 0.9307  acc: 0.8217    eval auc: 0.7511  acc: 0.6817    test auc: 0.7530  acc: 0.6823, time: 0.6920
epoch 29    train auc: 0.9496  acc: 0.8506    eval auc: 0.7552  acc: 0.6807    test auc: 0.7561  acc: 0.6836, time: 0.4360
epoch 30    train auc: 0.9408  acc: 0.8358    eval auc: 0.7525  acc: 0.6841    test auc: 0.7537  acc: 0.6852, time: 0.6950
epoch 31    train auc: 0.9528  acc: 0.8524    eval auc: 0.7512  acc: 0.6778    test auc: 0.7530  acc: 0.6857, time: 0.4350
epoch 32    train auc: 0.9474  acc: 0.8447    eval auc: 0.7502  acc: 0.6837    test auc: 0.7509  acc: 0.6830, time: 0.6920
epoch 33    train auc: 0.9565  acc: 0.8571    eval auc: 0.7462  acc: 0.6761    test auc: 0.7475  acc: 0.6789, time: 0.4179
epoch 34    train auc: 0.9530  acc: 0.8505    eval auc: 0.7477  acc: 0.6820    test auc: 0.7475  acc: 0.6806, time: 0.6870
epoch 35    train auc: 0.9606  acc: 0.8610    eval auc: 0.7450  acc: 0.6778    test auc: 0.7459  acc: 0.6786, time: 0.4159
epoch 36    train auc: 0.9582  acc: 0.8571    eval auc: 0.7448  acc: 0.6832    test auc: 0.7443  acc: 0.6791, time: 0.7050
epoch 37    train auc: 0.9644  acc: 0.8682    eval auc: 0.7480  acc: 0.6840    test auc: 0.7471  acc: 0.6833, time: 0.4510
epoch 38    train auc: 0.9642  acc: 0.8674    eval auc: 0.7440  acc: 0.6819    test auc: 0.7431  acc: 0.6795, time: 0.6830
epoch 39    train auc: 0.9683  acc: 0.8756    eval auc: 0.7456  acc: 0.6851    test auc: 0.7443  acc: 0.6838, time: 0.4160
epoch 40    train auc: 0.9680  acc: 0.8733    eval auc: 0.7438  acc: 0.6831    test auc: 0.7425  acc: 0.6811, time: 0.6890
epoch 41    train auc: 0.9713  acc: 0.8824    eval auc: 0.7451  acc: 0.6874    test auc: 0.7438  acc: 0.6854, time: 0.4090
epoch 42    train auc: 0.9710  acc: 0.8804    eval auc: 0.7394  acc: 0.6815    test auc: 0.7375  acc: 0.6797, time: 0.7280
epoch 43    train auc: 0.9735  acc: 0.8861    eval auc: 0.7454  acc: 0.6891    test auc: 0.7441  acc: 0.6877, time: 0.4170
epoch 44    train auc: 0.9739  acc: 0.8872    eval auc: 0.7423  acc: 0.6850    test auc: 0.7406  acc: 0.6853, time: 0.6870
epoch 45    train auc: 0.9760  acc: 0.8913    eval auc: 0.7414  acc: 0.6860    test auc: 0.7393  acc: 0.6850, time: 0.4590
epoch 46    train auc: 0.9762  acc: 0.8927    eval auc: 0.7398  acc: 0.6818    test auc: 0.7369  acc: 0.6810, time: 0.7460
epoch 47    train auc: 0.9775  acc: 0.8955    eval auc: 0.7427  acc: 0.6898    test auc: 0.7393  acc: 0.6823, time: 0.4690
epoch 48    train auc: 0.9786  acc: 0.8995    eval auc: 0.7411  acc: 0.6832    test auc: 0.7380  acc: 0.6820, time: 0.7490
epoch 49    train auc: 0.9802  acc: 0.9028    eval auc: 0.7386  acc: 0.6839    test auc: 0.7360  acc: 0.6815, time: 0.4850
avg time per epoch : 0.5752569723129273
--- 37.23847937583923 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:41:35.159548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:41:35.159935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5177  acc: 0.5083    eval auc: 0.4874  acc: 0.4994    test auc: 0.4913  acc: 0.4981, time: 1.1690
epoch 1    train auc: 0.5305  acc: 0.5172    eval auc: 0.4797  acc: 0.4956    test auc: 0.4688  acc: 0.4847, time: 0.4820
epoch 2    train auc: 0.6067  acc: 0.5132    eval auc: 0.5418  acc: 0.5089    test auc: 0.5326  acc: 0.5088, time: 0.7970
epoch 3    train auc: 0.5675  acc: 0.5052    eval auc: 0.4300  acc: 0.4944    test auc: 0.4271  acc: 0.4923, time: 0.4940
epoch 4    train auc: 0.6187  acc: 0.5348    eval auc: 0.4509  acc: 0.4934    test auc: 0.4534  acc: 0.4906, time: 0.7790
epoch 5    train auc: 0.6150  acc: 0.5569    eval auc: 0.4350  acc: 0.4652    test auc: 0.4381  acc: 0.4720, time: 0.4960
epoch 6    train auc: 0.7381  acc: 0.6700    eval auc: 0.5734  acc: 0.5421    test auc: 0.5878  acc: 0.5521, time: 0.8030
epoch 7    train auc: 0.7828  acc: 0.7087    eval auc: 0.6247  acc: 0.5975    test auc: 0.6391  acc: 0.6126, time: 0.4830
epoch 8    train auc: 0.8576  acc: 0.7380    eval auc: 0.7225  acc: 0.7069    test auc: 0.7298  acc: 0.7186, time: 0.7910
epoch 9    train auc: 0.8753  acc: 0.7729    eval auc: 0.7444  acc: 0.7212    test auc: 0.7497  acc: 0.7282, time: 0.4869
epoch 10    train auc: 0.8877  acc: 0.7778    eval auc: 0.7642  acc: 0.7368    test auc: 0.7673  acc: 0.7427, time: 0.7889
epoch 11    train auc: 0.8917  acc: 0.7828    eval auc: 0.7655  acc: 0.7359    test auc: 0.7684  acc: 0.7382, time: 0.4870
epoch 12    train auc: 0.8971  acc: 0.7836    eval auc: 0.7731  acc: 0.7401    test auc: 0.7748  acc: 0.7447, time: 0.7930
epoch 13    train auc: 0.8996  acc: 0.7981    eval auc: 0.7716  acc: 0.7302    test auc: 0.7736  acc: 0.7316, time: 0.5059
epoch 14    train auc: 0.9034  acc: 0.7958    eval auc: 0.7768  acc: 0.7379    test auc: 0.7777  acc: 0.7375, time: 0.7970
epoch 15    train auc: 0.9056  acc: 0.8061    eval auc: 0.7746  acc: 0.7242    test auc: 0.7757  acc: 0.7230, time: 0.4750
epoch 16    train auc: 0.9086  acc: 0.8009    eval auc: 0.7793  acc: 0.7350    test auc: 0.7793  acc: 0.7330, time: 0.7780
epoch 17    train auc: 0.9104  acc: 0.8138    eval auc: 0.7760  acc: 0.7148    test auc: 0.7765  acc: 0.7140, time: 0.4830
epoch 18    train auc: 0.9126  acc: 0.8076    eval auc: 0.7809  acc: 0.7301    test auc: 0.7804  acc: 0.7288, time: 0.8000
epoch 19    train auc: 0.9143  acc: 0.8144    eval auc: 0.7774  acc: 0.7156    test auc: 0.7770  acc: 0.7159, time: 0.4770
epoch 20    train auc: 0.9160  acc: 0.8110    eval auc: 0.7817  acc: 0.7274    test auc: 0.7808  acc: 0.7261, time: 0.7900
epoch 21    train auc: 0.9175  acc: 0.8175    eval auc: 0.7780  acc: 0.7146    test auc: 0.7771  acc: 0.7134, time: 0.4800
epoch 22    train auc: 0.9186  acc: 0.8128    eval auc: 0.7822  acc: 0.7268    test auc: 0.7807  acc: 0.7251, time: 0.7920
epoch 23    train auc: 0.9202  acc: 0.8208    eval auc: 0.7777  acc: 0.7118    test auc: 0.7766  acc: 0.7091, time: 0.4740
epoch 24    train auc: 0.9207  acc: 0.8154    eval auc: 0.7823  acc: 0.7236    test auc: 0.7806  acc: 0.7231, time: 0.8069
epoch 25    train auc: 0.9223  acc: 0.8212    eval auc: 0.7783  acc: 0.7121    test auc: 0.7768  acc: 0.7117, time: 0.4860
epoch 26    train auc: 0.9226  acc: 0.8188    eval auc: 0.7822  acc: 0.7224    test auc: 0.7804  acc: 0.7207, time: 0.7930
epoch 27    train auc: 0.9241  acc: 0.8218    eval auc: 0.7781  acc: 0.7131    test auc: 0.7763  acc: 0.7104, time: 0.4780
epoch 28    train auc: 0.9243  acc: 0.8201    eval auc: 0.7818  acc: 0.7207    test auc: 0.7798  acc: 0.7185, time: 0.8070
epoch 29    train auc: 0.9256  acc: 0.8228    eval auc: 0.7777  acc: 0.7122    test auc: 0.7756  acc: 0.7102, time: 0.4800
epoch 30    train auc: 0.9256  acc: 0.8214    eval auc: 0.7815  acc: 0.7194    test auc: 0.7794  acc: 0.7184, time: 0.8000
epoch 31    train auc: 0.9272  acc: 0.8262    eval auc: 0.7762  acc: 0.7093    test auc: 0.7743  acc: 0.7068, time: 0.4910
epoch 32    train auc: 0.9264  acc: 0.8192    eval auc: 0.7813  acc: 0.7218    test auc: 0.7788  acc: 0.7190, time: 0.7850
epoch 33    train auc: 0.9284  acc: 0.8277    eval auc: 0.7759  acc: 0.7060    test auc: 0.7741  acc: 0.7063, time: 0.4780
epoch 34    train auc: 0.9279  acc: 0.8238    eval auc: 0.7800  acc: 0.7160    test auc: 0.7780  acc: 0.7163, time: 0.7840
epoch 35    train auc: 0.9294  acc: 0.8298    eval auc: 0.7749  acc: 0.7047    test auc: 0.7734  acc: 0.7035, time: 0.4960
epoch 36    train auc: 0.9284  acc: 0.8222    eval auc: 0.7805  acc: 0.7178    test auc: 0.7783  acc: 0.7181, time: 0.7720
epoch 37    train auc: 0.9304  acc: 0.8311    eval auc: 0.7739  acc: 0.7035    test auc: 0.7724  acc: 0.7027, time: 0.4890
epoch 38    train auc: 0.9295  acc: 0.8252    eval auc: 0.7794  acc: 0.7153    test auc: 0.7771  acc: 0.7158, time: 0.7810
epoch 39    train auc: 0.9314  acc: 0.8326    eval auc: 0.7727  acc: 0.7007    test auc: 0.7711  acc: 0.7014, time: 0.4870
epoch 40    train auc: 0.9302  acc: 0.8259    eval auc: 0.7791  acc: 0.7145    test auc: 0.7770  acc: 0.7156, time: 0.7860
epoch 41    train auc: 0.9321  acc: 0.8323    eval auc: 0.7733  acc: 0.7016    test auc: 0.7716  acc: 0.7042, time: 0.4710
epoch 42    train auc: 0.9309  acc: 0.8258    eval auc: 0.7784  acc: 0.7131    test auc: 0.7761  acc: 0.7144, time: 0.7800
epoch 43    train auc: 0.9330  acc: 0.8330    eval auc: 0.7723  acc: 0.7008    test auc: 0.7705  acc: 0.7037, time: 0.4719
epoch 44    train auc: 0.9316  acc: 0.8265    eval auc: 0.7778  acc: 0.7125    test auc: 0.7755  acc: 0.7143, time: 0.7830
epoch 45    train auc: 0.9333  acc: 0.8310    eval auc: 0.7728  acc: 0.7045    test auc: 0.7706  acc: 0.7041, time: 0.4850
epoch 46    train auc: 0.9322  acc: 0.8277    eval auc: 0.7774  acc: 0.7120    test auc: 0.7751  acc: 0.7135, time: 0.7950
epoch 47    train auc: 0.9341  acc: 0.8334    eval auc: 0.7719  acc: 0.7026    test auc: 0.7697  acc: 0.7027, time: 0.4800
epoch 48    train auc: 0.9332  acc: 0.8301    eval auc: 0.7760  acc: 0.7085    test auc: 0.7738  acc: 0.7108, time: 0.7930
epoch 49    train auc: 0.9348  acc: 0.8341    eval auc: 0.7711  acc: 0.7022    test auc: 0.7690  acc: 0.7021, time: 0.4759
avg time per epoch : 0.6447197389602661
--- 41.62001609802246 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:42:16.895411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:42:16.895744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4926  acc: 0.4961    eval auc: 0.5162  acc: 0.5087    test auc: 0.5055  acc: 0.5030, time: 1.1670
epoch 1    train auc: 0.5141  acc: 0.5106    eval auc: 0.4733  acc: 0.4780    test auc: 0.4842  acc: 0.4903, time: 0.4769
epoch 2    train auc: 0.5521  acc: 0.5208    eval auc: 0.4286  acc: 0.4759    test auc: 0.4170  acc: 0.4618, time: 0.7610
epoch 3    train auc: 0.5789  acc: 0.5529    eval auc: 0.3843  acc: 0.4201    test auc: 0.3823  acc: 0.4212, time: 0.4709
epoch 4    train auc: 0.5887  acc: 0.5616    eval auc: 0.3728  acc: 0.4096    test auc: 0.3674  acc: 0.4057, time: 0.7700
epoch 5    train auc: 0.5920  acc: 0.5642    eval auc: 0.3678  acc: 0.4063    test auc: 0.3638  acc: 0.4010, time: 0.4699
epoch 6    train auc: 0.5936  acc: 0.5652    eval auc: 0.3655  acc: 0.4021    test auc: 0.3620  acc: 0.4023, time: 0.7620
epoch 7    train auc: 0.5945  acc: 0.5655    eval auc: 0.3648  acc: 0.4013    test auc: 0.3607  acc: 0.4023, time: 0.4640
epoch 8    train auc: 0.5951  acc: 0.5657    eval auc: 0.3641  acc: 0.4010    test auc: 0.3600  acc: 0.4018, time: 0.7550
epoch 9    train auc: 0.5955  acc: 0.5660    eval auc: 0.3638  acc: 0.4002    test auc: 0.3594  acc: 0.4019, time: 0.4670
epoch 10    train auc: 0.5958  acc: 0.5661    eval auc: 0.3635  acc: 0.4016    test auc: 0.3593  acc: 0.4002, time: 0.7650
epoch 11    train auc: 0.5961  acc: 0.5660    eval auc: 0.3634  acc: 0.4021    test auc: 0.3587  acc: 0.3998, time: 0.4530
epoch 12    train auc: 0.5962  acc: 0.5662    eval auc: 0.3632  acc: 0.4011    test auc: 0.3587  acc: 0.4003, time: 0.7630
epoch 13    train auc: 0.5964  acc: 0.5663    eval auc: 0.3633  acc: 0.4019    test auc: 0.3584  acc: 0.3992, time: 0.4770
epoch 14    train auc: 0.5964  acc: 0.5662    eval auc: 0.3634  acc: 0.4030    test auc: 0.3581  acc: 0.3983, time: 0.8330
epoch 15    train auc: 0.5965  acc: 0.5664    eval auc: 0.3633  acc: 0.4019    test auc: 0.3582  acc: 0.3989, time: 0.4670
epoch 16    train auc: 0.5966  acc: 0.5664    eval auc: 0.3632  acc: 0.4032    test auc: 0.3580  acc: 0.3976, time: 0.7750
epoch 17    train auc: 0.5967  acc: 0.5664    eval auc: 0.3632  acc: 0.4034    test auc: 0.3580  acc: 0.3973, time: 0.4660
epoch 18    train auc: 0.5967  acc: 0.5664    eval auc: 0.3631  acc: 0.4034    test auc: 0.3581  acc: 0.3976, time: 0.7590
epoch 19    train auc: 0.5968  acc: 0.5664    eval auc: 0.3631  acc: 0.4029    test auc: 0.3579  acc: 0.3979, time: 0.4720
epoch 20    train auc: 0.5968  acc: 0.5666    eval auc: 0.3631  acc: 0.4016    test auc: 0.3581  acc: 0.3987, time: 0.7630
epoch 21    train auc: 0.5969  acc: 0.5665    eval auc: 0.3635  acc: 0.4041    test auc: 0.3576  acc: 0.3964, time: 0.4690
epoch 22    train auc: 0.5969  acc: 0.5666    eval auc: 0.3633  acc: 0.4037    test auc: 0.3577  acc: 0.3964, time: 0.7640
epoch 23    train auc: 0.5969  acc: 0.5667    eval auc: 0.3633  acc: 0.4038    test auc: 0.3576  acc: 0.3962, time: 0.4750
epoch 24    train auc: 0.5969  acc: 0.5666    eval auc: 0.3632  acc: 0.4049    test auc: 0.3576  acc: 0.3952, time: 0.7610
epoch 25    train auc: 0.5969  acc: 0.5667    eval auc: 0.3633  acc: 0.4019    test auc: 0.3578  acc: 0.3980, time: 0.4820
epoch 26    train auc: 0.5970  acc: 0.5667    eval auc: 0.3633  acc: 0.4019    test auc: 0.3576  acc: 0.3980, time: 0.7430
epoch 27    train auc: 0.5970  acc: 0.5667    eval auc: 0.3632  acc: 0.4029    test auc: 0.3578  acc: 0.3971, time: 0.4549
epoch 28    train auc: 0.5970  acc: 0.5667    eval auc: 0.3631  acc: 0.4025    test auc: 0.3579  acc: 0.3973, time: 0.7450
epoch 29    train auc: 0.5970  acc: 0.5667    eval auc: 0.3633  acc: 0.4043    test auc: 0.3577  acc: 0.3957, time: 0.4610
epoch 30    train auc: 0.5970  acc: 0.5667    eval auc: 0.3636  acc: 0.4022    test auc: 0.3574  acc: 0.3978, time: 0.7520
epoch 31    train auc: 0.5970  acc: 0.5667    eval auc: 0.3635  acc: 0.4036    test auc: 0.3574  acc: 0.3963, time: 0.4550
epoch 32    train auc: 0.5970  acc: 0.5667    eval auc: 0.3637  acc: 0.4035    test auc: 0.3573  acc: 0.3964, time: 0.7310
epoch 33    train auc: 0.5971  acc: 0.5667    eval auc: 0.3637  acc: 0.4036    test auc: 0.3572  acc: 0.3963, time: 0.4440
epoch 34    train auc: 0.5971  acc: 0.5667    eval auc: 0.3635  acc: 0.4015    test auc: 0.3574  acc: 0.3984, time: 0.7500
epoch 35    train auc: 0.5971  acc: 0.5667    eval auc: 0.3631  acc: 0.4035    test auc: 0.3577  acc: 0.3964, time: 0.4470
epoch 36    train auc: 0.5971  acc: 0.5667    eval auc: 0.3632  acc: 0.4044    test auc: 0.3576  acc: 0.3954, time: 0.7230
epoch 37    train auc: 0.5971  acc: 0.5668    eval auc: 0.3634  acc: 0.4030    test auc: 0.3575  acc: 0.3966, time: 0.4480
epoch 38    train auc: 0.5971  acc: 0.5668    eval auc: 0.3636  acc: 0.4032    test auc: 0.3573  acc: 0.3964, time: 0.7350
epoch 39    train auc: 0.5971  acc: 0.5668    eval auc: 0.3636  acc: 0.4034    test auc: 0.3573  acc: 0.3963, time: 0.4510
epoch 40    train auc: 0.5971  acc: 0.5668    eval auc: 0.3632  acc: 0.4030    test auc: 0.3575  acc: 0.3966, time: 0.7310
epoch 41    train auc: 0.5971  acc: 0.5668    eval auc: 0.3635  acc: 0.4037    test auc: 0.3572  acc: 0.3958, time: 0.4400
epoch 42    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4034    test auc: 0.3575  acc: 0.3960, time: 0.7280
epoch 43    train auc: 0.5971  acc: 0.5669    eval auc: 0.3633  acc: 0.4017    test auc: 0.3574  acc: 0.3977, time: 0.4440
epoch 44    train auc: 0.5971  acc: 0.5669    eval auc: 0.3634  acc: 0.4011    test auc: 0.3574  acc: 0.3983, time: 0.7130
epoch 45    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4029    test auc: 0.3577  acc: 0.3965, time: 0.4540
epoch 46    train auc: 0.5971  acc: 0.5669    eval auc: 0.3633  acc: 0.4012    test auc: 0.3576  acc: 0.3982, time: 0.7059
epoch 47    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4012    test auc: 0.3576  acc: 0.3982, time: 0.4360
epoch 48    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4012    test auc: 0.3575  acc: 0.3982, time: 0.7090
epoch 49    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4008    test auc: 0.3577  acc: 0.3986, time: 0.4390
avg time per epoch : 0.6129477071762085
--- 39.68794631958008 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:42:56.476524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:42:56.476894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5249  acc: 0.5122    eval auc: 0.4969  acc: 0.4989    test auc: 0.5020  acc: 0.4972, time: 1.0440
epoch 1    train auc: 0.5345  acc: 0.5212    eval auc: 0.4787  acc: 0.4858    test auc: 0.4793  acc: 0.4875, time: 0.4510
epoch 2    train auc: 0.5943  acc: 0.5218    eval auc: 0.4871  acc: 0.5070    test auc: 0.4857  acc: 0.5011, time: 0.6880
epoch 3    train auc: 0.6418  acc: 0.5908    eval auc: 0.5126  acc: 0.5301    test auc: 0.5092  acc: 0.5243, time: 0.4360
epoch 4    train auc: 0.7255  acc: 0.6553    eval auc: 0.5826  acc: 0.5912    test auc: 0.5868  acc: 0.5951, time: 0.7220
epoch 5    train auc: 0.7923  acc: 0.7148    eval auc: 0.6475  acc: 0.6336    test auc: 0.6533  acc: 0.6410, time: 0.4330
epoch 6    train auc: 0.8505  acc: 0.7511    eval auc: 0.7121  acc: 0.6951    test auc: 0.7162  acc: 0.6967, time: 0.6890
epoch 7    train auc: 0.8770  acc: 0.7760    eval auc: 0.7454  acc: 0.7139    test auc: 0.7480  acc: 0.7173, time: 0.4320
epoch 8    train auc: 0.8892  acc: 0.7801    eval auc: 0.7623  acc: 0.7270    test auc: 0.7641  acc: 0.7309, time: 0.6929
epoch 9    train auc: 0.8957  acc: 0.7966    eval auc: 0.7697  acc: 0.7291    test auc: 0.7710  acc: 0.7265, time: 0.4280
epoch 10    train auc: 0.9001  acc: 0.8066    eval auc: 0.7740  acc: 0.7231    test auc: 0.7751  acc: 0.7211, time: 0.6840
epoch 11    train auc: 0.9035  acc: 0.8049    eval auc: 0.7761  acc: 0.7290    test auc: 0.7767  acc: 0.7262, time: 0.4350
epoch 12    train auc: 0.9064  acc: 0.8049    eval auc: 0.7780  acc: 0.7314    test auc: 0.7782  acc: 0.7291, time: 0.6870
epoch 13    train auc: 0.9089  acc: 0.8123    eval auc: 0.7781  acc: 0.7230    test auc: 0.7782  acc: 0.7187, time: 0.4280
epoch 14    train auc: 0.9112  acc: 0.8149    eval auc: 0.7788  acc: 0.7218    test auc: 0.7787  acc: 0.7173, time: 0.6860
epoch 15    train auc: 0.9133  acc: 0.8168    eval auc: 0.7789  acc: 0.7198    test auc: 0.7785  acc: 0.7163, time: 0.4349
epoch 16    train auc: 0.9153  acc: 0.8179    eval auc: 0.7789  acc: 0.7179    test auc: 0.7782  acc: 0.7145, time: 0.6800
epoch 17    train auc: 0.9171  acc: 0.8208    eval auc: 0.7783  acc: 0.7131    test auc: 0.7775  acc: 0.7078, time: 0.4300
epoch 18    train auc: 0.9186  acc: 0.8199    eval auc: 0.7791  acc: 0.7163    test auc: 0.7779  acc: 0.7125, time: 0.7110
epoch 19    train auc: 0.9202  acc: 0.8216    eval auc: 0.7785  acc: 0.7137    test auc: 0.7771  acc: 0.7091, time: 0.4280
epoch 20    train auc: 0.9216  acc: 0.8217    eval auc: 0.7784  acc: 0.7150    test auc: 0.7768  acc: 0.7107, time: 0.6980
epoch 21    train auc: 0.9229  acc: 0.8234    eval auc: 0.7777  acc: 0.7128    test auc: 0.7759  acc: 0.7079, time: 0.4230
epoch 22    train auc: 0.9239  acc: 0.8232    eval auc: 0.7781  acc: 0.7141    test auc: 0.7760  acc: 0.7100, time: 0.6860
epoch 23    train auc: 0.9252  acc: 0.8265    eval auc: 0.7765  acc: 0.7112    test auc: 0.7745  acc: 0.7045, time: 0.4180
epoch 24    train auc: 0.9260  acc: 0.8259    eval auc: 0.7772  acc: 0.7121    test auc: 0.7752  acc: 0.7074, time: 0.6890
epoch 25    train auc: 0.9270  acc: 0.8275    eval auc: 0.7766  acc: 0.7107    test auc: 0.7745  acc: 0.7056, time: 0.4170
epoch 26    train auc: 0.9279  acc: 0.8278    eval auc: 0.7761  acc: 0.7107    test auc: 0.7741  acc: 0.7047, time: 0.6920
epoch 27    train auc: 0.9287  acc: 0.8284    eval auc: 0.7756  acc: 0.7108    test auc: 0.7734  acc: 0.7056, time: 0.4110
epoch 28    train auc: 0.9294  acc: 0.8308    eval auc: 0.7750  acc: 0.7080    test auc: 0.7729  acc: 0.7021, time: 0.6750
epoch 29    train auc: 0.9300  acc: 0.8295    eval auc: 0.7753  acc: 0.7106    test auc: 0.7728  acc: 0.7063, time: 0.4430
epoch 30    train auc: 0.9307  acc: 0.8311    eval auc: 0.7744  acc: 0.7092    test auc: 0.7721  acc: 0.7039, time: 0.6970
epoch 31    train auc: 0.9315  acc: 0.8314    eval auc: 0.7730  acc: 0.7046    test auc: 0.7705  acc: 0.7010, time: 0.4280
epoch 32    train auc: 0.9316  acc: 0.8302    eval auc: 0.7747  acc: 0.7093    test auc: 0.7718  acc: 0.7063, time: 0.7020
epoch 33    train auc: 0.9326  acc: 0.8334    eval auc: 0.7724  acc: 0.7037    test auc: 0.7697  acc: 0.7008, time: 0.4610
epoch 34    train auc: 0.9331  acc: 0.8339    eval auc: 0.7720  acc: 0.7028    test auc: 0.7695  acc: 0.7006, time: 0.6930
epoch 35    train auc: 0.9336  acc: 0.8352    eval auc: 0.7713  acc: 0.7016    test auc: 0.7688  acc: 0.7004, time: 0.4239
epoch 36    train auc: 0.9337  acc: 0.8318    eval auc: 0.7734  acc: 0.7073    test auc: 0.7706  acc: 0.7043, time: 0.7120
epoch 37    train auc: 0.9346  acc: 0.8362    eval auc: 0.7706  acc: 0.7016    test auc: 0.7681  acc: 0.6987, time: 0.4560
epoch 38    train auc: 0.9350  acc: 0.8351    eval auc: 0.7714  acc: 0.7024    test auc: 0.7685  acc: 0.6997, time: 0.7390
epoch 39    train auc: 0.9356  acc: 0.8380    eval auc: 0.7689  acc: 0.6971    test auc: 0.7663  acc: 0.6977, time: 0.4740
epoch 40    train auc: 0.9358  acc: 0.8359    eval auc: 0.7707  acc: 0.7013    test auc: 0.7680  acc: 0.7004, time: 0.8060
epoch 41    train auc: 0.9364  acc: 0.8375    eval auc: 0.7692  acc: 0.6974    test auc: 0.7666  acc: 0.6980, time: 0.4950
epoch 42    train auc: 0.9367  acc: 0.8367    eval auc: 0.7695  acc: 0.7000    test auc: 0.7668  acc: 0.6990, time: 0.8050
epoch 43    train auc: 0.9372  acc: 0.8384    eval auc: 0.7683  acc: 0.6970    test auc: 0.7658  acc: 0.6958, time: 0.4860
epoch 44    train auc: 0.9374  acc: 0.8371    eval auc: 0.7688  acc: 0.6993    test auc: 0.7661  acc: 0.6977, time: 0.8100
epoch 45    train auc: 0.9374  acc: 0.8362    eval auc: 0.7688  acc: 0.7000    test auc: 0.7659  acc: 0.6988, time: 0.4810
epoch 46    train auc: 0.9380  acc: 0.8390    eval auc: 0.7685  acc: 0.6987    test auc: 0.7658  acc: 0.6990, time: 0.8010
epoch 47    train auc: 0.9384  acc: 0.8392    eval auc: 0.7674  acc: 0.6977    test auc: 0.7648  acc: 0.6963, time: 0.4930
epoch 48    train auc: 0.9390  acc: 0.8408    eval auc: 0.7661  acc: 0.6957    test auc: 0.7638  acc: 0.6949, time: 0.7920
epoch 49    train auc: 0.9390  acc: 0.8402    eval auc: 0.7665  acc: 0.6976    test auc: 0.7639  acc: 0.6969, time: 0.4920
avg time per epoch : 0.5883706331253051
--- 38.05603313446045 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:43:34.640468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:43:34.640798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4896  acc: 0.4935    eval auc: 0.5234  acc: 0.5152    test auc: 0.5093  acc: 0.5042, time: 1.0860
epoch 1    train auc: 0.7124  acc: 0.6666    eval auc: 0.6752  acc: 0.6490    test auc: 0.6909  acc: 0.6576, time: 0.4780
epoch 2    train auc: 0.8737  acc: 0.7445    eval auc: 0.7845  acc: 0.7193    test auc: 0.7872  acc: 0.7309, time: 0.7990
epoch 3    train auc: 0.8972  acc: 0.7931    eval auc: 0.7925  acc: 0.7505    test auc: 0.7955  acc: 0.7523, time: 0.4740
epoch 4    train auc: 0.8924  acc: 0.7629    eval auc: 0.7937  acc: 0.7296    test auc: 0.7931  acc: 0.7376, time: 0.7950
epoch 5    train auc: 0.9158  acc: 0.8135    eval auc: 0.7883  acc: 0.7222    test auc: 0.7890  acc: 0.7206, time: 0.4860
epoch 6    train auc: 0.9056  acc: 0.7762    eval auc: 0.7882  acc: 0.7235    test auc: 0.7849  acc: 0.7298, time: 0.7840
epoch 7    train auc: 0.9250  acc: 0.8221    eval auc: 0.7792  acc: 0.7045    test auc: 0.7781  acc: 0.7069, time: 0.5080
epoch 8    train auc: 0.9118  acc: 0.7827    eval auc: 0.7829  acc: 0.7158    test auc: 0.7788  acc: 0.7177, time: 0.9130
epoch 9    train auc: 0.9303  acc: 0.8282    eval auc: 0.7744  acc: 0.6988    test auc: 0.7729  acc: 0.7011, time: 0.5770
epoch 10    train auc: 0.9210  acc: 0.7988    eval auc: 0.7822  acc: 0.7177    test auc: 0.7785  acc: 0.7150, time: 0.9250
epoch 11    train auc: 0.9328  acc: 0.8278    eval auc: 0.7742  acc: 0.7055    test auc: 0.7719  acc: 0.6997, time: 0.5750
epoch 12    train auc: 0.9244  acc: 0.8045    eval auc: 0.7830  acc: 0.7180    test auc: 0.7791  acc: 0.7147, time: 0.9030
epoch 13    train auc: 0.9364  acc: 0.8345    eval auc: 0.7698  acc: 0.6958    test auc: 0.7684  acc: 0.6922, time: 0.5710
epoch 14    train auc: 0.9309  acc: 0.8159    eval auc: 0.7790  acc: 0.7139    test auc: 0.7765  acc: 0.7081, time: 0.9170
epoch 15    train auc: 0.9389  acc: 0.8370    eval auc: 0.7664  acc: 0.6948    test auc: 0.7649  acc: 0.6903, time: 0.5700
epoch 16    train auc: 0.9329  acc: 0.8191    eval auc: 0.7740  acc: 0.7088    test auc: 0.7717  acc: 0.7017, time: 0.9040
epoch 17    train auc: 0.9423  acc: 0.8419    eval auc: 0.7645  acc: 0.6911    test auc: 0.7642  acc: 0.6898, time: 0.5750
epoch 18    train auc: 0.9369  acc: 0.8287    eval auc: 0.7711  acc: 0.7048    test auc: 0.7704  acc: 0.7019, time: 0.9140
epoch 19    train auc: 0.9441  acc: 0.8440    eval auc: 0.7614  acc: 0.6891    test auc: 0.7618  acc: 0.6898, time: 0.5850
epoch 20    train auc: 0.9406  acc: 0.8358    eval auc: 0.7666  acc: 0.6991    test auc: 0.7655  acc: 0.6965, time: 0.9260
epoch 21    train auc: 0.9471  acc: 0.8503    eval auc: 0.7587  acc: 0.6844    test auc: 0.7582  acc: 0.6869, time: 0.5570
epoch 22    train auc: 0.9432  acc: 0.8397    eval auc: 0.7649  acc: 0.6961    test auc: 0.7645  acc: 0.6974, time: 0.9030
epoch 23    train auc: 0.9486  acc: 0.8501    eval auc: 0.7576  acc: 0.6866    test auc: 0.7581  acc: 0.6891, time: 0.5670
epoch 24    train auc: 0.9441  acc: 0.8399    eval auc: 0.7613  acc: 0.6924    test auc: 0.7613  acc: 0.6945, time: 0.8760
epoch 25    train auc: 0.9509  acc: 0.8536    eval auc: 0.7572  acc: 0.6839    test auc: 0.7575  acc: 0.6853, time: 0.5360
epoch 26    train auc: 0.9478  acc: 0.8454    eval auc: 0.7598  acc: 0.6890    test auc: 0.7601  acc: 0.6922, time: 0.8430
epoch 27    train auc: 0.9530  acc: 0.8560    eval auc: 0.7539  acc: 0.6818    test auc: 0.7547  acc: 0.6872, time: 0.5110
epoch 28    train auc: 0.9498  acc: 0.8478    eval auc: 0.7586  acc: 0.6889    test auc: 0.7586  acc: 0.6903, time: 0.8570
epoch 29    train auc: 0.9550  acc: 0.8581    eval auc: 0.7510  acc: 0.6801    test auc: 0.7517  acc: 0.6830, time: 0.4970
epoch 30    train auc: 0.9504  acc: 0.8474    eval auc: 0.7554  acc: 0.6856    test auc: 0.7556  acc: 0.6870, time: 0.7860
epoch 31    train auc: 0.9579  acc: 0.8614    eval auc: 0.7486  acc: 0.6780    test auc: 0.7500  acc: 0.6823, time: 0.4800
epoch 32    train auc: 0.9519  acc: 0.8486    eval auc: 0.7533  acc: 0.6854    test auc: 0.7540  acc: 0.6856, time: 0.7970
epoch 33    train auc: 0.9604  acc: 0.8641    eval auc: 0.7451  acc: 0.6751    test auc: 0.7456  acc: 0.6799, time: 0.4820
epoch 34    train auc: 0.9592  acc: 0.8609    eval auc: 0.7510  acc: 0.6802    test auc: 0.7528  acc: 0.6864, time: 0.7690
epoch 35    train auc: 0.9629  acc: 0.8675    eval auc: 0.7434  acc: 0.6741    test auc: 0.7458  acc: 0.6812, time: 0.4870
epoch 36    train auc: 0.9622  acc: 0.8676    eval auc: 0.7474  acc: 0.6774    test auc: 0.7504  acc: 0.6872, time: 0.7830
epoch 37    train auc: 0.9659  acc: 0.8729    eval auc: 0.7420  acc: 0.6767    test auc: 0.7445  acc: 0.6815, time: 0.4720
epoch 38    train auc: 0.9654  acc: 0.8744    eval auc: 0.7461  acc: 0.6762    test auc: 0.7495  acc: 0.6856, time: 0.7810
epoch 39    train auc: 0.9685  acc: 0.8787    eval auc: 0.7399  acc: 0.6758    test auc: 0.7430  acc: 0.6818, time: 0.4720
epoch 40    train auc: 0.9679  acc: 0.8816    eval auc: 0.7453  acc: 0.6762    test auc: 0.7491  acc: 0.6851, time: 0.7780
epoch 41    train auc: 0.9706  acc: 0.8842    eval auc: 0.7392  acc: 0.6723    test auc: 0.7426  acc: 0.6831, time: 0.4770
epoch 42    train auc: 0.9706  acc: 0.8842    eval auc: 0.7442  acc: 0.6811    test auc: 0.7470  acc: 0.6838, time: 0.7770
epoch 43    train auc: 0.9729  acc: 0.8893    eval auc: 0.7381  acc: 0.6712    test auc: 0.7408  acc: 0.6817, time: 0.4770
epoch 44    train auc: 0.9731  acc: 0.8909    eval auc: 0.7433  acc: 0.6824    test auc: 0.7463  acc: 0.6887, time: 0.7870
epoch 45    train auc: 0.9748  acc: 0.8959    eval auc: 0.7369  acc: 0.6747    test auc: 0.7392  acc: 0.6810, time: 0.4760
epoch 46    train auc: 0.9760  acc: 0.8972    eval auc: 0.7390  acc: 0.6774    test auc: 0.7414  acc: 0.6851, time: 0.7800
epoch 47    train auc: 0.9766  acc: 0.8989    eval auc: 0.7346  acc: 0.6719    test auc: 0.7373  acc: 0.6789, time: 0.4740
epoch 48    train auc: 0.9776  acc: 0.8995    eval auc: 0.7374  acc: 0.6784    test auc: 0.7406  acc: 0.6865, time: 0.7790
epoch 49    train auc: 0.9779  acc: 0.9016    eval auc: 0.7324  acc: 0.6727    test auc: 0.7357  acc: 0.6768, time: 0.4910
avg time per epoch : 0.6803323745727539
--- 43.97000169754028 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:44:18.641010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:44:18.641374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5398  acc: 0.5233    eval auc: 0.5365  acc: 0.5182    test auc: 0.5321  acc: 0.5184, time: 1.1270
epoch 1    train auc: 0.5790  acc: 0.5458    eval auc: 0.5186  acc: 0.5064    test auc: 0.5165  acc: 0.5064, time: 0.4950
epoch 2    train auc: 0.7796  acc: 0.5018    eval auc: 0.7452  acc: 0.4999    test auc: 0.7578  acc: 0.5053, time: 0.7760
epoch 3    train auc: 0.6824  acc: 0.6253    eval auc: 0.5548  acc: 0.5325    test auc: 0.5554  acc: 0.5347, time: 0.4750
epoch 4    train auc: 0.7913  acc: 0.7100    eval auc: 0.6620  acc: 0.6244    test auc: 0.6684  acc: 0.6330, time: 0.7710
epoch 5    train auc: 0.8010  acc: 0.7130    eval auc: 0.6628  acc: 0.6353    test auc: 0.6698  acc: 0.6442, time: 0.4680
epoch 6    train auc: 0.8599  acc: 0.7516    eval auc: 0.7305  acc: 0.7000    test auc: 0.7340  acc: 0.7058, time: 0.7980
epoch 7    train auc: 0.8676  acc: 0.7605    eval auc: 0.7358  acc: 0.6989    test auc: 0.7387  acc: 0.7043, time: 0.4810
epoch 8    train auc: 0.8858  acc: 0.7750    eval auc: 0.7629  acc: 0.7226    test auc: 0.7648  acc: 0.7278, time: 0.7700
epoch 9    train auc: 0.8881  acc: 0.7855    eval auc: 0.7614  acc: 0.7157    test auc: 0.7630  acc: 0.7192, time: 0.4620
epoch 10    train auc: 0.8961  acc: 0.8020    eval auc: 0.7754  acc: 0.7204    test auc: 0.7768  acc: 0.7205, time: 0.7790
epoch 11    train auc: 0.8971  acc: 0.7947    eval auc: 0.7722  acc: 0.7205    test auc: 0.7727  acc: 0.7223, time: 0.4740
epoch 12    train auc: 0.9018  acc: 0.8003    eval auc: 0.7818  acc: 0.7294    test auc: 0.7818  acc: 0.7295, time: 0.7660
epoch 13    train auc: 0.9032  acc: 0.8044    eval auc: 0.7781  acc: 0.7204    test auc: 0.7781  acc: 0.7198, time: 0.4630
epoch 14    train auc: 0.9061  acc: 0.8097    eval auc: 0.7849  acc: 0.7254    test auc: 0.7847  acc: 0.7230, time: 0.7590
epoch 15    train auc: 0.9076  acc: 0.8075    eval auc: 0.7815  acc: 0.7219    test auc: 0.7809  acc: 0.7224, time: 0.4730
epoch 16    train auc: 0.9097  acc: 0.8112    eval auc: 0.7866  acc: 0.7271    test auc: 0.7857  acc: 0.7248, time: 0.7559
epoch 17    train auc: 0.9111  acc: 0.8135    eval auc: 0.7831  acc: 0.7215    test auc: 0.7822  acc: 0.7189, time: 0.4670
epoch 18    train auc: 0.9126  acc: 0.8132    eval auc: 0.7876  acc: 0.7278    test auc: 0.7863  acc: 0.7257, time: 0.7530
epoch 19    train auc: 0.9141  acc: 0.8169    eval auc: 0.7838  acc: 0.7179    test auc: 0.7826  acc: 0.7158, time: 0.4650
epoch 20    train auc: 0.9152  acc: 0.8171    eval auc: 0.7878  acc: 0.7225    test auc: 0.7862  acc: 0.7220, time: 0.7400
epoch 21    train auc: 0.9165  acc: 0.8180    eval auc: 0.7838  acc: 0.7202    test auc: 0.7820  acc: 0.7173, time: 0.4570
epoch 22    train auc: 0.9173  acc: 0.8196    eval auc: 0.7879  acc: 0.7217    test auc: 0.7859  acc: 0.7174, time: 0.7520
epoch 23    train auc: 0.9187  acc: 0.8207    eval auc: 0.7835  acc: 0.7158    test auc: 0.7814  acc: 0.7127, time: 0.4440
epoch 24    train auc: 0.9191  acc: 0.8206    eval auc: 0.7878  acc: 0.7204    test auc: 0.7857  acc: 0.7166, time: 0.7480
epoch 25    train auc: 0.9206  acc: 0.8217    eval auc: 0.7835  acc: 0.7170    test auc: 0.7811  acc: 0.7127, time: 0.4570
epoch 26    train auc: 0.9207  acc: 0.8215    eval auc: 0.7878  acc: 0.7193    test auc: 0.7854  acc: 0.7172, time: 0.7390
epoch 27    train auc: 0.9224  acc: 0.8236    eval auc: 0.7829  acc: 0.7153    test auc: 0.7803  acc: 0.7105, time: 0.4430
epoch 28    train auc: 0.9221  acc: 0.8235    eval auc: 0.7871  acc: 0.7192    test auc: 0.7847  acc: 0.7135, time: 0.7390
epoch 29    train auc: 0.9237  acc: 0.8233    eval auc: 0.7826  acc: 0.7172    test auc: 0.7796  acc: 0.7118, time: 0.4420
epoch 30    train auc: 0.9233  acc: 0.8245    eval auc: 0.7867  acc: 0.7190    test auc: 0.7841  acc: 0.7122, time: 0.7420
epoch 31    train auc: 0.9252  acc: 0.8257    eval auc: 0.7813  acc: 0.7168    test auc: 0.7781  acc: 0.7089, time: 0.4450
epoch 32    train auc: 0.9245  acc: 0.8243    eval auc: 0.7865  acc: 0.7202    test auc: 0.7836  acc: 0.7161, time: 0.7490
epoch 33    train auc: 0.9264  acc: 0.8268    eval auc: 0.7811  acc: 0.7135    test auc: 0.7778  acc: 0.7072, time: 0.4460
epoch 34    train auc: 0.9255  acc: 0.8263    eval auc: 0.7854  acc: 0.7177    test auc: 0.7828  acc: 0.7115, time: 0.7340
epoch 35    train auc: 0.9275  acc: 0.8290    eval auc: 0.7804  acc: 0.7122    test auc: 0.7774  acc: 0.7054, time: 0.4470
epoch 36    train auc: 0.9263  acc: 0.8253    eval auc: 0.7858  acc: 0.7180    test auc: 0.7830  acc: 0.7140, time: 0.7189
epoch 37    train auc: 0.9285  acc: 0.8308    eval auc: 0.7788  acc: 0.7062    test auc: 0.7763  acc: 0.7026, time: 0.4380
epoch 38    train auc: 0.9273  acc: 0.8263    eval auc: 0.7848  acc: 0.7166    test auc: 0.7819  acc: 0.7131, time: 0.7120
epoch 39    train auc: 0.9296  acc: 0.8315    eval auc: 0.7781  acc: 0.7078    test auc: 0.7750  acc: 0.7030, time: 0.4450
epoch 40    train auc: 0.9279  acc: 0.8257    eval auc: 0.7848  acc: 0.7165    test auc: 0.7819  acc: 0.7147, time: 0.7010
epoch 41    train auc: 0.9303  acc: 0.8318    eval auc: 0.7778  acc: 0.7058    test auc: 0.7750  acc: 0.7021, time: 0.4320
epoch 42    train auc: 0.9287  acc: 0.8279    eval auc: 0.7839  acc: 0.7145    test auc: 0.7811  acc: 0.7131, time: 0.7170
epoch 43    train auc: 0.9311  acc: 0.8318    eval auc: 0.7771  acc: 0.7060    test auc: 0.7736  acc: 0.7036, time: 0.4309
epoch 44    train auc: 0.9294  acc: 0.8278    eval auc: 0.7834  acc: 0.7157    test auc: 0.7805  acc: 0.7133, time: 0.7020
epoch 45    train auc: 0.9315  acc: 0.8297    eval auc: 0.7770  acc: 0.7080    test auc: 0.7733  acc: 0.7042, time: 0.4220
epoch 46    train auc: 0.9298  acc: 0.8284    eval auc: 0.7827  acc: 0.7127    test auc: 0.7801  acc: 0.7115, time: 0.7050
epoch 47    train auc: 0.9324  acc: 0.8320    eval auc: 0.7761  acc: 0.7053    test auc: 0.7725  acc: 0.7021, time: 0.4320
epoch 48    train auc: 0.9307  acc: 0.8300    eval auc: 0.7815  acc: 0.7105    test auc: 0.7790  acc: 0.7096, time: 0.7070
epoch 49    train auc: 0.9332  acc: 0.8334    eval auc: 0.7752  acc: 0.7039    test auc: 0.7718  acc: 0.7015, time: 0.4300
avg time per epoch : 0.6058891677856445
--- 39.26499843597412 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:44:57.962252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:44:57.962596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5049  acc: 0.5019    eval auc: 0.5000  acc: 0.5005    test auc: 0.4878  acc: 0.4934, time: 1.0500
epoch 1    train auc: 0.7449  acc: 0.6444    eval auc: 0.7131  acc: 0.6212    test auc: 0.7349  acc: 0.6333, time: 0.4450
epoch 2    train auc: 0.8601  acc: 0.7554    eval auc: 0.7939  acc: 0.7285    test auc: 0.7969  acc: 0.7405, time: 0.7110
epoch 3    train auc: 0.8864  acc: 0.7818    eval auc: 0.8000  acc: 0.7479    test auc: 0.8004  acc: 0.7553, time: 0.4390
epoch 4    train auc: 0.8960  acc: 0.7851    eval auc: 0.8013  acc: 0.7428    test auc: 0.7992  acc: 0.7485, time: 0.7160
epoch 5    train auc: 0.9095  acc: 0.8052    eval auc: 0.7954  acc: 0.7352    test auc: 0.7928  acc: 0.7308, time: 0.4280
epoch 6    train auc: 0.9139  acc: 0.8053    eval auc: 0.7926  acc: 0.7283    test auc: 0.7879  acc: 0.7272, time: 0.6970
epoch 7    train auc: 0.9211  acc: 0.8179    eval auc: 0.7862  acc: 0.7174    test auc: 0.7816  acc: 0.7120, time: 0.4230
epoch 8    train auc: 0.9200  acc: 0.8100    eval auc: 0.7846  acc: 0.7150    test auc: 0.7791  acc: 0.7119, time: 0.6980
epoch 9    train auc: 0.9262  acc: 0.8229    eval auc: 0.7784  acc: 0.7001    test auc: 0.7748  acc: 0.6988, time: 0.4150
epoch 10    train auc: 0.9250  acc: 0.8152    eval auc: 0.7812  acc: 0.7132    test auc: 0.7762  acc: 0.7067, time: 0.7250
epoch 11    train auc: 0.9296  acc: 0.8221    eval auc: 0.7763  acc: 0.7043    test auc: 0.7716  acc: 0.7029, time: 0.4190
epoch 12    train auc: 0.9273  acc: 0.8150    eval auc: 0.7812  acc: 0.7125    test auc: 0.7761  acc: 0.7081, time: 0.6990
epoch 13    train auc: 0.9339  acc: 0.8317    eval auc: 0.7724  acc: 0.6980    test auc: 0.7685  acc: 0.6963, time: 0.4210
epoch 14    train auc: 0.9334  acc: 0.8297    eval auc: 0.7742  acc: 0.7035    test auc: 0.7707  acc: 0.7019, time: 0.6750
epoch 15    train auc: 0.9364  acc: 0.8353    eval auc: 0.7679  acc: 0.6976    test auc: 0.7644  acc: 0.6949, time: 0.4190
epoch 16    train auc: 0.9340  acc: 0.8264    eval auc: 0.7706  acc: 0.6987    test auc: 0.7668  acc: 0.7017, time: 0.7120
epoch 17    train auc: 0.9381  acc: 0.8382    eval auc: 0.7675  acc: 0.6937    test auc: 0.7642  acc: 0.6935, time: 0.4200
epoch 18    train auc: 0.9373  acc: 0.8352    eval auc: 0.7691  acc: 0.6964    test auc: 0.7663  acc: 0.6990, time: 0.6870
epoch 19    train auc: 0.9401  acc: 0.8414    eval auc: 0.7642  acc: 0.6902    test auc: 0.7615  acc: 0.6926, time: 0.4270
epoch 20    train auc: 0.9396  acc: 0.8389    eval auc: 0.7648  acc: 0.6915    test auc: 0.7620  acc: 0.6947, time: 0.6770
epoch 21    train auc: 0.9418  acc: 0.8429    eval auc: 0.7620  acc: 0.6880    test auc: 0.7597  acc: 0.6905, time: 0.4440
epoch 22    train auc: 0.9413  acc: 0.8412    eval auc: 0.7639  acc: 0.6916    test auc: 0.7609  acc: 0.6921, time: 0.7430
epoch 23    train auc: 0.9430  acc: 0.8433    eval auc: 0.7615  acc: 0.6902    test auc: 0.7592  acc: 0.6882, time: 0.4710
epoch 24    train auc: 0.9414  acc: 0.8391    eval auc: 0.7615  acc: 0.6890    test auc: 0.7590  acc: 0.6943, time: 0.7540
epoch 25    train auc: 0.9444  acc: 0.8445    eval auc: 0.7596  acc: 0.6880    test auc: 0.7572  acc: 0.6876, time: 0.4940
epoch 26    train auc: 0.9437  acc: 0.8438    eval auc: 0.7609  acc: 0.6898    test auc: 0.7588  acc: 0.6925, time: 0.8250
epoch 27    train auc: 0.9456  acc: 0.8465    eval auc: 0.7585  acc: 0.6854    test auc: 0.7566  acc: 0.6895, time: 0.4870
epoch 28    train auc: 0.9447  acc: 0.8439    eval auc: 0.7607  acc: 0.6873    test auc: 0.7584  acc: 0.6902, time: 0.7950
epoch 29    train auc: 0.9472  acc: 0.8485    eval auc: 0.7560  acc: 0.6833    test auc: 0.7531  acc: 0.6841, time: 0.4960
epoch 30    train auc: 0.9437  acc: 0.8426    eval auc: 0.7590  acc: 0.6883    test auc: 0.7557  acc: 0.6906, time: 0.7870
epoch 31    train auc: 0.9487  acc: 0.8510    eval auc: 0.7536  acc: 0.6806    test auc: 0.7520  acc: 0.6854, time: 0.4860
epoch 32    train auc: 0.9433  acc: 0.8403    eval auc: 0.7570  acc: 0.6876    test auc: 0.7546  acc: 0.6885, time: 0.7970
epoch 33    train auc: 0.9494  acc: 0.8532    eval auc: 0.7512  acc: 0.6801    test auc: 0.7493  acc: 0.6813, time: 0.4940
epoch 34    train auc: 0.9477  acc: 0.8484    eval auc: 0.7552  acc: 0.6839    test auc: 0.7538  acc: 0.6876, time: 0.7900
epoch 35    train auc: 0.9509  acc: 0.8549    eval auc: 0.7504  acc: 0.6811    test auc: 0.7489  acc: 0.6792, time: 0.4990
epoch 36    train auc: 0.9511  acc: 0.8544    eval auc: 0.7515  acc: 0.6807    test auc: 0.7508  acc: 0.6836, time: 0.8330
epoch 37    train auc: 0.9527  acc: 0.8575    eval auc: 0.7516  acc: 0.6812    test auc: 0.7504  acc: 0.6815, time: 0.5080
epoch 38    train auc: 0.9516  acc: 0.8542    eval auc: 0.7524  acc: 0.6823    test auc: 0.7513  acc: 0.6866, time: 0.9270
epoch 39    train auc: 0.9556  acc: 0.8623    eval auc: 0.7493  acc: 0.6820    test auc: 0.7492  acc: 0.6813, time: 0.5350
epoch 40    train auc: 0.9555  acc: 0.8616    eval auc: 0.7504  acc: 0.6827    test auc: 0.7513  acc: 0.6833, time: 0.7970
epoch 41    train auc: 0.9601  acc: 0.8736    eval auc: 0.7491  acc: 0.6818    test auc: 0.7498  acc: 0.6819, time: 0.4870
epoch 42    train auc: 0.9633  acc: 0.8776    eval auc: 0.7467  acc: 0.6810    test auc: 0.7473  acc: 0.6824, time: 0.8050
epoch 43    train auc: 0.9672  acc: 0.8858    eval auc: 0.7443  acc: 0.6793    test auc: 0.7448  acc: 0.6814, time: 0.4920
epoch 44    train auc: 0.9681  acc: 0.8879    eval auc: 0.7454  acc: 0.6828    test auc: 0.7460  acc: 0.6815, time: 0.8080
epoch 45    train auc: 0.9730  acc: 0.8994    eval auc: 0.7424  acc: 0.6802    test auc: 0.7422  acc: 0.6792, time: 0.4890
epoch 46    train auc: 0.9755  acc: 0.9043    eval auc: 0.7407  acc: 0.6787    test auc: 0.7411  acc: 0.6808, time: 0.8000
epoch 47    train auc: 0.9775  acc: 0.9078    eval auc: 0.7375  acc: 0.6772    test auc: 0.7378  acc: 0.6807, time: 0.4960
epoch 48    train auc: 0.9792  acc: 0.9102    eval auc: 0.7381  acc: 0.6817    test auc: 0.7370  acc: 0.6789, time: 0.8130
epoch 49    train auc: 0.9808  acc: 0.9136    eval auc: 0.7359  acc: 0.6802    test auc: 0.7352  acc: 0.6761, time: 0.4860
avg time per epoch : 0.6188187026977539
--- 40.11096405982971 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:45:38.088398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:45:38.088740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5085  acc: 0.5056    eval auc: 0.4893  acc: 0.4888    test auc: 0.4970  acc: 0.5005, time: 1.1180
epoch 1    train auc: 0.5311  acc: 0.5173    eval auc: 0.4760  acc: 0.4851    test auc: 0.4690  acc: 0.4832, time: 0.4850
epoch 2    train auc: 0.5870  acc: 0.5173    eval auc: 0.5032  acc: 0.5017    test auc: 0.4964  acc: 0.4927, time: 0.8000
epoch 3    train auc: 0.7321  acc: 0.6522    eval auc: 0.6296  acc: 0.6075    test auc: 0.6354  acc: 0.6153, time: 0.4989
epoch 4    train auc: 0.7868  acc: 0.6374    eval auc: 0.6732  acc: 0.6188    test auc: 0.6788  acc: 0.6304, time: 0.7870
epoch 5    train auc: 0.8269  acc: 0.6996    eval auc: 0.7007  acc: 0.6747    test auc: 0.7061  acc: 0.6826, time: 0.4880
epoch 6    train auc: 0.8585  acc: 0.7310    eval auc: 0.7295  acc: 0.6994    test auc: 0.7343  acc: 0.7042, time: 0.8060
epoch 7    train auc: 0.8751  acc: 0.7578    eval auc: 0.7473  acc: 0.7102    test auc: 0.7509  acc: 0.7159, time: 0.4740
epoch 8    train auc: 0.8840  acc: 0.7669    eval auc: 0.7578  acc: 0.7146    test auc: 0.7607  acc: 0.7191, time: 0.7970
epoch 9    train auc: 0.8907  acc: 0.7870    eval auc: 0.7642  acc: 0.7154    test auc: 0.7659  acc: 0.7143, time: 0.4820
epoch 10    train auc: 0.8968  acc: 0.8033    eval auc: 0.7697  acc: 0.7082    test auc: 0.7712  acc: 0.7014, time: 0.8020
epoch 11    train auc: 0.9002  acc: 0.8001    eval auc: 0.7730  acc: 0.7156    test auc: 0.7735  acc: 0.7128, time: 0.4820
epoch 12    train auc: 0.9039  acc: 0.8018    eval auc: 0.7760  acc: 0.7187    test auc: 0.7761  acc: 0.7146, time: 0.7900
epoch 13    train auc: 0.9071  acc: 0.8080    eval auc: 0.7770  acc: 0.7145    test auc: 0.7769  acc: 0.7079, time: 0.4950
epoch 14    train auc: 0.9100  acc: 0.8111    eval auc: 0.7784  acc: 0.7141    test auc: 0.7783  acc: 0.7080, time: 0.7980
epoch 15    train auc: 0.9122  acc: 0.8118    eval auc: 0.7789  acc: 0.7154    test auc: 0.7784  acc: 0.7107, time: 0.4870
epoch 16    train auc: 0.9145  acc: 0.8142    eval auc: 0.7793  acc: 0.7151    test auc: 0.7785  acc: 0.7087, time: 0.7880
epoch 17    train auc: 0.9165  acc: 0.8191    eval auc: 0.7792  acc: 0.7111    test auc: 0.7784  acc: 0.7074, time: 0.4950
epoch 18    train auc: 0.9180  acc: 0.8156    eval auc: 0.7798  acc: 0.7170    test auc: 0.7786  acc: 0.7112, time: 0.7780
epoch 19    train auc: 0.9197  acc: 0.8210    eval auc: 0.7790  acc: 0.7075    test auc: 0.7779  acc: 0.7060, time: 0.4770
epoch 20    train auc: 0.9210  acc: 0.8197    eval auc: 0.7791  acc: 0.7104    test auc: 0.7776  acc: 0.7100, time: 0.7740
epoch 21    train auc: 0.9223  acc: 0.8230    eval auc: 0.7784  acc: 0.7066    test auc: 0.7769  acc: 0.7073, time: 0.4900
epoch 22    train auc: 0.9234  acc: 0.8223    eval auc: 0.7787  acc: 0.7111    test auc: 0.7766  acc: 0.7078, time: 0.8010
epoch 23    train auc: 0.9245  acc: 0.8240    eval auc: 0.7776  acc: 0.7065    test auc: 0.7756  acc: 0.7048, time: 0.4780
epoch 24    train auc: 0.9254  acc: 0.8244    eval auc: 0.7778  acc: 0.7091    test auc: 0.7758  acc: 0.7042, time: 0.7900
epoch 25    train auc: 0.9263  acc: 0.8254    eval auc: 0.7774  acc: 0.7081    test auc: 0.7753  acc: 0.7052, time: 0.4760
epoch 26    train auc: 0.9272  acc: 0.8270    eval auc: 0.7772  acc: 0.7074    test auc: 0.7751  acc: 0.7037, time: 0.7820
epoch 27    train auc: 0.9279  acc: 0.8264    eval auc: 0.7765  acc: 0.7078    test auc: 0.7743  acc: 0.7050, time: 0.4820
epoch 28    train auc: 0.9287  acc: 0.8295    eval auc: 0.7759  acc: 0.7058    test auc: 0.7738  acc: 0.7007, time: 0.7900
epoch 29    train auc: 0.9293  acc: 0.8286    eval auc: 0.7760  acc: 0.7075    test auc: 0.7736  acc: 0.7050, time: 0.4770
epoch 30    train auc: 0.9300  acc: 0.8304    eval auc: 0.7750  acc: 0.7041    test auc: 0.7729  acc: 0.7014, time: 0.7760
epoch 31    train auc: 0.9306  acc: 0.8299    eval auc: 0.7745  acc: 0.7063    test auc: 0.7719  acc: 0.7041, time: 0.4940
epoch 32    train auc: 0.9311  acc: 0.8300    eval auc: 0.7747  acc: 0.7073    test auc: 0.7720  acc: 0.7050, time: 0.7990
epoch 33    train auc: 0.9318  acc: 0.8309    eval auc: 0.7739  acc: 0.7048    test auc: 0.7713  acc: 0.7027, time: 0.4870
epoch 34    train auc: 0.9323  acc: 0.8340    eval auc: 0.7728  acc: 0.7007    test auc: 0.7705  acc: 0.6991, time: 0.7930
epoch 35    train auc: 0.9329  acc: 0.8331    eval auc: 0.7726  acc: 0.7009    test auc: 0.7702  acc: 0.7000, time: 0.4850
epoch 36    train auc: 0.9331  acc: 0.8331    eval auc: 0.7732  acc: 0.7047    test auc: 0.7707  acc: 0.7026, time: 0.7790
epoch 37    train auc: 0.9337  acc: 0.8350    eval auc: 0.7710  acc: 0.6975    test auc: 0.7688  acc: 0.6983, time: 0.4700
epoch 38    train auc: 0.9342  acc: 0.8339    eval auc: 0.7718  acc: 0.7014    test auc: 0.7691  acc: 0.6996, time: 0.7790
epoch 39    train auc: 0.9347  acc: 0.8360    eval auc: 0.7701  acc: 0.6977    test auc: 0.7677  acc: 0.6977, time: 0.4840
epoch 40    train auc: 0.9351  acc: 0.8350    eval auc: 0.7710  acc: 0.7002    test auc: 0.7686  acc: 0.6990, time: 0.7740
epoch 41    train auc: 0.9355  acc: 0.8375    eval auc: 0.7700  acc: 0.6994    test auc: 0.7675  acc: 0.6972, time: 0.4710
epoch 42    train auc: 0.9358  acc: 0.8363    eval auc: 0.7700  acc: 0.6994    test auc: 0.7676  acc: 0.6993, time: 0.7680
epoch 43    train auc: 0.9362  acc: 0.8364    eval auc: 0.7692  acc: 0.6988    test auc: 0.7667  acc: 0.6977, time: 0.4749
epoch 44    train auc: 0.9366  acc: 0.8369    eval auc: 0.7689  acc: 0.6987    test auc: 0.7665  acc: 0.6972, time: 0.7560
epoch 45    train auc: 0.9366  acc: 0.8362    eval auc: 0.7690  acc: 0.6991    test auc: 0.7663  acc: 0.6996, time: 0.4670
epoch 46    train auc: 0.9373  acc: 0.8397    eval auc: 0.7679  acc: 0.6956    test auc: 0.7656  acc: 0.6969, time: 0.7670
epoch 47    train auc: 0.9374  acc: 0.8380    eval auc: 0.7679  acc: 0.6983    test auc: 0.7655  acc: 0.6988, time: 0.4660
epoch 48    train auc: 0.9380  acc: 0.8402    eval auc: 0.7663  acc: 0.6939    test auc: 0.7641  acc: 0.6955, time: 0.7990
epoch 49    train auc: 0.9381  acc: 0.8390    eval auc: 0.7668  acc: 0.6971    test auc: 0.7644  acc: 0.6978, time: 0.4850
avg time per epoch : 0.6408381843566895
--- 41.438963174819946 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:46:19.544770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:46:19.545112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4874  acc: 0.4964    eval auc: 0.5160  acc: 0.4996    test auc: 0.5224  acc: 0.5134, time: 0.8400
epoch 1    train auc: 0.5038  acc: 0.4965    eval auc: 0.4943  acc: 0.5045    test auc: 0.4976  acc: 0.5063, time: 0.5290
epoch 2    train auc: 0.8296  acc: 0.7033    eval auc: 0.7248  acc: 0.6897    test auc: 0.7275  acc: 0.6978, time: 0.5219
epoch 3    train auc: 0.8887  acc: 0.7749    eval auc: 0.7848  acc: 0.7463    test auc: 0.7873  acc: 0.7531, time: 0.5290
epoch 4    train auc: 0.9002  acc: 0.7905    eval auc: 0.7911  acc: 0.7499    test auc: 0.7925  acc: 0.7533, time: 0.5080
epoch 5    train auc: 0.9080  acc: 0.8014    eval auc: 0.7913  acc: 0.7376    test auc: 0.7920  acc: 0.7361, time: 0.5210
epoch 6    train auc: 0.9144  acc: 0.8082    eval auc: 0.7886  acc: 0.7283    test auc: 0.7891  acc: 0.7225, time: 0.5159
epoch 7    train auc: 0.9190  acc: 0.8111    eval auc: 0.7865  acc: 0.7270    test auc: 0.7865  acc: 0.7207, time: 0.5360
epoch 8    train auc: 0.9231  acc: 0.8181    eval auc: 0.7817  acc: 0.7156    test auc: 0.7817  acc: 0.7107, time: 0.5750
epoch 9    train auc: 0.9256  acc: 0.8198    eval auc: 0.7809  acc: 0.7173    test auc: 0.7803  acc: 0.7107, time: 0.5660
epoch 10    train auc: 0.9274  acc: 0.8199    eval auc: 0.7803  acc: 0.7170    test auc: 0.7792  acc: 0.7128, time: 0.5190
epoch 11    train auc: 0.9296  acc: 0.8247    eval auc: 0.7785  acc: 0.7131    test auc: 0.7774  acc: 0.7093, time: 0.5480
epoch 12    train auc: 0.9313  acc: 0.8257    eval auc: 0.7761  acc: 0.7107    test auc: 0.7748  acc: 0.7060, time: 0.5480
epoch 13    train auc: 0.9324  acc: 0.8275    eval auc: 0.7760  acc: 0.7108    test auc: 0.7752  acc: 0.7086, time: 0.5520
epoch 14    train auc: 0.9339  acc: 0.8305    eval auc: 0.7733  acc: 0.7047    test auc: 0.7729  acc: 0.7053, time: 0.5890
epoch 15    train auc: 0.9343  acc: 0.8298    eval auc: 0.7735  acc: 0.7069    test auc: 0.7737  acc: 0.7072, time: 0.5130
epoch 16    train auc: 0.9350  acc: 0.8293    eval auc: 0.7727  acc: 0.7048    test auc: 0.7726  acc: 0.7059, time: 0.5350
epoch 17    train auc: 0.9363  acc: 0.8316    eval auc: 0.7713  acc: 0.7040    test auc: 0.7706  acc: 0.7042, time: 0.5530
epoch 18    train auc: 0.9366  acc: 0.8313    eval auc: 0.7709  acc: 0.7043    test auc: 0.7703  acc: 0.7040, time: 0.5790
epoch 19    train auc: 0.9374  acc: 0.8331    eval auc: 0.7702  acc: 0.7028    test auc: 0.7701  acc: 0.7036, time: 0.5510
epoch 20    train auc: 0.9381  acc: 0.8336    eval auc: 0.7674  acc: 0.6987    test auc: 0.7679  acc: 0.6971, time: 0.5360
epoch 21    train auc: 0.9389  acc: 0.8346    eval auc: 0.7685  acc: 0.7019    test auc: 0.7684  acc: 0.7016, time: 0.5580
epoch 22    train auc: 0.9397  acc: 0.8356    eval auc: 0.7670  acc: 0.6991    test auc: 0.7669  acc: 0.6969, time: 0.5240
epoch 23    train auc: 0.9405  acc: 0.8364    eval auc: 0.7655  acc: 0.6972    test auc: 0.7654  acc: 0.6951, time: 0.5190
epoch 24    train auc: 0.9414  acc: 0.8374    eval auc: 0.7644  acc: 0.6958    test auc: 0.7644  acc: 0.6963, time: 0.4870
epoch 25    train auc: 0.9421  acc: 0.8385    eval auc: 0.7640  acc: 0.6974    test auc: 0.7638  acc: 0.6962, time: 0.4940
epoch 26    train auc: 0.9431  acc: 0.8396    eval auc: 0.7622  acc: 0.6949    test auc: 0.7619  acc: 0.6930, time: 0.4899
epoch 27    train auc: 0.9433  acc: 0.8393    eval auc: 0.7634  acc: 0.6964    test auc: 0.7630  acc: 0.6971, time: 0.4930
epoch 28    train auc: 0.9444  acc: 0.8408    eval auc: 0.7621  acc: 0.6957    test auc: 0.7616  acc: 0.6947, time: 0.4850
epoch 29    train auc: 0.9451  acc: 0.8418    eval auc: 0.7611  acc: 0.6935    test auc: 0.7608  acc: 0.6939, time: 0.4800
epoch 30    train auc: 0.9455  acc: 0.8423    eval auc: 0.7618  acc: 0.6962    test auc: 0.7610  acc: 0.6951, time: 0.4899
epoch 31    train auc: 0.9466  acc: 0.8436    eval auc: 0.7604  acc: 0.6963    test auc: 0.7598  acc: 0.6945, time: 0.4830
epoch 32    train auc: 0.9477  acc: 0.8451    eval auc: 0.7583  acc: 0.6936    test auc: 0.7582  acc: 0.6931, time: 0.4930
epoch 33    train auc: 0.9478  acc: 0.8444    eval auc: 0.7580  acc: 0.6923    test auc: 0.7582  acc: 0.6906, time: 0.5190
epoch 34    train auc: 0.9491  acc: 0.8472    eval auc: 0.7582  acc: 0.6949    test auc: 0.7574  acc: 0.6930, time: 0.5340
epoch 35    train auc: 0.9499  acc: 0.8482    eval auc: 0.7567  acc: 0.6929    test auc: 0.7565  acc: 0.6915, time: 0.5390
epoch 36    train auc: 0.9507  acc: 0.8495    eval auc: 0.7567  acc: 0.6936    test auc: 0.7563  acc: 0.6924, time: 0.5340
epoch 37    train auc: 0.9517  acc: 0.8509    eval auc: 0.7536  acc: 0.6892    test auc: 0.7535  acc: 0.6891, time: 0.5300
epoch 38    train auc: 0.9523  acc: 0.8515    eval auc: 0.7551  acc: 0.6921    test auc: 0.7547  acc: 0.6912, time: 0.5260
epoch 39    train auc: 0.9528  acc: 0.8530    eval auc: 0.7552  acc: 0.6938    test auc: 0.7544  acc: 0.6916, time: 0.5200
epoch 40    train auc: 0.9535  acc: 0.8541    eval auc: 0.7546  acc: 0.6929    test auc: 0.7542  acc: 0.6921, time: 0.5220
epoch 41    train auc: 0.9547  acc: 0.8563    eval auc: 0.7534  acc: 0.6915    test auc: 0.7532  acc: 0.6911, time: 0.5230
epoch 42    train auc: 0.9561  acc: 0.8583    eval auc: 0.7512  acc: 0.6895    test auc: 0.7514  acc: 0.6900, time: 0.5270
epoch 43    train auc: 0.9562  acc: 0.8577    eval auc: 0.7522  acc: 0.6916    test auc: 0.7522  acc: 0.6937, time: 0.5230
epoch 44    train auc: 0.9575  acc: 0.8593    eval auc: 0.7512  acc: 0.6906    test auc: 0.7514  acc: 0.6936, time: 0.5120
epoch 45    train auc: 0.9588  acc: 0.8603    eval auc: 0.7497  acc: 0.6900    test auc: 0.7496  acc: 0.6929, time: 0.5150
epoch 46    train auc: 0.9592  acc: 0.8615    eval auc: 0.7507  acc: 0.6912    test auc: 0.7504  acc: 0.6929, time: 0.5260
epoch 47    train auc: 0.9603  acc: 0.8635    eval auc: 0.7481  acc: 0.6900    test auc: 0.7483  acc: 0.6902, time: 0.5020
epoch 48    train auc: 0.9613  acc: 0.8636    eval auc: 0.7464  acc: 0.6882    test auc: 0.7463  acc: 0.6890, time: 0.5120
epoch 49    train auc: 0.9620  acc: 0.8651    eval auc: 0.7466  acc: 0.6890    test auc: 0.7466  acc: 0.6884, time: 0.5180
avg time per epoch : 0.5308420038223267
--- 32.57804560661316 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:46:52.177597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:46:52.177929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5630  acc: 0.5427    eval auc: 0.5441  acc: 0.5345    test auc: 0.5436  acc: 0.5295, time: 0.7940
epoch 1    train auc: 0.5816  acc: 0.5566    eval auc: 0.5567  acc: 0.5414    test auc: 0.5569  acc: 0.5377, time: 0.5280
epoch 2    train auc: 0.7531  acc: 0.6591    eval auc: 0.6671  acc: 0.6290    test auc: 0.6802  acc: 0.6299, time: 0.5079
epoch 3    train auc: 0.7050  acc: 0.6437    eval auc: 0.6376  acc: 0.6259    test auc: 0.6456  acc: 0.6268, time: 0.5050
epoch 4    train auc: 0.8238  acc: 0.7470    eval auc: 0.7528  acc: 0.7124    test auc: 0.7562  acc: 0.7170, time: 0.5120
epoch 5    train auc: 0.8262  acc: 0.7204    eval auc: 0.7399  acc: 0.6985    test auc: 0.7458  acc: 0.7083, time: 0.5180
epoch 6    train auc: 0.8440  acc: 0.7297    eval auc: 0.7534  acc: 0.7024    test auc: 0.7583  acc: 0.7112, time: 0.5000
epoch 7    train auc: 0.8571  acc: 0.7482    eval auc: 0.7668  acc: 0.7176    test auc: 0.7696  acc: 0.7251, time: 0.5020
epoch 8    train auc: 0.8661  acc: 0.7598    eval auc: 0.7766  acc: 0.7279    test auc: 0.7786  acc: 0.7329, time: 0.4900
epoch 9    train auc: 0.8718  acc: 0.7662    eval auc: 0.7823  acc: 0.7302    test auc: 0.7841  acc: 0.7379, time: 0.5179
epoch 10    train auc: 0.8758  acc: 0.7708    eval auc: 0.7858  acc: 0.7337    test auc: 0.7869  acc: 0.7411, time: 0.4920
epoch 11    train auc: 0.8785  acc: 0.7744    eval auc: 0.7880  acc: 0.7367    test auc: 0.7891  acc: 0.7432, time: 0.4860
epoch 12    train auc: 0.8807  acc: 0.7768    eval auc: 0.7894  acc: 0.7341    test auc: 0.7904  acc: 0.7434, time: 0.5010
epoch 13    train auc: 0.8823  acc: 0.7795    eval auc: 0.7904  acc: 0.7387    test auc: 0.7913  acc: 0.7409, time: 0.5040
epoch 14    train auc: 0.8841  acc: 0.7805    eval auc: 0.7912  acc: 0.7380    test auc: 0.7922  acc: 0.7418, time: 0.4969
epoch 15    train auc: 0.8853  acc: 0.7815    eval auc: 0.7917  acc: 0.7370    test auc: 0.7929  acc: 0.7399, time: 0.4950
epoch 16    train auc: 0.8865  acc: 0.7829    eval auc: 0.7923  acc: 0.7369    test auc: 0.7934  acc: 0.7387, time: 0.5020
epoch 17    train auc: 0.8877  acc: 0.7839    eval auc: 0.7928  acc: 0.7348    test auc: 0.7940  acc: 0.7380, time: 0.4980
epoch 18    train auc: 0.8890  acc: 0.7853    eval auc: 0.7933  acc: 0.7349    test auc: 0.7945  acc: 0.7354, time: 0.4839
epoch 19    train auc: 0.8903  acc: 0.7863    eval auc: 0.7938  acc: 0.7348    test auc: 0.7950  acc: 0.7343, time: 0.4900
epoch 20    train auc: 0.8917  acc: 0.7881    eval auc: 0.7943  acc: 0.7343    test auc: 0.7956  acc: 0.7318, time: 0.4930
epoch 21    train auc: 0.8929  acc: 0.7888    eval auc: 0.7947  acc: 0.7347    test auc: 0.7962  acc: 0.7315, time: 0.4970
epoch 22    train auc: 0.8944  acc: 0.7904    eval auc: 0.7952  acc: 0.7346    test auc: 0.7967  acc: 0.7309, time: 0.4799
epoch 23    train auc: 0.8953  acc: 0.7914    eval auc: 0.7953  acc: 0.7337    test auc: 0.7970  acc: 0.7262, time: 0.4900
epoch 24    train auc: 0.8971  acc: 0.7936    eval auc: 0.7961  acc: 0.7352    test auc: 0.7979  acc: 0.7291, time: 0.4920
epoch 25    train auc: 0.8984  acc: 0.7961    eval auc: 0.7965  acc: 0.7354    test auc: 0.7984  acc: 0.7289, time: 0.4850
epoch 26    train auc: 0.8994  acc: 0.7969    eval auc: 0.7964  acc: 0.7336    test auc: 0.7985  acc: 0.7277, time: 0.4879
epoch 27    train auc: 0.8998  acc: 0.7968    eval auc: 0.7961  acc: 0.7326    test auc: 0.7983  acc: 0.7255, time: 0.4740
epoch 28    train auc: 0.9011  acc: 0.7979    eval auc: 0.7966  acc: 0.7317    test auc: 0.7988  acc: 0.7261, time: 0.4670
epoch 29    train auc: 0.9020  acc: 0.7984    eval auc: 0.7967  acc: 0.7316    test auc: 0.7989  acc: 0.7258, time: 0.4820
epoch 30    train auc: 0.9028  acc: 0.7987    eval auc: 0.7967  acc: 0.7318    test auc: 0.7991  acc: 0.7263, time: 0.4859
epoch 31    train auc: 0.9042  acc: 0.8003    eval auc: 0.7974  acc: 0.7346    test auc: 0.7996  acc: 0.7281, time: 0.4690
epoch 32    train auc: 0.9045  acc: 0.8001    eval auc: 0.7971  acc: 0.7346    test auc: 0.7994  acc: 0.7274, time: 0.4810
epoch 33    train auc: 0.9049  acc: 0.8001    eval auc: 0.7969  acc: 0.7347    test auc: 0.7992  acc: 0.7270, time: 0.4819
epoch 34    train auc: 0.9055  acc: 0.8013    eval auc: 0.7969  acc: 0.7343    test auc: 0.7992  acc: 0.7275, time: 0.4779
epoch 35    train auc: 0.9053  acc: 0.8002    eval auc: 0.7961  acc: 0.7308    test auc: 0.7985  acc: 0.7223, time: 0.4720
epoch 36    train auc: 0.9060  acc: 0.8008    eval auc: 0.7963  acc: 0.7318    test auc: 0.7986  acc: 0.7242, time: 0.4710
epoch 37    train auc: 0.9060  acc: 0.8009    eval auc: 0.7959  acc: 0.7302    test auc: 0.7982  acc: 0.7220, time: 0.4800
epoch 38    train auc: 0.9069  acc: 0.8020    eval auc: 0.7962  acc: 0.7308    test auc: 0.7985  acc: 0.7244, time: 0.4989
epoch 39    train auc: 0.9074  acc: 0.8014    eval auc: 0.7963  acc: 0.7308    test auc: 0.7985  acc: 0.7250, time: 0.4610
epoch 40    train auc: 0.9078  acc: 0.8020    eval auc: 0.7962  acc: 0.7308    test auc: 0.7983  acc: 0.7241, time: 0.4760
epoch 41    train auc: 0.9078  acc: 0.8020    eval auc: 0.7957  acc: 0.7303    test auc: 0.7979  acc: 0.7233, time: 0.4770
epoch 42    train auc: 0.9081  acc: 0.8024    eval auc: 0.7954  acc: 0.7296    test auc: 0.7978  acc: 0.7212, time: 0.4919
epoch 43    train auc: 0.9077  acc: 0.8018    eval auc: 0.7947  acc: 0.7279    test auc: 0.7971  acc: 0.7197, time: 0.4730
epoch 44    train auc: 0.9086  acc: 0.8022    eval auc: 0.7951  acc: 0.7296    test auc: 0.7974  acc: 0.7212, time: 0.4760
epoch 45    train auc: 0.9090  acc: 0.8023    eval auc: 0.7951  acc: 0.7290    test auc: 0.7973  acc: 0.7213, time: 0.4717
epoch 46    train auc: 0.9090  acc: 0.8022    eval auc: 0.7948  acc: 0.7285    test auc: 0.7970  acc: 0.7197, time: 0.4849
epoch 47    train auc: 0.9090  acc: 0.8027    eval auc: 0.7943  acc: 0.7269    test auc: 0.7966  acc: 0.7189, time: 0.4650
epoch 48    train auc: 0.9092  acc: 0.8027    eval auc: 0.7941  acc: 0.7264    test auc: 0.7963  acc: 0.7190, time: 0.4690
epoch 49    train auc: 0.9099  acc: 0.8033    eval auc: 0.7944  acc: 0.7290    test auc: 0.7965  acc: 0.7199, time: 0.4640
avg time per epoch : 0.49396623611450197
--- 30.333667993545532 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:47:22.501398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:47:22.501771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4953  acc: 0.4958    eval auc: 0.5106  acc: 0.5076    test auc: 0.5034  acc: 0.5049, time: 0.8170
epoch 1    train auc: 0.4786  acc: 0.4856    eval auc: 0.5278  acc: 0.5192    test auc: 0.5365  acc: 0.5239, time: 0.5370
epoch 2    train auc: 0.5217  acc: 0.5149    eval auc: 0.4709  acc: 0.4793    test auc: 0.4636  acc: 0.4760, time: 0.5079
epoch 3    train auc: 0.5561  acc: 0.5381    eval auc: 0.4216  acc: 0.4490    test auc: 0.4105  acc: 0.4368, time: 0.5120
epoch 4    train auc: 0.5748  acc: 0.5527    eval auc: 0.3957  acc: 0.4263    test auc: 0.3826  acc: 0.4158, time: 0.4780
epoch 5    train auc: 0.5843  acc: 0.5602    eval auc: 0.3814  acc: 0.4139    test auc: 0.3705  acc: 0.4055, time: 0.5210
epoch 6    train auc: 0.5895  acc: 0.5632    eval auc: 0.3741  acc: 0.4097    test auc: 0.3636  acc: 0.4005, time: 0.5099
epoch 7    train auc: 0.5918  acc: 0.5646    eval auc: 0.3706  acc: 0.4075    test auc: 0.3610  acc: 0.3986, time: 0.4910
epoch 8    train auc: 0.5932  acc: 0.5655    eval auc: 0.3684  acc: 0.4050    test auc: 0.3599  acc: 0.3985, time: 0.5010
epoch 9    train auc: 0.5942  acc: 0.5660    eval auc: 0.3672  acc: 0.4047    test auc: 0.3590  acc: 0.3973, time: 0.5190
epoch 10    train auc: 0.5948  acc: 0.5664    eval auc: 0.3663  acc: 0.4049    test auc: 0.3583  acc: 0.3959, time: 0.5100
epoch 11    train auc: 0.5952  acc: 0.5665    eval auc: 0.3660  acc: 0.4054    test auc: 0.3579  acc: 0.3951, time: 0.4930
epoch 12    train auc: 0.5956  acc: 0.5667    eval auc: 0.3657  acc: 0.4047    test auc: 0.3574  acc: 0.3953, time: 0.4850
epoch 13    train auc: 0.5958  acc: 0.5667    eval auc: 0.3654  acc: 0.4044    test auc: 0.3572  acc: 0.3956, time: 0.5100
epoch 14    train auc: 0.5961  acc: 0.5668    eval auc: 0.3648  acc: 0.4045    test auc: 0.3573  acc: 0.3952, time: 0.4939
epoch 15    train auc: 0.5963  acc: 0.5668    eval auc: 0.3645  acc: 0.4026    test auc: 0.3573  acc: 0.3969, time: 0.4780
epoch 16    train auc: 0.5964  acc: 0.5668    eval auc: 0.3644  acc: 0.4051    test auc: 0.3570  acc: 0.3944, time: 0.4900
epoch 17    train auc: 0.5965  acc: 0.5669    eval auc: 0.3641  acc: 0.4064    test auc: 0.3571  acc: 0.3930, time: 0.4920
epoch 18    train auc: 0.5966  acc: 0.5669    eval auc: 0.3642  acc: 0.4039    test auc: 0.3570  acc: 0.3954, time: 0.5100
epoch 19    train auc: 0.5967  acc: 0.5669    eval auc: 0.3641  acc: 0.4039    test auc: 0.3569  acc: 0.3954, time: 0.4939
epoch 20    train auc: 0.5968  acc: 0.5669    eval auc: 0.3639  acc: 0.4028    test auc: 0.3570  acc: 0.3966, time: 0.5060
epoch 21    train auc: 0.5968  acc: 0.5669    eval auc: 0.3640  acc: 0.4043    test auc: 0.3568  acc: 0.3951, time: 0.4950
epoch 22    train auc: 0.5969  acc: 0.5669    eval auc: 0.3638  acc: 0.4044    test auc: 0.3570  acc: 0.3950, time: 0.5117
epoch 23    train auc: 0.5969  acc: 0.5669    eval auc: 0.3636  acc: 0.4035    test auc: 0.3572  acc: 0.3959, time: 0.5120
epoch 24    train auc: 0.5970  acc: 0.5669    eval auc: 0.3636  acc: 0.4061    test auc: 0.3570  acc: 0.3933, time: 0.4720
epoch 25    train auc: 0.5970  acc: 0.5669    eval auc: 0.3636  acc: 0.4050    test auc: 0.3570  acc: 0.3944, time: 0.4820
epoch 26    train auc: 0.5970  acc: 0.5669    eval auc: 0.3635  acc: 0.4037    test auc: 0.3570  acc: 0.3957, time: 0.5320
epoch 27    train auc: 0.5971  acc: 0.5669    eval auc: 0.3634  acc: 0.4041    test auc: 0.3571  acc: 0.3953, time: 0.4830
epoch 28    train auc: 0.5971  acc: 0.5669    eval auc: 0.3634  acc: 0.4029    test auc: 0.3571  acc: 0.3965, time: 0.4870
epoch 29    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4048    test auc: 0.3573  acc: 0.3946, time: 0.4810
epoch 30    train auc: 0.5971  acc: 0.5669    eval auc: 0.3631  acc: 0.4025    test auc: 0.3575  acc: 0.3969, time: 0.5069
epoch 31    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4004    test auc: 0.3573  acc: 0.3990, time: 0.4720
epoch 32    train auc: 0.5971  acc: 0.5669    eval auc: 0.3628  acc: 0.4009    test auc: 0.3577  acc: 0.3985, time: 0.4889
epoch 33    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4019    test auc: 0.3573  acc: 0.3974, time: 0.4760
epoch 34    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4013    test auc: 0.3573  acc: 0.3980, time: 0.4999
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3630  acc: 0.3999    test auc: 0.3575  acc: 0.3995, time: 0.4720
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4022    test auc: 0.3573  acc: 0.3972, time: 0.4970
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3630  acc: 0.4013    test auc: 0.3574  acc: 0.3980, time: 0.4950
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3630  acc: 0.4010    test auc: 0.3575  acc: 0.3984, time: 0.5250
epoch 39    train auc: 0.5972  acc: 0.5669    eval auc: 0.3627  acc: 0.4011    test auc: 0.3578  acc: 0.3983, time: 0.5260
epoch 40    train auc: 0.5972  acc: 0.5669    eval auc: 0.3627  acc: 0.4021    test auc: 0.3578  acc: 0.3973, time: 0.5330
epoch 41    train auc: 0.5972  acc: 0.5669    eval auc: 0.3628  acc: 0.4028    test auc: 0.3576  acc: 0.3966, time: 0.5340
epoch 42    train auc: 0.5972  acc: 0.5669    eval auc: 0.3628  acc: 0.4018    test auc: 0.3576  acc: 0.3976, time: 0.5350
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4016    test auc: 0.3573  acc: 0.3978, time: 0.5199
epoch 44    train auc: 0.5972  acc: 0.5669    eval auc: 0.3629  acc: 0.4010    test auc: 0.3575  acc: 0.3984, time: 0.5240
epoch 45    train auc: 0.5972  acc: 0.5669    eval auc: 0.3630  acc: 0.4019    test auc: 0.3574  acc: 0.3974, time: 0.5290
epoch 46    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4042    test auc: 0.3572  acc: 0.3952, time: 0.5320
epoch 47    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4041    test auc: 0.3572  acc: 0.3953, time: 0.5189
epoch 48    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4036    test auc: 0.3571  acc: 0.3958, time: 0.5330
epoch 49    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4056    test auc: 0.3571  acc: 0.3938, time: 0.5330
avg time per epoch : 0.5112275981903076
--- 31.294684886932373 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:47:53.868753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:47:53.869103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5137  acc: 0.5061    eval auc: 0.5000  acc: 0.5004    test auc: 0.5064  acc: 0.5003, time: 0.8380
epoch 1    train auc: 0.5435  acc: 0.5270    eval auc: 0.5110  acc: 0.5043    test auc: 0.5234  acc: 0.5172, time: 0.5390
epoch 2    train auc: 0.5983  acc: 0.5649    eval auc: 0.5351  acc: 0.5231    test auc: 0.5460  acc: 0.5313, time: 0.5500
epoch 3    train auc: 0.7225  acc: 0.6026    eval auc: 0.6333  acc: 0.5867    test auc: 0.6470  acc: 0.5944, time: 0.5300
epoch 4    train auc: 0.7930  acc: 0.6628    eval auc: 0.6860  acc: 0.6420    test auc: 0.6962  acc: 0.6545, time: 0.5330
epoch 5    train auc: 0.8340  acc: 0.6887    eval auc: 0.7181  acc: 0.6696    test auc: 0.7262  acc: 0.6825, time: 0.5410
epoch 6    train auc: 0.8644  acc: 0.7193    eval auc: 0.7486  acc: 0.6974    test auc: 0.7525  acc: 0.7070, time: 0.5430
epoch 7    train auc: 0.8797  acc: 0.7334    eval auc: 0.7667  acc: 0.7102    test auc: 0.7691  acc: 0.7217, time: 0.5420
epoch 8    train auc: 0.8878  acc: 0.7583    eval auc: 0.7762  acc: 0.7252    test auc: 0.7781  acc: 0.7389, time: 0.5240
epoch 9    train auc: 0.8924  acc: 0.7705    eval auc: 0.7805  acc: 0.7363    test auc: 0.7822  acc: 0.7448, time: 0.5390
epoch 10    train auc: 0.8958  acc: 0.7772    eval auc: 0.7828  acc: 0.7413    test auc: 0.7841  acc: 0.7475, time: 0.5320
epoch 11    train auc: 0.8987  acc: 0.7868    eval auc: 0.7840  acc: 0.7440    test auc: 0.7852  acc: 0.7485, time: 0.5340
epoch 12    train auc: 0.9013  acc: 0.7927    eval auc: 0.7844  acc: 0.7432    test auc: 0.7854  acc: 0.7444, time: 0.5280
epoch 13    train auc: 0.9038  acc: 0.8009    eval auc: 0.7845  acc: 0.7411    test auc: 0.7851  acc: 0.7367, time: 0.5369
epoch 14    train auc: 0.9059  acc: 0.7999    eval auc: 0.7843  acc: 0.7401    test auc: 0.7845  acc: 0.7355, time: 0.5410
epoch 15    train auc: 0.9080  acc: 0.8062    eval auc: 0.7839  acc: 0.7359    test auc: 0.7839  acc: 0.7276, time: 0.5240
epoch 16    train auc: 0.9102  acc: 0.8122    eval auc: 0.7834  acc: 0.7297    test auc: 0.7834  acc: 0.7197, time: 0.5270
epoch 17    train auc: 0.9119  acc: 0.8118    eval auc: 0.7834  acc: 0.7291    test auc: 0.7830  acc: 0.7215, time: 0.5340
epoch 18    train auc: 0.9136  acc: 0.8143    eval auc: 0.7829  acc: 0.7261    test auc: 0.7825  acc: 0.7187, time: 0.5370
epoch 19    train auc: 0.9152  acc: 0.8158    eval auc: 0.7824  acc: 0.7255    test auc: 0.7817  acc: 0.7173, time: 0.5350
epoch 20    train auc: 0.9167  acc: 0.8177    eval auc: 0.7818  acc: 0.7238    test auc: 0.7810  acc: 0.7130, time: 0.5180
epoch 21    train auc: 0.9179  acc: 0.8177    eval auc: 0.7819  acc: 0.7243    test auc: 0.7809  acc: 0.7163, time: 0.5240
epoch 22    train auc: 0.9191  acc: 0.8175    eval auc: 0.7814  acc: 0.7254    test auc: 0.7801  acc: 0.7164, time: 0.5380
epoch 23    train auc: 0.9205  acc: 0.8208    eval auc: 0.7805  acc: 0.7187    test auc: 0.7794  acc: 0.7098, time: 0.5360
epoch 24    train auc: 0.9214  acc: 0.8205    eval auc: 0.7802  acc: 0.7216    test auc: 0.7788  acc: 0.7133, time: 0.5360
epoch 25    train auc: 0.9225  acc: 0.8216    eval auc: 0.7798  acc: 0.7189    test auc: 0.7784  acc: 0.7131, time: 0.5160
epoch 26    train auc: 0.9235  acc: 0.8242    eval auc: 0.7786  acc: 0.7150    test auc: 0.7773  acc: 0.7073, time: 0.5260
epoch 27    train auc: 0.9244  acc: 0.8251    eval auc: 0.7782  acc: 0.7135    test auc: 0.7768  acc: 0.7075, time: 0.5310
epoch 28    train auc: 0.9252  acc: 0.8257    eval auc: 0.7778  acc: 0.7137    test auc: 0.7763  acc: 0.7068, time: 0.5190
epoch 29    train auc: 0.9258  acc: 0.8254    eval auc: 0.7775  acc: 0.7144    test auc: 0.7757  acc: 0.7083, time: 0.5350
epoch 30    train auc: 0.9265  acc: 0.8258    eval auc: 0.7772  acc: 0.7145    test auc: 0.7756  acc: 0.7088, time: 0.5330
epoch 31    train auc: 0.9271  acc: 0.8258    eval auc: 0.7768  acc: 0.7141    test auc: 0.7749  acc: 0.7087, time: 0.5280
epoch 32    train auc: 0.9279  acc: 0.8279    eval auc: 0.7760  acc: 0.7126    test auc: 0.7741  acc: 0.7075, time: 0.5320
epoch 33    train auc: 0.9284  acc: 0.8278    eval auc: 0.7759  acc: 0.7121    test auc: 0.7741  acc: 0.7083, time: 0.5330
epoch 34    train auc: 0.9289  acc: 0.8284    eval auc: 0.7755  acc: 0.7114    test auc: 0.7735  acc: 0.7088, time: 0.5390
epoch 35    train auc: 0.9296  acc: 0.8304    eval auc: 0.7745  acc: 0.7066    test auc: 0.7729  acc: 0.7032, time: 0.5330
epoch 36    train auc: 0.9301  acc: 0.8305    eval auc: 0.7743  acc: 0.7067    test auc: 0.7726  acc: 0.7037, time: 0.5290
epoch 37    train auc: 0.9305  acc: 0.8311    eval auc: 0.7739  acc: 0.7050    test auc: 0.7722  acc: 0.7023, time: 0.5300
epoch 38    train auc: 0.9309  acc: 0.8301    eval auc: 0.7739  acc: 0.7094    test auc: 0.7718  acc: 0.7040, time: 0.5390
epoch 39    train auc: 0.9314  acc: 0.8307    eval auc: 0.7733  acc: 0.7072    test auc: 0.7713  acc: 0.7039, time: 0.5330
epoch 40    train auc: 0.9316  acc: 0.8297    eval auc: 0.7731  acc: 0.7111    test auc: 0.7707  acc: 0.7053, time: 0.5200
epoch 41    train auc: 0.9321  acc: 0.8311    eval auc: 0.7732  acc: 0.7102    test auc: 0.7711  acc: 0.7049, time: 0.5240
epoch 42    train auc: 0.9327  acc: 0.8336    eval auc: 0.7714  acc: 0.7011    test auc: 0.7698  acc: 0.7003, time: 0.5209
epoch 43    train auc: 0.9330  acc: 0.8335    eval auc: 0.7714  acc: 0.7008    test auc: 0.7699  acc: 0.7002, time: 0.5340
epoch 44    train auc: 0.9333  acc: 0.8320    eval auc: 0.7719  acc: 0.7078    test auc: 0.7698  acc: 0.7023, time: 0.5250
epoch 45    train auc: 0.9336  acc: 0.8327    eval auc: 0.7715  acc: 0.7074    test auc: 0.7693  acc: 0.7019, time: 0.5280
epoch 46    train auc: 0.9341  acc: 0.8333    eval auc: 0.7709  acc: 0.7061    test auc: 0.7687  acc: 0.7007, time: 0.5269
epoch 47    train auc: 0.9344  acc: 0.8342    eval auc: 0.7706  acc: 0.7041    test auc: 0.7687  acc: 0.7004, time: 0.5140
epoch 48    train auc: 0.9348  acc: 0.8351    eval auc: 0.7699  acc: 0.7029    test auc: 0.7681  acc: 0.7007, time: 0.5250
epoch 49    train auc: 0.9347  acc: 0.8332    eval auc: 0.7705  acc: 0.7062    test auc: 0.7682  acc: 0.7014, time: 0.5230
avg time per epoch : 0.5371170139312744
--- 32.93696665763855 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:48:26.886752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:48:26.887107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5009  acc: 0.4985    eval auc: 0.4926  acc: 0.5009    test auc: 0.5039  acc: 0.5038, time: 0.8370
epoch 1    train auc: 0.4882  acc: 0.4895    eval auc: 0.5267  acc: 0.5220    test auc: 0.5135  acc: 0.5121, time: 0.5570
epoch 2    train auc: 0.6111  acc: 0.5187    eval auc: 0.4746  acc: 0.5053    test auc: 0.4814  acc: 0.5051, time: 0.5290
epoch 3    train auc: 0.8752  acc: 0.7507    eval auc: 0.7724  acc: 0.7289    test auc: 0.7753  acc: 0.7377, time: 0.5360
epoch 4    train auc: 0.8943  acc: 0.7820    eval auc: 0.7907  acc: 0.7492    test auc: 0.7929  acc: 0.7562, time: 0.5349
epoch 5    train auc: 0.9035  acc: 0.7955    eval auc: 0.7936  acc: 0.7370    test auc: 0.7947  acc: 0.7390, time: 0.5450
epoch 6    train auc: 0.9117  acc: 0.8051    eval auc: 0.7925  acc: 0.7316    test auc: 0.7923  acc: 0.7290, time: 0.5280
epoch 7    train auc: 0.9176  acc: 0.8081    eval auc: 0.7894  acc: 0.7256    test auc: 0.7887  acc: 0.7255, time: 0.5400
epoch 8    train auc: 0.9231  acc: 0.8201    eval auc: 0.7847  acc: 0.7153    test auc: 0.7839  acc: 0.7118, time: 0.5310
epoch 9    train auc: 0.9261  acc: 0.8218    eval auc: 0.7830  acc: 0.7168    test auc: 0.7815  acc: 0.7133, time: 0.5400
epoch 10    train auc: 0.9281  acc: 0.8217    eval auc: 0.7819  acc: 0.7154    test auc: 0.7803  acc: 0.7130, time: 0.5300
epoch 11    train auc: 0.9299  acc: 0.8237    eval auc: 0.7807  acc: 0.7141    test auc: 0.7787  acc: 0.7099, time: 0.5330
epoch 12    train auc: 0.9319  acc: 0.8266    eval auc: 0.7768  acc: 0.7086    test auc: 0.7744  acc: 0.7062, time: 0.5350
epoch 13    train auc: 0.9329  acc: 0.8293    eval auc: 0.7782  acc: 0.7079    test auc: 0.7760  acc: 0.7083, time: 0.5410
epoch 14    train auc: 0.9342  acc: 0.8311    eval auc: 0.7753  acc: 0.7042    test auc: 0.7741  acc: 0.7056, time: 0.5210
epoch 15    train auc: 0.9346  acc: 0.8305    eval auc: 0.7758  acc: 0.7075    test auc: 0.7744  acc: 0.7055, time: 0.5370
epoch 16    train auc: 0.9356  acc: 0.8334    eval auc: 0.7728  acc: 0.7015    test auc: 0.7721  acc: 0.7004, time: 0.5450
epoch 17    train auc: 0.9354  acc: 0.8282    eval auc: 0.7730  acc: 0.7054    test auc: 0.7709  acc: 0.7016, time: 0.5460
epoch 18    train auc: 0.9368  acc: 0.8319    eval auc: 0.7725  acc: 0.7047    test auc: 0.7712  acc: 0.7014, time: 0.5310
epoch 19    train auc: 0.9371  acc: 0.8318    eval auc: 0.7724  acc: 0.7052    test auc: 0.7710  acc: 0.7032, time: 0.5300
epoch 20    train auc: 0.9380  acc: 0.8357    eval auc: 0.7698  acc: 0.7003    test auc: 0.7688  acc: 0.6971, time: 0.5240
epoch 21    train auc: 0.9385  acc: 0.8342    eval auc: 0.7705  acc: 0.7027    test auc: 0.7689  acc: 0.7007, time: 0.5430
epoch 22    train auc: 0.9392  acc: 0.8367    eval auc: 0.7700  acc: 0.7013    test auc: 0.7686  acc: 0.6988, time: 0.5200
epoch 23    train auc: 0.9400  acc: 0.8378    eval auc: 0.7688  acc: 0.7002    test auc: 0.7673  acc: 0.6970, time: 0.5230
epoch 24    train auc: 0.9404  acc: 0.8372    eval auc: 0.7679  acc: 0.6995    test auc: 0.7662  acc: 0.6982, time: 0.5190
epoch 25    train auc: 0.9404  acc: 0.8366    eval auc: 0.7680  acc: 0.6991    test auc: 0.7664  acc: 0.6981, time: 0.5300
epoch 26    train auc: 0.9417  acc: 0.8404    eval auc: 0.7655  acc: 0.6964    test auc: 0.7637  acc: 0.6932, time: 0.5110
epoch 27    train auc: 0.9420  acc: 0.8402    eval auc: 0.7654  acc: 0.6972    test auc: 0.7635  acc: 0.6944, time: 0.5080
epoch 28    train auc: 0.9416  acc: 0.8379    eval auc: 0.7652  acc: 0.6974    test auc: 0.7629  acc: 0.6956, time: 0.5190
epoch 29    train auc: 0.9421  acc: 0.8395    eval auc: 0.7650  acc: 0.6975    test auc: 0.7627  acc: 0.6942, time: 0.5210
epoch 30    train auc: 0.9429  acc: 0.8412    eval auc: 0.7646  acc: 0.6971    test auc: 0.7620  acc: 0.6935, time: 0.5160
epoch 31    train auc: 0.9427  acc: 0.8395    eval auc: 0.7628  acc: 0.6968    test auc: 0.7600  acc: 0.6908, time: 0.5160
epoch 32    train auc: 0.9404  acc: 0.8327    eval auc: 0.7643  acc: 0.6984    test auc: 0.7616  acc: 0.6954, time: 0.5110
epoch 33    train auc: 0.9435  acc: 0.8414    eval auc: 0.7628  acc: 0.6950    test auc: 0.7608  acc: 0.6926, time: 0.5120
epoch 34    train auc: 0.9438  acc: 0.8405    eval auc: 0.7611  acc: 0.6942    test auc: 0.7581  acc: 0.6900, time: 0.5180
epoch 35    train auc: 0.9438  acc: 0.8407    eval auc: 0.7614  acc: 0.6947    test auc: 0.7592  acc: 0.6912, time: 0.5090
epoch 36    train auc: 0.9444  acc: 0.8408    eval auc: 0.7610  acc: 0.6949    test auc: 0.7583  acc: 0.6885, time: 0.5100
epoch 37    train auc: 0.9447  acc: 0.8415    eval auc: 0.7600  acc: 0.6932    test auc: 0.7577  acc: 0.6889, time: 0.5070
epoch 38    train auc: 0.9439  acc: 0.8397    eval auc: 0.7608  acc: 0.6947    test auc: 0.7585  acc: 0.6909, time: 0.5110
epoch 39    train auc: 0.9454  acc: 0.8426    eval auc: 0.7590  acc: 0.6923    test auc: 0.7570  acc: 0.6886, time: 0.5030
epoch 40    train auc: 0.9451  acc: 0.8417    eval auc: 0.7588  acc: 0.6926    test auc: 0.7568  acc: 0.6893, time: 0.5030
epoch 41    train auc: 0.9460  acc: 0.8441    eval auc: 0.7583  acc: 0.6922    test auc: 0.7569  acc: 0.6896, time: 0.5270
epoch 42    train auc: 0.9463  acc: 0.8445    eval auc: 0.7570  acc: 0.6912    test auc: 0.7553  acc: 0.6878, time: 0.5050
epoch 43    train auc: 0.9469  acc: 0.8454    eval auc: 0.7559  acc: 0.6889    test auc: 0.7550  acc: 0.6873, time: 0.5030
epoch 44    train auc: 0.9462  acc: 0.8432    eval auc: 0.7579  acc: 0.6929    test auc: 0.7565  acc: 0.6897, time: 0.4960
epoch 45    train auc: 0.9456  acc: 0.8414    eval auc: 0.7576  acc: 0.6923    test auc: 0.7558  acc: 0.6885, time: 0.4990
epoch 46    train auc: 0.9461  acc: 0.8421    eval auc: 0.7571  acc: 0.6911    test auc: 0.7557  acc: 0.6887, time: 0.4990
epoch 47    train auc: 0.9478  acc: 0.8460    eval auc: 0.7548  acc: 0.6884    test auc: 0.7538  acc: 0.6857, time: 0.4870
epoch 48    train auc: 0.9481  acc: 0.8470    eval auc: 0.7550  acc: 0.6878    test auc: 0.7545  acc: 0.6877, time: 0.4950
epoch 49    train auc: 0.9483  acc: 0.8465    eval auc: 0.7545  acc: 0.6874    test auc: 0.7540  acc: 0.6872, time: 0.5060
avg time per epoch : 0.5275382661819458
--- 32.32202410697937 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:48:59.132197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:48:59.132521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5603  acc: 0.5393    eval auc: 0.5305  acc: 0.5234    test auc: 0.5429  acc: 0.5329, time: 0.7860
epoch 1    train auc: 0.6324  acc: 0.5966    eval auc: 0.5658  acc: 0.5646    test auc: 0.5792  acc: 0.5724, time: 0.4879
epoch 2    train auc: 0.7396  acc: 0.6674    eval auc: 0.7059  acc: 0.6497    test auc: 0.7166  acc: 0.6628, time: 0.4830
epoch 3    train auc: 0.8494  acc: 0.7710    eval auc: 0.7650  acc: 0.7339    test auc: 0.7779  acc: 0.7388, time: 0.4870
epoch 4    train auc: 0.8547  acc: 0.7514    eval auc: 0.7614  acc: 0.7296    test auc: 0.7714  acc: 0.7321, time: 0.4980
epoch 5    train auc: 0.8658  acc: 0.7322    eval auc: 0.7678  acc: 0.7104    test auc: 0.7762  acc: 0.7198, time: 0.4750
epoch 6    train auc: 0.8772  acc: 0.7433    eval auc: 0.7796  acc: 0.7217    test auc: 0.7870  acc: 0.7287, time: 0.4900
epoch 7    train auc: 0.8836  acc: 0.7645    eval auc: 0.7866  acc: 0.7400    test auc: 0.7938  acc: 0.7455, time: 0.4809
epoch 8    train auc: 0.8876  acc: 0.7738    eval auc: 0.7897  acc: 0.7465    test auc: 0.7964  acc: 0.7510, time: 0.4929
epoch 9    train auc: 0.8909  acc: 0.7797    eval auc: 0.7914  acc: 0.7490    test auc: 0.7976  acc: 0.7531, time: 0.4950
epoch 10    train auc: 0.8937  acc: 0.7834    eval auc: 0.7929  acc: 0.7505    test auc: 0.7984  acc: 0.7563, time: 0.4770
epoch 11    train auc: 0.8960  acc: 0.7870    eval auc: 0.7940  acc: 0.7491    test auc: 0.7992  acc: 0.7561, time: 0.4890
epoch 12    train auc: 0.8980  acc: 0.7911    eval auc: 0.7946  acc: 0.7505    test auc: 0.7995  acc: 0.7545, time: 0.4870
epoch 13    train auc: 0.8998  acc: 0.7937    eval auc: 0.7951  acc: 0.7512    test auc: 0.7999  acc: 0.7542, time: 0.4899
epoch 14    train auc: 0.9016  acc: 0.7939    eval auc: 0.7958  acc: 0.7509    test auc: 0.8002  acc: 0.7544, time: 0.4740
epoch 15    train auc: 0.9029  acc: 0.7962    eval auc: 0.7960  acc: 0.7504    test auc: 0.8004  acc: 0.7533, time: 0.4870
epoch 16    train auc: 0.9043  acc: 0.7968    eval auc: 0.7965  acc: 0.7504    test auc: 0.8005  acc: 0.7522, time: 0.4879
epoch 17    train auc: 0.9054  acc: 0.7984    eval auc: 0.7967  acc: 0.7501    test auc: 0.8005  acc: 0.7499, time: 0.4830
epoch 18    train auc: 0.9065  acc: 0.8004    eval auc: 0.7967  acc: 0.7494    test auc: 0.8005  acc: 0.7488, time: 0.4760
epoch 19    train auc: 0.9076  acc: 0.8011    eval auc: 0.7967  acc: 0.7485    test auc: 0.8001  acc: 0.7473, time: 0.4780
epoch 20    train auc: 0.9086  acc: 0.8023    eval auc: 0.7968  acc: 0.7472    test auc: 0.7999  acc: 0.7464, time: 0.4880
epoch 21    train auc: 0.9095  acc: 0.8030    eval auc: 0.7967  acc: 0.7457    test auc: 0.7998  acc: 0.7458, time: 0.4859
epoch 22    train auc: 0.9105  acc: 0.8030    eval auc: 0.7966  acc: 0.7457    test auc: 0.7994  acc: 0.7451, time: 0.4750
epoch 23    train auc: 0.9113  acc: 0.8037    eval auc: 0.7962  acc: 0.7448    test auc: 0.7990  acc: 0.7434, time: 0.4740
epoch 24    train auc: 0.9123  acc: 0.8039    eval auc: 0.7963  acc: 0.7437    test auc: 0.7987  acc: 0.7422, time: 0.4810
epoch 25    train auc: 0.9132  acc: 0.8046    eval auc: 0.7960  acc: 0.7445    test auc: 0.7983  acc: 0.7406, time: 0.4890
epoch 26    train auc: 0.9141  acc: 0.8062    eval auc: 0.7955  acc: 0.7424    test auc: 0.7977  acc: 0.7374, time: 0.4920
epoch 27    train auc: 0.9150  acc: 0.8081    eval auc: 0.7950  acc: 0.7406    test auc: 0.7971  acc: 0.7352, time: 0.4640
epoch 28    train auc: 0.9159  acc: 0.8084    eval auc: 0.7947  acc: 0.7394    test auc: 0.7965  acc: 0.7339, time: 0.4720
epoch 29    train auc: 0.9167  acc: 0.8087    eval auc: 0.7943  acc: 0.7401    test auc: 0.7958  acc: 0.7330, time: 0.4700
epoch 30    train auc: 0.9175  acc: 0.8097    eval auc: 0.7938  acc: 0.7394    test auc: 0.7953  acc: 0.7311, time: 0.4720
epoch 31    train auc: 0.9184  acc: 0.8097    eval auc: 0.7934  acc: 0.7380    test auc: 0.7945  acc: 0.7304, time: 0.4800
epoch 32    train auc: 0.9192  acc: 0.8109    eval auc: 0.7928  acc: 0.7376    test auc: 0.7940  acc: 0.7291, time: 0.4810
epoch 33    train auc: 0.9198  acc: 0.8125    eval auc: 0.7922  acc: 0.7374    test auc: 0.7934  acc: 0.7277, time: 0.4929
epoch 34    train auc: 0.9205  acc: 0.8130    eval auc: 0.7917  acc: 0.7354    test auc: 0.7926  acc: 0.7276, time: 0.4800
epoch 35    train auc: 0.9213  acc: 0.8156    eval auc: 0.7911  acc: 0.7339    test auc: 0.7921  acc: 0.7265, time: 0.4660
epoch 36    train auc: 0.9220  acc: 0.8160    eval auc: 0.7905  acc: 0.7314    test auc: 0.7914  acc: 0.7249, time: 0.4800
epoch 37    train auc: 0.9226  acc: 0.8172    eval auc: 0.7901  acc: 0.7298    test auc: 0.7908  acc: 0.7226, time: 0.4990
epoch 38    train auc: 0.9231  acc: 0.8167    eval auc: 0.7896  acc: 0.7294    test auc: 0.7902  acc: 0.7237, time: 0.4910
epoch 39    train auc: 0.9236  acc: 0.8172    eval auc: 0.7891  acc: 0.7294    test auc: 0.7896  acc: 0.7245, time: 0.4730
epoch 40    train auc: 0.9242  acc: 0.8180    eval auc: 0.7886  acc: 0.7284    test auc: 0.7889  acc: 0.7233, time: 0.4940
epoch 41    train auc: 0.9245  acc: 0.8179    eval auc: 0.7884  acc: 0.7282    test auc: 0.7887  acc: 0.7223, time: 0.5089
epoch 42    train auc: 0.9253  acc: 0.8210    eval auc: 0.7875  acc: 0.7248    test auc: 0.7880  acc: 0.7191, time: 0.4830
epoch 43    train auc: 0.9256  acc: 0.8217    eval auc: 0.7872  acc: 0.7235    test auc: 0.7877  acc: 0.7181, time: 0.4810
epoch 44    train auc: 0.9260  acc: 0.8199    eval auc: 0.7869  acc: 0.7258    test auc: 0.7871  acc: 0.7204, time: 0.4940
epoch 45    train auc: 0.9263  acc: 0.8205    eval auc: 0.7866  acc: 0.7248    test auc: 0.7867  acc: 0.7187, time: 0.5250
epoch 46    train auc: 0.9268  acc: 0.8211    eval auc: 0.7860  acc: 0.7233    test auc: 0.7861  acc: 0.7184, time: 0.5050
epoch 47    train auc: 0.9271  acc: 0.8217    eval auc: 0.7858  acc: 0.7228    test auc: 0.7859  acc: 0.7178, time: 0.5050
epoch 48    train auc: 0.9275  acc: 0.8223    eval auc: 0.7853  acc: 0.7219    test auc: 0.7853  acc: 0.7166, time: 0.5090
epoch 49    train auc: 0.9276  acc: 0.8198    eval auc: 0.7850  acc: 0.7211    test auc: 0.7848  acc: 0.7172, time: 0.5210
avg time per epoch : 0.49271421909332275
--- 30.14489769935608 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:49:29.349532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:49:29.349897: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4955  acc: 0.4989    eval auc: 0.5107  acc: 0.5006    test auc: 0.5084  acc: 0.5017, time: 0.8330
epoch 1    train auc: 0.6601  acc: 0.5808    eval auc: 0.6142  acc: 0.5698    test auc: 0.6377  acc: 0.5761, time: 0.4999
epoch 2    train auc: 0.8729  acc: 0.7464    eval auc: 0.7783  acc: 0.7243    test auc: 0.7867  acc: 0.7320, time: 0.4840
epoch 3    train auc: 0.8924  acc: 0.7692    eval auc: 0.7905  acc: 0.7408    test auc: 0.7946  acc: 0.7485, time: 0.4960
epoch 4    train auc: 0.9036  acc: 0.7890    eval auc: 0.7908  acc: 0.7418    test auc: 0.7931  acc: 0.7448, time: 0.5230
epoch 5    train auc: 0.9127  acc: 0.8036    eval auc: 0.7854  acc: 0.7251    test auc: 0.7867  acc: 0.7259, time: 0.4950
epoch 6    train auc: 0.9194  acc: 0.8146    eval auc: 0.7822  acc: 0.7189    test auc: 0.7818  acc: 0.7151, time: 0.5010
epoch 7    train auc: 0.9243  acc: 0.8213    eval auc: 0.7785  acc: 0.7101    test auc: 0.7782  acc: 0.7082, time: 0.4780
epoch 8    train auc: 0.9279  acc: 0.8280    eval auc: 0.7719  acc: 0.6965    test auc: 0.7720  acc: 0.6935, time: 0.5090
epoch 9    train auc: 0.9302  acc: 0.8297    eval auc: 0.7739  acc: 0.7014    test auc: 0.7727  acc: 0.6976, time: 0.4899
epoch 10    train auc: 0.9322  acc: 0.8322    eval auc: 0.7722  acc: 0.7015    test auc: 0.7711  acc: 0.6955, time: 0.4820
epoch 11    train auc: 0.9335  acc: 0.8329    eval auc: 0.7715  acc: 0.6997    test auc: 0.7696  acc: 0.6958, time: 0.4860
epoch 12    train auc: 0.9352  acc: 0.8364    eval auc: 0.7689  acc: 0.6974    test auc: 0.7670  acc: 0.6929, time: 0.5190
epoch 13    train auc: 0.9365  acc: 0.8368    eval auc: 0.7696  acc: 0.6978    test auc: 0.7673  acc: 0.6935, time: 0.4749
epoch 14    train auc: 0.9382  acc: 0.8391    eval auc: 0.7659  acc: 0.6945    test auc: 0.7641  acc: 0.6889, time: 0.4790
epoch 15    train auc: 0.9385  acc: 0.8382    eval auc: 0.7681  acc: 0.6958    test auc: 0.7664  acc: 0.6948, time: 0.4850
epoch 16    train auc: 0.9398  acc: 0.8413    eval auc: 0.7645  acc: 0.6919    test auc: 0.7632  acc: 0.6905, time: 0.5030
epoch 17    train auc: 0.9390  acc: 0.8380    eval auc: 0.7657  acc: 0.6926    test auc: 0.7631  acc: 0.6913, time: 0.4970
epoch 18    train auc: 0.9414  acc: 0.8430    eval auc: 0.7644  acc: 0.6915    test auc: 0.7625  acc: 0.6902, time: 0.5360
epoch 19    train auc: 0.9419  acc: 0.8427    eval auc: 0.7639  acc: 0.6915    test auc: 0.7619  acc: 0.6908, time: 0.5380
epoch 20    train auc: 0.9430  acc: 0.8452    eval auc: 0.7591  acc: 0.6884    test auc: 0.7575  acc: 0.6846, time: 0.5470
epoch 21    train auc: 0.9430  acc: 0.8449    eval auc: 0.7622  acc: 0.6915    test auc: 0.7603  acc: 0.6911, time: 0.5319
epoch 22    train auc: 0.9448  acc: 0.8472    eval auc: 0.7590  acc: 0.6845    test auc: 0.7576  acc: 0.6859, time: 0.5350
epoch 23    train auc: 0.9458  acc: 0.8490    eval auc: 0.7587  acc: 0.6860    test auc: 0.7570  acc: 0.6872, time: 0.5350
epoch 24    train auc: 0.9463  acc: 0.8489    eval auc: 0.7584  acc: 0.6876    test auc: 0.7563  acc: 0.6878, time: 0.5369
epoch 25    train auc: 0.9470  acc: 0.8497    eval auc: 0.7568  acc: 0.6850    test auc: 0.7554  acc: 0.6853, time: 0.5339
epoch 26    train auc: 0.9477  acc: 0.8514    eval auc: 0.7555  acc: 0.6869    test auc: 0.7538  acc: 0.6849, time: 0.5280
epoch 27    train auc: 0.9481  acc: 0.8510    eval auc: 0.7556  acc: 0.6844    test auc: 0.7537  acc: 0.6853, time: 0.5320
epoch 28    train auc: 0.9484  acc: 0.8523    eval auc: 0.7545  acc: 0.6851    test auc: 0.7525  acc: 0.6844, time: 0.5440
epoch 29    train auc: 0.9480  acc: 0.8505    eval auc: 0.7552  acc: 0.6871    test auc: 0.7531  acc: 0.6864, time: 0.5310
epoch 30    train auc: 0.9495  acc: 0.8536    eval auc: 0.7542  acc: 0.6846    test auc: 0.7526  acc: 0.6844, time: 0.5240
epoch 31    train auc: 0.9499  acc: 0.8542    eval auc: 0.7528  acc: 0.6828    test auc: 0.7512  acc: 0.6856, time: 0.5400
epoch 32    train auc: 0.9480  acc: 0.8491    eval auc: 0.7538  acc: 0.6860    test auc: 0.7518  acc: 0.6883, time: 0.5390
epoch 33    train auc: 0.9502  acc: 0.8542    eval auc: 0.7529  acc: 0.6851    test auc: 0.7516  acc: 0.6846, time: 0.5279
epoch 34    train auc: 0.9507  acc: 0.8546    eval auc: 0.7516  acc: 0.6841    test auc: 0.7499  acc: 0.6841, time: 0.5310
epoch 35    train auc: 0.9513  acc: 0.8550    eval auc: 0.7511  acc: 0.6817    test auc: 0.7499  acc: 0.6823, time: 0.5430
epoch 36    train auc: 0.9515  acc: 0.8549    eval auc: 0.7520  acc: 0.6831    test auc: 0.7502  acc: 0.6832, time: 0.5300
epoch 37    train auc: 0.9519  acc: 0.8567    eval auc: 0.7504  acc: 0.6841    test auc: 0.7487  acc: 0.6812, time: 0.5329
epoch 38    train auc: 0.9516  acc: 0.8556    eval auc: 0.7504  acc: 0.6827    test auc: 0.7489  acc: 0.6815, time: 0.5370
epoch 39    train auc: 0.9526  acc: 0.8567    eval auc: 0.7485  acc: 0.6810    test auc: 0.7477  acc: 0.6805, time: 0.5290
epoch 40    train auc: 0.9527  acc: 0.8573    eval auc: 0.7488  acc: 0.6799    test auc: 0.7477  acc: 0.6817, time: 0.5330
epoch 41    train auc: 0.9528  acc: 0.8576    eval auc: 0.7487  acc: 0.6806    test auc: 0.7477  acc: 0.6801, time: 0.5309
epoch 42    train auc: 0.9535  acc: 0.8586    eval auc: 0.7480  acc: 0.6804    test auc: 0.7469  acc: 0.6805, time: 0.5360
epoch 43    train auc: 0.9530  acc: 0.8569    eval auc: 0.7463  acc: 0.6780    test auc: 0.7458  acc: 0.6780, time: 0.5300
epoch 44    train auc: 0.9534  acc: 0.8560    eval auc: 0.7485  acc: 0.6818    test auc: 0.7475  acc: 0.6820, time: 0.5250
epoch 45    train auc: 0.9536  acc: 0.8566    eval auc: 0.7478  acc: 0.6802    test auc: 0.7468  acc: 0.6814, time: 0.5219
epoch 46    train auc: 0.9532  acc: 0.8566    eval auc: 0.7479  acc: 0.6825    test auc: 0.7461  acc: 0.6795, time: 0.5320
epoch 47    train auc: 0.9544  acc: 0.8587    eval auc: 0.7452  acc: 0.6797    test auc: 0.7448  acc: 0.6785, time: 0.5350
epoch 48    train auc: 0.9542  acc: 0.8587    eval auc: 0.7444  acc: 0.6775    test auc: 0.7443  acc: 0.6772, time: 0.5300
epoch 49    train auc: 0.9548  acc: 0.8589    eval auc: 0.7454  acc: 0.6778    test auc: 0.7454  acc: 0.6818, time: 0.5240
avg time per epoch : 0.5258921527862549
--- 32.27696418762207 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:50:01.764066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:50:01.764396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5084  acc: 0.5034    eval auc: 0.4976  acc: 0.5045    test auc: 0.4898  acc: 0.4945, time: 0.8530
epoch 1    train auc: 0.5446  acc: 0.5087    eval auc: 0.4783  acc: 0.4970    test auc: 0.4832  acc: 0.4908, time: 0.5370
epoch 2    train auc: 0.5784  acc: 0.5516    eval auc: 0.5100  acc: 0.5252    test auc: 0.5102  acc: 0.5193, time: 0.5250
epoch 3    train auc: 0.7186  acc: 0.5843    eval auc: 0.6410  acc: 0.5762    test auc: 0.6672  acc: 0.5788, time: 0.5380
epoch 4    train auc: 0.8447  acc: 0.6976    eval auc: 0.7449  acc: 0.6805    test auc: 0.7575  acc: 0.6939, time: 0.5500
epoch 5    train auc: 0.8586  acc: 0.6932    eval auc: 0.7631  acc: 0.6797    test auc: 0.7763  acc: 0.6938, time: 0.5320
epoch 6    train auc: 0.8710  acc: 0.7047    eval auc: 0.7748  acc: 0.6889    test auc: 0.7851  acc: 0.6991, time: 0.5370
epoch 7    train auc: 0.8819  acc: 0.7281    eval auc: 0.7844  acc: 0.7096    test auc: 0.7924  acc: 0.7186, time: 0.5360
epoch 8    train auc: 0.8888  acc: 0.7504    eval auc: 0.7907  acc: 0.7271    test auc: 0.7964  acc: 0.7377, time: 0.5420
epoch 9    train auc: 0.8922  acc: 0.7597    eval auc: 0.7928  acc: 0.7349    test auc: 0.7976  acc: 0.7467, time: 0.5450
epoch 10    train auc: 0.8947  acc: 0.7663    eval auc: 0.7944  acc: 0.7396    test auc: 0.7985  acc: 0.7517, time: 0.5230
epoch 11    train auc: 0.8968  acc: 0.7752    eval auc: 0.7954  acc: 0.7459    test auc: 0.7991  acc: 0.7539, time: 0.5300
epoch 12    train auc: 0.8985  acc: 0.7801    eval auc: 0.7961  acc: 0.7475    test auc: 0.7995  acc: 0.7532, time: 0.5390
epoch 13    train auc: 0.9002  acc: 0.7886    eval auc: 0.7966  acc: 0.7516    test auc: 0.7998  acc: 0.7522, time: 0.5290
epoch 14    train auc: 0.9012  acc: 0.7892    eval auc: 0.7971  acc: 0.7494    test auc: 0.7999  acc: 0.7492, time: 0.5230
epoch 15    train auc: 0.9024  acc: 0.7939    eval auc: 0.7972  acc: 0.7453    test auc: 0.7999  acc: 0.7445, time: 0.5359
epoch 16    train auc: 0.9037  acc: 0.7996    eval auc: 0.7974  acc: 0.7429    test auc: 0.7998  acc: 0.7366, time: 0.5370
epoch 17    train auc: 0.9044  acc: 0.7986    eval auc: 0.7976  acc: 0.7416    test auc: 0.7997  acc: 0.7374, time: 0.5290
epoch 18    train auc: 0.9054  acc: 0.8005    eval auc: 0.7976  acc: 0.7392    test auc: 0.7995  acc: 0.7327, time: 0.5250
epoch 19    train auc: 0.9061  acc: 0.8009    eval auc: 0.7974  acc: 0.7381    test auc: 0.7991  acc: 0.7317, time: 0.5310
epoch 20    train auc: 0.9071  acc: 0.8023    eval auc: 0.7973  acc: 0.7362    test auc: 0.7988  acc: 0.7284, time: 0.5450
epoch 21    train auc: 0.9076  acc: 0.8019    eval auc: 0.7971  acc: 0.7365    test auc: 0.7985  acc: 0.7284, time: 0.5230
epoch 22    train auc: 0.9083  acc: 0.8026    eval auc: 0.7969  acc: 0.7361    test auc: 0.7981  acc: 0.7271, time: 0.5200
epoch 23    train auc: 0.9093  acc: 0.8058    eval auc: 0.7966  acc: 0.7340    test auc: 0.7980  acc: 0.7233, time: 0.5370
epoch 24    train auc: 0.9096  acc: 0.8046    eval auc: 0.7963  acc: 0.7355    test auc: 0.7974  acc: 0.7250, time: 0.5400
epoch 25    train auc: 0.9103  acc: 0.8051    eval auc: 0.7959  acc: 0.7346    test auc: 0.7969  acc: 0.7242, time: 0.5350
epoch 26    train auc: 0.9111  acc: 0.8065    eval auc: 0.7955  acc: 0.7327    test auc: 0.7965  acc: 0.7211, time: 0.5340
epoch 27    train auc: 0.9116  acc: 0.8067    eval auc: 0.7953  acc: 0.7323    test auc: 0.7962  acc: 0.7209, time: 0.5340
epoch 28    train auc: 0.9122  acc: 0.8072    eval auc: 0.7949  acc: 0.7320    test auc: 0.7957  acc: 0.7186, time: 0.5570
epoch 29    train auc: 0.9126  acc: 0.8071    eval auc: 0.7945  acc: 0.7317    test auc: 0.7951  acc: 0.7174, time: 0.5330
epoch 30    train auc: 0.9130  acc: 0.8075    eval auc: 0.7940  acc: 0.7316    test auc: 0.7946  acc: 0.7191, time: 0.5410
epoch 31    train auc: 0.9136  acc: 0.8075    eval auc: 0.7935  acc: 0.7308    test auc: 0.7940  acc: 0.7161, time: 0.5360
epoch 32    train auc: 0.9144  acc: 0.8089    eval auc: 0.7934  acc: 0.7288    test auc: 0.7938  acc: 0.7145, time: 0.5380
epoch 33    train auc: 0.9148  acc: 0.8089    eval auc: 0.7931  acc: 0.7292    test auc: 0.7935  acc: 0.7147, time: 0.5340
epoch 34    train auc: 0.9153  acc: 0.8092    eval auc: 0.7923  acc: 0.7282    test auc: 0.7925  acc: 0.7143, time: 0.5280
epoch 35    train auc: 0.9163  acc: 0.8122    eval auc: 0.7924  acc: 0.7241    test auc: 0.7927  acc: 0.7132, time: 0.5240
epoch 36    train auc: 0.9169  acc: 0.8115    eval auc: 0.7918  acc: 0.7248    test auc: 0.7919  acc: 0.7128, time: 0.5340
epoch 37    train auc: 0.9177  acc: 0.8133    eval auc: 0.7917  acc: 0.7232    test auc: 0.7917  acc: 0.7121, time: 0.5290
epoch 38    train auc: 0.9182  acc: 0.8116    eval auc: 0.7906  acc: 0.7252    test auc: 0.7903  acc: 0.7130, time: 0.5240
epoch 39    train auc: 0.9189  acc: 0.8126    eval auc: 0.7898  acc: 0.7241    test auc: 0.7895  acc: 0.7134, time: 0.5200
epoch 40    train auc: 0.9197  acc: 0.8141    eval auc: 0.7890  acc: 0.7233    test auc: 0.7885  acc: 0.7126, time: 0.5210
epoch 41    train auc: 0.9209  acc: 0.8153    eval auc: 0.7889  acc: 0.7222    test auc: 0.7884  acc: 0.7112, time: 0.5230
epoch 42    train auc: 0.9224  acc: 0.8200    eval auc: 0.7881  acc: 0.7171    test auc: 0.7878  acc: 0.7066, time: 0.5160
epoch 43    train auc: 0.9233  acc: 0.8203    eval auc: 0.7875  acc: 0.7158    test auc: 0.7871  acc: 0.7078, time: 0.5180
epoch 44    train auc: 0.9243  acc: 0.8208    eval auc: 0.7863  acc: 0.7161    test auc: 0.7858  acc: 0.7089, time: 0.5460
epoch 45    train auc: 0.9252  acc: 0.8218    eval auc: 0.7851  acc: 0.7163    test auc: 0.7843  acc: 0.7086, time: 0.5290
epoch 46    train auc: 0.9258  acc: 0.8223    eval auc: 0.7836  acc: 0.7167    test auc: 0.7826  acc: 0.7102, time: 0.5260
epoch 47    train auc: 0.9273  acc: 0.8243    eval auc: 0.7830  acc: 0.7128    test auc: 0.7822  acc: 0.7072, time: 0.5340
epoch 48    train auc: 0.9286  acc: 0.8256    eval auc: 0.7822  acc: 0.7087    test auc: 0.7818  acc: 0.7048, time: 0.5340
epoch 49    train auc: 0.9291  acc: 0.8253    eval auc: 0.7808  acc: 0.7131    test auc: 0.7800  acc: 0.7059, time: 0.5280
avg time per epoch : 0.5387360000610352
--- 33.045031785964966 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:50:34.747878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:50:34.748218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4964  acc: 0.5043    eval auc: 0.5156  acc: 0.5060    test auc: 0.5047  acc: 0.5066, time: 0.8440
epoch 1    train auc: 0.8211  acc: 0.6432    eval auc: 0.7272  acc: 0.6308    test auc: 0.7407  acc: 0.6465, time: 0.3130
epoch 2    train auc: 0.8874  acc: 0.7758    eval auc: 0.7884  acc: 0.7464    test auc: 0.7942  acc: 0.7542, time: 0.5299
epoch 3    train auc: 0.8994  acc: 0.7940    eval auc: 0.7923  acc: 0.7497    test auc: 0.7966  acc: 0.7510, time: 0.3220
epoch 4    train auc: 0.9070  acc: 0.8034    eval auc: 0.7936  acc: 0.7388    test auc: 0.7968  acc: 0.7349, time: 0.5380
epoch 5    train auc: 0.9129  acc: 0.8128    eval auc: 0.7928  acc: 0.7250    test auc: 0.7946  acc: 0.7172, time: 0.3080
epoch 6    train auc: 0.9180  acc: 0.8144    eval auc: 0.7912  acc: 0.7258    test auc: 0.7918  acc: 0.7158, time: 0.5210
epoch 7    train auc: 0.9232  acc: 0.8201    eval auc: 0.7855  acc: 0.7127    test auc: 0.7848  acc: 0.7076, time: 0.3170
epoch 8    train auc: 0.9257  acc: 0.8188    eval auc: 0.7841  acc: 0.7176    test auc: 0.7831  acc: 0.7104, time: 0.5170
epoch 9    train auc: 0.9292  acc: 0.8265    eval auc: 0.7789  acc: 0.7048    test auc: 0.7777  acc: 0.7030, time: 0.3280
epoch 10    train auc: 0.9296  acc: 0.8241    eval auc: 0.7807  acc: 0.7091    test auc: 0.7796  acc: 0.7055, time: 0.5010
epoch 11    train auc: 0.9308  acc: 0.8233    eval auc: 0.7799  acc: 0.7131    test auc: 0.7771  acc: 0.7069, time: 0.3170
epoch 12    train auc: 0.9308  acc: 0.8221    eval auc: 0.7817  acc: 0.7140    test auc: 0.7799  acc: 0.7105, time: 0.5070
epoch 13    train auc: 0.9345  acc: 0.8314    eval auc: 0.7752  acc: 0.7030    test auc: 0.7727  acc: 0.6995, time: 0.3040
epoch 14    train auc: 0.9342  acc: 0.8290    eval auc: 0.7767  acc: 0.7052    test auc: 0.7754  acc: 0.7023, time: 0.5180
epoch 15    train auc: 0.9362  acc: 0.8356    eval auc: 0.7689  acc: 0.6945    test auc: 0.7661  acc: 0.6910, time: 0.3080
epoch 16    train auc: 0.9367  acc: 0.8326    eval auc: 0.7732  acc: 0.7014    test auc: 0.7709  acc: 0.6978, time: 0.5200
epoch 17    train auc: 0.9382  acc: 0.8370    eval auc: 0.7668  acc: 0.6903    test auc: 0.7654  acc: 0.6895, time: 0.3070
epoch 18    train auc: 0.9377  acc: 0.8349    eval auc: 0.7724  acc: 0.7010    test auc: 0.7714  acc: 0.6981, time: 0.5000
epoch 19    train auc: 0.9393  acc: 0.8381    eval auc: 0.7661  acc: 0.6897    test auc: 0.7654  acc: 0.6906, time: 0.3139
epoch 20    train auc: 0.9400  acc: 0.8382    eval auc: 0.7668  acc: 0.6936    test auc: 0.7656  acc: 0.6918, time: 0.5050
epoch 21    train auc: 0.9407  acc: 0.8405    eval auc: 0.7653  acc: 0.6926    test auc: 0.7636  acc: 0.6897, time: 0.3160
epoch 22    train auc: 0.9403  acc: 0.8382    eval auc: 0.7683  acc: 0.6978    test auc: 0.7673  acc: 0.6965, time: 0.5040
epoch 23    train auc: 0.9403  acc: 0.8378    eval auc: 0.7690  acc: 0.6991    test auc: 0.7673  acc: 0.6952, time: 0.3140
epoch 24    train auc: 0.9419  acc: 0.8424    eval auc: 0.7650  acc: 0.6931    test auc: 0.7639  acc: 0.6929, time: 0.5059
epoch 25    train auc: 0.9423  acc: 0.8417    eval auc: 0.7646  acc: 0.6942    test auc: 0.7634  acc: 0.6923, time: 0.3060
epoch 26    train auc: 0.9421  acc: 0.8402    eval auc: 0.7662  acc: 0.6963    test auc: 0.7654  acc: 0.6957, time: 0.4920
epoch 27    train auc: 0.9431  acc: 0.8429    eval auc: 0.7634  acc: 0.6939    test auc: 0.7619  acc: 0.6918, time: 0.3010
epoch 28    train auc: 0.9425  acc: 0.8407    eval auc: 0.7644  acc: 0.6947    test auc: 0.7641  acc: 0.6947, time: 0.5099
epoch 29    train auc: 0.9439  acc: 0.8445    eval auc: 0.7613  acc: 0.6898    test auc: 0.7605  acc: 0.6910, time: 0.3050
epoch 30    train auc: 0.9435  acc: 0.8431    eval auc: 0.7632  acc: 0.6926    test auc: 0.7622  acc: 0.6926, time: 0.4970
epoch 31    train auc: 0.9441  acc: 0.8441    eval auc: 0.7614  acc: 0.6913    test auc: 0.7607  acc: 0.6913, time: 0.3050
epoch 32    train auc: 0.9438  acc: 0.8429    eval auc: 0.7625  acc: 0.6930    test auc: 0.7615  acc: 0.6915, time: 0.5030
epoch 33    train auc: 0.9452  acc: 0.8456    eval auc: 0.7581  acc: 0.6863    test auc: 0.7571  acc: 0.6887, time: 0.3160
epoch 34    train auc: 0.9452  acc: 0.8457    eval auc: 0.7603  acc: 0.6898    test auc: 0.7597  acc: 0.6912, time: 0.4770
epoch 35    train auc: 0.9455  acc: 0.8465    eval auc: 0.7552  acc: 0.6828    test auc: 0.7547  acc: 0.6850, time: 0.3010
epoch 36    train auc: 0.9458  acc: 0.8462    eval auc: 0.7586  acc: 0.6884    test auc: 0.7582  acc: 0.6895, time: 0.4890
epoch 37    train auc: 0.9466  acc: 0.8482    eval auc: 0.7565  acc: 0.6867    test auc: 0.7556  acc: 0.6861, time: 0.3050
epoch 38    train auc: 0.9466  acc: 0.8480    eval auc: 0.7570  acc: 0.6858    test auc: 0.7562  acc: 0.6886, time: 0.5040
epoch 39    train auc: 0.9471  acc: 0.8492    eval auc: 0.7553  acc: 0.6850    test auc: 0.7547  acc: 0.6863, time: 0.2890
epoch 40    train auc: 0.9465  acc: 0.8472    eval auc: 0.7570  acc: 0.6863    test auc: 0.7565  acc: 0.6895, time: 0.4760
epoch 41    train auc: 0.9476  acc: 0.8493    eval auc: 0.7540  acc: 0.6825    test auc: 0.7537  acc: 0.6867, time: 0.2940
epoch 42    train auc: 0.9476  acc: 0.8483    eval auc: 0.7558  acc: 0.6871    test auc: 0.7549  acc: 0.6893, time: 0.4970
epoch 43    train auc: 0.9473  acc: 0.8473    eval auc: 0.7569  acc: 0.6857    test auc: 0.7566  acc: 0.6899, time: 0.3109
epoch 44    train auc: 0.9480  acc: 0.8489    eval auc: 0.7552  acc: 0.6863    test auc: 0.7548  acc: 0.6889, time: 0.4740
epoch 45    train auc: 0.9490  acc: 0.8507    eval auc: 0.7534  acc: 0.6824    test auc: 0.7531  acc: 0.6871, time: 0.2990
epoch 46    train auc: 0.9493  acc: 0.8513    eval auc: 0.7523  acc: 0.6818    test auc: 0.7517  acc: 0.6854, time: 0.4810
epoch 47    train auc: 0.9486  acc: 0.8495    eval auc: 0.7528  acc: 0.6833    test auc: 0.7521  acc: 0.6873, time: 0.2960
epoch 48    train auc: 0.9497  acc: 0.8515    eval auc: 0.7529  acc: 0.6838    test auc: 0.7525  acc: 0.6873, time: 0.4929
epoch 49    train auc: 0.9503  acc: 0.8524    eval auc: 0.7516  acc: 0.6807    test auc: 0.7509  acc: 0.6840, time: 0.3080
avg time per epoch : 0.412130274772644
--- 26.358019590377808 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:51:01.103004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:51:01.103317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5001  acc: 0.5010    eval auc: 0.5122  acc: 0.5029    test auc: 0.4991  acc: 0.5008, time: 0.8720
epoch 1    train auc: 0.5180  acc: 0.5089    eval auc: 0.4776  acc: 0.4868    test auc: 0.4788  acc: 0.4912, time: 0.3190
epoch 2    train auc: 0.5091  acc: 0.5079    eval auc: 0.5476  acc: 0.5194    test auc: 0.5539  acc: 0.5245, time: 0.4830
epoch 3    train auc: 0.5399  acc: 0.5204    eval auc: 0.4481  acc: 0.4722    test auc: 0.4445  acc: 0.4694, time: 0.2900
epoch 4    train auc: 0.5595  acc: 0.5295    eval auc: 0.4381  acc: 0.4694    test auc: 0.4326  acc: 0.4650, time: 0.4910
epoch 5    train auc: 0.5628  acc: 0.5336    eval auc: 0.4273  acc: 0.4603    test auc: 0.4214  acc: 0.4557, time: 0.2950
epoch 6    train auc: 0.5895  acc: 0.5558    eval auc: 0.4296  acc: 0.4502    test auc: 0.4239  acc: 0.4488, time: 0.4830
epoch 7    train auc: 0.6191  acc: 0.5766    eval auc: 0.4494  acc: 0.4597    test auc: 0.4445  acc: 0.4583, time: 0.2930
epoch 8    train auc: 0.7374  acc: 0.6699    eval auc: 0.5807  acc: 0.5582    test auc: 0.5865  acc: 0.5677, time: 0.4850
epoch 9    train auc: 0.8014  acc: 0.7157    eval auc: 0.6558  acc: 0.6328    test auc: 0.6610  acc: 0.6394, time: 0.3440
epoch 10    train auc: 0.8572  acc: 0.7479    eval auc: 0.7249  acc: 0.7019    test auc: 0.7320  acc: 0.7063, time: 0.5229
epoch 11    train auc: 0.8716  acc: 0.7610    eval auc: 0.7437  acc: 0.7135    test auc: 0.7501  acc: 0.7212, time: 0.3310
epoch 12    train auc: 0.8812  acc: 0.7644    eval auc: 0.7593  acc: 0.7237    test auc: 0.7650  acc: 0.7326, time: 0.5190
epoch 13    train auc: 0.8858  acc: 0.7848    eval auc: 0.7635  acc: 0.7269    test auc: 0.7686  acc: 0.7274, time: 0.3220
epoch 14    train auc: 0.8896  acc: 0.7868    eval auc: 0.7694  acc: 0.7295    test auc: 0.7740  acc: 0.7349, time: 0.5470
epoch 15    train auc: 0.8930  acc: 0.7932    eval auc: 0.7697  acc: 0.7265    test auc: 0.7740  acc: 0.7267, time: 0.3170
epoch 16    train auc: 0.8959  acc: 0.7912    eval auc: 0.7729  acc: 0.7305    test auc: 0.7766  acc: 0.7324, time: 0.4726
epoch 17    train auc: 0.8986  acc: 0.8018    eval auc: 0.7722  acc: 0.7181    test auc: 0.7758  acc: 0.7194, time: 0.2806
epoch 18    train auc: 0.9011  acc: 0.7978    eval auc: 0.7747  acc: 0.7272    test auc: 0.7777  acc: 0.7263, time: 0.4556
epoch 19    train auc: 0.9037  acc: 0.8032    eval auc: 0.7738  acc: 0.7189    test auc: 0.7764  acc: 0.7205, time: 0.2827
epoch 20    train auc: 0.9058  acc: 0.8027    eval auc: 0.7757  acc: 0.7232    test auc: 0.7779  acc: 0.7232, time: 0.4587
epoch 21    train auc: 0.9079  acc: 0.8076    eval auc: 0.7747  acc: 0.7179    test auc: 0.7768  acc: 0.7157, time: 0.2809
epoch 22    train auc: 0.9097  acc: 0.8066    eval auc: 0.7766  acc: 0.7212    test auc: 0.7780  acc: 0.7186, time: 0.4569
epoch 23    train auc: 0.9114  acc: 0.8115    eval auc: 0.7754  acc: 0.7148    test auc: 0.7769  acc: 0.7117, time: 0.2821
epoch 24    train auc: 0.9129  acc: 0.8092    eval auc: 0.7774  acc: 0.7207    test auc: 0.7783  acc: 0.7179, time: 0.4630
epoch 25    train auc: 0.9144  acc: 0.8134    eval auc: 0.7763  acc: 0.7141    test auc: 0.7773  acc: 0.7114, time: 0.2759
epoch 26    train auc: 0.9157  acc: 0.8132    eval auc: 0.7777  acc: 0.7186    test auc: 0.7783  acc: 0.7166, time: 0.4625
epoch 27    train auc: 0.9169  acc: 0.8153    eval auc: 0.7768  acc: 0.7152    test auc: 0.7772  acc: 0.7128, time: 0.2774
epoch 28    train auc: 0.9181  acc: 0.8156    eval auc: 0.7779  acc: 0.7178    test auc: 0.7780  acc: 0.7151, time: 0.4620
epoch 29    train auc: 0.9190  acc: 0.8167    eval auc: 0.7774  acc: 0.7158    test auc: 0.7775  acc: 0.7138, time: 0.2730
epoch 30    train auc: 0.9201  acc: 0.8171    eval auc: 0.7781  acc: 0.7167    test auc: 0.7778  acc: 0.7163, time: 0.4588
epoch 31    train auc: 0.9211  acc: 0.8201    eval auc: 0.7763  acc: 0.7107    test auc: 0.7763  acc: 0.7083, time: 0.2791
epoch 32    train auc: 0.9216  acc: 0.8165    eval auc: 0.7782  acc: 0.7197    test auc: 0.7776  acc: 0.7166, time: 0.4611
epoch 33    train auc: 0.9227  acc: 0.8216    eval auc: 0.7767  acc: 0.7101    test auc: 0.7765  acc: 0.7093, time: 0.2740
epoch 34    train auc: 0.9234  acc: 0.8204    eval auc: 0.7778  acc: 0.7167    test auc: 0.7772  acc: 0.7158, time: 0.4632
epoch 35    train auc: 0.9241  acc: 0.8240    eval auc: 0.7764  acc: 0.7073    test auc: 0.7762  acc: 0.7089, time: 0.2835
epoch 36    train auc: 0.9243  acc: 0.8187    eval auc: 0.7786  acc: 0.7196    test auc: 0.7776  acc: 0.7172, time: 0.4609
epoch 37    train auc: 0.9254  acc: 0.8252    eval auc: 0.7757  acc: 0.7043    test auc: 0.7754  acc: 0.7062, time: 0.2822
epoch 38    train auc: 0.9257  acc: 0.8223    eval auc: 0.7778  acc: 0.7181    test auc: 0.7767  acc: 0.7153, time: 0.4553
epoch 39    train auc: 0.9266  acc: 0.8276    eval auc: 0.7750  acc: 0.7053    test auc: 0.7745  acc: 0.7055, time: 0.2827
epoch 40    train auc: 0.9265  acc: 0.8216    eval auc: 0.7780  acc: 0.7186    test auc: 0.7768  acc: 0.7159, time: 0.4597
epoch 41    train auc: 0.9276  acc: 0.8277    eval auc: 0.7755  acc: 0.7087    test auc: 0.7747  acc: 0.7062, time: 0.2766
epoch 42    train auc: 0.9277  acc: 0.8238    eval auc: 0.7773  acc: 0.7151    test auc: 0.7760  acc: 0.7141, time: 0.4565
epoch 43    train auc: 0.9287  acc: 0.8286    eval auc: 0.7748  acc: 0.7066    test auc: 0.7740  acc: 0.7055, time: 0.2791
epoch 44    train auc: 0.9284  acc: 0.8232    eval auc: 0.7773  acc: 0.7160    test auc: 0.7758  acc: 0.7150, time: 0.4571
epoch 45    train auc: 0.9294  acc: 0.8288    eval auc: 0.7752  acc: 0.7107    test auc: 0.7742  acc: 0.7087, time: 0.2759
epoch 46    train auc: 0.9291  acc: 0.8239    eval auc: 0.7772  acc: 0.7152    test auc: 0.7757  acc: 0.7145, time: 0.4471
epoch 47    train auc: 0.9302  acc: 0.8292    eval auc: 0.7748  acc: 0.7092    test auc: 0.7738  acc: 0.7081, time: 0.2826
epoch 48    train auc: 0.9303  acc: 0.8270    eval auc: 0.7760  acc: 0.7117    test auc: 0.7747  acc: 0.7108, time: 0.4688
epoch 49    train auc: 0.9311  acc: 0.8302    eval auc: 0.7741  acc: 0.7089    test auc: 0.7731  acc: 0.7063, time: 0.3080
avg time per epoch : 0.39019752502441407
--- 24.994348764419556 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:51:26.069715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:51:26.070061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4944  acc: 0.5002    eval auc: 0.5460  acc: 0.5167    test auc: 0.5469  acc: 0.5188, time: 0.7874
epoch 1    train auc: 0.7956  acc: 0.6708    eval auc: 0.7096  acc: 0.6579    test auc: 0.7209  acc: 0.6704, time: 0.2950
epoch 2    train auc: 0.8872  acc: 0.7582    eval auc: 0.7860  acc: 0.7346    test auc: 0.7901  acc: 0.7432, time: 0.4811
epoch 3    train auc: 0.8989  acc: 0.7857    eval auc: 0.7934  acc: 0.7513    test auc: 0.7962  acc: 0.7566, time: 0.2936
epoch 4    train auc: 0.9068  acc: 0.7974    eval auc: 0.7940  acc: 0.7445    test auc: 0.7967  acc: 0.7444, time: 0.4770
epoch 5    train auc: 0.9141  acc: 0.8123    eval auc: 0.7905  acc: 0.7279    test auc: 0.7922  acc: 0.7224, time: 0.2939
epoch 6    train auc: 0.9203  acc: 0.8174    eval auc: 0.7861  acc: 0.7190    test auc: 0.7866  acc: 0.7138, time: 0.4663
epoch 7    train auc: 0.9247  acc: 0.8220    eval auc: 0.7827  acc: 0.7109    test auc: 0.7822  acc: 0.7085, time: 0.2877
epoch 8    train auc: 0.9270  acc: 0.8211    eval auc: 0.7807  acc: 0.7098    test auc: 0.7794  acc: 0.7106, time: 0.4710
epoch 9    train auc: 0.9302  acc: 0.8269    eval auc: 0.7778  acc: 0.7053    test auc: 0.7767  acc: 0.7034, time: 0.2893
epoch 10    train auc: 0.9319  acc: 0.8280    eval auc: 0.7768  acc: 0.7043    test auc: 0.7760  acc: 0.7020, time: 0.4685
epoch 11    train auc: 0.9328  acc: 0.8280    eval auc: 0.7774  acc: 0.7055    test auc: 0.7758  acc: 0.7067, time: 0.2840
epoch 12    train auc: 0.9330  acc: 0.8260    eval auc: 0.7791  acc: 0.7102    test auc: 0.7780  acc: 0.7106, time: 0.4604
epoch 13    train auc: 0.9360  acc: 0.8336    eval auc: 0.7712  acc: 0.6990    test auc: 0.7700  acc: 0.6978, time: 0.2825
epoch 14    train auc: 0.9366  acc: 0.8330    eval auc: 0.7726  acc: 0.7022    test auc: 0.7717  acc: 0.7008, time: 0.4612
epoch 15    train auc: 0.9373  acc: 0.8343    eval auc: 0.7702  acc: 0.7017    test auc: 0.7688  acc: 0.6989, time: 0.2935
epoch 16    train auc: 0.9381  acc: 0.8360    eval auc: 0.7695  acc: 0.7004    test auc: 0.7681  acc: 0.6970, time: 0.4582
epoch 17    train auc: 0.9394  acc: 0.8386    eval auc: 0.7672  acc: 0.6969    test auc: 0.7666  acc: 0.6951, time: 0.2809
epoch 18    train auc: 0.9393  acc: 0.8371    eval auc: 0.7695  acc: 0.7023    test auc: 0.7692  acc: 0.6995, time: 0.4559
epoch 19    train auc: 0.9402  acc: 0.8389    eval auc: 0.7634  acc: 0.6921    test auc: 0.7637  acc: 0.6904, time: 0.2809
epoch 20    train auc: 0.9414  acc: 0.8412    eval auc: 0.7634  acc: 0.6930    test auc: 0.7630  acc: 0.6925, time: 0.4696
epoch 21    train auc: 0.9420  acc: 0.8412    eval auc: 0.7634  acc: 0.6934    test auc: 0.7629  acc: 0.6926, time: 0.2895
epoch 22    train auc: 0.9422  acc: 0.8398    eval auc: 0.7634  acc: 0.6936    test auc: 0.7633  acc: 0.6930, time: 0.4720
epoch 23    train auc: 0.9424  acc: 0.8413    eval auc: 0.7638  acc: 0.6944    test auc: 0.7636  acc: 0.6926, time: 0.2880
epoch 24    train auc: 0.9434  acc: 0.8429    eval auc: 0.7607  acc: 0.6899    test auc: 0.7606  acc: 0.6903, time: 0.4659
epoch 25    train auc: 0.9434  acc: 0.8428    eval auc: 0.7621  acc: 0.6929    test auc: 0.7620  acc: 0.6923, time: 0.2997
epoch 26    train auc: 0.9440  acc: 0.8443    eval auc: 0.7610  acc: 0.6909    test auc: 0.7607  acc: 0.6934, time: 0.4925
epoch 27    train auc: 0.9447  acc: 0.8452    eval auc: 0.7596  acc: 0.6898    test auc: 0.7596  acc: 0.6928, time: 0.2902
epoch 28    train auc: 0.9447  acc: 0.8441    eval auc: 0.7603  acc: 0.6915    test auc: 0.7599  acc: 0.6941, time: 0.4701
epoch 29    train auc: 0.9454  acc: 0.8461    eval auc: 0.7585  acc: 0.6899    test auc: 0.7577  acc: 0.6906, time: 0.2970
epoch 30    train auc: 0.9450  acc: 0.8442    eval auc: 0.7599  acc: 0.6923    test auc: 0.7587  acc: 0.6904, time: 0.4826
epoch 31    train auc: 0.9465  acc: 0.8473    eval auc: 0.7562  acc: 0.6879    test auc: 0.7561  acc: 0.6897, time: 0.2906
epoch 32    train auc: 0.9445  acc: 0.8430    eval auc: 0.7592  acc: 0.6948    test auc: 0.7578  acc: 0.6903, time: 0.4743
epoch 33    train auc: 0.9469  acc: 0.8475    eval auc: 0.7551  acc: 0.6884    test auc: 0.7539  acc: 0.6876, time: 0.2919
epoch 34    train auc: 0.9474  acc: 0.8487    eval auc: 0.7560  acc: 0.6864    test auc: 0.7552  acc: 0.6882, time: 0.4636
epoch 35    train auc: 0.9477  acc: 0.8488    eval auc: 0.7551  acc: 0.6892    test auc: 0.7541  acc: 0.6895, time: 0.2756
epoch 36    train auc: 0.9483  acc: 0.8504    eval auc: 0.7540  acc: 0.6851    test auc: 0.7536  acc: 0.6878, time: 0.4605
epoch 37    train auc: 0.9487  acc: 0.8504    eval auc: 0.7542  acc: 0.6861    test auc: 0.7535  acc: 0.6866, time: 0.2800
epoch 38    train auc: 0.9490  acc: 0.8509    eval auc: 0.7536  acc: 0.6850    test auc: 0.7528  acc: 0.6866, time: 0.4569
epoch 39    train auc: 0.9498  acc: 0.8519    eval auc: 0.7518  acc: 0.6841    test auc: 0.7510  acc: 0.6836, time: 0.2816
epoch 40    train auc: 0.9498  acc: 0.8511    eval auc: 0.7534  acc: 0.6854    test auc: 0.7526  acc: 0.6857, time: 0.4485
epoch 41    train auc: 0.9508  acc: 0.8524    eval auc: 0.7502  acc: 0.6840    test auc: 0.7497  acc: 0.6845, time: 0.2790
epoch 42    train auc: 0.9510  acc: 0.8526    eval auc: 0.7527  acc: 0.6871    test auc: 0.7517  acc: 0.6874, time: 0.4543
epoch 43    train auc: 0.9514  acc: 0.8523    eval auc: 0.7521  acc: 0.6864    test auc: 0.7508  acc: 0.6845, time: 0.2752
epoch 44    train auc: 0.9522  acc: 0.8532    eval auc: 0.7517  acc: 0.6863    test auc: 0.7513  acc: 0.6870, time: 0.4494
epoch 45    train auc: 0.9533  acc: 0.8548    eval auc: 0.7499  acc: 0.6843    test auc: 0.7493  acc: 0.6845, time: 0.2760
epoch 46    train auc: 0.9545  acc: 0.8564    eval auc: 0.7476  acc: 0.6827    test auc: 0.7466  acc: 0.6818, time: 0.4486
epoch 47    train auc: 0.9548  acc: 0.8570    eval auc: 0.7487  acc: 0.6830    test auc: 0.7478  acc: 0.6832, time: 0.2790
epoch 48    train auc: 0.9562  acc: 0.8580    eval auc: 0.7473  acc: 0.6827    test auc: 0.7466  acc: 0.6817, time: 0.4516
epoch 49    train auc: 0.9569  acc: 0.8587    eval auc: 0.7463  acc: 0.6817    test auc: 0.7458  acc: 0.6824, time: 0.2743
avg time per epoch : 0.3819276857376099
--- 24.297805309295654 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:51:50.507803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:51:50.508152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5215  acc: 0.5122    eval auc: 0.4876  acc: 0.4916    test auc: 0.4900  acc: 0.4921, time: 0.7995
epoch 1    train auc: 0.5239  acc: 0.5163    eval auc: 0.4710  acc: 0.4786    test auc: 0.4738  acc: 0.4839, time: 0.2933
epoch 2    train auc: 0.5421  acc: 0.5281    eval auc: 0.4526  acc: 0.4640    test auc: 0.4543  acc: 0.4674, time: 0.4840
epoch 3    train auc: 0.5544  acc: 0.5353    eval auc: 0.4400  acc: 0.4577    test auc: 0.4386  acc: 0.4610, time: 0.2966
epoch 4    train auc: 0.5748  acc: 0.5497    eval auc: 0.4304  acc: 0.4507    test auc: 0.4273  acc: 0.4506, time: 0.4506
epoch 5    train auc: 0.6186  acc: 0.5808    eval auc: 0.4573  acc: 0.4708    test auc: 0.4571  acc: 0.4709, time: 0.2719
epoch 6    train auc: 0.7236  acc: 0.6535    eval auc: 0.5793  acc: 0.5390    test auc: 0.5860  acc: 0.5420, time: 0.4504
epoch 7    train auc: 0.8019  acc: 0.7161    eval auc: 0.6763  acc: 0.6564    test auc: 0.6832  acc: 0.6609, time: 0.2709
epoch 8    train auc: 0.8539  acc: 0.7338    eval auc: 0.7311  acc: 0.7022    test auc: 0.7372  acc: 0.7082, time: 0.4516
epoch 9    train auc: 0.8750  acc: 0.7566    eval auc: 0.7544  acc: 0.7185    test auc: 0.7586  acc: 0.7268, time: 0.2699
epoch 10    train auc: 0.8850  acc: 0.7789    eval auc: 0.7654  acc: 0.7268    test auc: 0.7688  acc: 0.7333, time: 0.4512
epoch 11    train auc: 0.8903  acc: 0.7777    eval auc: 0.7708  acc: 0.7304    test auc: 0.7732  acc: 0.7376, time: 0.2719
epoch 12    train auc: 0.8947  acc: 0.7833    eval auc: 0.7746  acc: 0.7320    test auc: 0.7765  acc: 0.7377, time: 0.4573
epoch 13    train auc: 0.8982  acc: 0.7939    eval auc: 0.7767  acc: 0.7313    test auc: 0.7782  acc: 0.7340, time: 0.2720
epoch 14    train auc: 0.9012  acc: 0.7992    eval auc: 0.7787  acc: 0.7265    test auc: 0.7799  acc: 0.7292, time: 0.4587
epoch 15    train auc: 0.9036  acc: 0.8007    eval auc: 0.7799  acc: 0.7267    test auc: 0.7807  acc: 0.7291, time: 0.2739
epoch 16    train auc: 0.9060  acc: 0.8028    eval auc: 0.7811  acc: 0.7259    test auc: 0.7815  acc: 0.7269, time: 0.4570
epoch 17    train auc: 0.9082  acc: 0.8083    eval auc: 0.7816  acc: 0.7224    test auc: 0.7819  acc: 0.7192, time: 0.2834
epoch 18    train auc: 0.9101  acc: 0.8082    eval auc: 0.7824  acc: 0.7233    test auc: 0.7824  acc: 0.7210, time: 0.4494
epoch 19    train auc: 0.9118  acc: 0.8093    eval auc: 0.7826  acc: 0.7233    test auc: 0.7822  acc: 0.7211, time: 0.2745
epoch 20    train auc: 0.9135  acc: 0.8118    eval auc: 0.7826  acc: 0.7222    test auc: 0.7821  acc: 0.7192, time: 0.4514
epoch 21    train auc: 0.9150  acc: 0.8138    eval auc: 0.7825  acc: 0.7210    test auc: 0.7818  acc: 0.7190, time: 0.2798
epoch 22    train auc: 0.9165  acc: 0.8164    eval auc: 0.7824  acc: 0.7212    test auc: 0.7815  acc: 0.7181, time: 0.4706
epoch 23    train auc: 0.9178  acc: 0.8180    eval auc: 0.7819  acc: 0.7187    test auc: 0.7809  acc: 0.7163, time: 0.2883
epoch 24    train auc: 0.9190  acc: 0.8186    eval auc: 0.7820  acc: 0.7200    test auc: 0.7808  acc: 0.7166, time: 0.4640
epoch 25    train auc: 0.9201  acc: 0.8201    eval auc: 0.7817  acc: 0.7180    test auc: 0.7804  acc: 0.7164, time: 0.2810
epoch 26    train auc: 0.9212  acc: 0.8211    eval auc: 0.7813  acc: 0.7171    test auc: 0.7800  acc: 0.7140, time: 0.4744
epoch 27    train auc: 0.9222  acc: 0.8212    eval auc: 0.7808  acc: 0.7148    test auc: 0.7793  acc: 0.7161, time: 0.2840
epoch 28    train auc: 0.9231  acc: 0.8237    eval auc: 0.7803  acc: 0.7137    test auc: 0.7788  acc: 0.7085, time: 0.4663
epoch 29    train auc: 0.9238  acc: 0.8221    eval auc: 0.7803  acc: 0.7156    test auc: 0.7784  acc: 0.7148, time: 0.2879
epoch 30    train auc: 0.9248  acc: 0.8249    eval auc: 0.7794  acc: 0.7138    test auc: 0.7777  acc: 0.7107, time: 0.4649
epoch 31    train auc: 0.9256  acc: 0.8257    eval auc: 0.7785  acc: 0.7114    test auc: 0.7768  acc: 0.7098, time: 0.2904
epoch 32    train auc: 0.9261  acc: 0.8238    eval auc: 0.7788  acc: 0.7133    test auc: 0.7766  acc: 0.7126, time: 0.4665
epoch 33    train auc: 0.9269  acc: 0.8256    eval auc: 0.7779  acc: 0.7099    test auc: 0.7759  acc: 0.7082, time: 0.2915
epoch 34    train auc: 0.9276  acc: 0.8276    eval auc: 0.7771  acc: 0.7095    test auc: 0.7753  acc: 0.7052, time: 0.4755
epoch 35    train auc: 0.9281  acc: 0.8282    eval auc: 0.7769  acc: 0.7096    test auc: 0.7750  acc: 0.7048, time: 0.2968
epoch 36    train auc: 0.9285  acc: 0.8263    eval auc: 0.7773  acc: 0.7105    test auc: 0.7752  acc: 0.7109, time: 0.4820
epoch 37    train auc: 0.9292  acc: 0.8293    eval auc: 0.7755  acc: 0.7078    test auc: 0.7737  acc: 0.7015, time: 0.2902
epoch 38    train auc: 0.9298  acc: 0.8277    eval auc: 0.7756  acc: 0.7068    test auc: 0.7734  acc: 0.7062, time: 0.4788
epoch 39    train auc: 0.9303  acc: 0.8298    eval auc: 0.7743  acc: 0.7052    test auc: 0.7723  acc: 0.7007, time: 0.2907
epoch 40    train auc: 0.9307  acc: 0.8297    eval auc: 0.7751  acc: 0.7074    test auc: 0.7730  acc: 0.7053, time: 0.4544
epoch 41    train auc: 0.9312  acc: 0.8301    eval auc: 0.7742  acc: 0.7075    test auc: 0.7722  acc: 0.7026, time: 0.2866
epoch 42    train auc: 0.9317  acc: 0.8307    eval auc: 0.7737  acc: 0.7055    test auc: 0.7717  acc: 0.7027, time: 0.4673
epoch 43    train auc: 0.9322  acc: 0.8310    eval auc: 0.7729  acc: 0.7041    test auc: 0.7709  acc: 0.7008, time: 0.2863
epoch 44    train auc: 0.9325  acc: 0.8308    eval auc: 0.7729  acc: 0.7050    test auc: 0.7708  acc: 0.7014, time: 0.4622
epoch 45    train auc: 0.9327  acc: 0.8296    eval auc: 0.7730  acc: 0.7056    test auc: 0.7707  acc: 0.7033, time: 0.2826
epoch 46    train auc: 0.9333  acc: 0.8323    eval auc: 0.7723  acc: 0.7049    test auc: 0.7702  acc: 0.7004, time: 0.4602
epoch 47    train auc: 0.9336  acc: 0.8328    eval auc: 0.7719  acc: 0.7055    test auc: 0.7697  acc: 0.7001, time: 0.2826
epoch 48    train auc: 0.9342  acc: 0.8330    eval auc: 0.7703  acc: 0.7016    test auc: 0.7684  acc: 0.6969, time: 0.4650
epoch 49    train auc: 0.9344  acc: 0.8332    eval auc: 0.7709  acc: 0.7047    test auc: 0.7688  acc: 0.6976, time: 0.2759
avg time per epoch : 0.3797323322296143
--- 24.36349320411682 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:52:14.820824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:52:14.821183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5142  acc: 0.5222    eval auc: 0.5273  acc: 0.5175    test auc: 0.5109  acc: 0.5114, time: 0.7748
epoch 1    train auc: 0.8576  acc: 0.6660    eval auc: 0.7622  acc: 0.6510    test auc: 0.7708  acc: 0.6657, time: 0.2948
epoch 2    train auc: 0.8916  acc: 0.7727    eval auc: 0.7911  acc: 0.7433    test auc: 0.7950  acc: 0.7517, time: 0.4570
epoch 3    train auc: 0.9010  acc: 0.8057    eval auc: 0.7920  acc: 0.7370    test auc: 0.7950  acc: 0.7320, time: 0.2804
epoch 4    train auc: 0.9051  acc: 0.7926    eval auc: 0.7958  acc: 0.7421    test auc: 0.7961  acc: 0.7428, time: 0.4574
epoch 5    train auc: 0.9117  acc: 0.8129    eval auc: 0.7935  acc: 0.7251    test auc: 0.7943  acc: 0.7184, time: 0.2782
epoch 6    train auc: 0.9131  acc: 0.8032    eval auc: 0.7950  acc: 0.7341    test auc: 0.7940  acc: 0.7310, time: 0.4570
epoch 7    train auc: 0.9197  acc: 0.8197    eval auc: 0.7897  acc: 0.7171    test auc: 0.7888  acc: 0.7069, time: 0.2775
epoch 8    train auc: 0.9195  acc: 0.8045    eval auc: 0.7901  acc: 0.7263    test auc: 0.7881  acc: 0.7243, time: 0.4590
epoch 9    train auc: 0.9275  acc: 0.8273    eval auc: 0.7804  acc: 0.7024    test auc: 0.7795  acc: 0.6968, time: 0.2761
epoch 10    train auc: 0.9256  acc: 0.8111    eval auc: 0.7866  acc: 0.7239    test auc: 0.7842  acc: 0.7185, time: 0.4498
epoch 11    train auc: 0.9296  acc: 0.8222    eval auc: 0.7808  acc: 0.7143    test auc: 0.7780  acc: 0.7063, time: 0.2767
epoch 12    train auc: 0.9283  acc: 0.8144    eval auc: 0.7848  acc: 0.7206    test auc: 0.7826  acc: 0.7157, time: 0.4586
epoch 13    train auc: 0.9341  acc: 0.8336    eval auc: 0.7731  acc: 0.6975    test auc: 0.7712  acc: 0.6955, time: 0.2698
epoch 14    train auc: 0.9335  acc: 0.8285    eval auc: 0.7787  acc: 0.7111    test auc: 0.7766  acc: 0.7052, time: 0.4539
epoch 15    train auc: 0.9360  acc: 0.8351    eval auc: 0.7706  acc: 0.6975    test auc: 0.7681  acc: 0.6932, time: 0.2719
epoch 16    train auc: 0.9356  acc: 0.8319    eval auc: 0.7748  acc: 0.7062    test auc: 0.7722  acc: 0.7010, time: 0.4464
epoch 17    train auc: 0.9380  acc: 0.8384    eval auc: 0.7665  acc: 0.6895    test auc: 0.7649  acc: 0.6886, time: 0.2774
epoch 18    train auc: 0.9378  acc: 0.8354    eval auc: 0.7726  acc: 0.7021    test auc: 0.7708  acc: 0.6970, time: 0.4505
epoch 19    train auc: 0.9396  acc: 0.8391    eval auc: 0.7663  acc: 0.6924    test auc: 0.7646  acc: 0.6900, time: 0.2752
epoch 20    train auc: 0.9401  acc: 0.8392    eval auc: 0.7681  acc: 0.6965    test auc: 0.7660  acc: 0.6924, time: 0.4648
epoch 21    train auc: 0.9413  acc: 0.8406    eval auc: 0.7641  acc: 0.6906    test auc: 0.7617  acc: 0.6865, time: 0.2884
epoch 22    train auc: 0.9416  acc: 0.8409    eval auc: 0.7672  acc: 0.6947    test auc: 0.7653  acc: 0.6923, time: 0.4659
epoch 23    train auc: 0.9418  acc: 0.8399    eval auc: 0.7660  acc: 0.6957    test auc: 0.7636  acc: 0.6880, time: 0.2837
epoch 24    train auc: 0.9434  acc: 0.8432    eval auc: 0.7625  acc: 0.6880    test auc: 0.7612  acc: 0.6878, time: 0.4631
epoch 25    train auc: 0.9447  acc: 0.8454    eval auc: 0.7620  acc: 0.6887    test auc: 0.7597  acc: 0.6867, time: 0.2874
epoch 26    train auc: 0.9452  acc: 0.8443    eval auc: 0.7627  acc: 0.6895    test auc: 0.7611  acc: 0.6869, time: 0.4639
epoch 27    train auc: 0.9464  acc: 0.8471    eval auc: 0.7589  acc: 0.6849    test auc: 0.7573  acc: 0.6827, time: 0.2873
epoch 28    train auc: 0.9472  acc: 0.8480    eval auc: 0.7598  acc: 0.6846    test auc: 0.7587  acc: 0.6843, time: 0.4548
epoch 29    train auc: 0.9483  acc: 0.8488    eval auc: 0.7583  acc: 0.6854    test auc: 0.7569  acc: 0.6833, time: 0.2807
epoch 30    train auc: 0.9492  acc: 0.8490    eval auc: 0.7589  acc: 0.6878    test auc: 0.7575  acc: 0.6839, time: 0.4628
epoch 31    train auc: 0.9504  acc: 0.8499    eval auc: 0.7568  acc: 0.6849    test auc: 0.7559  acc: 0.6821, time: 0.2729
epoch 32    train auc: 0.9513  acc: 0.8505    eval auc: 0.7550  acc: 0.6840    test auc: 0.7537  acc: 0.6807, time: 0.4627
epoch 33    train auc: 0.9533  acc: 0.8533    eval auc: 0.7517  acc: 0.6794    test auc: 0.7500  acc: 0.6773, time: 0.2740
epoch 34    train auc: 0.9548  acc: 0.8538    eval auc: 0.7523  acc: 0.6815    test auc: 0.7509  acc: 0.6795, time: 0.4605
epoch 35    train auc: 0.9555  acc: 0.8550    eval auc: 0.7519  acc: 0.6815    test auc: 0.7515  acc: 0.6806, time: 0.2725
epoch 36    train auc: 0.9570  acc: 0.8557    eval auc: 0.7502  acc: 0.6794    test auc: 0.7501  acc: 0.6788, time: 0.4493
epoch 37    train auc: 0.9583  acc: 0.8569    eval auc: 0.7513  acc: 0.6815    test auc: 0.7511  acc: 0.6776, time: 0.2733
epoch 38    train auc: 0.9595  acc: 0.8585    eval auc: 0.7474  acc: 0.6779    test auc: 0.7476  acc: 0.6752, time: 0.4545
epoch 39    train auc: 0.9613  acc: 0.8615    eval auc: 0.7481  acc: 0.6784    test auc: 0.7490  acc: 0.6768, time: 0.2761
epoch 40    train auc: 0.9625  acc: 0.8628    eval auc: 0.7455  acc: 0.6767    test auc: 0.7466  acc: 0.6741, time: 0.4500
epoch 41    train auc: 0.9646  acc: 0.8682    eval auc: 0.7446  acc: 0.6753    test auc: 0.7468  acc: 0.6767, time: 0.2711
epoch 42    train auc: 0.9654  acc: 0.8676    eval auc: 0.7437  acc: 0.6765    test auc: 0.7451  acc: 0.6747, time: 0.4612
epoch 43    train auc: 0.9672  acc: 0.8746    eval auc: 0.7443  acc: 0.6774    test auc: 0.7461  acc: 0.6772, time: 0.2751
epoch 44    train auc: 0.9680  acc: 0.8728    eval auc: 0.7433  acc: 0.6768    test auc: 0.7448  acc: 0.6755, time: 0.4464
epoch 45    train auc: 0.9696  acc: 0.8808    eval auc: 0.7439  acc: 0.6800    test auc: 0.7451  acc: 0.6799, time: 0.2804
epoch 46    train auc: 0.9703  acc: 0.8777    eval auc: 0.7401  acc: 0.6739    test auc: 0.7418  acc: 0.6749, time: 0.4370
epoch 47    train auc: 0.9722  acc: 0.8856    eval auc: 0.7413  acc: 0.6760    test auc: 0.7428  acc: 0.6789, time: 0.2769
epoch 48    train auc: 0.9729  acc: 0.8852    eval auc: 0.7389  acc: 0.6738    test auc: 0.7408  acc: 0.6752, time: 0.4538
epoch 49    train auc: 0.9741  acc: 0.8898    eval auc: 0.7396  acc: 0.6773    test auc: 0.7419  acc: 0.6804, time: 0.2705
avg time per epoch : 0.3732679510116577
--- 24.05693244934082 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:52:38.865433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:52:38.865773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5365  acc: 0.5255    eval auc: 0.5347  acc: 0.5161    test auc: 0.5506  acc: 0.5356, time: 0.7906
epoch 1    train auc: 0.5625  acc: 0.5013    eval auc: 0.5043  acc: 0.5006    test auc: 0.5029  acc: 0.4957, time: 0.2912
epoch 2    train auc: 0.7659  acc: 0.6893    eval auc: 0.7087  acc: 0.6572    test auc: 0.7226  acc: 0.6630, time: 0.4936
epoch 3    train auc: 0.7565  acc: 0.5890    eval auc: 0.6776  acc: 0.5828    test auc: 0.6893  acc: 0.5850, time: 0.2860
epoch 4    train auc: 0.8560  acc: 0.7062    eval auc: 0.7641  acc: 0.6890    test auc: 0.7709  acc: 0.6998, time: 0.4561
epoch 5    train auc: 0.8640  acc: 0.6979    eval auc: 0.7635  acc: 0.6814    test auc: 0.7693  acc: 0.6938, time: 0.2827
epoch 6    train auc: 0.8822  acc: 0.7503    eval auc: 0.7850  acc: 0.7263    test auc: 0.7880  acc: 0.7381, time: 0.4532
epoch 7    train auc: 0.8870  acc: 0.7498    eval auc: 0.7874  acc: 0.7251    test auc: 0.7897  acc: 0.7375, time: 0.2760
epoch 8    train auc: 0.8909  acc: 0.7727    eval auc: 0.7926  acc: 0.7453    test auc: 0.7953  acc: 0.7517, time: 0.4536
epoch 9    train auc: 0.8942  acc: 0.7717    eval auc: 0.7933  acc: 0.7447    test auc: 0.7955  acc: 0.7509, time: 0.2915
epoch 10    train auc: 0.8947  acc: 0.7874    eval auc: 0.7943  acc: 0.7538    test auc: 0.7974  acc: 0.7568, time: 0.4468
epoch 11    train auc: 0.8985  acc: 0.7791    eval auc: 0.7956  acc: 0.7467    test auc: 0.7975  acc: 0.7548, time: 0.2719
epoch 12    train auc: 0.8990  acc: 0.7901    eval auc: 0.7961  acc: 0.7538    test auc: 0.7984  acc: 0.7561, time: 0.4566
epoch 13    train auc: 0.9013  acc: 0.7879    eval auc: 0.7965  acc: 0.7529    test auc: 0.7984  acc: 0.7559, time: 0.2843
epoch 14    train auc: 0.9013  acc: 0.7947    eval auc: 0.7964  acc: 0.7527    test auc: 0.7988  acc: 0.7559, time: 0.4545
epoch 15    train auc: 0.9037  acc: 0.7923    eval auc: 0.7971  acc: 0.7539    test auc: 0.7990  acc: 0.7557, time: 0.2850
epoch 16    train auc: 0.9039  acc: 0.7969    eval auc: 0.7970  acc: 0.7514    test auc: 0.7990  acc: 0.7532, time: 0.4555
epoch 17    train auc: 0.9056  acc: 0.7955    eval auc: 0.7974  acc: 0.7520    test auc: 0.7989  acc: 0.7543, time: 0.2814
epoch 18    train auc: 0.9059  acc: 0.7987    eval auc: 0.7973  acc: 0.7503    test auc: 0.7990  acc: 0.7503, time: 0.4479
epoch 19    train auc: 0.9075  acc: 0.7967    eval auc: 0.7977  acc: 0.7497    test auc: 0.7989  acc: 0.7512, time: 0.2848
epoch 20    train auc: 0.9076  acc: 0.8003    eval auc: 0.7970  acc: 0.7471    test auc: 0.7986  acc: 0.7453, time: 0.4596
epoch 21    train auc: 0.9090  acc: 0.7988    eval auc: 0.7975  acc: 0.7468    test auc: 0.7984  acc: 0.7477, time: 0.2819
epoch 22    train auc: 0.9090  acc: 0.8018    eval auc: 0.7969  acc: 0.7451    test auc: 0.7981  acc: 0.7432, time: 0.4670
epoch 23    train auc: 0.9103  acc: 0.8010    eval auc: 0.7970  acc: 0.7455    test auc: 0.7977  acc: 0.7427, time: 0.2867
epoch 24    train auc: 0.9105  acc: 0.8029    eval auc: 0.7965  acc: 0.7453    test auc: 0.7975  acc: 0.7392, time: 0.4698
epoch 25    train auc: 0.9119  acc: 0.8024    eval auc: 0.7965  acc: 0.7441    test auc: 0.7968  acc: 0.7392, time: 0.2875
epoch 26    train auc: 0.9121  acc: 0.8051    eval auc: 0.7954  acc: 0.7411    test auc: 0.7964  acc: 0.7296, time: 0.4712
epoch 27    train auc: 0.9137  acc: 0.8036    eval auc: 0.7958  acc: 0.7413    test auc: 0.7958  acc: 0.7329, time: 0.2914
epoch 28    train auc: 0.9138  acc: 0.8076    eval auc: 0.7943  acc: 0.7333    test auc: 0.7950  acc: 0.7233, time: 0.4737
epoch 29    train auc: 0.9156  acc: 0.8054    eval auc: 0.7949  acc: 0.7390    test auc: 0.7943  acc: 0.7281, time: 0.2915
epoch 30    train auc: 0.9160  acc: 0.8101    eval auc: 0.7932  acc: 0.7291    test auc: 0.7937  acc: 0.7202, time: 0.4780
epoch 31    train auc: 0.9178  acc: 0.8094    eval auc: 0.7932  acc: 0.7336    test auc: 0.7924  acc: 0.7230, time: 0.2934
epoch 32    train auc: 0.9186  acc: 0.8121    eval auc: 0.7924  acc: 0.7302    test auc: 0.7922  acc: 0.7232, time: 0.4792
epoch 33    train auc: 0.9200  acc: 0.8136    eval auc: 0.7918  acc: 0.7290    test auc: 0.7908  acc: 0.7217, time: 0.3012
epoch 34    train auc: 0.9205  acc: 0.8161    eval auc: 0.7903  acc: 0.7211    test auc: 0.7903  acc: 0.7147, time: 0.4772
epoch 35    train auc: 0.9221  acc: 0.8179    eval auc: 0.7900  acc: 0.7246    test auc: 0.7890  acc: 0.7179, time: 0.2980
epoch 36    train auc: 0.9225  acc: 0.8177    eval auc: 0.7892  acc: 0.7222    test auc: 0.7888  acc: 0.7165, time: 0.4781
epoch 37    train auc: 0.9240  acc: 0.8211    eval auc: 0.7882  acc: 0.7202    test auc: 0.7870  acc: 0.7132, time: 0.2968
epoch 38    train auc: 0.9243  acc: 0.8210    eval auc: 0.7875  acc: 0.7185    test auc: 0.7868  acc: 0.7131, time: 0.4620
epoch 39    train auc: 0.9256  acc: 0.8244    eval auc: 0.7863  acc: 0.7161    test auc: 0.7850  acc: 0.7096, time: 0.2965
epoch 40    train auc: 0.9258  acc: 0.8233    eval auc: 0.7859  acc: 0.7161    test auc: 0.7852  acc: 0.7106, time: 0.4775
epoch 41    train auc: 0.9269  acc: 0.8238    eval auc: 0.7852  acc: 0.7172    test auc: 0.7834  acc: 0.7127, time: 0.2953
epoch 42    train auc: 0.9271  acc: 0.8247    eval auc: 0.7846  acc: 0.7152    test auc: 0.7837  acc: 0.7113, time: 0.4740
epoch 43    train auc: 0.9282  acc: 0.8258    eval auc: 0.7838  acc: 0.7157    test auc: 0.7819  acc: 0.7108, time: 0.2963
epoch 44    train auc: 0.9282  acc: 0.8266    eval auc: 0.7833  acc: 0.7145    test auc: 0.7823  acc: 0.7104, time: 0.4895
epoch 45    train auc: 0.9288  acc: 0.8235    eval auc: 0.7829  acc: 0.7193    test auc: 0.7806  acc: 0.7121, time: 0.3014
epoch 46    train auc: 0.9289  acc: 0.8272    eval auc: 0.7820  acc: 0.7112    test auc: 0.7812  acc: 0.7075, time: 0.4820
epoch 47    train auc: 0.9299  acc: 0.8266    eval auc: 0.7817  acc: 0.7153    test auc: 0.7795  acc: 0.7099, time: 0.2955
epoch 48    train auc: 0.9298  acc: 0.8286    eval auc: 0.7808  acc: 0.7096    test auc: 0.7801  acc: 0.7056, time: 0.4795
epoch 49    train auc: 0.9307  acc: 0.8278    eval auc: 0.7805  acc: 0.7126    test auc: 0.7783  acc: 0.7092, time: 0.2965
avg time per epoch : 0.38542278289794923
--- 24.43938660621643 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:53:03.440267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:53:03.440596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4890  acc: 0.4979    eval auc: 0.5302  acc: 0.5003    test auc: 0.5323  acc: 0.5079, time: 0.7708
epoch 1    train auc: 0.7994  acc: 0.6664    eval auc: 0.7215  acc: 0.6524    test auc: 0.7353  acc: 0.6658, time: 0.2893
epoch 2    train auc: 0.8842  acc: 0.7479    eval auc: 0.7866  acc: 0.7261    test auc: 0.7912  acc: 0.7341, time: 0.4812
epoch 3    train auc: 0.8971  acc: 0.7843    eval auc: 0.7934  acc: 0.7519    test auc: 0.7977  acc: 0.7568, time: 0.2889
epoch 4    train auc: 0.9046  acc: 0.7888    eval auc: 0.7947  acc: 0.7501    test auc: 0.7980  acc: 0.7514, time: 0.4720
epoch 5    train auc: 0.9136  acc: 0.8120    eval auc: 0.7906  acc: 0.7285    test auc: 0.7924  acc: 0.7186, time: 0.2850
epoch 6    train auc: 0.9199  acc: 0.8158    eval auc: 0.7865  acc: 0.7231    test auc: 0.7863  acc: 0.7158, time: 0.4707
epoch 7    train auc: 0.9250  acc: 0.8232    eval auc: 0.7811  acc: 0.7121    test auc: 0.7798  acc: 0.7053, time: 0.2906
epoch 8    train auc: 0.9272  acc: 0.8217    eval auc: 0.7781  acc: 0.7104    test auc: 0.7762  acc: 0.7054, time: 0.4816
epoch 9    train auc: 0.9304  acc: 0.8296    eval auc: 0.7732  acc: 0.6985    test auc: 0.7716  acc: 0.6922, time: 0.2883
epoch 10    train auc: 0.9321  acc: 0.8295    eval auc: 0.7750  acc: 0.7053    test auc: 0.7729  acc: 0.7016, time: 0.4732
epoch 11    train auc: 0.9327  acc: 0.8272    eval auc: 0.7747  acc: 0.7060    test auc: 0.7715  acc: 0.6989, time: 0.2932
epoch 12    train auc: 0.9333  acc: 0.8272    eval auc: 0.7769  acc: 0.7096    test auc: 0.7740  acc: 0.7022, time: 0.4778
epoch 13    train auc: 0.9366  acc: 0.8353    eval auc: 0.7690  acc: 0.6939    test auc: 0.7664  acc: 0.6926, time: 0.2889
epoch 14    train auc: 0.9375  acc: 0.8361    eval auc: 0.7692  acc: 0.6956    test auc: 0.7672  acc: 0.6934, time: 0.4734
epoch 15    train auc: 0.9386  acc: 0.8374    eval auc: 0.7656  acc: 0.6903    test auc: 0.7627  acc: 0.6897, time: 0.2905
epoch 16    train auc: 0.9391  acc: 0.8375    eval auc: 0.7662  acc: 0.6928    test auc: 0.7633  acc: 0.6922, time: 0.4733
epoch 17    train auc: 0.9403  acc: 0.8404    eval auc: 0.7643  acc: 0.6896    test auc: 0.7624  acc: 0.6905, time: 0.2873
epoch 18    train auc: 0.9408  acc: 0.8395    eval auc: 0.7658  acc: 0.6934    test auc: 0.7642  acc: 0.6924, time: 0.4755
epoch 19    train auc: 0.9417  acc: 0.8410    eval auc: 0.7629  acc: 0.6922    test auc: 0.7613  acc: 0.6898, time: 0.2869
epoch 20    train auc: 0.9425  acc: 0.8427    eval auc: 0.7608  acc: 0.6895    test auc: 0.7592  acc: 0.6889, time: 0.4788
epoch 21    train auc: 0.9429  acc: 0.8423    eval auc: 0.7612  acc: 0.6908    test auc: 0.7597  acc: 0.6905, time: 0.2899
epoch 22    train auc: 0.9434  acc: 0.8426    eval auc: 0.7606  acc: 0.6891    test auc: 0.7592  acc: 0.6887, time: 0.4812
epoch 23    train auc: 0.9434  acc: 0.8426    eval auc: 0.7618  acc: 0.6932    test auc: 0.7602  acc: 0.6908, time: 0.2885
epoch 24    train auc: 0.9448  acc: 0.8452    eval auc: 0.7577  acc: 0.6878    test auc: 0.7564  acc: 0.6874, time: 0.4722
epoch 25    train auc: 0.9450  acc: 0.8450    eval auc: 0.7589  acc: 0.6893    test auc: 0.7578  acc: 0.6885, time: 0.2951
epoch 26    train auc: 0.9455  acc: 0.8457    eval auc: 0.7580  acc: 0.6893    test auc: 0.7569  acc: 0.6869, time: 0.4738
epoch 27    train auc: 0.9461  acc: 0.8458    eval auc: 0.7572  acc: 0.6889    test auc: 0.7564  acc: 0.6867, time: 0.2949
epoch 28    train auc: 0.9464  acc: 0.8464    eval auc: 0.7572  acc: 0.6886    test auc: 0.7564  acc: 0.6876, time: 0.4791
epoch 29    train auc: 0.9470  acc: 0.8476    eval auc: 0.7557  acc: 0.6866    test auc: 0.7553  acc: 0.6876, time: 0.2894
epoch 30    train auc: 0.9468  acc: 0.8462    eval auc: 0.7566  acc: 0.6890    test auc: 0.7556  acc: 0.6880, time: 0.4722
epoch 31    train auc: 0.9479  acc: 0.8473    eval auc: 0.7538  acc: 0.6859    test auc: 0.7536  acc: 0.6860, time: 0.2854
epoch 32    train auc: 0.9475  acc: 0.8475    eval auc: 0.7545  acc: 0.6877    test auc: 0.7534  acc: 0.6839, time: 0.4777
epoch 33    train auc: 0.9491  acc: 0.8500    eval auc: 0.7507  acc: 0.6819    test auc: 0.7505  acc: 0.6811, time: 0.2869
epoch 34    train auc: 0.9489  acc: 0.8489    eval auc: 0.7540  acc: 0.6876    test auc: 0.7530  acc: 0.6853, time: 0.4748
epoch 35    train auc: 0.9501  acc: 0.8510    eval auc: 0.7509  acc: 0.6824    test auc: 0.7508  acc: 0.6812, time: 0.2920
epoch 36    train auc: 0.9505  acc: 0.8514    eval auc: 0.7510  acc: 0.6837    test auc: 0.7509  acc: 0.6826, time: 0.4792
epoch 37    train auc: 0.9511  acc: 0.8521    eval auc: 0.7509  acc: 0.6819    test auc: 0.7497  acc: 0.6804, time: 0.2870
epoch 38    train auc: 0.9517  acc: 0.8512    eval auc: 0.7510  acc: 0.6846    test auc: 0.7498  acc: 0.6813, time: 0.4810
epoch 39    train auc: 0.9529  acc: 0.8532    eval auc: 0.7492  acc: 0.6807    test auc: 0.7485  acc: 0.6792, time: 0.2903
epoch 40    train auc: 0.9530  acc: 0.8531    eval auc: 0.7503  acc: 0.6825    test auc: 0.7492  acc: 0.6795, time: 0.4679
epoch 41    train auc: 0.9549  acc: 0.8548    eval auc: 0.7482  acc: 0.6800    test auc: 0.7479  acc: 0.6787, time: 0.2892
epoch 42    train auc: 0.9555  acc: 0.8560    eval auc: 0.7492  acc: 0.6820    test auc: 0.7484  acc: 0.6804, time: 0.4742
epoch 43    train auc: 0.9567  acc: 0.8561    eval auc: 0.7478  acc: 0.6811    test auc: 0.7471  acc: 0.6788, time: 0.2934
epoch 44    train auc: 0.9577  acc: 0.8570    eval auc: 0.7487  acc: 0.6815    test auc: 0.7482  acc: 0.6820, time: 0.4718
epoch 45    train auc: 0.9592  acc: 0.8588    eval auc: 0.7469  acc: 0.6806    test auc: 0.7462  acc: 0.6801, time: 0.2871
epoch 46    train auc: 0.9612  acc: 0.8622    eval auc: 0.7434  acc: 0.6758    test auc: 0.7425  acc: 0.6760, time: 0.4713
epoch 47    train auc: 0.9611  acc: 0.8615    eval auc: 0.7445  acc: 0.6772    test auc: 0.7433  acc: 0.6773, time: 0.3190
epoch 48    train auc: 0.9636  acc: 0.8660    eval auc: 0.7421  acc: 0.6768    test auc: 0.7415  acc: 0.6775, time: 0.4980
epoch 49    train auc: 0.9650  acc: 0.8684    eval auc: 0.7412  acc: 0.6775    test auc: 0.7401  acc: 0.6772, time: 0.2960
avg time per epoch : 0.3895138692855835
--- 24.787121057510376 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:53:28.277808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:53:28.278166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5163  acc: 0.5098    eval auc: 0.4993  acc: 0.5029    test auc: 0.4974  acc: 0.4937, time: 0.8460
epoch 1    train auc: 0.5267  acc: 0.5133    eval auc: 0.4884  acc: 0.4994    test auc: 0.4918  acc: 0.5006, time: 0.2950
epoch 2    train auc: 0.6198  acc: 0.5729    eval auc: 0.5502  acc: 0.5253    test auc: 0.5549  acc: 0.5309, time: 0.5020
epoch 3    train auc: 0.7346  acc: 0.5029    eval auc: 0.6404  acc: 0.5015    test auc: 0.6557  acc: 0.5049, time: 0.2990
epoch 4    train auc: 0.8404  acc: 0.7370    eval auc: 0.7542  acc: 0.7079    test auc: 0.7578  acc: 0.7219, time: 0.4780
epoch 5    train auc: 0.8633  acc: 0.7181    eval auc: 0.7885  acc: 0.6989    test auc: 0.7883  acc: 0.7102, time: 0.2939
epoch 6    train auc: 0.8750  acc: 0.7313    eval auc: 0.7954  acc: 0.7112    test auc: 0.7947  acc: 0.7211, time: 0.4806
epoch 7    train auc: 0.8832  acc: 0.7499    eval auc: 0.7965  acc: 0.7272    test auc: 0.7965  acc: 0.7365, time: 0.2897
epoch 8    train auc: 0.8879  acc: 0.7574    eval auc: 0.7974  acc: 0.7340    test auc: 0.7975  acc: 0.7434, time: 0.4765
epoch 9    train auc: 0.8914  acc: 0.7750    eval auc: 0.7962  acc: 0.7446    test auc: 0.7972  acc: 0.7539, time: 0.2936
epoch 10    train auc: 0.8941  acc: 0.7814    eval auc: 0.7958  acc: 0.7500    test auc: 0.7973  acc: 0.7549, time: 0.4742
epoch 11    train auc: 0.8969  acc: 0.7813    eval auc: 0.7964  acc: 0.7498    test auc: 0.7975  acc: 0.7555, time: 0.3008
epoch 12    train auc: 0.8992  acc: 0.7823    eval auc: 0.7967  acc: 0.7485    test auc: 0.7977  acc: 0.7549, time: 0.4739
epoch 13    train auc: 0.9013  acc: 0.7899    eval auc: 0.7958  acc: 0.7519    test auc: 0.7973  acc: 0.7552, time: 0.2935
epoch 14    train auc: 0.9034  acc: 0.7931    eval auc: 0.7954  acc: 0.7511    test auc: 0.7970  acc: 0.7522, time: 0.4784
epoch 15    train auc: 0.9055  acc: 0.7951    eval auc: 0.7952  acc: 0.7490    test auc: 0.7968  acc: 0.7490, time: 0.3025
epoch 16    train auc: 0.9074  acc: 0.7960    eval auc: 0.7950  acc: 0.7477    test auc: 0.7962  acc: 0.7470, time: 0.4822
epoch 17    train auc: 0.9096  acc: 0.8033    eval auc: 0.7934  acc: 0.7433    test auc: 0.7949  acc: 0.7415, time: 0.2913
epoch 18    train auc: 0.9113  acc: 0.8023    eval auc: 0.7933  acc: 0.7431    test auc: 0.7943  acc: 0.7416, time: 0.4719
epoch 19    train auc: 0.9136  acc: 0.8088    eval auc: 0.7915  acc: 0.7372    test auc: 0.7924  acc: 0.7362, time: 0.2909
epoch 20    train auc: 0.9154  acc: 0.8095    eval auc: 0.7902  acc: 0.7347    test auc: 0.7908  acc: 0.7339, time: 0.4769
epoch 21    train auc: 0.9175  acc: 0.8140    eval auc: 0.7879  acc: 0.7294    test auc: 0.7885  acc: 0.7278, time: 0.2957
epoch 22    train auc: 0.9189  acc: 0.8142    eval auc: 0.7870  acc: 0.7292    test auc: 0.7869  acc: 0.7283, time: 0.4835
epoch 23    train auc: 0.9209  acc: 0.8191    eval auc: 0.7842  acc: 0.7206    test auc: 0.7844  acc: 0.7215, time: 0.2929
epoch 24    train auc: 0.9221  acc: 0.8195    eval auc: 0.7833  acc: 0.7200    test auc: 0.7830  acc: 0.7199, time: 0.4779
epoch 25    train auc: 0.9235  acc: 0.8222    eval auc: 0.7814  acc: 0.7150    test auc: 0.7811  acc: 0.7166, time: 0.2999
epoch 26    train auc: 0.9247  acc: 0.8233    eval auc: 0.7802  acc: 0.7135    test auc: 0.7798  acc: 0.7158, time: 0.4940
epoch 27    train auc: 0.9258  acc: 0.8239    eval auc: 0.7791  acc: 0.7121    test auc: 0.7784  acc: 0.7120, time: 0.3200
epoch 28    train auc: 0.9267  acc: 0.8257    eval auc: 0.7781  acc: 0.7088    test auc: 0.7772  acc: 0.7086, time: 0.5250
epoch 29    train auc: 0.9275  acc: 0.8263    eval auc: 0.7782  acc: 0.7106    test auc: 0.7767  acc: 0.7095, time: 0.3110
epoch 30    train auc: 0.9284  acc: 0.8275    eval auc: 0.7769  acc: 0.7087    test auc: 0.7756  acc: 0.7074, time: 0.4890
epoch 31    train auc: 0.9293  acc: 0.8290    eval auc: 0.7755  acc: 0.7060    test auc: 0.7739  acc: 0.7065, time: 0.2959
epoch 32    train auc: 0.9296  acc: 0.8273    eval auc: 0.7764  acc: 0.7101    test auc: 0.7741  acc: 0.7070, time: 0.4920
epoch 33    train auc: 0.9306  acc: 0.8306    eval auc: 0.7751  acc: 0.7068    test auc: 0.7731  acc: 0.7058, time: 0.3130
epoch 34    train auc: 0.9313  acc: 0.8315    eval auc: 0.7743  acc: 0.7047    test auc: 0.7724  acc: 0.7030, time: 0.5061
epoch 35    train auc: 0.9318  acc: 0.8326    eval auc: 0.7734  acc: 0.7036    test auc: 0.7716  acc: 0.6995, time: 0.2920
epoch 36    train auc: 0.9321  acc: 0.8311    eval auc: 0.7749  acc: 0.7088    test auc: 0.7722  acc: 0.7035, time: 0.4800
epoch 37    train auc: 0.9329  acc: 0.8337    eval auc: 0.7726  acc: 0.7007    test auc: 0.7706  acc: 0.6983, time: 0.3039
epoch 38    train auc: 0.9334  acc: 0.8336    eval auc: 0.7733  acc: 0.7045    test auc: 0.7704  acc: 0.7019, time: 0.4790
epoch 39    train auc: 0.9339  acc: 0.8357    eval auc: 0.7710  acc: 0.6969    test auc: 0.7689  acc: 0.6961, time: 0.2960
epoch 40    train auc: 0.9345  acc: 0.8351    eval auc: 0.7723  acc: 0.7027    test auc: 0.7695  acc: 0.7009, time: 0.4913
epoch 41    train auc: 0.9350  acc: 0.8367    eval auc: 0.7713  acc: 0.6987    test auc: 0.7686  acc: 0.6995, time: 0.2999
epoch 42    train auc: 0.9353  acc: 0.8358    eval auc: 0.7717  acc: 0.7022    test auc: 0.7684  acc: 0.7006, time: 0.4840
epoch 43    train auc: 0.9360  acc: 0.8375    eval auc: 0.7703  acc: 0.6983    test auc: 0.7675  acc: 0.6981, time: 0.2929
epoch 44    train auc: 0.9363  acc: 0.8367    eval auc: 0.7707  acc: 0.7003    test auc: 0.7674  acc: 0.6984, time: 0.5040
epoch 45    train auc: 0.9366  acc: 0.8373    eval auc: 0.7705  acc: 0.7001    test auc: 0.7670  acc: 0.6989, time: 0.3140
epoch 46    train auc: 0.9371  acc: 0.8393    eval auc: 0.7699  acc: 0.6983    test auc: 0.7668  acc: 0.6978, time: 0.5160
epoch 47    train auc: 0.9375  acc: 0.8395    eval auc: 0.7695  acc: 0.6990    test auc: 0.7662  acc: 0.6972, time: 0.3300
epoch 48    train auc: 0.9380  acc: 0.8412    eval auc: 0.7684  acc: 0.6971    test auc: 0.7654  acc: 0.6954, time: 0.5030
epoch 49    train auc: 0.9383  acc: 0.8408    eval auc: 0.7687  acc: 0.6991    test auc: 0.7654  acc: 0.6972, time: 0.3020
avg time per epoch : 0.4015094470977783
--- 25.71395206451416 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:53:54.014465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:53:54.014834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4975  acc: 0.4991    eval auc: 0.5096  acc: 0.4986    test auc: 0.4979  acc: 0.5025, time: 1.0111
epoch 1    train auc: 0.4955  acc: 0.4976    eval auc: 0.5116  acc: 0.5012    test auc: 0.5045  acc: 0.5057, time: 0.7250
epoch 2    train auc: 0.5086  acc: 0.5022    eval auc: 0.5308  acc: 0.4945    test auc: 0.5246  acc: 0.4998, time: 0.7236
epoch 3    train auc: 0.8570  acc: 0.7698    eval auc: 0.7544  acc: 0.6702    test auc: 0.7660  acc: 0.6788, time: 0.7446
epoch 4    train auc: 0.8896  acc: 0.7996    eval auc: 0.7805  acc: 0.7297    test auc: 0.7884  acc: 0.7307, time: 0.7110
epoch 5    train auc: 0.9043  acc: 0.8068    eval auc: 0.7835  acc: 0.7189    test auc: 0.7891  acc: 0.7170, time: 0.7090
epoch 6    train auc: 0.9114  acc: 0.8107    eval auc: 0.7842  acc: 0.7143    test auc: 0.7879  acc: 0.7131, time: 0.7380
epoch 7    train auc: 0.9167  acc: 0.8128    eval auc: 0.7821  acc: 0.7082    test auc: 0.7853  acc: 0.7072, time: 0.7510
epoch 8    train auc: 0.9203  acc: 0.8149    eval auc: 0.7767  acc: 0.6977    test auc: 0.7792  acc: 0.6957, time: 0.7190
epoch 9    train auc: 0.9239  acc: 0.8178    eval auc: 0.7796  acc: 0.7080    test auc: 0.7810  acc: 0.7060, time: 0.7575
epoch 10    train auc: 0.9255  acc: 0.8187    eval auc: 0.7777  acc: 0.7013    test auc: 0.7793  acc: 0.7021, time: 0.7280
epoch 11    train auc: 0.9276  acc: 0.8215    eval auc: 0.7778  acc: 0.7029    test auc: 0.7792  acc: 0.7046, time: 0.7456
epoch 12    train auc: 0.9297  acc: 0.8235    eval auc: 0.7738  acc: 0.6964    test auc: 0.7750  acc: 0.7004, time: 0.7432
epoch 13    train auc: 0.9300  acc: 0.8232    eval auc: 0.7744  acc: 0.6947    test auc: 0.7754  acc: 0.6994, time: 0.7289
epoch 14    train auc: 0.9308  acc: 0.8231    eval auc: 0.7711  acc: 0.6922    test auc: 0.7724  acc: 0.6959, time: 0.7408
epoch 15    train auc: 0.9326  acc: 0.8270    eval auc: 0.7724  acc: 0.6961    test auc: 0.7738  acc: 0.7008, time: 0.7199
epoch 16    train auc: 0.9320  acc: 0.8234    eval auc: 0.7689  acc: 0.6884    test auc: 0.7706  acc: 0.6957, time: 0.7279
epoch 17    train auc: 0.9348  acc: 0.8284    eval auc: 0.7715  acc: 0.6974    test auc: 0.7713  acc: 0.6994, time: 0.7348
epoch 18    train auc: 0.9346  acc: 0.8277    eval auc: 0.7687  acc: 0.6936    test auc: 0.7694  acc: 0.6963, time: 0.7442
epoch 19    train auc: 0.9349  acc: 0.8287    eval auc: 0.7698  acc: 0.6937    test auc: 0.7703  acc: 0.6970, time: 0.7272
epoch 20    train auc: 0.9336  acc: 0.8252    eval auc: 0.7662  acc: 0.6887    test auc: 0.7668  acc: 0.6912, time: 0.7219
epoch 21    train auc: 0.9371  acc: 0.8310    eval auc: 0.7692  acc: 0.6948    test auc: 0.7693  acc: 0.6965, time: 0.7300
epoch 22    train auc: 0.9360  acc: 0.8293    eval auc: 0.7663  acc: 0.6883    test auc: 0.7665  acc: 0.6906, time: 0.7189
epoch 23    train auc: 0.9380  acc: 0.8322    eval auc: 0.7663  acc: 0.6895    test auc: 0.7664  acc: 0.6899, time: 0.7169
epoch 24    train auc: 0.9413  acc: 0.8366    eval auc: 0.7658  acc: 0.6898    test auc: 0.7656  acc: 0.6913, time: 0.7170
epoch 25    train auc: 0.9450  acc: 0.8410    eval auc: 0.7639  acc: 0.6885    test auc: 0.7637  acc: 0.6883, time: 0.7420
epoch 26    train auc: 0.9482  acc: 0.8437    eval auc: 0.7602  acc: 0.6843    test auc: 0.7607  acc: 0.6878, time: 0.7303
epoch 27    train auc: 0.9522  acc: 0.8495    eval auc: 0.7575  acc: 0.6820    test auc: 0.7577  acc: 0.6857, time: 0.7400
epoch 28    train auc: 0.9551  acc: 0.8546    eval auc: 0.7566  acc: 0.6847    test auc: 0.7556  acc: 0.6864, time: 0.7432
epoch 29    train auc: 0.9573  acc: 0.8567    eval auc: 0.7544  acc: 0.6856    test auc: 0.7530  acc: 0.6869, time: 0.7408
epoch 30    train auc: 0.9585  acc: 0.8573    eval auc: 0.7534  acc: 0.6861    test auc: 0.7515  acc: 0.6873, time: 0.7270
epoch 31    train auc: 0.9614  acc: 0.8633    eval auc: 0.7515  acc: 0.6893    test auc: 0.7497  acc: 0.6903, time: 0.7160
epoch 32    train auc: 0.9624  acc: 0.8652    eval auc: 0.7510  acc: 0.6899    test auc: 0.7489  acc: 0.6903, time: 0.7460
epoch 33    train auc: 0.9631  acc: 0.8648    eval auc: 0.7495  acc: 0.6889    test auc: 0.7469  acc: 0.6861, time: 0.7234
epoch 34    train auc: 0.9659  acc: 0.8707    eval auc: 0.7475  acc: 0.6874    test auc: 0.7441  acc: 0.6857, time: 0.7218
epoch 35    train auc: 0.9666  acc: 0.8709    eval auc: 0.7486  acc: 0.6905    test auc: 0.7451  acc: 0.6872, time: 0.7270
epoch 36    train auc: 0.9688  acc: 0.8755    eval auc: 0.7466  acc: 0.6897    test auc: 0.7436  acc: 0.6885, time: 0.7259
epoch 37    train auc: 0.9695  acc: 0.8789    eval auc: 0.7455  acc: 0.6905    test auc: 0.7432  acc: 0.6890, time: 0.7192
epoch 38    train auc: 0.9712  acc: 0.8848    eval auc: 0.7441  acc: 0.6904    test auc: 0.7422  acc: 0.6898, time: 0.7010
epoch 39    train auc: 0.9722  acc: 0.8864    eval auc: 0.7421  acc: 0.6890    test auc: 0.7403  acc: 0.6893, time: 0.7020
epoch 40    train auc: 0.9736  acc: 0.8905    eval auc: 0.7458  acc: 0.6929    test auc: 0.7428  acc: 0.6935, time: 0.7132
epoch 41    train auc: 0.9746  acc: 0.8931    eval auc: 0.7439  acc: 0.6897    test auc: 0.7411  acc: 0.6899, time: 0.7400
epoch 42    train auc: 0.9759  acc: 0.8961    eval auc: 0.7443  acc: 0.6886    test auc: 0.7414  acc: 0.6921, time: 0.7480
epoch 43    train auc: 0.9767  acc: 0.8978    eval auc: 0.7441  acc: 0.6899    test auc: 0.7414  acc: 0.6935, time: 0.7180
epoch 44    train auc: 0.9776  acc: 0.9001    eval auc: 0.7441  acc: 0.6885    test auc: 0.7414  acc: 0.6931, time: 0.7281
epoch 45    train auc: 0.9790  acc: 0.9035    eval auc: 0.7399  acc: 0.6849    test auc: 0.7375  acc: 0.6890, time: 0.7089
epoch 46    train auc: 0.9794  acc: 0.9037    eval auc: 0.7417  acc: 0.6882    test auc: 0.7388  acc: 0.6928, time: 0.7173
epoch 47    train auc: 0.9803  acc: 0.9061    eval auc: 0.7406  acc: 0.6880    test auc: 0.7378  acc: 0.6902, time: 0.7019
epoch 48    train auc: 0.9808  acc: 0.9086    eval auc: 0.7406  acc: 0.6872    test auc: 0.7379  acc: 0.6921, time: 0.7150
epoch 49    train auc: 0.9815  acc: 0.9097    eval auc: 0.7379  acc: 0.6856    test auc: 0.7356  acc: 0.6915, time: 0.7180
avg time per epoch : 0.7329827260971069
--- 45.48485279083252 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:54:39.521158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:54:39.521597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5071  acc: 0.5059    eval auc: 0.5120  acc: 0.5022    test auc: 0.5197  acc: 0.5094, time: 1.0205
epoch 1    train auc: 0.5193  acc: 0.5059    eval auc: 0.5250  acc: 0.4971    test auc: 0.5324  acc: 0.5152, time: 0.7175
epoch 2    train auc: 0.5265  acc: 0.5165    eval auc: 0.4883  acc: 0.4949    test auc: 0.4924  acc: 0.4957, time: 0.6910
epoch 3    train auc: 0.5524  acc: 0.5135    eval auc: 0.4545  acc: 0.4924    test auc: 0.4647  acc: 0.4943, time: 0.6910
epoch 4    train auc: 0.5763  acc: 0.5166    eval auc: 0.4287  acc: 0.4789    test auc: 0.4372  acc: 0.4759, time: 0.6945
epoch 5    train auc: 0.5862  acc: 0.5154    eval auc: 0.4264  acc: 0.4779    test auc: 0.4332  acc: 0.4773, time: 0.6839
epoch 6    train auc: 0.6270  acc: 0.5304    eval auc: 0.4469  acc: 0.4592    test auc: 0.4525  acc: 0.4528, time: 0.6870
epoch 7    train auc: 0.6696  acc: 0.5217    eval auc: 0.4869  acc: 0.4699    test auc: 0.4957  acc: 0.4681, time: 0.6945
epoch 8    train auc: 0.8120  acc: 0.6902    eval auc: 0.6779  acc: 0.6677    test auc: 0.6903  acc: 0.6808, time: 0.6900
epoch 9    train auc: 0.8541  acc: 0.6733    eval auc: 0.7754  acc: 0.5747    test auc: 0.7852  acc: 0.5747, time: 0.6953
epoch 10    train auc: 0.8333  acc: 0.5763    eval auc: 0.7771  acc: 0.5257    test auc: 0.7896  acc: 0.5296, time: 0.6789
epoch 11    train auc: 0.8406  acc: 0.6133    eval auc: 0.7744  acc: 0.5409    test auc: 0.7874  acc: 0.5486, time: 0.6719
epoch 12    train auc: 0.8469  acc: 0.6476    eval auc: 0.7725  acc: 0.5624    test auc: 0.7856  acc: 0.5648, time: 0.6817
epoch 13    train auc: 0.8496  acc: 0.6679    eval auc: 0.7701  acc: 0.5739    test auc: 0.7831  acc: 0.5750, time: 0.6940
epoch 14    train auc: 0.8560  acc: 0.6902    eval auc: 0.7708  acc: 0.5889    test auc: 0.7835  acc: 0.5898, time: 0.6710
epoch 15    train auc: 0.8588  acc: 0.7040    eval auc: 0.7701  acc: 0.5998    test auc: 0.7827  acc: 0.6022, time: 0.6795
epoch 16    train auc: 0.8598  acc: 0.7100    eval auc: 0.7691  acc: 0.6054    test auc: 0.7815  acc: 0.6070, time: 0.6770
epoch 17    train auc: 0.8631  acc: 0.7214    eval auc: 0.7699  acc: 0.6179    test auc: 0.7818  acc: 0.6135, time: 0.6745
epoch 18    train auc: 0.8658  acc: 0.7295    eval auc: 0.7704  acc: 0.6230    test auc: 0.7822  acc: 0.6219, time: 0.6860
epoch 19    train auc: 0.8683  acc: 0.7356    eval auc: 0.7713  acc: 0.6291    test auc: 0.7827  acc: 0.6284, time: 0.6892
epoch 20    train auc: 0.8696  acc: 0.7404    eval auc: 0.7711  acc: 0.6334    test auc: 0.7823  acc: 0.6321, time: 0.6699
epoch 21    train auc: 0.8718  acc: 0.7448    eval auc: 0.7719  acc: 0.6363    test auc: 0.7829  acc: 0.6356, time: 0.6650
epoch 22    train auc: 0.8739  acc: 0.7495    eval auc: 0.7725  acc: 0.6407    test auc: 0.7833  acc: 0.6395, time: 0.6703
epoch 23    train auc: 0.8733  acc: 0.7480    eval auc: 0.7714  acc: 0.6393    test auc: 0.7823  acc: 0.6386, time: 0.6580
epoch 24    train auc: 0.8770  acc: 0.7546    eval auc: 0.7735  acc: 0.6451    test auc: 0.7839  acc: 0.6456, time: 0.6800
epoch 25    train auc: 0.8780  acc: 0.7563    eval auc: 0.7736  acc: 0.6465    test auc: 0.7839  acc: 0.6461, time: 0.6589
epoch 26    train auc: 0.8784  acc: 0.7564    eval auc: 0.7731  acc: 0.6468    test auc: 0.7835  acc: 0.6461, time: 0.6691
epoch 27    train auc: 0.8800  acc: 0.7587    eval auc: 0.7737  acc: 0.6499    test auc: 0.7838  acc: 0.6480, time: 0.6569
epoch 28    train auc: 0.8810  acc: 0.7606    eval auc: 0.7739  acc: 0.6516    test auc: 0.7838  acc: 0.6495, time: 0.6520
epoch 29    train auc: 0.8823  acc: 0.7626    eval auc: 0.7743  acc: 0.6536    test auc: 0.7841  acc: 0.6517, time: 0.6704
epoch 30    train auc: 0.8839  acc: 0.7661    eval auc: 0.7751  acc: 0.6575    test auc: 0.7847  acc: 0.6530, time: 0.6678
epoch 31    train auc: 0.8855  acc: 0.7674    eval auc: 0.7758  acc: 0.6597    test auc: 0.7852  acc: 0.6550, time: 0.6570
epoch 32    train auc: 0.8857  acc: 0.7673    eval auc: 0.7753  acc: 0.6605    test auc: 0.7849  acc: 0.6547, time: 0.6759
epoch 33    train auc: 0.8864  acc: 0.7682    eval auc: 0.7755  acc: 0.6609    test auc: 0.7849  acc: 0.6545, time: 0.6747
epoch 34    train auc: 0.8881  acc: 0.7707    eval auc: 0.7764  acc: 0.6629    test auc: 0.7854  acc: 0.6575, time: 0.6562
epoch 35    train auc: 0.8877  acc: 0.7699    eval auc: 0.7754  acc: 0.6612    test auc: 0.7846  acc: 0.6547, time: 0.6782
epoch 36    train auc: 0.8894  acc: 0.7724    eval auc: 0.7765  acc: 0.6625    test auc: 0.7853  acc: 0.6584, time: 0.6568
epoch 37    train auc: 0.8901  acc: 0.7735    eval auc: 0.7766  acc: 0.6628    test auc: 0.7853  acc: 0.6590, time: 0.6540
epoch 38    train auc: 0.8917  acc: 0.7754    eval auc: 0.7774  acc: 0.6668    test auc: 0.7860  acc: 0.6609, time: 0.6520
epoch 39    train auc: 0.8925  acc: 0.7762    eval auc: 0.7775  acc: 0.6670    test auc: 0.7860  acc: 0.6617, time: 0.6310
epoch 40    train auc: 0.8937  acc: 0.7777    eval auc: 0.7780  acc: 0.6681    test auc: 0.7863  acc: 0.6619, time: 0.6626
epoch 41    train auc: 0.8942  acc: 0.7777    eval auc: 0.7779  acc: 0.6687    test auc: 0.7863  acc: 0.6625, time: 0.6579
epoch 42    train auc: 0.8946  acc: 0.7781    eval auc: 0.7777  acc: 0.6676    test auc: 0.7860  acc: 0.6625, time: 0.6552
epoch 43    train auc: 0.8954  acc: 0.7786    eval auc: 0.7778  acc: 0.6694    test auc: 0.7861  acc: 0.6634, time: 0.6886
epoch 44    train auc: 0.8967  acc: 0.7805    eval auc: 0.7784  acc: 0.6713    test auc: 0.7864  acc: 0.6648, time: 0.6580
epoch 45    train auc: 0.8973  acc: 0.7810    eval auc: 0.7785  acc: 0.6717    test auc: 0.7864  acc: 0.6645, time: 0.6963
epoch 46    train auc: 0.8982  acc: 0.7821    eval auc: 0.7786  acc: 0.6722    test auc: 0.7863  acc: 0.6650, time: 0.6887
epoch 47    train auc: 0.8985  acc: 0.7823    eval auc: 0.7783  acc: 0.6725    test auc: 0.7859  acc: 0.6642, time: 0.7092
epoch 48    train auc: 0.8994  acc: 0.7821    eval auc: 0.7785  acc: 0.6728    test auc: 0.7858  acc: 0.6645, time: 0.7138
epoch 49    train auc: 0.9005  acc: 0.7840    eval auc: 0.7789  acc: 0.6761    test auc: 0.7861  acc: 0.6669, time: 0.7219
avg time per epoch : 0.6835042524337769
--- 42.32898664474487 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:55:21.864369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:55:21.864732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4842  acc: 0.4915    eval auc: 0.5282  acc: 0.5143    test auc: 0.5193  acc: 0.5113, time: 1.0466
epoch 1    train auc: 0.5019  acc: 0.5005    eval auc: 0.4907  acc: 0.4946    test auc: 0.5038  acc: 0.5040, time: 0.7280
epoch 2    train auc: 0.5627  acc: 0.5228    eval auc: 0.4190  acc: 0.4695    test auc: 0.4155  acc: 0.4651, time: 0.6679
epoch 3    train auc: 0.8377  acc: 0.7078    eval auc: 0.7196  acc: 0.6900    test auc: 0.7241  acc: 0.7040, time: 0.6958
epoch 4    train auc: 0.8913  acc: 0.7734    eval auc: 0.7818  acc: 0.7396    test auc: 0.7813  acc: 0.7491, time: 0.7001
epoch 5    train auc: 0.9063  acc: 0.7987    eval auc: 0.7891  acc: 0.7374    test auc: 0.7879  acc: 0.7369, time: 0.6640
epoch 6    train auc: 0.9152  acc: 0.8114    eval auc: 0.7884  acc: 0.7269    test auc: 0.7860  acc: 0.7206, time: 0.7110
epoch 7    train auc: 0.9210  acc: 0.8163    eval auc: 0.7857  acc: 0.7220    test auc: 0.7831  acc: 0.7152, time: 0.6740
epoch 8    train auc: 0.9259  acc: 0.8235    eval auc: 0.7790  acc: 0.7079    test auc: 0.7760  acc: 0.7004, time: 0.6710
epoch 9    train auc: 0.9271  acc: 0.8184    eval auc: 0.7826  acc: 0.7166    test auc: 0.7785  acc: 0.7134, time: 0.7166
epoch 10    train auc: 0.9283  acc: 0.8169    eval auc: 0.7817  acc: 0.7158    test auc: 0.7774  acc: 0.7100, time: 0.6659
epoch 11    train auc: 0.9300  acc: 0.8201    eval auc: 0.7813  acc: 0.7148    test auc: 0.7766  acc: 0.7095, time: 0.7282
epoch 12    train auc: 0.9337  acc: 0.8299    eval auc: 0.7735  acc: 0.7024    test auc: 0.7695  acc: 0.7002, time: 0.7189
epoch 13    train auc: 0.9337  acc: 0.8273    eval auc: 0.7776  acc: 0.7098    test auc: 0.7738  acc: 0.7069, time: 0.7309
epoch 14    train auc: 0.9362  acc: 0.8332    eval auc: 0.7701  acc: 0.6964    test auc: 0.7681  acc: 0.6967, time: 0.7486
epoch 15    train auc: 0.9360  acc: 0.8301    eval auc: 0.7745  acc: 0.7076    test auc: 0.7719  acc: 0.7056, time: 0.7309
epoch 16    train auc: 0.9382  acc: 0.8362    eval auc: 0.7697  acc: 0.7006    test auc: 0.7675  acc: 0.6955, time: 0.7419
epoch 17    train auc: 0.9362  acc: 0.8276    eval auc: 0.7716  acc: 0.7029    test auc: 0.7681  acc: 0.7008, time: 0.7498
epoch 18    train auc: 0.9389  acc: 0.8354    eval auc: 0.7697  acc: 0.6997    test auc: 0.7673  acc: 0.6996, time: 0.7340
epoch 19    train auc: 0.9375  acc: 0.8301    eval auc: 0.7719  acc: 0.7041    test auc: 0.7691  acc: 0.7047, time: 0.7355
epoch 20    train auc: 0.9405  acc: 0.8376    eval auc: 0.7677  acc: 0.6994    test auc: 0.7652  acc: 0.6957, time: 0.7510
epoch 21    train auc: 0.9410  acc: 0.8384    eval auc: 0.7666  acc: 0.6964    test auc: 0.7640  acc: 0.6951, time: 0.7239
epoch 22    train auc: 0.9415  acc: 0.8397    eval auc: 0.7674  acc: 0.6984    test auc: 0.7645  acc: 0.6945, time: 0.7369
epoch 23    train auc: 0.9432  acc: 0.8433    eval auc: 0.7645  acc: 0.6943    test auc: 0.7621  acc: 0.6902, time: 0.7336
epoch 24    train auc: 0.9440  acc: 0.8440    eval auc: 0.7638  acc: 0.6959    test auc: 0.7611  acc: 0.6912, time: 0.7250
epoch 25    train auc: 0.9440  acc: 0.8432    eval auc: 0.7576  acc: 0.6859    test auc: 0.7561  acc: 0.6857, time: 0.7472
epoch 26    train auc: 0.9456  acc: 0.8443    eval auc: 0.7621  acc: 0.6926    test auc: 0.7590  acc: 0.6903, time: 0.7347
epoch 27    train auc: 0.9473  acc: 0.8485    eval auc: 0.7610  acc: 0.6904    test auc: 0.7581  acc: 0.6890, time: 0.7284
epoch 28    train auc: 0.9472  acc: 0.8469    eval auc: 0.7619  acc: 0.6926    test auc: 0.7585  acc: 0.6917, time: 0.7140
epoch 29    train auc: 0.9489  acc: 0.8511    eval auc: 0.7621  acc: 0.6925    test auc: 0.7585  acc: 0.6917, time: 0.7299
epoch 30    train auc: 0.9529  acc: 0.8580    eval auc: 0.7587  acc: 0.6867    test auc: 0.7556  acc: 0.6879, time: 0.7080
epoch 31    train auc: 0.9554  acc: 0.8614    eval auc: 0.7570  acc: 0.6877    test auc: 0.7538  acc: 0.6851, time: 0.7200
epoch 32    train auc: 0.9556  acc: 0.8607    eval auc: 0.7591  acc: 0.6918    test auc: 0.7554  acc: 0.6890, time: 0.7390
epoch 33    train auc: 0.9603  acc: 0.8704    eval auc: 0.7578  acc: 0.6910    test auc: 0.7550  acc: 0.6896, time: 0.7484
epoch 34    train auc: 0.9638  acc: 0.8758    eval auc: 0.7522  acc: 0.6839    test auc: 0.7487  acc: 0.6840, time: 0.7379
epoch 35    train auc: 0.9660  acc: 0.8817    eval auc: 0.7553  acc: 0.6882    test auc: 0.7522  acc: 0.6890, time: 0.7220
epoch 36    train auc: 0.9686  acc: 0.8855    eval auc: 0.7500  acc: 0.6839    test auc: 0.7468  acc: 0.6834, time: 0.7476
epoch 37    train auc: 0.9703  acc: 0.8889    eval auc: 0.7513  acc: 0.6877    test auc: 0.7483  acc: 0.6877, time: 0.7269
epoch 38    train auc: 0.9718  acc: 0.8908    eval auc: 0.7497  acc: 0.6853    test auc: 0.7465  acc: 0.6860, time: 0.7200
epoch 39    train auc: 0.9743  acc: 0.8966    eval auc: 0.7474  acc: 0.6815    test auc: 0.7442  acc: 0.6865, time: 0.7262
epoch 40    train auc: 0.9753  acc: 0.8984    eval auc: 0.7479  acc: 0.6858    test auc: 0.7435  acc: 0.6831, time: 0.7180
epoch 41    train auc: 0.9768  acc: 0.9014    eval auc: 0.7467  acc: 0.6858    test auc: 0.7429  acc: 0.6861, time: 0.7271
epoch 42    train auc: 0.9779  acc: 0.9043    eval auc: 0.7456  acc: 0.6870    test auc: 0.7420  acc: 0.6839, time: 0.7090
epoch 43    train auc: 0.9794  acc: 0.9076    eval auc: 0.7423  acc: 0.6844    test auc: 0.7385  acc: 0.6827, time: 0.7420
epoch 44    train auc: 0.9804  acc: 0.9102    eval auc: 0.7426  acc: 0.6844    test auc: 0.7395  acc: 0.6832, time: 0.7275
epoch 45    train auc: 0.9814  acc: 0.9112    eval auc: 0.7411  acc: 0.6832    test auc: 0.7376  acc: 0.6799, time: 0.7283
epoch 46    train auc: 0.9821  acc: 0.9141    eval auc: 0.7416  acc: 0.6844    test auc: 0.7384  acc: 0.6813, time: 0.7272
epoch 47    train auc: 0.9834  acc: 0.9174    eval auc: 0.7375  acc: 0.6807    test auc: 0.7353  acc: 0.6802, time: 0.7385
epoch 48    train auc: 0.9840  acc: 0.9184    eval auc: 0.7384  acc: 0.6839    test auc: 0.7356  acc: 0.6817, time: 0.7207
epoch 49    train auc: 0.9846  acc: 0.9199    eval auc: 0.7393  acc: 0.6839    test auc: 0.7365  acc: 0.6834, time: 0.8948
avg time per epoch : 0.7322731494903565
--- 45.3544807434082 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:56:07.342249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:56:07.342593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5266  acc: 0.5198    eval auc: 0.4981  acc: 0.5001    test auc: 0.4960  acc: 0.4988, time: 1.0570
epoch 1    train auc: 0.5745  acc: 0.5264    eval auc: 0.5264  acc: 0.5175    test auc: 0.5302  acc: 0.5168, time: 0.7570
epoch 2    train auc: 0.6584  acc: 0.5945    eval auc: 0.5576  acc: 0.5585    test auc: 0.5603  acc: 0.5538, time: 0.7440
epoch 3    train auc: 0.7331  acc: 0.5771    eval auc: 0.6251  acc: 0.5645    test auc: 0.6333  acc: 0.5684, time: 0.7240
epoch 4    train auc: 0.8035  acc: 0.7248    eval auc: 0.6882  acc: 0.6828    test auc: 0.6996  acc: 0.6922, time: 0.7410
epoch 5    train auc: 0.8447  acc: 0.7103    eval auc: 0.7213  acc: 0.6872    test auc: 0.7297  acc: 0.6994, time: 0.7220
epoch 6    train auc: 0.8718  acc: 0.7398    eval auc: 0.7497  acc: 0.7104    test auc: 0.7556  acc: 0.7197, time: 0.7209
epoch 7    train auc: 0.8840  acc: 0.7500    eval auc: 0.7636  acc: 0.7177    test auc: 0.7680  acc: 0.7276, time: 0.7300
epoch 8    train auc: 0.8911  acc: 0.7901    eval auc: 0.7686  acc: 0.7285    test auc: 0.7728  acc: 0.7300, time: 0.7230
epoch 9    train auc: 0.8964  acc: 0.7897    eval auc: 0.7724  acc: 0.7304    test auc: 0.7755  acc: 0.7302, time: 0.7259
epoch 10    train auc: 0.9006  acc: 0.7910    eval auc: 0.7753  acc: 0.7297    test auc: 0.7772  acc: 0.7311, time: 0.7060
epoch 11    train auc: 0.9045  acc: 0.8041    eval auc: 0.7774  acc: 0.7257    test auc: 0.7788  acc: 0.7233, time: 0.7140
epoch 12    train auc: 0.9076  acc: 0.8075    eval auc: 0.7783  acc: 0.7248    test auc: 0.7790  acc: 0.7223, time: 0.7240
epoch 13    train auc: 0.9105  acc: 0.8138    eval auc: 0.7790  acc: 0.7207    test auc: 0.7793  acc: 0.7165, time: 0.7010
epoch 14    train auc: 0.9128  acc: 0.8134    eval auc: 0.7799  acc: 0.7213    test auc: 0.7797  acc: 0.7198, time: 0.7050
epoch 15    train auc: 0.9151  acc: 0.8182    eval auc: 0.7801  acc: 0.7179    test auc: 0.7797  acc: 0.7166, time: 0.7119
epoch 16    train auc: 0.9171  acc: 0.8201    eval auc: 0.7803  acc: 0.7177    test auc: 0.7796  acc: 0.7153, time: 0.6960
epoch 17    train auc: 0.9187  acc: 0.8195    eval auc: 0.7808  acc: 0.7192    test auc: 0.7796  acc: 0.7171, time: 0.6990
epoch 18    train auc: 0.9202  acc: 0.8208    eval auc: 0.7803  acc: 0.7178    test auc: 0.7787  acc: 0.7154, time: 0.7000
epoch 19    train auc: 0.9217  acc: 0.8235    eval auc: 0.7797  acc: 0.7144    test auc: 0.7779  acc: 0.7143, time: 0.7100
epoch 20    train auc: 0.9230  acc: 0.8251    eval auc: 0.7785  acc: 0.7117    test auc: 0.7766  acc: 0.7078, time: 0.6980
epoch 21    train auc: 0.9238  acc: 0.8235    eval auc: 0.7801  acc: 0.7166    test auc: 0.7779  acc: 0.7170, time: 0.6970
epoch 22    train auc: 0.9248  acc: 0.8236    eval auc: 0.7799  acc: 0.7171    test auc: 0.7772  acc: 0.7174, time: 0.6940
epoch 23    train auc: 0.9261  acc: 0.8280    eval auc: 0.7769  acc: 0.7102    test auc: 0.7747  acc: 0.7060, time: 0.6860
epoch 24    train auc: 0.9268  acc: 0.8277    eval auc: 0.7779  acc: 0.7135    test auc: 0.7754  acc: 0.7106, time: 0.6880
epoch 25    train auc: 0.9276  acc: 0.8282    eval auc: 0.7776  acc: 0.7114    test auc: 0.7751  acc: 0.7088, time: 0.6839
epoch 26    train auc: 0.9286  acc: 0.8299    eval auc: 0.7756  acc: 0.7080    test auc: 0.7729  acc: 0.7054, time: 0.6870
epoch 27    train auc: 0.9292  acc: 0.8293    eval auc: 0.7760  acc: 0.7095    test auc: 0.7732  acc: 0.7058, time: 0.6750
epoch 28    train auc: 0.9300  acc: 0.8310    eval auc: 0.7748  acc: 0.7089    test auc: 0.7719  acc: 0.7041, time: 0.6909
epoch 29    train auc: 0.9305  acc: 0.8316    eval auc: 0.7749  acc: 0.7095    test auc: 0.7720  acc: 0.7042, time: 0.6710
epoch 30    train auc: 0.9309  acc: 0.8305    eval auc: 0.7760  acc: 0.7109    test auc: 0.7730  acc: 0.7085, time: 0.6780
epoch 31    train auc: 0.9317  acc: 0.8327    eval auc: 0.7738  acc: 0.7072    test auc: 0.7708  acc: 0.7030, time: 0.6670
epoch 32    train auc: 0.9323  acc: 0.8330    eval auc: 0.7728  acc: 0.7055    test auc: 0.7698  acc: 0.7014, time: 0.6860
epoch 33    train auc: 0.9326  acc: 0.8333    eval auc: 0.7737  acc: 0.7073    test auc: 0.7709  acc: 0.7045, time: 0.7110
epoch 34    train auc: 0.9331  acc: 0.8338    eval auc: 0.7730  acc: 0.7043    test auc: 0.7698  acc: 0.7021, time: 0.7250
epoch 35    train auc: 0.9334  acc: 0.8345    eval auc: 0.7710  acc: 0.6988    test auc: 0.7685  acc: 0.6981, time: 0.6790
epoch 36    train auc: 0.9340  acc: 0.8345    eval auc: 0.7714  acc: 0.6997    test auc: 0.7687  acc: 0.6998, time: 0.6770
epoch 37    train auc: 0.9343  acc: 0.8349    eval auc: 0.7697  acc: 0.6972    test auc: 0.7671  acc: 0.6970, time: 0.6740
epoch 38    train auc: 0.9349  acc: 0.8362    eval auc: 0.7713  acc: 0.7030    test auc: 0.7682  acc: 0.6994, time: 0.6920
epoch 39    train auc: 0.9351  acc: 0.8351    eval auc: 0.7713  acc: 0.7037    test auc: 0.7680  acc: 0.7017, time: 0.6620
epoch 40    train auc: 0.9358  acc: 0.8370    eval auc: 0.7700  acc: 0.7015    test auc: 0.7669  acc: 0.6990, time: 0.6530
epoch 41    train auc: 0.9359  acc: 0.8378    eval auc: 0.7704  acc: 0.7029    test auc: 0.7676  acc: 0.7001, time: 0.6820
epoch 42    train auc: 0.9365  acc: 0.8379    eval auc: 0.7675  acc: 0.6982    test auc: 0.7649  acc: 0.6957, time: 0.6630
epoch 43    train auc: 0.9366  acc: 0.8391    eval auc: 0.7697  acc: 0.7022    test auc: 0.7669  acc: 0.6996, time: 0.6670
epoch 44    train auc: 0.9371  acc: 0.8395    eval auc: 0.7685  acc: 0.7010    test auc: 0.7658  acc: 0.6974, time: 0.6599
epoch 45    train auc: 0.9375  acc: 0.8398    eval auc: 0.7678  acc: 0.7011    test auc: 0.7648  acc: 0.6970, time: 0.6650
epoch 46    train auc: 0.9371  acc: 0.8381    eval auc: 0.7688  acc: 0.7028    test auc: 0.7655  acc: 0.7004, time: 0.6530
epoch 47    train auc: 0.9375  acc: 0.8384    eval auc: 0.7689  acc: 0.7030    test auc: 0.7659  acc: 0.7019, time: 0.6620
epoch 48    train auc: 0.9383  acc: 0.8399    eval auc: 0.7661  acc: 0.6978    test auc: 0.7634  acc: 0.6952, time: 0.6760
epoch 49    train auc: 0.9382  acc: 0.8396    eval auc: 0.7680  acc: 0.7024    test auc: 0.7651  acc: 0.7002, time: 0.6490
avg time per epoch : 0.7012686538696289
--- 43.6990008354187 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:56:51.095637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:56:51.096034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4857  acc: 0.4989    eval auc: 0.5243  acc: 0.4994    test auc: 0.5201  acc: 0.5038, time: 0.9910
epoch 1    train auc: 0.7166  acc: 0.6407    eval auc: 0.6870  acc: 0.6168    test auc: 0.7065  acc: 0.6375, time: 0.6850
epoch 2    train auc: 0.8804  acc: 0.7605    eval auc: 0.7896  acc: 0.7337    test auc: 0.7932  acc: 0.7452, time: 0.6810
epoch 3    train auc: 0.8935  acc: 0.7732    eval auc: 0.7978  acc: 0.7415    test auc: 0.7985  acc: 0.7523, time: 0.6590
epoch 4    train auc: 0.9048  acc: 0.7907    eval auc: 0.7944  acc: 0.7407    test auc: 0.7931  acc: 0.7400, time: 0.6640
epoch 5    train auc: 0.9125  acc: 0.7968    eval auc: 0.7921  acc: 0.7320    test auc: 0.7896  acc: 0.7292, time: 0.6590
epoch 6    train auc: 0.9187  acc: 0.8063    eval auc: 0.7905  acc: 0.7289    test auc: 0.7882  acc: 0.7267, time: 0.6739
epoch 7    train auc: 0.9225  acc: 0.8107    eval auc: 0.7874  acc: 0.7251    test auc: 0.7852  acc: 0.7222, time: 0.6500
epoch 8    train auc: 0.9273  acc: 0.8197    eval auc: 0.7823  acc: 0.7159    test auc: 0.7802  acc: 0.7130, time: 0.6700
epoch 9    train auc: 0.9266  acc: 0.8142    eval auc: 0.7826  acc: 0.7180    test auc: 0.7796  acc: 0.7135, time: 0.6880
epoch 10    train auc: 0.9287  acc: 0.8167    eval auc: 0.7805  acc: 0.7150    test auc: 0.7778  acc: 0.7107, time: 0.6690
epoch 11    train auc: 0.9295  acc: 0.8168    eval auc: 0.7795  acc: 0.7130    test auc: 0.7767  acc: 0.7105, time: 0.6740
epoch 12    train auc: 0.9328  acc: 0.8238    eval auc: 0.7771  acc: 0.7124    test auc: 0.7748  acc: 0.7078, time: 0.7810
epoch 13    train auc: 0.9324  acc: 0.8217    eval auc: 0.7779  acc: 0.7115    test auc: 0.7754  acc: 0.7100, time: 0.7670
epoch 14    train auc: 0.9355  acc: 0.8290    eval auc: 0.7745  acc: 0.7063    test auc: 0.7735  acc: 0.7075, time: 0.7990
epoch 15    train auc: 0.9333  acc: 0.8217    eval auc: 0.7754  acc: 0.7092    test auc: 0.7737  acc: 0.7075, time: 0.7780
epoch 16    train auc: 0.9361  acc: 0.8284    eval auc: 0.7744  acc: 0.7070    test auc: 0.7735  acc: 0.7074, time: 0.7800
epoch 17    train auc: 0.9343  acc: 0.8214    eval auc: 0.7728  acc: 0.7060    test auc: 0.7705  acc: 0.7046, time: 0.7740
epoch 18    train auc: 0.9370  acc: 0.8276    eval auc: 0.7725  acc: 0.7065    test auc: 0.7710  acc: 0.7058, time: 0.7860
epoch 19    train auc: 0.9372  acc: 0.8270    eval auc: 0.7727  acc: 0.7068    test auc: 0.7712  acc: 0.7062, time: 0.7620
epoch 20    train auc: 0.9407  acc: 0.8356    eval auc: 0.7707  acc: 0.7035    test auc: 0.7696  acc: 0.7034, time: 0.7789
epoch 21    train auc: 0.9398  acc: 0.8303    eval auc: 0.7707  acc: 0.7050    test auc: 0.7690  acc: 0.7027, time: 0.7760
epoch 22    train auc: 0.9423  acc: 0.8369    eval auc: 0.7701  acc: 0.7043    test auc: 0.7687  acc: 0.7021, time: 0.7590
epoch 23    train auc: 0.9436  acc: 0.8376    eval auc: 0.7687  acc: 0.7029    test auc: 0.7667  acc: 0.7009, time: 0.7700
epoch 24    train auc: 0.9453  acc: 0.8398    eval auc: 0.7668  acc: 0.7010    test auc: 0.7647  acc: 0.7007, time: 0.7720
epoch 25    train auc: 0.9470  acc: 0.8426    eval auc: 0.7651  acc: 0.7004    test auc: 0.7631  acc: 0.7006, time: 0.7840
epoch 26    train auc: 0.9478  acc: 0.8437    eval auc: 0.7647  acc: 0.7000    test auc: 0.7620  acc: 0.6984, time: 0.7620
epoch 27    train auc: 0.9490  acc: 0.8450    eval auc: 0.7632  acc: 0.6998    test auc: 0.7599  acc: 0.6990, time: 0.7760
epoch 28    train auc: 0.9503  acc: 0.8463    eval auc: 0.7607  acc: 0.6976    test auc: 0.7575  acc: 0.6976, time: 0.7780
epoch 29    train auc: 0.9508  acc: 0.8467    eval auc: 0.7619  acc: 0.7022    test auc: 0.7578  acc: 0.6989, time: 0.7600
epoch 30    train auc: 0.9533  acc: 0.8508    eval auc: 0.7594  acc: 0.6987    test auc: 0.7555  acc: 0.6974, time: 0.7660
epoch 31    train auc: 0.9548  acc: 0.8536    eval auc: 0.7566  acc: 0.6977    test auc: 0.7522  acc: 0.6949, time: 0.7650
epoch 32    train auc: 0.9547  acc: 0.8528    eval auc: 0.7571  acc: 0.6994    test auc: 0.7523  acc: 0.6963, time: 0.7690
epoch 33    train auc: 0.9564  acc: 0.8553    eval auc: 0.7547  acc: 0.6977    test auc: 0.7505  acc: 0.6949, time: 0.7690
epoch 34    train auc: 0.9582  acc: 0.8566    eval auc: 0.7521  acc: 0.6947    test auc: 0.7469  acc: 0.6899, time: 0.7800
epoch 35    train auc: 0.9608  acc: 0.8618    eval auc: 0.7536  acc: 0.6980    test auc: 0.7488  acc: 0.6943, time: 0.7640
epoch 36    train auc: 0.9625  acc: 0.8633    eval auc: 0.7504  acc: 0.6948    test auc: 0.7450  acc: 0.6899, time: 0.7660
epoch 37    train auc: 0.9630  acc: 0.8645    eval auc: 0.7518  acc: 0.6983    test auc: 0.7458  acc: 0.6910, time: 0.7750
epoch 38    train auc: 0.9649  acc: 0.8676    eval auc: 0.7499  acc: 0.6959    test auc: 0.7444  acc: 0.6893, time: 0.7880
epoch 39    train auc: 0.9666  acc: 0.8695    eval auc: 0.7474  acc: 0.6949    test auc: 0.7420  acc: 0.6903, time: 0.7630
epoch 40    train auc: 0.9662  acc: 0.8688    eval auc: 0.7478  acc: 0.6964    test auc: 0.7426  acc: 0.6902, time: 0.7620
epoch 41    train auc: 0.9673  acc: 0.8719    eval auc: 0.7491  acc: 0.6967    test auc: 0.7432  acc: 0.6913, time: 0.7730
epoch 42    train auc: 0.9687  acc: 0.8751    eval auc: 0.7488  acc: 0.6962    test auc: 0.7437  acc: 0.6922, time: 0.7790
epoch 43    train auc: 0.9696  acc: 0.8757    eval auc: 0.7464  acc: 0.6931    test auc: 0.7417  acc: 0.6909, time: 0.7630
epoch 44    train auc: 0.9695  acc: 0.8761    eval auc: 0.7474  acc: 0.6954    test auc: 0.7426  acc: 0.6924, time: 0.7680
epoch 45    train auc: 0.9712  acc: 0.8786    eval auc: 0.7461  acc: 0.6945    test auc: 0.7410  acc: 0.6887, time: 0.7560
epoch 46    train auc: 0.9724  acc: 0.8823    eval auc: 0.7440  acc: 0.6931    test auc: 0.7392  acc: 0.6902, time: 0.7620
epoch 47    train auc: 0.9729  acc: 0.8827    eval auc: 0.7452  acc: 0.6919    test auc: 0.7401  acc: 0.6884, time: 0.7610
epoch 48    train auc: 0.9728  acc: 0.8841    eval auc: 0.7454  acc: 0.6939    test auc: 0.7404  acc: 0.6898, time: 0.7609
epoch 49    train auc: 0.9733  acc: 0.8842    eval auc: 0.7439  acc: 0.6934    test auc: 0.7381  acc: 0.6886, time: 0.7600
avg time per epoch : 0.7531307601928711
--- 46.90704011917114 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:57:37.979959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:57:37.980319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5339  acc: 0.5237    eval auc: 0.5193  acc: 0.5197    test auc: 0.5242  acc: 0.5164, time: 1.0460
epoch 1    train auc: 0.6454  acc: 0.5879    eval auc: 0.5630  acc: 0.5453    test auc: 0.5713  acc: 0.5468, time: 0.7530
epoch 2    train auc: 0.6311  acc: 0.5762    eval auc: 0.6314  acc: 0.5643    test auc: 0.6366  acc: 0.5676, time: 0.7570
epoch 3    train auc: 0.7902  acc: 0.7147    eval auc: 0.6794  acc: 0.6527    test auc: 0.6948  acc: 0.6680, time: 0.7690
epoch 4    train auc: 0.8173  acc: 0.7360    eval auc: 0.7088  acc: 0.6971    test auc: 0.7180  acc: 0.7099, time: 0.7690
epoch 5    train auc: 0.8422  acc: 0.7389    eval auc: 0.7299  acc: 0.7100    test auc: 0.7393  acc: 0.7184, time: 0.7560
epoch 6    train auc: 0.8682  acc: 0.7467    eval auc: 0.7600  acc: 0.7215    test auc: 0.7670  acc: 0.7285, time: 0.7489
epoch 7    train auc: 0.8798  acc: 0.7472    eval auc: 0.7752  acc: 0.7233    test auc: 0.7801  acc: 0.7307, time: 0.7390
epoch 8    train auc: 0.8858  acc: 0.7545    eval auc: 0.7823  acc: 0.7298    test auc: 0.7862  acc: 0.7361, time: 0.7520
epoch 9    train auc: 0.8899  acc: 0.7580    eval auc: 0.7856  acc: 0.7307    test auc: 0.7888  acc: 0.7383, time: 0.7050
epoch 10    train auc: 0.8928  acc: 0.7641    eval auc: 0.7880  acc: 0.7340    test auc: 0.7906  acc: 0.7414, time: 0.7460
epoch 11    train auc: 0.8948  acc: 0.7702    eval auc: 0.7897  acc: 0.7396    test auc: 0.7924  acc: 0.7447, time: 0.7150
epoch 12    train auc: 0.8965  acc: 0.7749    eval auc: 0.7908  acc: 0.7416    test auc: 0.7935  acc: 0.7465, time: 0.7470
epoch 13    train auc: 0.8977  acc: 0.7789    eval auc: 0.7919  acc: 0.7409    test auc: 0.7945  acc: 0.7458, time: 0.7260
epoch 14    train auc: 0.8988  acc: 0.7820    eval auc: 0.7924  acc: 0.7398    test auc: 0.7949  acc: 0.7447, time: 0.7260
epoch 15    train auc: 0.8997  acc: 0.7838    eval auc: 0.7926  acc: 0.7380    test auc: 0.7952  acc: 0.7419, time: 0.7310
epoch 16    train auc: 0.9006  acc: 0.7893    eval auc: 0.7930  acc: 0.7381    test auc: 0.7958  acc: 0.7411, time: 0.7110
epoch 17    train auc: 0.9014  acc: 0.7912    eval auc: 0.7931  acc: 0.7365    test auc: 0.7961  acc: 0.7369, time: 0.7270
epoch 18    train auc: 0.9021  acc: 0.7938    eval auc: 0.7933  acc: 0.7365    test auc: 0.7963  acc: 0.7352, time: 0.7279
epoch 19    train auc: 0.9030  acc: 0.7984    eval auc: 0.7930  acc: 0.7352    test auc: 0.7960  acc: 0.7289, time: 0.7100
epoch 20    train auc: 0.9037  acc: 0.8002    eval auc: 0.7929  acc: 0.7323    test auc: 0.7960  acc: 0.7257, time: 0.7180
epoch 21    train auc: 0.9044  acc: 0.7998    eval auc: 0.7929  acc: 0.7318    test auc: 0.7956  acc: 0.7255, time: 0.7100
epoch 22    train auc: 0.9052  acc: 0.8010    eval auc: 0.7926  acc: 0.7301    test auc: 0.7954  acc: 0.7238, time: 0.7150
epoch 23    train auc: 0.9063  acc: 0.8044    eval auc: 0.7925  acc: 0.7282    test auc: 0.7955  acc: 0.7197, time: 0.6950
epoch 24    train auc: 0.9071  acc: 0.8045    eval auc: 0.7922  acc: 0.7287    test auc: 0.7948  acc: 0.7177, time: 0.7060
epoch 25    train auc: 0.9079  acc: 0.8049    eval auc: 0.7919  acc: 0.7268    test auc: 0.7947  acc: 0.7179, time: 0.7090
epoch 26    train auc: 0.9092  acc: 0.8070    eval auc: 0.7916  acc: 0.7241    test auc: 0.7943  acc: 0.7138, time: 0.6890
epoch 27    train auc: 0.9101  acc: 0.8062    eval auc: 0.7911  acc: 0.7239    test auc: 0.7939  acc: 0.7135, time: 0.6940
epoch 28    train auc: 0.9110  acc: 0.8070    eval auc: 0.7909  acc: 0.7224    test auc: 0.7936  acc: 0.7124, time: 0.7050
epoch 29    train auc: 0.9120  acc: 0.8070    eval auc: 0.7907  acc: 0.7226    test auc: 0.7931  acc: 0.7112, time: 0.7010
epoch 30    train auc: 0.9130  acc: 0.8081    eval auc: 0.7907  acc: 0.7207    test auc: 0.7930  acc: 0.7109, time: 0.6880
epoch 31    train auc: 0.9139  acc: 0.8079    eval auc: 0.7902  acc: 0.7224    test auc: 0.7922  acc: 0.7112, time: 0.6960
epoch 32    train auc: 0.9148  acc: 0.8086    eval auc: 0.7898  acc: 0.7230    test auc: 0.7915  acc: 0.7106, time: 0.6899
epoch 33    train auc: 0.9154  acc: 0.8084    eval auc: 0.7898  acc: 0.7239    test auc: 0.7912  acc: 0.7112, time: 0.6790
epoch 34    train auc: 0.9166  acc: 0.8095    eval auc: 0.7895  acc: 0.7242    test auc: 0.7905  acc: 0.7111, time: 0.7050
epoch 35    train auc: 0.9180  acc: 0.8110    eval auc: 0.7895  acc: 0.7210    test auc: 0.7907  acc: 0.7095, time: 0.6800
epoch 36    train auc: 0.9189  acc: 0.8112    eval auc: 0.7892  acc: 0.7218    test auc: 0.7899  acc: 0.7088, time: 0.6770
epoch 37    train auc: 0.9199  acc: 0.8120    eval auc: 0.7891  acc: 0.7210    test auc: 0.7896  acc: 0.7083, time: 0.6870
epoch 38    train auc: 0.9206  acc: 0.8120    eval auc: 0.7888  acc: 0.7219    test auc: 0.7891  acc: 0.7104, time: 0.6840
epoch 39    train auc: 0.9214  acc: 0.8129    eval auc: 0.7883  acc: 0.7211    test auc: 0.7885  acc: 0.7088, time: 0.6800
epoch 40    train auc: 0.9223  acc: 0.8135    eval auc: 0.7880  acc: 0.7223    test auc: 0.7880  acc: 0.7092, time: 0.7000
epoch 41    train auc: 0.9230  acc: 0.8146    eval auc: 0.7883  acc: 0.7223    test auc: 0.7883  acc: 0.7101, time: 0.6700
epoch 42    train auc: 0.9239  acc: 0.8153    eval auc: 0.7874  acc: 0.7217    test auc: 0.7875  acc: 0.7093, time: 0.6670
epoch 43    train auc: 0.9248  acc: 0.8168    eval auc: 0.7876  acc: 0.7231    test auc: 0.7877  acc: 0.7095, time: 0.6770
epoch 44    train auc: 0.9249  acc: 0.8156    eval auc: 0.7873  acc: 0.7239    test auc: 0.7873  acc: 0.7099, time: 0.6949
epoch 45    train auc: 0.9255  acc: 0.8159    eval auc: 0.7866  acc: 0.7233    test auc: 0.7864  acc: 0.7093, time: 0.6700
epoch 46    train auc: 0.9260  acc: 0.8160    eval auc: 0.7862  acc: 0.7231    test auc: 0.7859  acc: 0.7093, time: 0.6700
epoch 47    train auc: 0.9269  acc: 0.8175    eval auc: 0.7863  acc: 0.7233    test auc: 0.7861  acc: 0.7088, time: 0.6670
epoch 48    train auc: 0.9277  acc: 0.8188    eval auc: 0.7859  acc: 0.7219    test auc: 0.7855  acc: 0.7088, time: 0.6700
epoch 49    train auc: 0.9276  acc: 0.8177    eval auc: 0.7854  acc: 0.7232    test auc: 0.7850  acc: 0.7111, time: 0.6630
avg time per epoch : 0.7143601942062378
--- 44.386019229888916 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:58:22.378800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:58:22.379187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4973  acc: 0.4975    eval auc: 0.5032  acc: 0.4989    test auc: 0.5047  acc: 0.5087, time: 1.0270
epoch 1    train auc: 0.5148  acc: 0.5038    eval auc: 0.4733  acc: 0.4921    test auc: 0.4830  acc: 0.4964, time: 0.6740
epoch 2    train auc: 0.5482  acc: 0.5359    eval auc: 0.4267  acc: 0.4424    test auc: 0.4292  acc: 0.4499, time: 0.6570
epoch 3    train auc: 0.5790  acc: 0.5552    eval auc: 0.3863  acc: 0.4235    test auc: 0.3811  acc: 0.4109, time: 0.6610
epoch 4    train auc: 0.5881  acc: 0.5589    eval auc: 0.3734  acc: 0.4121    test auc: 0.3679  acc: 0.4113, time: 0.6540
epoch 5    train auc: 0.5918  acc: 0.5630    eval auc: 0.3690  acc: 0.4074    test auc: 0.3629  acc: 0.4036, time: 0.6580
epoch 6    train auc: 0.5936  acc: 0.5643    eval auc: 0.3664  acc: 0.4061    test auc: 0.3608  acc: 0.4010, time: 0.6890
epoch 7    train auc: 0.5947  acc: 0.5652    eval auc: 0.3652  acc: 0.4063    test auc: 0.3596  acc: 0.3982, time: 0.6960
epoch 8    train auc: 0.5952  acc: 0.5658    eval auc: 0.3642  acc: 0.4038    test auc: 0.3595  acc: 0.3986, time: 0.6630
epoch 9    train auc: 0.5957  acc: 0.5663    eval auc: 0.3641  acc: 0.4051    test auc: 0.3589  acc: 0.3959, time: 0.6610
epoch 10    train auc: 0.5959  acc: 0.5666    eval auc: 0.3639  acc: 0.4044    test auc: 0.3587  acc: 0.3957, time: 0.6490
epoch 11    train auc: 0.5962  acc: 0.5666    eval auc: 0.3637  acc: 0.4032    test auc: 0.3582  acc: 0.3969, time: 0.6819
epoch 12    train auc: 0.5964  acc: 0.5667    eval auc: 0.3638  acc: 0.4042    test auc: 0.3579  acc: 0.3958, time: 0.6640
epoch 13    train auc: 0.5965  acc: 0.5667    eval auc: 0.3636  acc: 0.4041    test auc: 0.3578  acc: 0.3958, time: 0.6520
epoch 14    train auc: 0.5966  acc: 0.5668    eval auc: 0.3634  acc: 0.4023    test auc: 0.3579  acc: 0.3974, time: 0.6520
epoch 15    train auc: 0.5967  acc: 0.5668    eval auc: 0.3633  acc: 0.4038    test auc: 0.3579  acc: 0.3958, time: 0.6670
epoch 16    train auc: 0.5968  acc: 0.5669    eval auc: 0.3633  acc: 0.4012    test auc: 0.3579  acc: 0.3982, time: 0.6630
epoch 17    train auc: 0.5968  acc: 0.5668    eval auc: 0.3631  acc: 0.4032    test auc: 0.3580  acc: 0.3964, time: 0.6700
epoch 18    train auc: 0.5969  acc: 0.5668    eval auc: 0.3633  acc: 0.4036    test auc: 0.3578  acc: 0.3959, time: 0.6750
epoch 19    train auc: 0.5969  acc: 0.5668    eval auc: 0.3632  acc: 0.4025    test auc: 0.3577  acc: 0.3970, time: 0.6730
epoch 20    train auc: 0.5970  acc: 0.5669    eval auc: 0.3630  acc: 0.4028    test auc: 0.3579  acc: 0.3966, time: 0.6570
epoch 21    train auc: 0.5970  acc: 0.5669    eval auc: 0.3632  acc: 0.4038    test auc: 0.3578  acc: 0.3956, time: 0.6790
epoch 22    train auc: 0.5970  acc: 0.5669    eval auc: 0.3630  acc: 0.4023    test auc: 0.3580  acc: 0.3971, time: 0.6720
epoch 23    train auc: 0.5970  acc: 0.5669    eval auc: 0.3629  acc: 0.4021    test auc: 0.3580  acc: 0.3973, time: 0.6640
epoch 24    train auc: 0.5970  acc: 0.5669    eval auc: 0.3628  acc: 0.4028    test auc: 0.3580  acc: 0.3966, time: 0.6750
epoch 25    train auc: 0.5971  acc: 0.5669    eval auc: 0.3629  acc: 0.4030    test auc: 0.3579  acc: 0.3964, time: 0.6560
epoch 26    train auc: 0.5971  acc: 0.5669    eval auc: 0.3629  acc: 0.4024    test auc: 0.3578  acc: 0.3970, time: 0.6730
epoch 27    train auc: 0.5971  acc: 0.5669    eval auc: 0.3627  acc: 0.4024    test auc: 0.3580  acc: 0.3970, time: 0.7139
epoch 28    train auc: 0.5971  acc: 0.5669    eval auc: 0.3626  acc: 0.4015    test auc: 0.3581  acc: 0.3979, time: 0.7900
epoch 29    train auc: 0.5971  acc: 0.5669    eval auc: 0.3627  acc: 0.4030    test auc: 0.3582  acc: 0.3964, time: 0.7920
epoch 30    train auc: 0.5971  acc: 0.5669    eval auc: 0.3625  acc: 0.4021    test auc: 0.3583  acc: 0.3973, time: 0.8410
epoch 31    train auc: 0.5972  acc: 0.5669    eval auc: 0.3625  acc: 0.4002    test auc: 0.3582  acc: 0.3992, time: 0.7860
epoch 32    train auc: 0.5971  acc: 0.5669    eval auc: 0.3623  acc: 0.4015    test auc: 0.3584  acc: 0.3979, time: 0.7709
epoch 33    train auc: 0.5972  acc: 0.5669    eval auc: 0.3627  acc: 0.4013    test auc: 0.3580  acc: 0.3980, time: 0.7800
epoch 34    train auc: 0.5972  acc: 0.5669    eval auc: 0.3627  acc: 0.4025    test auc: 0.3579  acc: 0.3969, time: 0.7700
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3625  acc: 0.4005    test auc: 0.3583  acc: 0.3989, time: 0.7749
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3624  acc: 0.4002    test auc: 0.3583  acc: 0.3992, time: 0.7840
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3624  acc: 0.3990    test auc: 0.3582  acc: 0.4004, time: 0.7620
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3624  acc: 0.3998    test auc: 0.3584  acc: 0.3996, time: 0.7600
epoch 39    train auc: 0.5972  acc: 0.5669    eval auc: 0.3623  acc: 0.3995    test auc: 0.3584  acc: 0.3999, time: 0.7660
epoch 40    train auc: 0.5972  acc: 0.5669    eval auc: 0.3622  acc: 0.3998    test auc: 0.3585  acc: 0.3996, time: 0.7690
epoch 41    train auc: 0.5972  acc: 0.5669    eval auc: 0.3623  acc: 0.4012    test auc: 0.3584  acc: 0.3982, time: 0.7600
epoch 42    train auc: 0.5972  acc: 0.5669    eval auc: 0.3623  acc: 0.4010    test auc: 0.3584  acc: 0.3984, time: 0.7689
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3624  acc: 0.4006    test auc: 0.3583  acc: 0.3987, time: 0.8070
epoch 44    train auc: 0.5972  acc: 0.5669    eval auc: 0.3624  acc: 0.4003    test auc: 0.3583  acc: 0.3991, time: 0.7670
epoch 45    train auc: 0.5972  acc: 0.5669    eval auc: 0.3625  acc: 0.3995    test auc: 0.3582  acc: 0.3999, time: 0.7710
epoch 46    train auc: 0.5972  acc: 0.5669    eval auc: 0.3628  acc: 0.4018    test auc: 0.3580  acc: 0.3976, time: 0.7750
epoch 47    train auc: 0.5972  acc: 0.5669    eval auc: 0.3628  acc: 0.4004    test auc: 0.3579  acc: 0.3990, time: 0.7690
epoch 48    train auc: 0.5972  acc: 0.5669    eval auc: 0.3628  acc: 0.4016    test auc: 0.3579  acc: 0.3978, time: 0.7750
epoch 49    train auc: 0.5972  acc: 0.5669    eval auc: 0.3628  acc: 0.4034    test auc: 0.3579  acc: 0.3960, time: 0.7700
avg time per epoch : 0.7237049579620362
--- 45.15097713470459 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:59:07.601736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:59:07.602085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5052  acc: 0.5013    eval auc: 0.4961  acc: 0.4985    test auc: 0.5016  acc: 0.4970, time: 1.0480
epoch 1    train auc: 0.5337  acc: 0.5226    eval auc: 0.4895  acc: 0.4918    test auc: 0.4897  acc: 0.4939, time: 0.7610
epoch 2    train auc: 0.5783  acc: 0.5485    eval auc: 0.4996  acc: 0.4926    test auc: 0.5049  acc: 0.4973, time: 0.7620
epoch 3    train auc: 0.6876  acc: 0.6317    eval auc: 0.5630  acc: 0.5591    test auc: 0.5666  acc: 0.5556, time: 0.7640
epoch 4    train auc: 0.7781  acc: 0.7119    eval auc: 0.6477  acc: 0.6317    test auc: 0.6570  acc: 0.6331, time: 0.7720
epoch 5    train auc: 0.8453  acc: 0.7280    eval auc: 0.7169  acc: 0.6969    test auc: 0.7249  acc: 0.7068, time: 0.7630
epoch 6    train auc: 0.8756  acc: 0.7576    eval auc: 0.7518  acc: 0.7216    test auc: 0.7568  acc: 0.7283, time: 0.7560
epoch 7    train auc: 0.8881  acc: 0.7681    eval auc: 0.7660  acc: 0.7274    test auc: 0.7696  acc: 0.7361, time: 0.7420
epoch 8    train auc: 0.8943  acc: 0.7951    eval auc: 0.7688  acc: 0.7254    test auc: 0.7715  acc: 0.7281, time: 0.7560
epoch 9    train auc: 0.8997  acc: 0.7979    eval auc: 0.7720  acc: 0.7256    test auc: 0.7738  acc: 0.7274, time: 0.7530
epoch 10    train auc: 0.9041  acc: 0.7984    eval auc: 0.7746  acc: 0.7277    test auc: 0.7756  acc: 0.7291, time: 0.7580
epoch 11    train auc: 0.9078  acc: 0.8089    eval auc: 0.7754  acc: 0.7210    test auc: 0.7761  acc: 0.7209, time: 0.7600
epoch 12    train auc: 0.9109  acc: 0.8101    eval auc: 0.7762  acc: 0.7224    test auc: 0.7764  acc: 0.7212, time: 0.7610
epoch 13    train auc: 0.9137  acc: 0.8155    eval auc: 0.7763  acc: 0.7173    test auc: 0.7761  acc: 0.7160, time: 0.7750
epoch 14    train auc: 0.9161  acc: 0.8155    eval auc: 0.7770  acc: 0.7177    test auc: 0.7764  acc: 0.7178, time: 0.7560
epoch 15    train auc: 0.9182  acc: 0.8199    eval auc: 0.7766  acc: 0.7130    test auc: 0.7760  acc: 0.7137, time: 0.7580
epoch 16    train auc: 0.9200  acc: 0.8213    eval auc: 0.7768  acc: 0.7130    test auc: 0.7759  acc: 0.7117, time: 0.7410
epoch 17    train auc: 0.9216  acc: 0.8223    eval auc: 0.7774  acc: 0.7139    test auc: 0.7762  acc: 0.7146, time: 0.7410
epoch 18    train auc: 0.9229  acc: 0.8232    eval auc: 0.7770  acc: 0.7131    test auc: 0.7755  acc: 0.7141, time: 0.7410
epoch 19    train auc: 0.9243  acc: 0.8264    eval auc: 0.7762  acc: 0.7119    test auc: 0.7744  acc: 0.7095, time: 0.7320
epoch 20    train auc: 0.9255  acc: 0.8292    eval auc: 0.7750  acc: 0.7106    test auc: 0.7731  acc: 0.7043, time: 0.7440
epoch 21    train auc: 0.9264  acc: 0.8258    eval auc: 0.7768  acc: 0.7124    test auc: 0.7746  acc: 0.7111, time: 0.7490
epoch 22    train auc: 0.9273  acc: 0.8260    eval auc: 0.7766  acc: 0.7126    test auc: 0.7740  acc: 0.7114, time: 0.7400
epoch 23    train auc: 0.9284  acc: 0.8307    eval auc: 0.7735  acc: 0.7078    test auc: 0.7712  acc: 0.7021, time: 0.7670
epoch 24    train auc: 0.9291  acc: 0.8290    eval auc: 0.7751  acc: 0.7105    test auc: 0.7724  acc: 0.7085, time: 0.7500
epoch 25    train auc: 0.9300  acc: 0.8311    eval auc: 0.7742  acc: 0.7085    test auc: 0.7717  acc: 0.7052, time: 0.7680
epoch 26    train auc: 0.9308  acc: 0.8325    eval auc: 0.7725  acc: 0.7049    test auc: 0.7698  acc: 0.7021, time: 0.7670
epoch 27    train auc: 0.9314  acc: 0.8328    eval auc: 0.7729  acc: 0.7059    test auc: 0.7700  acc: 0.7028, time: 0.7470
epoch 28    train auc: 0.9321  acc: 0.8331    eval auc: 0.7717  acc: 0.7039    test auc: 0.7688  acc: 0.7021, time: 0.7390
epoch 29    train auc: 0.9327  acc: 0.8336    eval auc: 0.7719  acc: 0.7042    test auc: 0.7689  acc: 0.7032, time: 0.7300
epoch 30    train auc: 0.9330  acc: 0.8340    eval auc: 0.7728  acc: 0.7065    test auc: 0.7698  acc: 0.7053, time: 0.7279
epoch 31    train auc: 0.9339  acc: 0.8359    eval auc: 0.7705  acc: 0.7037    test auc: 0.7675  acc: 0.7004, time: 0.7280
epoch 32    train auc: 0.9344  acc: 0.8355    eval auc: 0.7695  acc: 0.7017    test auc: 0.7666  acc: 0.6990, time: 0.7260
epoch 33    train auc: 0.9348  acc: 0.8351    eval auc: 0.7701  acc: 0.7022    test auc: 0.7674  acc: 0.7010, time: 0.7430
epoch 34    train auc: 0.9352  acc: 0.8354    eval auc: 0.7698  acc: 0.7023    test auc: 0.7668  acc: 0.7007, time: 0.7230
epoch 35    train auc: 0.9356  acc: 0.8363    eval auc: 0.7679  acc: 0.6981    test auc: 0.7655  acc: 0.6943, time: 0.7180
epoch 36    train auc: 0.9360  acc: 0.8371    eval auc: 0.7677  acc: 0.6971    test auc: 0.7652  acc: 0.6941, time: 0.7300
epoch 37    train auc: 0.9364  acc: 0.8378    eval auc: 0.7663  acc: 0.6957    test auc: 0.7640  acc: 0.6918, time: 0.7230
epoch 38    train auc: 0.9371  acc: 0.8377    eval auc: 0.7673  acc: 0.6989    test auc: 0.7646  acc: 0.6952, time: 0.7230
epoch 39    train auc: 0.9371  acc: 0.8365    eval auc: 0.7677  acc: 0.7002    test auc: 0.7650  acc: 0.7004, time: 0.7210
epoch 40    train auc: 0.9378  acc: 0.8386    eval auc: 0.7664  acc: 0.6984    test auc: 0.7639  acc: 0.6941, time: 0.7040
epoch 41    train auc: 0.9381  acc: 0.8381    eval auc: 0.7663  acc: 0.6980    test auc: 0.7639  acc: 0.6944, time: 0.7000
epoch 42    train auc: 0.9385  acc: 0.8404    eval auc: 0.7641  acc: 0.6952    test auc: 0.7619  acc: 0.6905, time: 0.7200
epoch 43    train auc: 0.9388  acc: 0.8391    eval auc: 0.7658  acc: 0.6982    test auc: 0.7635  acc: 0.6951, time: 0.6960
epoch 44    train auc: 0.9392  acc: 0.8406    eval auc: 0.7647  acc: 0.6968    test auc: 0.7626  acc: 0.6936, time: 0.7010
epoch 45    train auc: 0.9396  acc: 0.8413    eval auc: 0.7641  acc: 0.6969    test auc: 0.7618  acc: 0.6936, time: 0.7300
epoch 46    train auc: 0.9395  acc: 0.8402    eval auc: 0.7648  acc: 0.6968    test auc: 0.7623  acc: 0.6956, time: 0.7480
epoch 47    train auc: 0.9400  acc: 0.8414    eval auc: 0.7645  acc: 0.6972    test auc: 0.7622  acc: 0.6952, time: 0.7060
epoch 48    train auc: 0.9404  acc: 0.8419    eval auc: 0.7624  acc: 0.6925    test auc: 0.7603  acc: 0.6910, time: 0.6950
epoch 49    train auc: 0.9406  acc: 0.8417    eval auc: 0.7635  acc: 0.6961    test auc: 0.7614  acc: 0.6937, time: 0.7060
avg time per epoch : 0.7453850317001343
--- 46.46796011924744 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 21:59:54.106747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 21:59:54.107096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4885  acc: 0.4935    eval auc: 0.5246  acc: 0.5161    test auc: 0.5121  acc: 0.5062, time: 1.0450
epoch 1    train auc: 0.4879  acc: 0.4988    eval auc: 0.5111  acc: 0.5008    test auc: 0.5250  acc: 0.5028, time: 0.4430
epoch 2    train auc: 0.5468  acc: 0.5315    eval auc: 0.4316  acc: 0.4516    test auc: 0.4301  acc: 0.4538, time: 0.7270
epoch 3    train auc: 0.7941  acc: 0.7129    eval auc: 0.6806  acc: 0.6823    test auc: 0.6904  acc: 0.6909, time: 0.4360
epoch 4    train auc: 0.8475  acc: 0.6552    eval auc: 0.7798  acc: 0.5711    test auc: 0.7876  acc: 0.5756, time: 0.7260
epoch 5    train auc: 0.8973  acc: 0.7987    eval auc: 0.7870  acc: 0.7278    test auc: 0.7891  acc: 0.7282, time: 0.4530
epoch 6    train auc: 0.8962  acc: 0.7516    eval auc: 0.7744  acc: 0.6347    test auc: 0.7815  acc: 0.6406, time: 0.7240
epoch 7    train auc: 0.9158  acc: 0.8131    eval auc: 0.7815  acc: 0.7099    test auc: 0.7821  acc: 0.7037, time: 0.4570
epoch 8    train auc: 0.9177  acc: 0.8073    eval auc: 0.7735  acc: 0.6859    test auc: 0.7766  acc: 0.6847, time: 0.7210
epoch 9    train auc: 0.9257  acc: 0.8227    eval auc: 0.7741  acc: 0.6969    test auc: 0.7746  acc: 0.6961, time: 0.4390
epoch 10    train auc: 0.9210  acc: 0.8080    eval auc: 0.7688  acc: 0.6852    test auc: 0.7720  acc: 0.6827, time: 0.7220
epoch 11    train auc: 0.9283  acc: 0.8207    eval auc: 0.7766  acc: 0.7048    test auc: 0.7759  acc: 0.7010, time: 0.4420
epoch 12    train auc: 0.9234  acc: 0.8126    eval auc: 0.7692  acc: 0.6877    test auc: 0.7715  acc: 0.6856, time: 0.7150
epoch 13    train auc: 0.9332  acc: 0.8310    eval auc: 0.7701  acc: 0.6942    test auc: 0.7702  acc: 0.6944, time: 0.4500
epoch 14    train auc: 0.9241  acc: 0.8116    eval auc: 0.7634  acc: 0.6811    test auc: 0.7664  acc: 0.6784, time: 0.7110
epoch 15    train auc: 0.9357  acc: 0.8331    eval auc: 0.7682  acc: 0.6935    test auc: 0.7679  acc: 0.6937, time: 0.4409
epoch 16    train auc: 0.9312  acc: 0.8245    eval auc: 0.7631  acc: 0.6844    test auc: 0.7648  acc: 0.6852, time: 0.6960
epoch 17    train auc: 0.9380  acc: 0.8365    eval auc: 0.7666  acc: 0.6900    test auc: 0.7667  acc: 0.6910, time: 0.4360
epoch 18    train auc: 0.9283  acc: 0.8185    eval auc: 0.7604  acc: 0.6812    test auc: 0.7631  acc: 0.6805, time: 0.7040
epoch 19    train auc: 0.9396  acc: 0.8388    eval auc: 0.7662  acc: 0.6926    test auc: 0.7666  acc: 0.6891, time: 0.4270
epoch 20    train auc: 0.9347  acc: 0.8309    eval auc: 0.7593  acc: 0.6812    test auc: 0.7616  acc: 0.6823, time: 0.6940
epoch 21    train auc: 0.9425  acc: 0.8436    eval auc: 0.7621  acc: 0.6849    test auc: 0.7625  acc: 0.6854, time: 0.4270
epoch 22    train auc: 0.9345  acc: 0.8287    eval auc: 0.7577  acc: 0.6793    test auc: 0.7599  acc: 0.6810, time: 0.7050
epoch 23    train auc: 0.9428  acc: 0.8436    eval auc: 0.7634  acc: 0.6889    test auc: 0.7637  acc: 0.6899, time: 0.4220
epoch 24    train auc: 0.9378  acc: 0.8350    eval auc: 0.7570  acc: 0.6789    test auc: 0.7596  acc: 0.6844, time: 0.7069
epoch 25    train auc: 0.9457  acc: 0.8472    eval auc: 0.7613  acc: 0.6861    test auc: 0.7619  acc: 0.6878, time: 0.4190
epoch 26    train auc: 0.9393  acc: 0.8366    eval auc: 0.7575  acc: 0.6799    test auc: 0.7599  acc: 0.6858, time: 0.7090
epoch 27    train auc: 0.9476  acc: 0.8513    eval auc: 0.7587  acc: 0.6832    test auc: 0.7597  acc: 0.6856, time: 0.4180
epoch 28    train auc: 0.9409  acc: 0.8388    eval auc: 0.7565  acc: 0.6795    test auc: 0.7586  acc: 0.6847, time: 0.6950
epoch 29    train auc: 0.9494  acc: 0.8535    eval auc: 0.7575  acc: 0.6815    test auc: 0.7578  acc: 0.6857, time: 0.4310
epoch 30    train auc: 0.9471  acc: 0.8487    eval auc: 0.7578  acc: 0.6846    test auc: 0.7592  acc: 0.6864, time: 0.6780
epoch 31    train auc: 0.9523  acc: 0.8571    eval auc: 0.7540  acc: 0.6798    test auc: 0.7557  acc: 0.6836, time: 0.4230
epoch 32    train auc: 0.9497  acc: 0.8506    eval auc: 0.7545  acc: 0.6785    test auc: 0.7580  acc: 0.6813, time: 0.6860
epoch 33    train auc: 0.9551  acc: 0.8603    eval auc: 0.7502  acc: 0.6745    test auc: 0.7520  acc: 0.6782, time: 0.4449
epoch 34    train auc: 0.9502  acc: 0.8510    eval auc: 0.7552  acc: 0.6798    test auc: 0.7591  acc: 0.6852, time: 0.6940
epoch 35    train auc: 0.9577  acc: 0.8628    eval auc: 0.7500  acc: 0.6749    test auc: 0.7529  acc: 0.6795, time: 0.4290
epoch 36    train auc: 0.9513  acc: 0.8548    eval auc: 0.7517  acc: 0.6779    test auc: 0.7562  acc: 0.6836, time: 0.6840
epoch 37    train auc: 0.9606  acc: 0.8667    eval auc: 0.7487  acc: 0.6763    test auc: 0.7507  acc: 0.6798, time: 0.4350
epoch 38    train auc: 0.9581  acc: 0.8658    eval auc: 0.7498  acc: 0.6792    test auc: 0.7534  acc: 0.6830, time: 0.7080
epoch 39    train auc: 0.9640  acc: 0.8753    eval auc: 0.7471  acc: 0.6766    test auc: 0.7487  acc: 0.6810, time: 0.4290
epoch 40    train auc: 0.9620  acc: 0.8727    eval auc: 0.7477  acc: 0.6806    test auc: 0.7518  acc: 0.6857, time: 0.6970
epoch 41    train auc: 0.9680  acc: 0.8840    eval auc: 0.7449  acc: 0.6798    test auc: 0.7469  acc: 0.6840, time: 0.4260
epoch 42    train auc: 0.9630  acc: 0.8765    eval auc: 0.7444  acc: 0.6820    test auc: 0.7482  acc: 0.6858, time: 0.6930
epoch 43    train auc: 0.9711  acc: 0.8907    eval auc: 0.7462  acc: 0.6854    test auc: 0.7480  acc: 0.6869, time: 0.4300
epoch 44    train auc: 0.9653  acc: 0.8786    eval auc: 0.7422  acc: 0.6827    test auc: 0.7454  acc: 0.6846, time: 0.6920
epoch 45    train auc: 0.9744  acc: 0.8968    eval auc: 0.7412  acc: 0.6841    test auc: 0.7432  acc: 0.6851, time: 0.4180
epoch 46    train auc: 0.9703  acc: 0.8891    eval auc: 0.7388  acc: 0.6820    test auc: 0.7411  acc: 0.6815, time: 0.6960
epoch 47    train auc: 0.9771  acc: 0.9015    eval auc: 0.7416  acc: 0.6857    test auc: 0.7429  acc: 0.6853, time: 0.4300
epoch 48    train auc: 0.9724  acc: 0.8944    eval auc: 0.7386  acc: 0.6845    test auc: 0.7418  acc: 0.6856, time: 0.7269
epoch 49    train auc: 0.9798  acc: 0.9080    eval auc: 0.7387  acc: 0.6865    test auc: 0.7408  acc: 0.6867, time: 0.4210
avg time per epoch : 0.5756441688537598
--- 37.334962368011475 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:00:31.425309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:00:31.425659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5625  acc: 0.5332    eval auc: 0.5345  acc: 0.5221    test auc: 0.5339  acc: 0.5228, time: 1.0130
epoch 1    train auc: 0.5503  acc: 0.5115    eval auc: 0.4649  acc: 0.4924    test auc: 0.4653  acc: 0.4908, time: 0.4200
epoch 2    train auc: 0.7042  acc: 0.5889    eval auc: 0.5833  acc: 0.5620    test auc: 0.5880  acc: 0.5687, time: 0.6780
epoch 3    train auc: 0.5736  acc: 0.5238    eval auc: 0.4307  acc: 0.4821    test auc: 0.4292  acc: 0.4836, time: 0.4440
epoch 4    train auc: 0.6503  acc: 0.6020    eval auc: 0.4825  acc: 0.4835    test auc: 0.4888  acc: 0.4851, time: 0.7070
epoch 5    train auc: 0.6768  acc: 0.6247    eval auc: 0.5049  acc: 0.5070    test auc: 0.5108  acc: 0.5093, time: 0.4910
epoch 6    train auc: 0.8170  acc: 0.7403    eval auc: 0.6801  acc: 0.6690    test auc: 0.6918  acc: 0.6740, time: 0.8140
epoch 7    train auc: 0.8434  acc: 0.7537    eval auc: 0.7062  acc: 0.6895    test auc: 0.7148  acc: 0.6930, time: 0.4950
epoch 8    train auc: 0.8788  acc: 0.7629    eval auc: 0.7520  acc: 0.7261    test auc: 0.7578  acc: 0.7340, time: 0.8120
epoch 9    train auc: 0.8841  acc: 0.7783    eval auc: 0.7556  acc: 0.7243    test auc: 0.7605  acc: 0.7298, time: 0.4900
epoch 10    train auc: 0.8929  acc: 0.7985    eval auc: 0.7726  acc: 0.7291    test auc: 0.7760  acc: 0.7305, time: 0.8030
epoch 11    train auc: 0.8947  acc: 0.7899    eval auc: 0.7688  acc: 0.7294    test auc: 0.7719  acc: 0.7330, time: 0.4970
epoch 12    train auc: 0.8992  acc: 0.7990    eval auc: 0.7789  acc: 0.7352    test auc: 0.7812  acc: 0.7355, time: 0.8030
epoch 13    train auc: 0.9009  acc: 0.8032    eval auc: 0.7758  acc: 0.7258    test auc: 0.7778  acc: 0.7236, time: 0.4920
epoch 14    train auc: 0.9036  acc: 0.8087    eval auc: 0.7830  acc: 0.7295    test auc: 0.7847  acc: 0.7245, time: 0.7999
epoch 15    train auc: 0.9052  acc: 0.8064    eval auc: 0.7794  acc: 0.7262    test auc: 0.7806  acc: 0.7242, time: 0.5070
epoch 16    train auc: 0.9073  acc: 0.8099    eval auc: 0.7852  acc: 0.7268    test auc: 0.7863  acc: 0.7242, time: 0.7930
epoch 17    train auc: 0.9089  acc: 0.8140    eval auc: 0.7818  acc: 0.7205    test auc: 0.7825  acc: 0.7132, time: 0.5170
epoch 18    train auc: 0.9103  acc: 0.8119    eval auc: 0.7865  acc: 0.7284    test auc: 0.7871  acc: 0.7243, time: 0.8070
epoch 19    train auc: 0.9118  acc: 0.8150    eval auc: 0.7831  acc: 0.7213    test auc: 0.7833  acc: 0.7140, time: 0.4900
epoch 20    train auc: 0.9130  acc: 0.8146    eval auc: 0.7872  acc: 0.7262    test auc: 0.7873  acc: 0.7205, time: 0.7960
epoch 21    train auc: 0.9144  acc: 0.8176    eval auc: 0.7835  acc: 0.7217    test auc: 0.7832  acc: 0.7148, time: 0.4819
epoch 22    train auc: 0.9154  acc: 0.8160    eval auc: 0.7874  acc: 0.7243    test auc: 0.7870  acc: 0.7215, time: 0.7940
epoch 23    train auc: 0.9167  acc: 0.8206    eval auc: 0.7835  acc: 0.7163    test auc: 0.7828  acc: 0.7119, time: 0.4910
epoch 24    train auc: 0.9175  acc: 0.8184    eval auc: 0.7873  acc: 0.7229    test auc: 0.7868  acc: 0.7197, time: 0.8020
epoch 25    train auc: 0.9187  acc: 0.8204    eval auc: 0.7836  acc: 0.7165    test auc: 0.7827  acc: 0.7121, time: 0.4910
epoch 26    train auc: 0.9194  acc: 0.8206    eval auc: 0.7869  acc: 0.7216    test auc: 0.7862  acc: 0.7187, time: 0.7930
epoch 27    train auc: 0.9207  acc: 0.8235    eval auc: 0.7831  acc: 0.7154    test auc: 0.7819  acc: 0.7115, time: 0.4950
epoch 28    train auc: 0.9211  acc: 0.8229    eval auc: 0.7862  acc: 0.7191    test auc: 0.7853  acc: 0.7137, time: 0.8010
epoch 29    train auc: 0.9221  acc: 0.8227    eval auc: 0.7826  acc: 0.7170    test auc: 0.7810  acc: 0.7118, time: 0.4930
epoch 30    train auc: 0.9226  acc: 0.8240    eval auc: 0.7853  acc: 0.7172    test auc: 0.7843  acc: 0.7115, time: 0.7920
epoch 31    train auc: 0.9238  acc: 0.8253    eval auc: 0.7812  acc: 0.7138    test auc: 0.7797  acc: 0.7105, time: 0.4980
epoch 32    train auc: 0.9239  acc: 0.8229    eval auc: 0.7848  acc: 0.7198    test auc: 0.7835  acc: 0.7160, time: 0.8010
epoch 33    train auc: 0.9252  acc: 0.8269    eval auc: 0.7811  acc: 0.7128    test auc: 0.7794  acc: 0.7093, time: 0.4830
epoch 34    train auc: 0.9252  acc: 0.8256    eval auc: 0.7836  acc: 0.7157    test auc: 0.7822  acc: 0.7100, time: 0.8020
epoch 35    train auc: 0.9265  acc: 0.8286    eval auc: 0.7805  acc: 0.7098    test auc: 0.7789  acc: 0.7053, time: 0.4970
epoch 36    train auc: 0.9260  acc: 0.8248    eval auc: 0.7838  acc: 0.7187    test auc: 0.7822  acc: 0.7137, time: 0.7990
epoch 37    train auc: 0.9276  acc: 0.8301    eval auc: 0.7795  acc: 0.7079    test auc: 0.7778  acc: 0.7040, time: 0.4830
epoch 38    train auc: 0.9272  acc: 0.8267    eval auc: 0.7823  acc: 0.7150    test auc: 0.7805  acc: 0.7100, time: 0.7890
epoch 39    train auc: 0.9287  acc: 0.8309    eval auc: 0.7782  acc: 0.7068    test auc: 0.7761  acc: 0.7041, time: 0.4990
epoch 40    train auc: 0.9278  acc: 0.8267    eval auc: 0.7821  acc: 0.7154    test auc: 0.7804  acc: 0.7107, time: 0.7950
epoch 41    train auc: 0.9296  acc: 0.8311    eval auc: 0.7782  acc: 0.7086    test auc: 0.7761  acc: 0.7050, time: 0.4930
epoch 42    train auc: 0.9288  acc: 0.8276    eval auc: 0.7814  acc: 0.7145    test auc: 0.7794  acc: 0.7109, time: 0.7990
epoch 43    train auc: 0.9303  acc: 0.8301    eval auc: 0.7774  acc: 0.7093    test auc: 0.7748  acc: 0.7061, time: 0.4769
epoch 44    train auc: 0.9296  acc: 0.8283    eval auc: 0.7805  acc: 0.7127    test auc: 0.7785  acc: 0.7089, time: 0.7990
epoch 45    train auc: 0.9308  acc: 0.8291    eval auc: 0.7770  acc: 0.7089    test auc: 0.7742  acc: 0.7074, time: 0.4870
epoch 46    train auc: 0.9301  acc: 0.8293    eval auc: 0.7797  acc: 0.7088    test auc: 0.7777  acc: 0.7082, time: 0.8050
epoch 47    train auc: 0.9317  acc: 0.8308    eval auc: 0.7762  acc: 0.7072    test auc: 0.7735  acc: 0.7050, time: 0.5000
epoch 48    train auc: 0.9311  acc: 0.8309    eval auc: 0.7783  acc: 0.7082    test auc: 0.7762  acc: 0.7054, time: 0.7889
epoch 49    train auc: 0.9324  acc: 0.8318    eval auc: 0.7756  acc: 0.7058    test auc: 0.7729  acc: 0.7047, time: 0.4660
avg time per epoch : 0.64326021194458
--- 41.65896773338318 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:01:13.145054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:01:13.145390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4852  acc: 0.4979    eval auc: 0.5261  acc: 0.5016    test auc: 0.5306  acc: 0.5071, time: 1.0530
epoch 1    train auc: 0.7086  acc: 0.5552    eval auc: 0.6517  acc: 0.5514    test auc: 0.6679  acc: 0.5520, time: 0.4740
epoch 2    train auc: 0.8823  acc: 0.7798    eval auc: 0.7841  acc: 0.7457    test auc: 0.7902  acc: 0.7539, time: 0.7930
epoch 3    train auc: 0.9010  acc: 0.8077    eval auc: 0.7912  acc: 0.7309    test auc: 0.7938  acc: 0.7277, time: 0.4880
epoch 4    train auc: 0.9105  acc: 0.8064    eval auc: 0.7929  acc: 0.7331    test auc: 0.7927  acc: 0.7316, time: 0.7710
epoch 5    train auc: 0.9183  acc: 0.8210    eval auc: 0.7888  acc: 0.7170    test auc: 0.7885  acc: 0.7075, time: 0.4750
epoch 6    train auc: 0.9234  acc: 0.8214    eval auc: 0.7851  acc: 0.7172    test auc: 0.7833  acc: 0.7111, time: 0.7590
epoch 7    train auc: 0.9277  acc: 0.8261    eval auc: 0.7801  acc: 0.7072    test auc: 0.7781  acc: 0.7017, time: 0.4710
epoch 8    train auc: 0.9296  acc: 0.8267    eval auc: 0.7767  acc: 0.7059    test auc: 0.7742  acc: 0.6988, time: 0.7680
epoch 9    train auc: 0.9328  acc: 0.8330    eval auc: 0.7729  acc: 0.6972    test auc: 0.7709  acc: 0.6950, time: 0.4610
epoch 10    train auc: 0.9331  acc: 0.8286    eval auc: 0.7772  acc: 0.7072    test auc: 0.7745  acc: 0.7023, time: 0.7580
epoch 11    train auc: 0.9339  acc: 0.8259    eval auc: 0.7761  acc: 0.7100    test auc: 0.7729  acc: 0.7006, time: 0.4600
epoch 12    train auc: 0.9360  acc: 0.8328    eval auc: 0.7757  acc: 0.7070    test auc: 0.7728  acc: 0.7006, time: 0.7620
epoch 13    train auc: 0.9394  acc: 0.8403    eval auc: 0.7677  acc: 0.6911    test auc: 0.7656  acc: 0.6913, time: 0.4890
epoch 14    train auc: 0.9410  acc: 0.8424    eval auc: 0.7698  acc: 0.6981    test auc: 0.7676  acc: 0.6945, time: 0.7940
epoch 15    train auc: 0.9438  acc: 0.8481    eval auc: 0.7625  acc: 0.6890    test auc: 0.7602  acc: 0.6846, time: 0.4650
epoch 16    train auc: 0.9454  acc: 0.8486    eval auc: 0.7669  acc: 0.6941    test auc: 0.7638  acc: 0.6902, time: 0.7660
epoch 17    train auc: 0.9491  acc: 0.8532    eval auc: 0.7601  acc: 0.6827    test auc: 0.7590  acc: 0.6817, time: 0.4690
epoch 18    train auc: 0.9513  acc: 0.8573    eval auc: 0.7656  acc: 0.6935    test auc: 0.7642  acc: 0.6910, time: 0.7720
epoch 19    train auc: 0.9552  acc: 0.8643    eval auc: 0.7612  acc: 0.6900    test auc: 0.7602  acc: 0.6874, time: 0.4730
epoch 20    train auc: 0.9578  acc: 0.8661    eval auc: 0.7621  acc: 0.6910    test auc: 0.7608  acc: 0.6892, time: 0.7650
epoch 21    train auc: 0.9626  acc: 0.8761    eval auc: 0.7567  acc: 0.6828    test auc: 0.7559  acc: 0.6827, time: 0.4750
epoch 22    train auc: 0.9649  acc: 0.8798    eval auc: 0.7612  acc: 0.6917    test auc: 0.7600  acc: 0.6908, time: 0.7590
epoch 23    train auc: 0.9683  acc: 0.8881    eval auc: 0.7588  acc: 0.6909    test auc: 0.7579  acc: 0.6922, time: 0.4649
epoch 24    train auc: 0.9720  acc: 0.8966    eval auc: 0.7546  acc: 0.6887    test auc: 0.7539  acc: 0.6861, time: 0.7640
epoch 25    train auc: 0.9747  acc: 0.9015    eval auc: 0.7530  acc: 0.6880    test auc: 0.7525  acc: 0.6874, time: 0.4720
epoch 26    train auc: 0.9770  acc: 0.9057    eval auc: 0.7526  acc: 0.6882    test auc: 0.7517  acc: 0.6869, time: 0.7550
epoch 27    train auc: 0.9791  acc: 0.9107    eval auc: 0.7485  acc: 0.6856    test auc: 0.7471  acc: 0.6851, time: 0.4570
epoch 28    train auc: 0.9797  acc: 0.9119    eval auc: 0.7506  acc: 0.6892    test auc: 0.7492  acc: 0.6879, time: 0.7620
epoch 29    train auc: 0.9817  acc: 0.9153    eval auc: 0.7447  acc: 0.6813    test auc: 0.7438  acc: 0.6812, time: 0.4540
epoch 30    train auc: 0.9830  acc: 0.9191    eval auc: 0.7474  acc: 0.6885    test auc: 0.7467  acc: 0.6880, time: 0.7500
epoch 31    train auc: 0.9846  acc: 0.9233    eval auc: 0.7431  acc: 0.6856    test auc: 0.7422  acc: 0.6844, time: 0.4630
epoch 32    train auc: 0.9856  acc: 0.9253    eval auc: 0.7431  acc: 0.6837    test auc: 0.7424  acc: 0.6860, time: 0.7360
epoch 33    train auc: 0.9862  acc: 0.9277    eval auc: 0.7406  acc: 0.6833    test auc: 0.7388  acc: 0.6815, time: 0.4580
epoch 34    train auc: 0.9874  acc: 0.9314    eval auc: 0.7409  acc: 0.6845    test auc: 0.7402  acc: 0.6836, time: 0.7350
epoch 35    train auc: 0.9884  acc: 0.9344    eval auc: 0.7364  acc: 0.6810    test auc: 0.7361  acc: 0.6793, time: 0.4470
epoch 36    train auc: 0.9894  acc: 0.9385    eval auc: 0.7364  acc: 0.6807    test auc: 0.7358  acc: 0.6833, time: 0.7440
epoch 37    train auc: 0.9901  acc: 0.9397    eval auc: 0.7347  acc: 0.6799    test auc: 0.7346  acc: 0.6787, time: 0.4450
epoch 38    train auc: 0.9905  acc: 0.9419    eval auc: 0.7350  acc: 0.6823    test auc: 0.7357  acc: 0.6811, time: 0.7150
epoch 39    train auc: 0.9913  acc: 0.9456    eval auc: 0.7329  acc: 0.6786    test auc: 0.7327  acc: 0.6778, time: 0.4410
epoch 40    train auc: 0.9914  acc: 0.9433    eval auc: 0.7331  acc: 0.6813    test auc: 0.7339  acc: 0.6836, time: 0.7320
epoch 41    train auc: 0.9920  acc: 0.9472    eval auc: 0.7322  acc: 0.6793    test auc: 0.7326  acc: 0.6794, time: 0.4350
epoch 42    train auc: 0.9919  acc: 0.9444    eval auc: 0.7325  acc: 0.6813    test auc: 0.7329  acc: 0.6815, time: 0.7340
epoch 43    train auc: 0.9928  acc: 0.9488    eval auc: 0.7282  acc: 0.6748    test auc: 0.7298  acc: 0.6772, time: 0.4270
epoch 44    train auc: 0.9932  acc: 0.9511    eval auc: 0.7285  acc: 0.6742    test auc: 0.7297  acc: 0.6769, time: 0.6980
epoch 45    train auc: 0.9936  acc: 0.9523    eval auc: 0.7291  acc: 0.6759    test auc: 0.7302  acc: 0.6780, time: 0.4540
epoch 46    train auc: 0.9939  acc: 0.9535    eval auc: 0.7262  acc: 0.6752    test auc: 0.7281  acc: 0.6765, time: 0.6990
epoch 47    train auc: 0.9940  acc: 0.9540    eval auc: 0.7260  acc: 0.6740    test auc: 0.7279  acc: 0.6780, time: 0.4350
epoch 48    train auc: 0.9942  acc: 0.9543    eval auc: 0.7278  acc: 0.6756    test auc: 0.7296  acc: 0.6784, time: 0.7019
epoch 49    train auc: 0.9946  acc: 0.9569    eval auc: 0.7251  acc: 0.6739    test auc: 0.7273  acc: 0.6776, time: 0.4300
avg time per epoch : 0.6105690240859986
--- 39.73600149154663 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:01:52.944818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:01:52.945265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5223  acc: 0.5041    eval auc: 0.4768  acc: 0.4969    test auc: 0.4747  acc: 0.4898, time: 1.0180
epoch 1    train auc: 0.5536  acc: 0.5159    eval auc: 0.4824  acc: 0.5025    test auc: 0.4793  acc: 0.4996, time: 0.4540
epoch 2    train auc: 0.6834  acc: 0.5503    eval auc: 0.5789  acc: 0.5423    test auc: 0.5913  acc: 0.5402, time: 0.7410
epoch 3    train auc: 0.8110  acc: 0.6840    eval auc: 0.7142  acc: 0.6634    test auc: 0.7230  acc: 0.6765, time: 0.4369
epoch 4    train auc: 0.8664  acc: 0.7117    eval auc: 0.7603  acc: 0.6910    test auc: 0.7652  acc: 0.7042, time: 0.7140
epoch 5    train auc: 0.8829  acc: 0.7343    eval auc: 0.7791  acc: 0.7111    test auc: 0.7828  acc: 0.7206, time: 0.4420
epoch 6    train auc: 0.8913  acc: 0.7618    eval auc: 0.7869  acc: 0.7337    test auc: 0.7903  acc: 0.7428, time: 0.7260
epoch 7    train auc: 0.8961  acc: 0.7777    eval auc: 0.7890  acc: 0.7459    test auc: 0.7920  acc: 0.7526, time: 0.4410
epoch 8    train auc: 0.8999  acc: 0.7806    eval auc: 0.7905  acc: 0.7468    test auc: 0.7930  acc: 0.7516, time: 0.7110
epoch 9    train auc: 0.9037  acc: 0.7908    eval auc: 0.7901  acc: 0.7435    test auc: 0.7920  acc: 0.7484, time: 0.4460
epoch 10    train auc: 0.9073  acc: 0.8040    eval auc: 0.7890  acc: 0.7335    test auc: 0.7905  acc: 0.7328, time: 0.7280
epoch 11    train auc: 0.9100  acc: 0.8036    eval auc: 0.7886  acc: 0.7337    test auc: 0.7889  acc: 0.7307, time: 0.4740
epoch 12    train auc: 0.9127  acc: 0.8057    eval auc: 0.7880  acc: 0.7309    test auc: 0.7877  acc: 0.7275, time: 0.7110
epoch 13    train auc: 0.9155  acc: 0.8122    eval auc: 0.7864  acc: 0.7248    test auc: 0.7855  acc: 0.7199, time: 0.4310
epoch 14    train auc: 0.9179  acc: 0.8162    eval auc: 0.7857  acc: 0.7242    test auc: 0.7844  acc: 0.7154, time: 0.7110
epoch 15    train auc: 0.9195  acc: 0.8144    eval auc: 0.7849  acc: 0.7257    test auc: 0.7829  acc: 0.7172, time: 0.4340
epoch 16    train auc: 0.9214  acc: 0.8176    eval auc: 0.7841  acc: 0.7228    test auc: 0.7817  acc: 0.7161, time: 0.7060
epoch 17    train auc: 0.9231  acc: 0.8204    eval auc: 0.7830  acc: 0.7192    test auc: 0.7804  acc: 0.7126, time: 0.4379
epoch 18    train auc: 0.9241  acc: 0.8197    eval auc: 0.7830  acc: 0.7190    test auc: 0.7799  acc: 0.7145, time: 0.7070
epoch 19    train auc: 0.9257  acc: 0.8247    eval auc: 0.7804  acc: 0.7113    test auc: 0.7777  acc: 0.7050, time: 0.4270
epoch 20    train auc: 0.9269  acc: 0.8252    eval auc: 0.7802  acc: 0.7124    test auc: 0.7771  acc: 0.7082, time: 0.7010
epoch 21    train auc: 0.9278  acc: 0.8256    eval auc: 0.7796  acc: 0.7134    test auc: 0.7762  acc: 0.7085, time: 0.4380
epoch 22    train auc: 0.9287  acc: 0.8269    eval auc: 0.7789  acc: 0.7118    test auc: 0.7752  acc: 0.7059, time: 0.6880
epoch 23    train auc: 0.9297  acc: 0.8285    eval auc: 0.7774  acc: 0.7100    test auc: 0.7739  acc: 0.7034, time: 0.4340
epoch 24    train auc: 0.9303  acc: 0.8288    eval auc: 0.7775  acc: 0.7112    test auc: 0.7738  acc: 0.7048, time: 0.7210
epoch 25    train auc: 0.9309  acc: 0.8293    eval auc: 0.7772  acc: 0.7122    test auc: 0.7734  acc: 0.7046, time: 0.4290
epoch 26    train auc: 0.9315  acc: 0.8292    eval auc: 0.7772  acc: 0.7121    test auc: 0.7734  acc: 0.7049, time: 0.6890
epoch 27    train auc: 0.9325  acc: 0.8310    eval auc: 0.7749  acc: 0.7054    test auc: 0.7714  acc: 0.6990, time: 0.4250
epoch 28    train auc: 0.9329  acc: 0.8314    eval auc: 0.7753  acc: 0.7049    test auc: 0.7715  acc: 0.7002, time: 0.7230
epoch 29    train auc: 0.9335  acc: 0.8320    eval auc: 0.7746  acc: 0.7053    test auc: 0.7707  acc: 0.6997, time: 0.4270
epoch 30    train auc: 0.9340  acc: 0.8327    eval auc: 0.7738  acc: 0.7037    test auc: 0.7704  acc: 0.6995, time: 0.6770
epoch 31    train auc: 0.9344  acc: 0.8327    eval auc: 0.7728  acc: 0.7041    test auc: 0.7690  acc: 0.6998, time: 0.4200
epoch 32    train auc: 0.9344  acc: 0.8319    eval auc: 0.7734  acc: 0.7065    test auc: 0.7695  acc: 0.7016, time: 0.7009
epoch 33    train auc: 0.9351  acc: 0.8333    eval auc: 0.7723  acc: 0.7046    test auc: 0.7685  acc: 0.6985, time: 0.4180
epoch 34    train auc: 0.9360  acc: 0.8352    eval auc: 0.7702  acc: 0.6997    test auc: 0.7673  acc: 0.6945, time: 0.6990
epoch 35    train auc: 0.9363  acc: 0.8356    eval auc: 0.7709  acc: 0.7001    test auc: 0.7675  acc: 0.6967, time: 0.4220
epoch 36    train auc: 0.9367  acc: 0.8358    eval auc: 0.7706  acc: 0.7007    test auc: 0.7677  acc: 0.6984, time: 0.6960
epoch 37    train auc: 0.9372  acc: 0.8367    eval auc: 0.7689  acc: 0.6990    test auc: 0.7661  acc: 0.6942, time: 0.4410
epoch 38    train auc: 0.9376  acc: 0.8372    eval auc: 0.7691  acc: 0.6993    test auc: 0.7661  acc: 0.6954, time: 0.6900
epoch 39    train auc: 0.9380  acc: 0.8386    eval auc: 0.7682  acc: 0.6994    test auc: 0.7651  acc: 0.6952, time: 0.4529
epoch 40    train auc: 0.9381  acc: 0.8381    eval auc: 0.7689  acc: 0.6997    test auc: 0.7660  acc: 0.6961, time: 0.7030
epoch 41    train auc: 0.9384  acc: 0.8384    eval auc: 0.7668  acc: 0.6958    test auc: 0.7643  acc: 0.6934, time: 0.4210
epoch 42    train auc: 0.9389  acc: 0.8395    eval auc: 0.7672  acc: 0.6975    test auc: 0.7645  acc: 0.6951, time: 0.7010
epoch 43    train auc: 0.9392  acc: 0.8400    eval auc: 0.7667  acc: 0.6971    test auc: 0.7638  acc: 0.6945, time: 0.4510
epoch 44    train auc: 0.9395  acc: 0.8403    eval auc: 0.7666  acc: 0.6980    test auc: 0.7638  acc: 0.6936, time: 0.7340
epoch 45    train auc: 0.9392  acc: 0.8395    eval auc: 0.7668  acc: 0.6982    test auc: 0.7636  acc: 0.6941, time: 0.4780
epoch 46    train auc: 0.9400  acc: 0.8412    eval auc: 0.7654  acc: 0.6957    test auc: 0.7629  acc: 0.6929, time: 0.7620
epoch 47    train auc: 0.9402  acc: 0.8409    eval auc: 0.7654  acc: 0.6962    test auc: 0.7627  acc: 0.6928, time: 0.4570
epoch 48    train auc: 0.9405  acc: 0.8408    eval auc: 0.7634  acc: 0.6936    test auc: 0.7612  acc: 0.6910, time: 0.7490
epoch 49    train auc: 0.9409  acc: 0.8424    eval auc: 0.7642  acc: 0.6941    test auc: 0.7617  acc: 0.6913, time: 0.4540
avg time per epoch : 0.5819615793228149
--- 37.83096408843994 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:02:30.799562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:02:30.799956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4946  acc: 0.4987    eval auc: 0.5139  acc: 0.5056    test auc: 0.5024  acc: 0.4985, time: 1.0610
epoch 1    train auc: 0.6234  acc: 0.5837    eval auc: 0.6146  acc: 0.5734    test auc: 0.6254  acc: 0.5868, time: 0.4340
epoch 2    train auc: 0.8492  acc: 0.7242    eval auc: 0.7558  acc: 0.7061    test auc: 0.7639  acc: 0.7161, time: 0.7240
epoch 3    train auc: 0.8955  acc: 0.7901    eval auc: 0.7918  acc: 0.7472    test auc: 0.7942  acc: 0.7523, time: 0.4359
epoch 4    train auc: 0.8968  acc: 0.7801    eval auc: 0.7950  acc: 0.7433    test auc: 0.7942  acc: 0.7486, time: 0.7370
epoch 5    train auc: 0.9147  acc: 0.8117    eval auc: 0.7886  acc: 0.7249    test auc: 0.7876  acc: 0.7173, time: 0.4580
epoch 6    train auc: 0.9129  acc: 0.7972    eval auc: 0.7924  acc: 0.7335    test auc: 0.7905  acc: 0.7339, time: 0.7130
epoch 7    train auc: 0.9256  acc: 0.8243    eval auc: 0.7777  acc: 0.7078    test auc: 0.7759  acc: 0.6995, time: 0.4400
epoch 8    train auc: 0.9181  acc: 0.7986    eval auc: 0.7876  acc: 0.7258    test auc: 0.7850  acc: 0.7229, time: 0.7180
epoch 9    train auc: 0.9309  acc: 0.8306    eval auc: 0.7717  acc: 0.6982    test auc: 0.7707  acc: 0.6938, time: 0.4360
epoch 10    train auc: 0.9223  acc: 0.8044    eval auc: 0.7864  acc: 0.7268    test auc: 0.7838  acc: 0.7199, time: 0.7220
epoch 11    train auc: 0.9324  acc: 0.8269    eval auc: 0.7758  acc: 0.7091    test auc: 0.7735  acc: 0.7037, time: 0.4350
epoch 12    train auc: 0.9254  acc: 0.8088    eval auc: 0.7855  acc: 0.7251    test auc: 0.7827  acc: 0.7190, time: 0.7180
epoch 13    train auc: 0.9373  acc: 0.8365    eval auc: 0.7685  acc: 0.6957    test auc: 0.7670  acc: 0.6922, time: 0.4320
epoch 14    train auc: 0.9306  acc: 0.8179    eval auc: 0.7811  acc: 0.7165    test auc: 0.7788  acc: 0.7132, time: 0.7810
epoch 15    train auc: 0.9398  acc: 0.8400    eval auc: 0.7650  acc: 0.6923    test auc: 0.7627  acc: 0.6899, time: 0.4820
epoch 16    train auc: 0.9324  acc: 0.8188    eval auc: 0.7767  acc: 0.7102    test auc: 0.7741  acc: 0.7095, time: 0.7980
epoch 17    train auc: 0.9422  acc: 0.8423    eval auc: 0.7635  acc: 0.6923    test auc: 0.7619  acc: 0.6884, time: 0.4870
epoch 18    train auc: 0.9351  acc: 0.8247    eval auc: 0.7751  acc: 0.7105    test auc: 0.7731  acc: 0.7096, time: 0.8330
epoch 19    train auc: 0.9440  acc: 0.8441    eval auc: 0.7609  acc: 0.6913    test auc: 0.7600  acc: 0.6904, time: 0.5040
epoch 20    train auc: 0.9369  acc: 0.8264    eval auc: 0.7708  acc: 0.7047    test auc: 0.7691  acc: 0.7050, time: 0.8260
epoch 21    train auc: 0.9460  acc: 0.8456    eval auc: 0.7587  acc: 0.6883    test auc: 0.7578  acc: 0.6892, time: 0.5040
epoch 22    train auc: 0.9392  acc: 0.8295    eval auc: 0.7690  acc: 0.7034    test auc: 0.7672  acc: 0.7027, time: 0.8230
epoch 23    train auc: 0.9460  acc: 0.8454    eval auc: 0.7614  acc: 0.6926    test auc: 0.7602  acc: 0.6913, time: 0.5120
epoch 24    train auc: 0.9420  acc: 0.8342    eval auc: 0.7656  acc: 0.6987    test auc: 0.7646  acc: 0.6985, time: 0.8170
epoch 25    train auc: 0.9487  acc: 0.8492    eval auc: 0.7558  acc: 0.6865    test auc: 0.7547  acc: 0.6836, time: 0.5060
epoch 26    train auc: 0.9429  acc: 0.8364    eval auc: 0.7661  acc: 0.7016    test auc: 0.7647  acc: 0.7002, time: 0.8070
epoch 27    train auc: 0.9497  acc: 0.8500    eval auc: 0.7559  acc: 0.6877    test auc: 0.7549  acc: 0.6844, time: 0.4850
epoch 28    train auc: 0.9436  acc: 0.8370    eval auc: 0.7646  acc: 0.6990    test auc: 0.7636  acc: 0.6967, time: 0.8220
epoch 29    train auc: 0.9508  acc: 0.8515    eval auc: 0.7544  acc: 0.6872    test auc: 0.7534  acc: 0.6817, time: 0.5060
epoch 30    train auc: 0.9447  acc: 0.8386    eval auc: 0.7634  acc: 0.6984    test auc: 0.7627  acc: 0.6948, time: 0.8400
epoch 31    train auc: 0.9518  acc: 0.8520    eval auc: 0.7537  acc: 0.6860    test auc: 0.7538  acc: 0.6844, time: 0.5050
epoch 32    train auc: 0.9449  acc: 0.8367    eval auc: 0.7612  acc: 0.6961    test auc: 0.7611  acc: 0.6954, time: 0.8040
epoch 33    train auc: 0.9533  acc: 0.8557    eval auc: 0.7503  acc: 0.6817    test auc: 0.7497  acc: 0.6779, time: 0.4950
epoch 34    train auc: 0.9481  acc: 0.8442    eval auc: 0.7610  acc: 0.6967    test auc: 0.7597  acc: 0.6911, time: 0.8190
epoch 35    train auc: 0.9541  acc: 0.8556    eval auc: 0.7499  acc: 0.6814    test auc: 0.7502  acc: 0.6791, time: 0.5020
epoch 36    train auc: 0.9508  acc: 0.8481    eval auc: 0.7585  acc: 0.6938    test auc: 0.7582  acc: 0.6918, time: 0.8360
epoch 37    train auc: 0.9567  acc: 0.8600    eval auc: 0.7476  acc: 0.6787    test auc: 0.7487  acc: 0.6788, time: 0.5040
epoch 38    train auc: 0.9534  acc: 0.8524    eval auc: 0.7573  acc: 0.6915    test auc: 0.7568  acc: 0.6860, time: 0.8160
epoch 39    train auc: 0.9590  acc: 0.8642    eval auc: 0.7484  acc: 0.6801    test auc: 0.7490  acc: 0.6785, time: 0.5070
epoch 40    train auc: 0.9564  acc: 0.8587    eval auc: 0.7564  acc: 0.6906    test auc: 0.7571  acc: 0.6874, time: 0.8030
epoch 41    train auc: 0.9623  acc: 0.8686    eval auc: 0.7449  acc: 0.6759    test auc: 0.7471  acc: 0.6778, time: 0.5019
epoch 42    train auc: 0.9620  acc: 0.8687    eval auc: 0.7503  acc: 0.6813    test auc: 0.7512  acc: 0.6825, time: 0.8209
epoch 43    train auc: 0.9651  acc: 0.8755    eval auc: 0.7480  acc: 0.6786    test auc: 0.7496  acc: 0.6836, time: 0.5050
epoch 44    train auc: 0.9672  acc: 0.8784    eval auc: 0.7469  acc: 0.6797    test auc: 0.7499  acc: 0.6838, time: 0.8180
epoch 45    train auc: 0.9704  acc: 0.8848    eval auc: 0.7367  acc: 0.6671    test auc: 0.7405  acc: 0.6774, time: 0.5040
epoch 46    train auc: 0.9715  acc: 0.8881    eval auc: 0.7451  acc: 0.6797    test auc: 0.7475  acc: 0.6834, time: 0.8190
epoch 47    train auc: 0.9742  acc: 0.8936    eval auc: 0.7399  acc: 0.6753    test auc: 0.7428  acc: 0.6806, time: 0.4909
epoch 48    train auc: 0.9749  acc: 0.8944    eval auc: 0.7442  acc: 0.6813    test auc: 0.7461  acc: 0.6830, time: 0.8310
epoch 49    train auc: 0.9783  acc: 0.9018    eval auc: 0.7352  acc: 0.6741    test auc: 0.7372  acc: 0.6800, time: 0.5070
avg time per epoch : 0.6437034225463867
--- 41.608001470565796 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:03:12.429638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:03:12.429984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5182  acc: 0.5135    eval auc: 0.5019  acc: 0.4989    test auc: 0.5079  acc: 0.5043, time: 1.1030
epoch 1    train auc: 0.5371  acc: 0.5176    eval auc: 0.4588  acc: 0.4823    test auc: 0.4692  acc: 0.4854, time: 0.4960
epoch 2    train auc: 0.6109  acc: 0.5725    eval auc: 0.4832  acc: 0.4829    test auc: 0.4913  acc: 0.4921, time: 0.7800
epoch 3    train auc: 0.5598  acc: 0.5416    eval auc: 0.4156  acc: 0.4433    test auc: 0.4156  acc: 0.4394, time: 0.5010
epoch 4    train auc: 0.5773  acc: 0.5527    eval auc: 0.4028  acc: 0.4326    test auc: 0.4016  acc: 0.4274, time: 0.7990
epoch 5    train auc: 0.5803  acc: 0.5559    eval auc: 0.3945  acc: 0.4247    test auc: 0.3924  acc: 0.4214, time: 0.4870
epoch 6    train auc: 0.6071  acc: 0.5707    eval auc: 0.4061  acc: 0.4335    test auc: 0.4047  acc: 0.4280, time: 0.8010
epoch 7    train auc: 0.6307  acc: 0.5875    eval auc: 0.4238  acc: 0.4429    test auc: 0.4228  acc: 0.4395, time: 0.4990
epoch 8    train auc: 0.7730  acc: 0.6935    eval auc: 0.6042  acc: 0.5515    test auc: 0.6102  acc: 0.5544, time: 0.8120
epoch 9    train auc: 0.8236  acc: 0.7432    eval auc: 0.6668  acc: 0.6333    test auc: 0.6771  acc: 0.6427, time: 0.4900
epoch 10    train auc: 0.8750  acc: 0.7892    eval auc: 0.7361  acc: 0.6864    test auc: 0.7449  acc: 0.6900, time: 0.8100
epoch 11    train auc: 0.8809  acc: 0.7733    eval auc: 0.7406  acc: 0.7196    test auc: 0.7493  acc: 0.7228, time: 0.4920
epoch 12    train auc: 0.8918  acc: 0.7948    eval auc: 0.7628  acc: 0.7288    test auc: 0.7691  acc: 0.7327, time: 0.7930
epoch 13    train auc: 0.8943  acc: 0.7949    eval auc: 0.7592  acc: 0.7231    test auc: 0.7653  acc: 0.7263, time: 0.4870
epoch 14    train auc: 0.8990  acc: 0.8064    eval auc: 0.7707  acc: 0.7219    test auc: 0.7751  acc: 0.7190, time: 0.7920
epoch 15    train auc: 0.9019  acc: 0.8020    eval auc: 0.7660  acc: 0.7218    test auc: 0.7703  acc: 0.7212, time: 0.4730
epoch 16    train auc: 0.9052  acc: 0.8111    eval auc: 0.7741  acc: 0.7230    test auc: 0.7772  acc: 0.7202, time: 0.7850
epoch 17    train auc: 0.9074  acc: 0.8121    eval auc: 0.7690  acc: 0.7121    test auc: 0.7719  acc: 0.7100, time: 0.4740
epoch 18    train auc: 0.9100  acc: 0.8160    eval auc: 0.7765  acc: 0.7219    test auc: 0.7787  acc: 0.7172, time: 0.7670
epoch 19    train auc: 0.9120  acc: 0.8144    eval auc: 0.7719  acc: 0.7156    test auc: 0.7735  acc: 0.7113, time: 0.4820
epoch 20    train auc: 0.9139  acc: 0.8188    eval auc: 0.7780  acc: 0.7200    test auc: 0.7793  acc: 0.7153, time: 0.7610
epoch 21    train auc: 0.9156  acc: 0.8182    eval auc: 0.7735  acc: 0.7161    test auc: 0.7742  acc: 0.7122, time: 0.4760
epoch 22    train auc: 0.9170  acc: 0.8200    eval auc: 0.7792  acc: 0.7204    test auc: 0.7796  acc: 0.7165, time: 0.7719
epoch 23    train auc: 0.9186  acc: 0.8220    eval auc: 0.7744  acc: 0.7126    test auc: 0.7743  acc: 0.7088, time: 0.4730
epoch 24    train auc: 0.9194  acc: 0.8228    eval auc: 0.7792  acc: 0.7151    test auc: 0.7794  acc: 0.7128, time: 0.7620
epoch 25    train auc: 0.9210  acc: 0.8227    eval auc: 0.7758  acc: 0.7159    test auc: 0.7753  acc: 0.7122, time: 0.4720
epoch 26    train auc: 0.9214  acc: 0.8230    eval auc: 0.7796  acc: 0.7128    test auc: 0.7795  acc: 0.7117, time: 0.7560
epoch 27    train auc: 0.9232  acc: 0.8254    eval auc: 0.7756  acc: 0.7140    test auc: 0.7748  acc: 0.7106, time: 0.4580
epoch 28    train auc: 0.9231  acc: 0.8244    eval auc: 0.7792  acc: 0.7119    test auc: 0.7788  acc: 0.7086, time: 0.7610
epoch 29    train auc: 0.9249  acc: 0.8257    eval auc: 0.7759  acc: 0.7144    test auc: 0.7747  acc: 0.7118, time: 0.4640
epoch 30    train auc: 0.9246  acc: 0.8258    eval auc: 0.7787  acc: 0.7112    test auc: 0.7782  acc: 0.7074, time: 0.7540
epoch 31    train auc: 0.9267  acc: 0.8280    eval auc: 0.7745  acc: 0.7104    test auc: 0.7732  acc: 0.7069, time: 0.4620
epoch 32    train auc: 0.9262  acc: 0.8257    eval auc: 0.7790  acc: 0.7148    test auc: 0.7782  acc: 0.7141, time: 0.7500
epoch 33    train auc: 0.9280  acc: 0.8290    eval auc: 0.7747  acc: 0.7100    test auc: 0.7732  acc: 0.7078, time: 0.4550
epoch 34    train auc: 0.9273  acc: 0.8291    eval auc: 0.7773  acc: 0.7073    test auc: 0.7766  acc: 0.7056, time: 0.7330
epoch 35    train auc: 0.9293  acc: 0.8319    eval auc: 0.7739  acc: 0.7067    test auc: 0.7725  acc: 0.7048, time: 0.4859
epoch 36    train auc: 0.9283  acc: 0.8286    eval auc: 0.7780  acc: 0.7104    test auc: 0.7773  acc: 0.7100, time: 0.7980
epoch 37    train auc: 0.9304  acc: 0.8334    eval auc: 0.7727  acc: 0.7035    test auc: 0.7715  acc: 0.7028, time: 0.4820
epoch 38    train auc: 0.9296  acc: 0.8307    eval auc: 0.7765  acc: 0.7076    test auc: 0.7756  acc: 0.7068, time: 0.7740
epoch 39    train auc: 0.9316  acc: 0.8345    eval auc: 0.7716  acc: 0.7011    test auc: 0.7701  acc: 0.7030, time: 0.4810
epoch 40    train auc: 0.9302  acc: 0.8312    eval auc: 0.7764  acc: 0.7085    test auc: 0.7757  acc: 0.7070, time: 0.7830
epoch 41    train auc: 0.9324  acc: 0.8351    eval auc: 0.7723  acc: 0.7026    test auc: 0.7709  acc: 0.7041, time: 0.4780
epoch 42    train auc: 0.9313  acc: 0.8328    eval auc: 0.7756  acc: 0.7070    test auc: 0.7748  acc: 0.7069, time: 0.7690
epoch 43    train auc: 0.9333  acc: 0.8349    eval auc: 0.7717  acc: 0.7020    test auc: 0.7701  acc: 0.7040, time: 0.4770
epoch 44    train auc: 0.9321  acc: 0.8330    eval auc: 0.7748  acc: 0.7052    test auc: 0.7740  acc: 0.7059, time: 0.7730
epoch 45    train auc: 0.9338  acc: 0.8334    eval auc: 0.7719  acc: 0.7030    test auc: 0.7701  acc: 0.7042, time: 0.4640
epoch 46    train auc: 0.9327  acc: 0.8344    eval auc: 0.7738  acc: 0.7036    test auc: 0.7732  acc: 0.7035, time: 0.7550
epoch 47    train auc: 0.9346  acc: 0.8348    eval auc: 0.7709  acc: 0.7024    test auc: 0.7693  acc: 0.7035, time: 0.4710
epoch 48    train auc: 0.9336  acc: 0.8352    eval auc: 0.7723  acc: 0.7006    test auc: 0.7717  acc: 0.7019, time: 0.7610
epoch 49    train auc: 0.9352  acc: 0.8356    eval auc: 0.7704  acc: 0.7020    test auc: 0.7688  acc: 0.7030, time: 0.4620
avg time per epoch : 0.6329127502441406
--- 41.03299856185913 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:03:53.588825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:03:53.589168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4988  acc: 0.4986    eval auc: 0.5132  acc: 0.5029    test auc: 0.5092  acc: 0.5047, time: 1.0950
epoch 1    train auc: 0.8115  acc: 0.6862    eval auc: 0.7624  acc: 0.6713    test auc: 0.7701  acc: 0.6854, time: 0.4700
epoch 2    train auc: 0.8900  acc: 0.7668    eval auc: 0.7990  acc: 0.7396    test auc: 0.7991  acc: 0.7481, time: 0.7590
epoch 3    train auc: 0.9022  acc: 0.7990    eval auc: 0.7982  acc: 0.7435    test auc: 0.7985  acc: 0.7454, time: 0.4660
epoch 4    train auc: 0.9088  acc: 0.8009    eval auc: 0.7961  acc: 0.7362    test auc: 0.7941  acc: 0.7337, time: 0.7060
epoch 5    train auc: 0.9197  acc: 0.8193    eval auc: 0.7896  acc: 0.7226    test auc: 0.7874  acc: 0.7161, time: 0.4409
epoch 6    train auc: 0.9245  acc: 0.8211    eval auc: 0.7865  acc: 0.7211    test auc: 0.7829  acc: 0.7132, time: 0.7160
epoch 7    train auc: 0.9286  acc: 0.8255    eval auc: 0.7815  acc: 0.7130    test auc: 0.7774  acc: 0.7066, time: 0.4250
epoch 8    train auc: 0.9307  acc: 0.8265    eval auc: 0.7779  acc: 0.7106    test auc: 0.7736  acc: 0.7045, time: 0.6880
epoch 9    train auc: 0.9332  acc: 0.8310    eval auc: 0.7731  acc: 0.6975    test auc: 0.7702  acc: 0.6942, time: 0.4230
epoch 10    train auc: 0.9343  acc: 0.8314    eval auc: 0.7743  acc: 0.7045    test auc: 0.7708  acc: 0.7013, time: 0.7100
epoch 11    train auc: 0.9337  acc: 0.8250    eval auc: 0.7740  acc: 0.7073    test auc: 0.7692  acc: 0.7008, time: 0.4240
epoch 12    train auc: 0.9342  acc: 0.8267    eval auc: 0.7770  acc: 0.7099    test auc: 0.7733  acc: 0.7047, time: 0.6880
epoch 13    train auc: 0.9386  acc: 0.8366    eval auc: 0.7669  acc: 0.6942    test auc: 0.7639  acc: 0.6918, time: 0.4240
epoch 14    train auc: 0.9392  acc: 0.8377    eval auc: 0.7690  acc: 0.6984    test auc: 0.7665  acc: 0.6967, time: 0.7040
epoch 15    train auc: 0.9408  acc: 0.8404    eval auc: 0.7629  acc: 0.6896    test auc: 0.7594  acc: 0.6871, time: 0.4270
epoch 16    train auc: 0.9414  acc: 0.8399    eval auc: 0.7645  acc: 0.6916    test auc: 0.7611  acc: 0.6902, time: 0.6850
epoch 17    train auc: 0.9420  acc: 0.8411    eval auc: 0.7618  acc: 0.6900    test auc: 0.7594  acc: 0.6867, time: 0.4240
epoch 18    train auc: 0.9426  acc: 0.8423    eval auc: 0.7630  acc: 0.6919    test auc: 0.7608  acc: 0.6886, time: 0.7100
epoch 19    train auc: 0.9433  acc: 0.8437    eval auc: 0.7624  acc: 0.6929    test auc: 0.7593  acc: 0.6880, time: 0.4249
epoch 20    train auc: 0.9443  acc: 0.8434    eval auc: 0.7596  acc: 0.6870    test auc: 0.7558  acc: 0.6821, time: 0.7050
epoch 21    train auc: 0.9457  acc: 0.8459    eval auc: 0.7587  acc: 0.6863    test auc: 0.7555  acc: 0.6839, time: 0.4319
epoch 22    train auc: 0.9463  acc: 0.8468    eval auc: 0.7585  acc: 0.6870    test auc: 0.7551  acc: 0.6844, time: 0.6880
epoch 23    train auc: 0.9463  acc: 0.8469    eval auc: 0.7595  acc: 0.6878    test auc: 0.7564  acc: 0.6880, time: 0.4180
epoch 24    train auc: 0.9473  acc: 0.8491    eval auc: 0.7579  acc: 0.6857    test auc: 0.7541  acc: 0.6857, time: 0.6990
epoch 25    train auc: 0.9484  acc: 0.8495    eval auc: 0.7565  acc: 0.6877    test auc: 0.7537  acc: 0.6849, time: 0.4279
epoch 26    train auc: 0.9493  acc: 0.8506    eval auc: 0.7560  acc: 0.6865    test auc: 0.7533  acc: 0.6863, time: 0.7010
epoch 27    train auc: 0.9497  acc: 0.8515    eval auc: 0.7555  acc: 0.6880    test auc: 0.7527  acc: 0.6846, time: 0.4300
epoch 28    train auc: 0.9492  acc: 0.8502    eval auc: 0.7577  acc: 0.6895    test auc: 0.7545  acc: 0.6877, time: 0.7039
epoch 29    train auc: 0.9513  acc: 0.8549    eval auc: 0.7514  acc: 0.6826    test auc: 0.7485  acc: 0.6794, time: 0.4310
epoch 30    train auc: 0.9508  acc: 0.8528    eval auc: 0.7543  acc: 0.6883    test auc: 0.7508  acc: 0.6839, time: 0.7160
epoch 31    train auc: 0.9526  acc: 0.8560    eval auc: 0.7516  acc: 0.6827    test auc: 0.7492  acc: 0.6826, time: 0.4280
epoch 32    train auc: 0.9508  acc: 0.8527    eval auc: 0.7531  acc: 0.6858    test auc: 0.7501  acc: 0.6843, time: 0.7170
epoch 33    train auc: 0.9533  acc: 0.8571    eval auc: 0.7499  acc: 0.6819    test auc: 0.7466  acc: 0.6813, time: 0.4440
epoch 34    train auc: 0.9526  acc: 0.8559    eval auc: 0.7514  acc: 0.6852    test auc: 0.7484  acc: 0.6825, time: 0.6940
epoch 35    train auc: 0.9539  acc: 0.8579    eval auc: 0.7469  acc: 0.6810    test auc: 0.7449  acc: 0.6782, time: 0.4300
epoch 36    train auc: 0.9542  acc: 0.8579    eval auc: 0.7479  acc: 0.6827    test auc: 0.7460  acc: 0.6806, time: 0.7060
epoch 37    train auc: 0.9552  acc: 0.8587    eval auc: 0.7467  acc: 0.6808    test auc: 0.7444  acc: 0.6763, time: 0.4360
epoch 38    train auc: 0.9558  acc: 0.8593    eval auc: 0.7480  acc: 0.6825    test auc: 0.7448  acc: 0.6780, time: 0.7020
epoch 39    train auc: 0.9565  acc: 0.8610    eval auc: 0.7463  acc: 0.6805    test auc: 0.7436  acc: 0.6769, time: 0.4340
epoch 40    train auc: 0.9571  acc: 0.8613    eval auc: 0.7472  acc: 0.6801    test auc: 0.7445  acc: 0.6773, time: 0.7260
epoch 41    train auc: 0.9578  acc: 0.8623    eval auc: 0.7453  acc: 0.6791    test auc: 0.7429  acc: 0.6762, time: 0.4280
epoch 42    train auc: 0.9582  acc: 0.8621    eval auc: 0.7475  acc: 0.6807    test auc: 0.7445  acc: 0.6792, time: 0.6980
epoch 43    train auc: 0.9591  acc: 0.8646    eval auc: 0.7455  acc: 0.6794    test auc: 0.7431  acc: 0.6774, time: 0.4700
epoch 44    train auc: 0.9597  acc: 0.8649    eval auc: 0.7477  acc: 0.6818    test auc: 0.7450  acc: 0.6798, time: 0.8310
epoch 45    train auc: 0.9613  acc: 0.8686    eval auc: 0.7463  acc: 0.6808    test auc: 0.7433  acc: 0.6773, time: 0.4950
epoch 46    train auc: 0.9624  acc: 0.8701    eval auc: 0.7408  acc: 0.6745    test auc: 0.7395  acc: 0.6743, time: 0.8360
epoch 47    train auc: 0.9648  acc: 0.8759    eval auc: 0.7435  acc: 0.6804    test auc: 0.7416  acc: 0.6800, time: 0.4970
epoch 48    train auc: 0.9654  acc: 0.8756    eval auc: 0.7394  acc: 0.6738    test auc: 0.7387  acc: 0.6781, time: 0.8160
epoch 49    train auc: 0.9678  acc: 0.8796    eval auc: 0.7392  acc: 0.6758    test auc: 0.7382  acc: 0.6781, time: 0.5030
avg time per epoch : 0.5890406751632691
--- 38.44100618362427 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 8, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:04:31.996588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:04:31.997069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5112  acc: 0.5057    eval auc: 0.4875  acc: 0.4914    test auc: 0.4789  acc: 0.4917, time: 1.1010
epoch 1    train auc: 0.5259  acc: 0.5140    eval auc: 0.4622  acc: 0.4770    test auc: 0.4605  acc: 0.4810, time: 0.4710
epoch 2    train auc: 0.5421  acc: 0.5166    eval auc: 0.4414  acc: 0.4788    test auc: 0.4384  acc: 0.4724, time: 0.7910
epoch 3    train auc: 0.5542  acc: 0.5294    eval auc: 0.4242  acc: 0.4565    test auc: 0.4200  acc: 0.4580, time: 0.4830
epoch 4    train auc: 0.5656  acc: 0.5422    eval auc: 0.4074  acc: 0.4376    test auc: 0.4026  acc: 0.4363, time: 0.7810
epoch 5    train auc: 0.5752  acc: 0.5517    eval auc: 0.3930  acc: 0.4265    test auc: 0.3895  acc: 0.4193, time: 0.4780
epoch 6    train auc: 0.5813  acc: 0.5563    eval auc: 0.3855  acc: 0.4163    test auc: 0.3817  acc: 0.4167, time: 0.7940
epoch 7    train auc: 0.5869  acc: 0.5607    eval auc: 0.3822  acc: 0.4136    test auc: 0.3771  acc: 0.4119, time: 0.4760
epoch 8    train auc: 0.5963  acc: 0.5681    eval auc: 0.3848  acc: 0.4168    test auc: 0.3793  acc: 0.4145, time: 0.7810
epoch 9    train auc: 0.6265  acc: 0.5894    eval auc: 0.4095  acc: 0.4354    test auc: 0.4051  acc: 0.4330, time: 0.4690
epoch 10    train auc: 0.7204  acc: 0.6515    eval auc: 0.5272  acc: 0.4982    test auc: 0.5311  acc: 0.5088, time: 0.7850
epoch 11    train auc: 0.7993  acc: 0.7248    eval auc: 0.6419  acc: 0.6286    test auc: 0.6511  acc: 0.6342, time: 0.4750
epoch 12    train auc: 0.8441  acc: 0.7520    eval auc: 0.7035  acc: 0.6952    test auc: 0.7090  acc: 0.7006, time: 0.7710
epoch 13    train auc: 0.8686  acc: 0.7755    eval auc: 0.7303  acc: 0.7043    test auc: 0.7344  acc: 0.7085, time: 0.4860
epoch 14    train auc: 0.8815  acc: 0.7835    eval auc: 0.7472  acc: 0.7171    test auc: 0.7499  acc: 0.7202, time: 0.7700
epoch 15    train auc: 0.8894  acc: 0.7893    eval auc: 0.7553  acc: 0.7174    test auc: 0.7571  acc: 0.7186, time: 0.4730
epoch 16    train auc: 0.8951  acc: 0.7911    eval auc: 0.7622  acc: 0.7220    test auc: 0.7629  acc: 0.7249, time: 0.7870
epoch 17    train auc: 0.9001  acc: 0.8032    eval auc: 0.7661  acc: 0.7165    test auc: 0.7662  acc: 0.7133, time: 0.4879
epoch 18    train auc: 0.9035  acc: 0.7989    eval auc: 0.7703  acc: 0.7224    test auc: 0.7695  acc: 0.7237, time: 0.7810
epoch 19    train auc: 0.9072  acc: 0.8098    eval auc: 0.7720  acc: 0.7154    test auc: 0.7708  acc: 0.7115, time: 0.4720
epoch 20    train auc: 0.9098  acc: 0.8068    eval auc: 0.7747  acc: 0.7180    test auc: 0.7731  acc: 0.7202, time: 0.7760
epoch 21    train auc: 0.9125  acc: 0.8146    eval auc: 0.7749  acc: 0.7139    test auc: 0.7730  acc: 0.7105, time: 0.4769
epoch 22    train auc: 0.9145  acc: 0.8107    eval auc: 0.7774  acc: 0.7200    test auc: 0.7748  acc: 0.7203, time: 0.7650
epoch 23    train auc: 0.9168  acc: 0.8184    eval auc: 0.7767  acc: 0.7137    test auc: 0.7741  acc: 0.7098, time: 0.4870
epoch 24    train auc: 0.9184  acc: 0.8182    eval auc: 0.7784  acc: 0.7196    test auc: 0.7754  acc: 0.7154, time: 0.7770
epoch 25    train auc: 0.9202  acc: 0.8217    eval auc: 0.7779  acc: 0.7141    test auc: 0.7749  acc: 0.7096, time: 0.4800
epoch 26    train auc: 0.9215  acc: 0.8203    eval auc: 0.7788  acc: 0.7184    test auc: 0.7756  acc: 0.7134, time: 0.7780
epoch 27    train auc: 0.9231  acc: 0.8245    eval auc: 0.7776  acc: 0.7144    test auc: 0.7744  acc: 0.7088, time: 0.4790
epoch 28    train auc: 0.9242  acc: 0.8251    eval auc: 0.7782  acc: 0.7140    test auc: 0.7747  acc: 0.7105, time: 0.7800
epoch 29    train auc: 0.9253  acc: 0.8256    eval auc: 0.7775  acc: 0.7130    test auc: 0.7741  acc: 0.7100, time: 0.4680
epoch 30    train auc: 0.9264  acc: 0.8270    eval auc: 0.7774  acc: 0.7121    test auc: 0.7739  acc: 0.7092, time: 0.7780
epoch 31    train auc: 0.9274  acc: 0.8278    eval auc: 0.7757  acc: 0.7098    test auc: 0.7721  acc: 0.7072, time: 0.4730
epoch 32    train auc: 0.9277  acc: 0.8246    eval auc: 0.7773  acc: 0.7139    test auc: 0.7735  acc: 0.7117, time: 0.7850
epoch 33    train auc: 0.9290  acc: 0.8291    eval auc: 0.7756  acc: 0.7100    test auc: 0.7717  acc: 0.7072, time: 0.4750
epoch 34    train auc: 0.9298  acc: 0.8304    eval auc: 0.7755  acc: 0.7088    test auc: 0.7718  acc: 0.7078, time: 0.8209
epoch 35    train auc: 0.9306  acc: 0.8317    eval auc: 0.7740  acc: 0.7063    test auc: 0.7704  acc: 0.7040, time: 0.4990
epoch 36    train auc: 0.9307  acc: 0.8294    eval auc: 0.7760  acc: 0.7122    test auc: 0.7722  acc: 0.7100, time: 0.7670
epoch 37    train auc: 0.9318  acc: 0.8333    eval auc: 0.7723  acc: 0.7037    test auc: 0.7688  acc: 0.7011, time: 0.4659
epoch 38    train auc: 0.9321  acc: 0.8314    eval auc: 0.7742  acc: 0.7076    test auc: 0.7702  acc: 0.7049, time: 0.7830
epoch 39    train auc: 0.9331  acc: 0.8341    eval auc: 0.7715  acc: 0.7030    test auc: 0.7677  acc: 0.6998, time: 0.4640
epoch 40    train auc: 0.9332  acc: 0.8324    eval auc: 0.7734  acc: 0.7068    test auc: 0.7696  acc: 0.7043, time: 0.7680
epoch 41    train auc: 0.9342  acc: 0.8358    eval auc: 0.7709  acc: 0.7029    test auc: 0.7672  acc: 0.6987, time: 0.4670
epoch 42    train auc: 0.9344  acc: 0.8342    eval auc: 0.7719  acc: 0.7047    test auc: 0.7681  acc: 0.7016, time: 0.7589
epoch 43    train auc: 0.9351  acc: 0.8363    eval auc: 0.7703  acc: 0.7008    test auc: 0.7665  acc: 0.6995, time: 0.4770
epoch 44    train auc: 0.9353  acc: 0.8345    eval auc: 0.7710  acc: 0.7036    test auc: 0.7671  acc: 0.7003, time: 0.7690
epoch 45    train auc: 0.9357  acc: 0.8356    eval auc: 0.7703  acc: 0.7027    test auc: 0.7663  acc: 0.7009, time: 0.4650
epoch 46    train auc: 0.9363  acc: 0.8378    eval auc: 0.7698  acc: 0.7014    test auc: 0.7660  acc: 0.7002, time: 0.7870
epoch 47    train auc: 0.9367  acc: 0.8382    eval auc: 0.7689  acc: 0.7003    test auc: 0.7652  acc: 0.6997, time: 0.4620
epoch 48    train auc: 0.9373  acc: 0.8391    eval auc: 0.7680  acc: 0.6993    test auc: 0.7644  acc: 0.6984, time: 0.7589
epoch 49    train auc: 0.9374  acc: 0.8384    eval auc: 0.7682  acc: 0.6995    test auc: 0.7645  acc: 0.7000, time: 0.4560
avg time per epoch : 0.6331829452514648
--- 41.09200167655945 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:05:13.076611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:05:13.076950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4914  acc: 0.4976    eval auc: 0.5142  acc: 0.5008    test auc: 0.5107  acc: 0.5056, time: 0.8240
epoch 1    train auc: 0.4841  acc: 0.4969    eval auc: 0.5232  acc: 0.5055    test auc: 0.5209  acc: 0.5030, time: 0.5260
epoch 2    train auc: 0.8505  acc: 0.6955    eval auc: 0.7494  acc: 0.6779    test auc: 0.7541  acc: 0.6924, time: 0.5300
epoch 3    train auc: 0.8898  acc: 0.7656    eval auc: 0.7884  acc: 0.7405    test auc: 0.7900  acc: 0.7471, time: 0.5460
epoch 4    train auc: 0.9002  acc: 0.7889    eval auc: 0.7933  acc: 0.7491    test auc: 0.7936  acc: 0.7511, time: 0.5260
epoch 5    train auc: 0.9076  acc: 0.7996    eval auc: 0.7948  acc: 0.7383    test auc: 0.7941  acc: 0.7383, time: 0.5260
epoch 6    train auc: 0.9136  acc: 0.8091    eval auc: 0.7940  acc: 0.7322    test auc: 0.7927  acc: 0.7274, time: 0.5270
epoch 7    train auc: 0.9183  acc: 0.8145    eval auc: 0.7919  acc: 0.7259    test auc: 0.7904  acc: 0.7194, time: 0.5300
epoch 8    train auc: 0.9228  acc: 0.8198    eval auc: 0.7867  acc: 0.7132    test auc: 0.7851  acc: 0.7095, time: 0.5350
epoch 9    train auc: 0.9255  acc: 0.8220    eval auc: 0.7846  acc: 0.7121    test auc: 0.7825  acc: 0.7088, time: 0.5700
epoch 10    train auc: 0.9276  acc: 0.8240    eval auc: 0.7821  acc: 0.7122    test auc: 0.7804  acc: 0.7058, time: 0.5230
epoch 11    train auc: 0.9296  acc: 0.8269    eval auc: 0.7802  acc: 0.7087    test auc: 0.7784  acc: 0.7046, time: 0.5250
epoch 12    train auc: 0.9316  acc: 0.8300    eval auc: 0.7767  acc: 0.7043    test auc: 0.7753  acc: 0.7023, time: 0.5230
epoch 13    train auc: 0.9326  acc: 0.8317    eval auc: 0.7773  acc: 0.7040    test auc: 0.7758  acc: 0.7003, time: 0.5201
epoch 14    train auc: 0.9341  acc: 0.8324    eval auc: 0.7743  acc: 0.6996    test auc: 0.7731  acc: 0.6970, time: 0.5160
epoch 15    train auc: 0.9349  acc: 0.8332    eval auc: 0.7738  acc: 0.6971    test auc: 0.7735  acc: 0.6964, time: 0.5310
epoch 16    train auc: 0.9361  acc: 0.8345    eval auc: 0.7723  acc: 0.6934    test auc: 0.7717  acc: 0.6931, time: 0.5120
epoch 17    train auc: 0.9383  acc: 0.8376    eval auc: 0.7722  acc: 0.6981    test auc: 0.7708  acc: 0.6976, time: 0.5140
epoch 18    train auc: 0.9390  acc: 0.8386    eval auc: 0.7696  acc: 0.6943    test auc: 0.7685  acc: 0.6942, time: 0.5100
epoch 19    train auc: 0.9401  acc: 0.8398    eval auc: 0.7697  acc: 0.6931    test auc: 0.7688  acc: 0.6928, time: 0.5110
epoch 20    train auc: 0.9401  acc: 0.8370    eval auc: 0.7655  acc: 0.6897    test auc: 0.7648  acc: 0.6904, time: 0.5200
epoch 21    train auc: 0.9425  acc: 0.8423    eval auc: 0.7673  acc: 0.6924    test auc: 0.7667  acc: 0.6922, time: 0.5040
epoch 22    train auc: 0.9438  acc: 0.8428    eval auc: 0.7659  acc: 0.6904    test auc: 0.7650  acc: 0.6921, time: 0.5040
epoch 23    train auc: 0.9450  acc: 0.8430    eval auc: 0.7639  acc: 0.6891    test auc: 0.7633  acc: 0.6906, time: 0.5020
epoch 24    train auc: 0.9463  acc: 0.8426    eval auc: 0.7631  acc: 0.6889    test auc: 0.7624  acc: 0.6891, time: 0.5070
epoch 25    train auc: 0.9487  acc: 0.8462    eval auc: 0.7620  acc: 0.6871    test auc: 0.7607  acc: 0.6896, time: 0.5060
epoch 26    train auc: 0.9497  acc: 0.8467    eval auc: 0.7599  acc: 0.6851    test auc: 0.7583  acc: 0.6866, time: 0.4990
epoch 27    train auc: 0.9520  acc: 0.8503    eval auc: 0.7588  acc: 0.6857    test auc: 0.7569  acc: 0.6884, time: 0.4960
epoch 28    train auc: 0.9541  acc: 0.8536    eval auc: 0.7579  acc: 0.6845    test auc: 0.7558  acc: 0.6884, time: 0.5050
epoch 29    train auc: 0.9557  acc: 0.8563    eval auc: 0.7566  acc: 0.6849    test auc: 0.7537  acc: 0.6867, time: 0.4900
epoch 30    train auc: 0.9576  acc: 0.8584    eval auc: 0.7558  acc: 0.6852    test auc: 0.7523  acc: 0.6860, time: 0.5010
epoch 31    train auc: 0.9596  acc: 0.8625    eval auc: 0.7536  acc: 0.6871    test auc: 0.7501  acc: 0.6864, time: 0.5000
epoch 32    train auc: 0.9611  acc: 0.8661    eval auc: 0.7523  acc: 0.6860    test auc: 0.7484  acc: 0.6864, time: 0.4970
epoch 33    train auc: 0.9623  acc: 0.8670    eval auc: 0.7518  acc: 0.6857    test auc: 0.7475  acc: 0.6838, time: 0.5130
epoch 34    train auc: 0.9653  acc: 0.8752    eval auc: 0.7493  acc: 0.6846    test auc: 0.7444  acc: 0.6866, time: 0.5030
epoch 35    train auc: 0.9656  acc: 0.8735    eval auc: 0.7472  acc: 0.6865    test auc: 0.7422  acc: 0.6825, time: 0.4939
epoch 36    train auc: 0.9688  acc: 0.8820    eval auc: 0.7456  acc: 0.6845    test auc: 0.7403  acc: 0.6838, time: 0.4940
epoch 37    train auc: 0.9698  acc: 0.8840    eval auc: 0.7440  acc: 0.6832    test auc: 0.7381  acc: 0.6819, time: 0.4950
epoch 38    train auc: 0.9722  acc: 0.8902    eval auc: 0.7424  acc: 0.6825    test auc: 0.7364  acc: 0.6806, time: 0.5000
epoch 39    train auc: 0.9743  acc: 0.8960    eval auc: 0.7405  acc: 0.6821    test auc: 0.7343  acc: 0.6793, time: 0.5010
epoch 40    train auc: 0.9758  acc: 0.9003    eval auc: 0.7383  acc: 0.6828    test auc: 0.7316  acc: 0.6780, time: 0.4880
epoch 41    train auc: 0.9771  acc: 0.9023    eval auc: 0.7392  acc: 0.6815    test auc: 0.7321  acc: 0.6789, time: 0.4960
epoch 42    train auc: 0.9780  acc: 0.9051    eval auc: 0.7346  acc: 0.6786    test auc: 0.7274  acc: 0.6768, time: 0.5030
epoch 43    train auc: 0.9800  acc: 0.9095    eval auc: 0.7332  acc: 0.6799    test auc: 0.7259  acc: 0.6758, time: 0.5080
epoch 44    train auc: 0.9806  acc: 0.9113    eval auc: 0.7328  acc: 0.6787    test auc: 0.7260  acc: 0.6766, time: 0.4870
epoch 45    train auc: 0.9822  acc: 0.9149    eval auc: 0.7312  acc: 0.6805    test auc: 0.7240  acc: 0.6765, time: 0.4870
epoch 46    train auc: 0.9830  acc: 0.9170    eval auc: 0.7306  acc: 0.6801    test auc: 0.7240  acc: 0.6776, time: 0.4870
epoch 47    train auc: 0.9840  acc: 0.9193    eval auc: 0.7277  acc: 0.6792    test auc: 0.7209  acc: 0.6756, time: 0.4880
epoch 48    train auc: 0.9842  acc: 0.9195    eval auc: 0.7269  acc: 0.6801    test auc: 0.7215  acc: 0.6748, time: 0.5000
epoch 49    train auc: 0.9850  acc: 0.9224    eval auc: 0.7248  acc: 0.6791    test auc: 0.7189  acc: 0.6726, time: 0.4890
avg time per epoch : 0.5157625579833984
--- 31.528148889541626 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:05:44.705240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:05:44.705618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4993  acc: 0.5000    eval auc: 0.4947  acc: 0.4956    test auc: 0.4936  acc: 0.4953, time: 0.8510
epoch 1    train auc: 0.5042  acc: 0.5018    eval auc: 0.5055  acc: 0.5051    test auc: 0.5093  acc: 0.5029, time: 0.5180
epoch 2    train auc: 0.5008  acc: 0.5016    eval auc: 0.5023  acc: 0.4939    test auc: 0.5102  acc: 0.5001, time: 0.5399
epoch 3    train auc: 0.5394  acc: 0.5151    eval auc: 0.4616  acc: 0.4897    test auc: 0.4530  acc: 0.4834, time: 0.5200
epoch 4    train auc: 0.5494  acc: 0.5024    eval auc: 0.4398  acc: 0.4985    test auc: 0.4271  acc: 0.4943, time: 0.5010
epoch 5    train auc: 0.5627  acc: 0.5117    eval auc: 0.4393  acc: 0.4883    test auc: 0.4269  acc: 0.4810, time: 0.4960
epoch 6    train auc: 0.6084  acc: 0.5293    eval auc: 0.4721  acc: 0.4955    test auc: 0.4608  acc: 0.4848, time: 0.5470
epoch 7    train auc: 0.7302  acc: 0.6103    eval auc: 0.6051  acc: 0.5971    test auc: 0.6114  acc: 0.6050, time: 0.5061
epoch 8    train auc: 0.8106  acc: 0.6652    eval auc: 0.6922  acc: 0.6520    test auc: 0.6992  acc: 0.6642, time: 0.5150
epoch 9    train auc: 0.8569  acc: 0.7053    eval auc: 0.7417  acc: 0.6877    test auc: 0.7449  acc: 0.6998, time: 0.5300
epoch 10    train auc: 0.8805  acc: 0.7379    eval auc: 0.7711  acc: 0.7160    test auc: 0.7724  acc: 0.7272, time: 0.5209
epoch 11    train auc: 0.8891  acc: 0.7627    eval auc: 0.7851  acc: 0.7316    test auc: 0.7861  acc: 0.7428, time: 0.4920
epoch 12    train auc: 0.8930  acc: 0.7745    eval auc: 0.7903  acc: 0.7396    test auc: 0.7915  acc: 0.7503, time: 0.5100
epoch 13    train auc: 0.8955  acc: 0.7825    eval auc: 0.7932  acc: 0.7470    test auc: 0.7946  acc: 0.7544, time: 0.5330
epoch 14    train auc: 0.8976  acc: 0.7855    eval auc: 0.7948  acc: 0.7484    test auc: 0.7962  acc: 0.7543, time: 0.5040
epoch 15    train auc: 0.8991  acc: 0.7884    eval auc: 0.7959  acc: 0.7498    test auc: 0.7975  acc: 0.7527, time: 0.5030
epoch 16    train auc: 0.9002  acc: 0.7921    eval auc: 0.7968  acc: 0.7500    test auc: 0.7985  acc: 0.7518, time: 0.5080
epoch 17    train auc: 0.9013  acc: 0.7942    eval auc: 0.7974  acc: 0.7500    test auc: 0.7993  acc: 0.7514, time: 0.5390
epoch 18    train auc: 0.9021  acc: 0.7954    eval auc: 0.7977  acc: 0.7505    test auc: 0.7998  acc: 0.7509, time: 0.5200
epoch 19    train auc: 0.9030  acc: 0.7960    eval auc: 0.7980  acc: 0.7497    test auc: 0.7999  acc: 0.7511, time: 0.4920
epoch 20    train auc: 0.9034  acc: 0.7971    eval auc: 0.7980  acc: 0.7494    test auc: 0.8002  acc: 0.7487, time: 0.5040
epoch 21    train auc: 0.9040  acc: 0.7977    eval auc: 0.7982  acc: 0.7488    test auc: 0.8004  acc: 0.7486, time: 0.5400
epoch 22    train auc: 0.9046  acc: 0.7975    eval auc: 0.7982  acc: 0.7473    test auc: 0.8004  acc: 0.7481, time: 0.5084
epoch 23    train auc: 0.9045  acc: 0.7986    eval auc: 0.7979  acc: 0.7472    test auc: 0.8006  acc: 0.7485, time: 0.4900
epoch 24    train auc: 0.9055  acc: 0.7976    eval auc: 0.7983  acc: 0.7466    test auc: 0.8007  acc: 0.7471, time: 0.5280
epoch 25    train auc: 0.9056  acc: 0.7979    eval auc: 0.7981  acc: 0.7472    test auc: 0.8007  acc: 0.7468, time: 0.5570
epoch 26    train auc: 0.9058  acc: 0.7986    eval auc: 0.7979  acc: 0.7457    test auc: 0.8006  acc: 0.7470, time: 0.5220
epoch 27    train auc: 0.9061  acc: 0.7986    eval auc: 0.7978  acc: 0.7454    test auc: 0.8006  acc: 0.7459, time: 0.5030
epoch 28    train auc: 0.9063  acc: 0.7986    eval auc: 0.7976  acc: 0.7445    test auc: 0.8005  acc: 0.7446, time: 0.5000
epoch 29    train auc: 0.9067  acc: 0.7984    eval auc: 0.7976  acc: 0.7444    test auc: 0.8004  acc: 0.7438, time: 0.5640
epoch 30    train auc: 0.9068  acc: 0.7988    eval auc: 0.7974  acc: 0.7446    test auc: 0.8003  acc: 0.7429, time: 0.5440
epoch 31    train auc: 0.9071  acc: 0.7984    eval auc: 0.7973  acc: 0.7446    test auc: 0.8003  acc: 0.7426, time: 0.4980
epoch 32    train auc: 0.9070  acc: 0.7984    eval auc: 0.7969  acc: 0.7442    test auc: 0.8001  acc: 0.7414, time: 0.5060
epoch 33    train auc: 0.9071  acc: 0.7988    eval auc: 0.7967  acc: 0.7448    test auc: 0.8000  acc: 0.7405, time: 0.5400
epoch 34    train auc: 0.9073  acc: 0.7989    eval auc: 0.7966  acc: 0.7447    test auc: 0.7998  acc: 0.7401, time: 0.4960
epoch 35    train auc: 0.9071  acc: 0.7988    eval auc: 0.7960  acc: 0.7434    test auc: 0.7997  acc: 0.7380, time: 0.4880
epoch 36    train auc: 0.9074  acc: 0.7984    eval auc: 0.7962  acc: 0.7431    test auc: 0.7996  acc: 0.7381, time: 0.4990
epoch 37    train auc: 0.9074  acc: 0.7985    eval auc: 0.7958  acc: 0.7422    test auc: 0.7994  acc: 0.7375, time: 0.5380
epoch 38    train auc: 0.9079  acc: 0.7982    eval auc: 0.7960  acc: 0.7416    test auc: 0.7994  acc: 0.7381, time: 0.5090
epoch 39    train auc: 0.9079  acc: 0.7983    eval auc: 0.7957  acc: 0.7413    test auc: 0.7993  acc: 0.7366, time: 0.5030
epoch 40    train auc: 0.9079  acc: 0.7981    eval auc: 0.7955  acc: 0.7420    test auc: 0.7991  acc: 0.7363, time: 0.5139
epoch 41    train auc: 0.9081  acc: 0.7982    eval auc: 0.7953  acc: 0.7412    test auc: 0.7991  acc: 0.7361, time: 0.5419
epoch 42    train auc: 0.9075  acc: 0.7979    eval auc: 0.7947  acc: 0.7383    test auc: 0.7988  acc: 0.7344, time: 0.4940
epoch 43    train auc: 0.9076  acc: 0.7977    eval auc: 0.7945  acc: 0.7381    test auc: 0.7987  acc: 0.7337, time: 0.5070
epoch 44    train auc: 0.9082  acc: 0.7981    eval auc: 0.7948  acc: 0.7396    test auc: 0.7987  acc: 0.7353, time: 0.5080
epoch 45    train auc: 0.9083  acc: 0.7986    eval auc: 0.7947  acc: 0.7389    test auc: 0.7987  acc: 0.7330, time: 0.5621
epoch 46    train auc: 0.9083  acc: 0.7993    eval auc: 0.7945  acc: 0.7363    test auc: 0.7986  acc: 0.7301, time: 0.5670
epoch 47    train auc: 0.9082  acc: 0.7999    eval auc: 0.7942  acc: 0.7348    test auc: 0.7984  acc: 0.7275, time: 0.5220
epoch 48    train auc: 0.9083  acc: 0.8000    eval auc: 0.7941  acc: 0.7343    test auc: 0.7983  acc: 0.7261, time: 0.5178
epoch 49    train auc: 0.9088  acc: 0.7996    eval auc: 0.7943  acc: 0.7340    test auc: 0.7982  acc: 0.7258, time: 0.4977
avg time per epoch : 0.5242847585678101
--- 32.17202377319336 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:06:16.810987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:06:16.811359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4821  acc: 0.4989    eval auc: 0.5336  acc: 0.4995    test auc: 0.5207  acc: 0.5038, time: 0.8222
epoch 1    train auc: 0.5200  acc: 0.5031    eval auc: 0.4656  acc: 0.4956    test auc: 0.4744  acc: 0.4950, time: 0.4990
epoch 2    train auc: 0.5552  acc: 0.5343    eval auc: 0.4143  acc: 0.4462    test auc: 0.4220  acc: 0.4508, time: 0.5124
epoch 3    train auc: 0.5637  acc: 0.5165    eval auc: 0.4053  acc: 0.4803    test auc: 0.4053  acc: 0.4702, time: 0.5060
epoch 4    train auc: 0.5778  acc: 0.5535    eval auc: 0.3861  acc: 0.4235    test auc: 0.3836  acc: 0.4159, time: 0.5043
epoch 5    train auc: 0.5847  acc: 0.5601    eval auc: 0.3777  acc: 0.4117    test auc: 0.3732  acc: 0.4081, time: 0.4999
epoch 6    train auc: 0.5894  acc: 0.5621    eval auc: 0.3716  acc: 0.4064    test auc: 0.3665  acc: 0.4072, time: 0.5031
epoch 7    train auc: 0.5920  acc: 0.5629    eval auc: 0.3682  acc: 0.4067    test auc: 0.3632  acc: 0.4047, time: 0.5046
epoch 8    train auc: 0.5932  acc: 0.5637    eval auc: 0.3663  acc: 0.4035    test auc: 0.3621  acc: 0.4054, time: 0.4972
epoch 9    train auc: 0.5941  acc: 0.5645    eval auc: 0.3657  acc: 0.4019    test auc: 0.3609  acc: 0.4045, time: 0.5033
epoch 10    train auc: 0.5947  acc: 0.5651    eval auc: 0.3651  acc: 0.4028    test auc: 0.3602  acc: 0.4019, time: 0.4909
epoch 11    train auc: 0.5952  acc: 0.5656    eval auc: 0.3647  acc: 0.4019    test auc: 0.3595  acc: 0.4013, time: 0.5001
epoch 12    train auc: 0.5955  acc: 0.5660    eval auc: 0.3647  acc: 0.4015    test auc: 0.3589  acc: 0.4006, time: 0.5252
epoch 13    train auc: 0.5957  acc: 0.5663    eval auc: 0.3644  acc: 0.4016    test auc: 0.3587  acc: 0.3996, time: 0.5851
epoch 14    train auc: 0.5960  acc: 0.5666    eval auc: 0.3640  acc: 0.4010    test auc: 0.3585  acc: 0.3993, time: 0.5799
epoch 15    train auc: 0.5962  acc: 0.5666    eval auc: 0.3638  acc: 0.4017    test auc: 0.3583  acc: 0.3986, time: 0.5476
epoch 16    train auc: 0.5962  acc: 0.5667    eval auc: 0.3640  acc: 0.3992    test auc: 0.3583  acc: 0.4006, time: 0.5517
epoch 17    train auc: 0.5964  acc: 0.5667    eval auc: 0.3636  acc: 0.4017    test auc: 0.3580  acc: 0.3982, time: 0.5251
epoch 18    train auc: 0.5965  acc: 0.5667    eval auc: 0.3636  acc: 0.4003    test auc: 0.3579  acc: 0.3997, time: 0.5069
epoch 19    train auc: 0.5966  acc: 0.5668    eval auc: 0.3634  acc: 0.4004    test auc: 0.3579  acc: 0.3993, time: 0.4995
epoch 20    train auc: 0.5967  acc: 0.5667    eval auc: 0.3634  acc: 0.4010    test auc: 0.3578  acc: 0.3989, time: 0.5058
epoch 21    train auc: 0.5967  acc: 0.5668    eval auc: 0.3636  acc: 0.4030    test auc: 0.3577  acc: 0.3967, time: 0.5024
epoch 22    train auc: 0.5968  acc: 0.5668    eval auc: 0.3633  acc: 0.4010    test auc: 0.3578  acc: 0.3987, time: 0.5125
epoch 23    train auc: 0.5968  acc: 0.5668    eval auc: 0.3632  acc: 0.4019    test auc: 0.3579  acc: 0.3977, time: 0.4984
epoch 24    train auc: 0.5968  acc: 0.5668    eval auc: 0.3633  acc: 0.4023    test auc: 0.3577  acc: 0.3973, time: 0.5014
epoch 25    train auc: 0.5969  acc: 0.5668    eval auc: 0.3632  acc: 0.4022    test auc: 0.3577  acc: 0.3976, time: 0.5047
epoch 26    train auc: 0.5969  acc: 0.5668    eval auc: 0.3631  acc: 0.4023    test auc: 0.3576  acc: 0.3974, time: 0.4920
epoch 27    train auc: 0.5969  acc: 0.5668    eval auc: 0.3632  acc: 0.4024    test auc: 0.3577  acc: 0.3973, time: 0.5026
epoch 28    train auc: 0.5970  acc: 0.5668    eval auc: 0.3629  acc: 0.4017    test auc: 0.3579  acc: 0.3980, time: 0.4934
epoch 29    train auc: 0.5970  acc: 0.5668    eval auc: 0.3629  acc: 0.4004    test auc: 0.3581  acc: 0.3993, time: 0.5051
epoch 30    train auc: 0.5970  acc: 0.5668    eval auc: 0.3629  acc: 0.4017    test auc: 0.3581  acc: 0.3980, time: 0.5000
epoch 31    train auc: 0.5970  acc: 0.5668    eval auc: 0.3628  acc: 0.4000    test auc: 0.3580  acc: 0.3997, time: 0.4944
epoch 32    train auc: 0.5970  acc: 0.5668    eval auc: 0.3626  acc: 0.4009    test auc: 0.3583  acc: 0.3989, time: 0.5031
epoch 33    train auc: 0.5970  acc: 0.5668    eval auc: 0.3629  acc: 0.4021    test auc: 0.3579  acc: 0.3977, time: 0.4937
epoch 34    train auc: 0.5971  acc: 0.5668    eval auc: 0.3630  acc: 0.4009    test auc: 0.3578  acc: 0.3987, time: 0.4990
epoch 35    train auc: 0.5971  acc: 0.5668    eval auc: 0.3629  acc: 0.4015    test auc: 0.3580  acc: 0.3982, time: 0.5020
epoch 36    train auc: 0.5971  acc: 0.5668    eval auc: 0.3631  acc: 0.4019    test auc: 0.3577  acc: 0.3977, time: 0.5017
epoch 37    train auc: 0.5971  acc: 0.5668    eval auc: 0.3628  acc: 0.4006    test auc: 0.3579  acc: 0.3990, time: 0.4988
epoch 38    train auc: 0.5971  acc: 0.5668    eval auc: 0.3626  acc: 0.3999    test auc: 0.3582  acc: 0.3997, time: 0.4883
epoch 39    train auc: 0.5971  acc: 0.5668    eval auc: 0.3624  acc: 0.3983    test auc: 0.3584  acc: 0.4013, time: 0.5142
epoch 40    train auc: 0.5971  acc: 0.5668    eval auc: 0.3623  acc: 0.3991    test auc: 0.3585  acc: 0.4005, time: 0.5317
epoch 41    train auc: 0.5971  acc: 0.5668    eval auc: 0.3625  acc: 0.3993    test auc: 0.3583  acc: 0.4003, time: 0.4946
epoch 42    train auc: 0.5971  acc: 0.5668    eval auc: 0.3624  acc: 0.4002    test auc: 0.3583  acc: 0.3995, time: 0.4926
epoch 43    train auc: 0.5971  acc: 0.5668    eval auc: 0.3626  acc: 0.3993    test auc: 0.3581  acc: 0.4003, time: 0.4917
epoch 44    train auc: 0.5971  acc: 0.5668    eval auc: 0.3626  acc: 0.4003    test auc: 0.3582  acc: 0.3993, time: 0.4893
epoch 45    train auc: 0.5971  acc: 0.5668    eval auc: 0.3626  acc: 0.3991    test auc: 0.3581  acc: 0.4005, time: 0.4951
epoch 46    train auc: 0.5971  acc: 0.5668    eval auc: 0.3626  acc: 0.3990    test auc: 0.3583  acc: 0.4006, time: 0.5015
epoch 47    train auc: 0.5971  acc: 0.5668    eval auc: 0.3627  acc: 0.3991    test auc: 0.3581  acc: 0.4005, time: 0.4919
epoch 48    train auc: 0.5971  acc: 0.5668    eval auc: 0.3628  acc: 0.4003    test auc: 0.3580  acc: 0.3993, time: 0.4957
epoch 49    train auc: 0.5971  acc: 0.5668    eval auc: 0.3627  acc: 0.4003    test auc: 0.3581  acc: 0.3993, time: 0.5575
avg time per epoch : 0.5143812942504883
--- 31.41189455986023 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:06:48.235839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:06:48.236196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5261  acc: 0.5185    eval auc: 0.5148  acc: 0.5120    test auc: 0.5079  acc: 0.5069, time: 0.7844
epoch 1    train auc: 0.5396  acc: 0.5220    eval auc: 0.5097  acc: 0.5060    test auc: 0.5120  acc: 0.5064, time: 0.5035
epoch 2    train auc: 0.5645  acc: 0.5403    eval auc: 0.4979  acc: 0.5043    test auc: 0.4966  acc: 0.5036, time: 0.4930
epoch 3    train auc: 0.6555  acc: 0.5763    eval auc: 0.5745  acc: 0.5615    test auc: 0.5761  acc: 0.5559, time: 0.4957
epoch 4    train auc: 0.7741  acc: 0.6446    eval auc: 0.6734  acc: 0.6253    test auc: 0.6786  acc: 0.6400, time: 0.5039
epoch 5    train auc: 0.8200  acc: 0.6773    eval auc: 0.7089  acc: 0.6617    test auc: 0.7149  acc: 0.6756, time: 0.4860
epoch 6    train auc: 0.8517  acc: 0.7039    eval auc: 0.7338  acc: 0.6853    test auc: 0.7394  acc: 0.6972, time: 0.4901
epoch 7    train auc: 0.8716  acc: 0.7284    eval auc: 0.7538  acc: 0.7049    test auc: 0.7577  acc: 0.7151, time: 0.4869
epoch 8    train auc: 0.8827  acc: 0.7506    eval auc: 0.7663  acc: 0.7189    test auc: 0.7691  acc: 0.7271, time: 0.4870
epoch 9    train auc: 0.8886  acc: 0.7608    eval auc: 0.7724  acc: 0.7255    test auc: 0.7745  acc: 0.7380, time: 0.4909
epoch 10    train auc: 0.8926  acc: 0.7728    eval auc: 0.7758  acc: 0.7317    test auc: 0.7773  acc: 0.7392, time: 0.4971
epoch 11    train auc: 0.8960  acc: 0.7876    eval auc: 0.7783  acc: 0.7342    test auc: 0.7793  acc: 0.7377, time: 0.5136
epoch 12    train auc: 0.8987  acc: 0.7938    eval auc: 0.7795  acc: 0.7342    test auc: 0.7803  acc: 0.7335, time: 0.5006
epoch 13    train auc: 0.9013  acc: 0.8021    eval auc: 0.7808  acc: 0.7262    test auc: 0.7812  acc: 0.7211, time: 0.4953
epoch 14    train auc: 0.9032  acc: 0.7997    eval auc: 0.7813  acc: 0.7281    test auc: 0.7813  acc: 0.7263, time: 0.5031
epoch 15    train auc: 0.9054  acc: 0.8053    eval auc: 0.7820  acc: 0.7252    test auc: 0.7819  acc: 0.7212, time: 0.4919
epoch 16    train auc: 0.9074  acc: 0.8111    eval auc: 0.7827  acc: 0.7213    test auc: 0.7823  acc: 0.7171, time: 0.5010
epoch 17    train auc: 0.9090  acc: 0.8099    eval auc: 0.7831  acc: 0.7235    test auc: 0.7823  acc: 0.7187, time: 0.4889
epoch 18    train auc: 0.9107  acc: 0.8122    eval auc: 0.7833  acc: 0.7220    test auc: 0.7822  acc: 0.7177, time: 0.5004
epoch 19    train auc: 0.9122  acc: 0.8137    eval auc: 0.7831  acc: 0.7209    test auc: 0.7815  acc: 0.7166, time: 0.5036
epoch 20    train auc: 0.9137  acc: 0.8179    eval auc: 0.7828  acc: 0.7191    test auc: 0.7809  acc: 0.7154, time: 0.4925
epoch 21    train auc: 0.9149  acc: 0.8174    eval auc: 0.7832  acc: 0.7204    test auc: 0.7811  acc: 0.7161, time: 0.4973
epoch 22    train auc: 0.9161  acc: 0.8182    eval auc: 0.7830  acc: 0.7199    test auc: 0.7805  acc: 0.7158, time: 0.4967
epoch 23    train auc: 0.9175  acc: 0.8217    eval auc: 0.7824  acc: 0.7179    test auc: 0.7800  acc: 0.7114, time: 0.4855
epoch 24    train auc: 0.9185  acc: 0.8215    eval auc: 0.7822  acc: 0.7192    test auc: 0.7794  acc: 0.7147, time: 0.4786
epoch 25    train auc: 0.9195  acc: 0.8228    eval auc: 0.7820  acc: 0.7187    test auc: 0.7792  acc: 0.7133, time: 0.4880
epoch 26    train auc: 0.9207  acc: 0.8256    eval auc: 0.7809  acc: 0.7141    test auc: 0.7780  acc: 0.7087, time: 0.4853
epoch 27    train auc: 0.9216  acc: 0.8259    eval auc: 0.7808  acc: 0.7135    test auc: 0.7778  acc: 0.7082, time: 0.4804
epoch 28    train auc: 0.9224  acc: 0.8254    eval auc: 0.7805  acc: 0.7146    test auc: 0.7772  acc: 0.7091, time: 0.4887
epoch 29    train auc: 0.9232  acc: 0.8254    eval auc: 0.7803  acc: 0.7151    test auc: 0.7768  acc: 0.7095, time: 0.4818
epoch 30    train auc: 0.9240  acc: 0.8268    eval auc: 0.7802  acc: 0.7133    test auc: 0.7768  acc: 0.7088, time: 0.4849
epoch 31    train auc: 0.9246  acc: 0.8255    eval auc: 0.7794  acc: 0.7140    test auc: 0.7756  acc: 0.7098, time: 0.4857
epoch 32    train auc: 0.9254  acc: 0.8280    eval auc: 0.7788  acc: 0.7124    test auc: 0.7750  acc: 0.7065, time: 0.4831
epoch 33    train auc: 0.9260  acc: 0.8278    eval auc: 0.7791  acc: 0.7122    test auc: 0.7753  acc: 0.7068, time: 0.4809
epoch 34    train auc: 0.9266  acc: 0.8278    eval auc: 0.7782  acc: 0.7122    test auc: 0.7741  acc: 0.7067, time: 0.4854
epoch 35    train auc: 0.9273  acc: 0.8296    eval auc: 0.7775  acc: 0.7068    test auc: 0.7737  acc: 0.7056, time: 0.4877
epoch 36    train auc: 0.9278  acc: 0.8295    eval auc: 0.7773  acc: 0.7074    test auc: 0.7733  acc: 0.7062, time: 0.4830
epoch 37    train auc: 0.9283  acc: 0.8304    eval auc: 0.7769  acc: 0.7062    test auc: 0.7730  acc: 0.7015, time: 0.4826
epoch 38    train auc: 0.9288  acc: 0.8297    eval auc: 0.7767  acc: 0.7081    test auc: 0.7724  acc: 0.7054, time: 0.4837
epoch 39    train auc: 0.9293  acc: 0.8301    eval auc: 0.7758  acc: 0.7074    test auc: 0.7716  acc: 0.7047, time: 0.4787
epoch 40    train auc: 0.9296  acc: 0.8295    eval auc: 0.7753  acc: 0.7073    test auc: 0.7707  acc: 0.7029, time: 0.4803
epoch 41    train auc: 0.9301  acc: 0.8308    eval auc: 0.7760  acc: 0.7066    test auc: 0.7716  acc: 0.7046, time: 0.4798
epoch 42    train auc: 0.9307  acc: 0.8324    eval auc: 0.7739  acc: 0.7023    test auc: 0.7699  acc: 0.6977, time: 0.4951
epoch 43    train auc: 0.9310  acc: 0.8325    eval auc: 0.7745  acc: 0.7042    test auc: 0.7704  acc: 0.6984, time: 0.4802
epoch 44    train auc: 0.9313  acc: 0.8311    eval auc: 0.7745  acc: 0.7052    test auc: 0.7700  acc: 0.7013, time: 0.4779
epoch 45    train auc: 0.9317  acc: 0.8318    eval auc: 0.7740  acc: 0.7048    test auc: 0.7694  acc: 0.7007, time: 0.4828
epoch 46    train auc: 0.9322  acc: 0.8336    eval auc: 0.7730  acc: 0.7023    test auc: 0.7686  acc: 0.6998, time: 0.4771
epoch 47    train auc: 0.9325  acc: 0.8332    eval auc: 0.7733  acc: 0.7029    test auc: 0.7690  acc: 0.7006, time: 0.4720
epoch 48    train auc: 0.9330  acc: 0.8343    eval auc: 0.7725  acc: 0.7015    test auc: 0.7682  acc: 0.6982, time: 0.4797
epoch 49    train auc: 0.9329  acc: 0.8326    eval auc: 0.7731  acc: 0.7062    test auc: 0.7684  acc: 0.7000, time: 0.4857
avg time per epoch : 0.49476022720336915
--- 30.22704005241394 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:07:18.483939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:07:18.484280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4932  acc: 0.4977    eval auc: 0.5101  acc: 0.5019    test auc: 0.5104  acc: 0.5047, time: 0.8561
epoch 1    train auc: 0.4980  acc: 0.5010    eval auc: 0.5021  acc: 0.4983    test auc: 0.5037  acc: 0.5011, time: 0.4952
epoch 2    train auc: 0.4935  acc: 0.4995    eval auc: 0.5098  acc: 0.5043    test auc: 0.5260  acc: 0.5050, time: 0.4837
epoch 3    train auc: 0.5310  acc: 0.5314    eval auc: 0.4569  acc: 0.4482    test auc: 0.4597  acc: 0.4561, time: 0.4728
epoch 4    train auc: 0.8501  acc: 0.7498    eval auc: 0.7497  acc: 0.7219    test auc: 0.7493  acc: 0.7259, time: 0.4930
epoch 5    train auc: 0.8871  acc: 0.7847    eval auc: 0.7790  acc: 0.7340    test auc: 0.7818  acc: 0.7362, time: 0.4753
epoch 6    train auc: 0.9002  acc: 0.8005    eval auc: 0.7861  acc: 0.7262    test auc: 0.7889  acc: 0.7199, time: 0.5007
epoch 7    train auc: 0.9082  acc: 0.8045    eval auc: 0.7863  acc: 0.7242    test auc: 0.7889  acc: 0.7200, time: 0.5026
epoch 8    train auc: 0.9144  acc: 0.8132    eval auc: 0.7831  acc: 0.7133    test auc: 0.7861  acc: 0.7083, time: 0.4806
epoch 9    train auc: 0.9194  acc: 0.8158    eval auc: 0.7808  acc: 0.7138    test auc: 0.7837  acc: 0.7079, time: 0.4951
epoch 10    train auc: 0.9231  acc: 0.8182    eval auc: 0.7799  acc: 0.7114    test auc: 0.7821  acc: 0.7105, time: 0.4990
epoch 11    train auc: 0.9263  acc: 0.8221    eval auc: 0.7783  acc: 0.7066    test auc: 0.7805  acc: 0.7058, time: 0.4939
epoch 12    train auc: 0.9291  acc: 0.8240    eval auc: 0.7755  acc: 0.7066    test auc: 0.7765  acc: 0.7027, time: 0.4985
epoch 13    train auc: 0.9308  acc: 0.8257    eval auc: 0.7769  acc: 0.7063    test auc: 0.7780  acc: 0.7030, time: 0.4978
epoch 14    train auc: 0.9329  acc: 0.8280    eval auc: 0.7736  acc: 0.7008    test auc: 0.7754  acc: 0.6958, time: 0.5035
epoch 15    train auc: 0.9342  acc: 0.8275    eval auc: 0.7726  acc: 0.7002    test auc: 0.7748  acc: 0.6949, time: 0.5006
epoch 16    train auc: 0.9363  acc: 0.8308    eval auc: 0.7723  acc: 0.6983    test auc: 0.7739  acc: 0.6961, time: 0.4964
epoch 17    train auc: 0.9386  acc: 0.8333    eval auc: 0.7704  acc: 0.6975    test auc: 0.7714  acc: 0.6964, time: 0.4938
epoch 18    train auc: 0.9401  acc: 0.8351    eval auc: 0.7690  acc: 0.6961    test auc: 0.7702  acc: 0.6945, time: 0.4958
epoch 19    train auc: 0.9417  acc: 0.8361    eval auc: 0.7690  acc: 0.6959    test auc: 0.7704  acc: 0.6929, time: 0.5027
epoch 20    train auc: 0.9433  acc: 0.8364    eval auc: 0.7654  acc: 0.6930    test auc: 0.7668  acc: 0.6874, time: 0.4990
epoch 21    train auc: 0.9457  acc: 0.8401    eval auc: 0.7647  acc: 0.6921    test auc: 0.7663  acc: 0.6885, time: 0.5007
epoch 22    train auc: 0.9472  acc: 0.8407    eval auc: 0.7623  acc: 0.6887    test auc: 0.7644  acc: 0.6872, time: 0.4970
epoch 23    train auc: 0.9496  acc: 0.8447    eval auc: 0.7587  acc: 0.6854    test auc: 0.7611  acc: 0.6836, time: 0.5029
epoch 24    train auc: 0.9517  acc: 0.8469    eval auc: 0.7570  acc: 0.6849    test auc: 0.7591  acc: 0.6820, time: 0.4999
epoch 25    train auc: 0.9532  acc: 0.8493    eval auc: 0.7560  acc: 0.6867    test auc: 0.7575  acc: 0.6819, time: 0.5014
epoch 26    train auc: 0.9548  acc: 0.8509    eval auc: 0.7544  acc: 0.6860    test auc: 0.7562  acc: 0.6810, time: 0.5070
epoch 27    train auc: 0.9562  acc: 0.8536    eval auc: 0.7531  acc: 0.6874    test auc: 0.7547  acc: 0.6839, time: 0.5016
epoch 28    train auc: 0.9582  acc: 0.8559    eval auc: 0.7514  acc: 0.6872    test auc: 0.7526  acc: 0.6814, time: 0.5210
epoch 29    train auc: 0.9594  acc: 0.8583    eval auc: 0.7509  acc: 0.6870    test auc: 0.7518  acc: 0.6799, time: 0.4995
epoch 30    train auc: 0.9607  acc: 0.8608    eval auc: 0.7499  acc: 0.6871    test auc: 0.7501  acc: 0.6797, time: 0.5016
epoch 31    train auc: 0.9621  acc: 0.8640    eval auc: 0.7475  acc: 0.6880    test auc: 0.7480  acc: 0.6814, time: 0.5011
epoch 32    train auc: 0.9629  acc: 0.8654    eval auc: 0.7459  acc: 0.6865    test auc: 0.7461  acc: 0.6806, time: 0.5034
epoch 33    train auc: 0.9640  acc: 0.8677    eval auc: 0.7448  acc: 0.6854    test auc: 0.7454  acc: 0.6800, time: 0.5112
epoch 34    train auc: 0.9656  acc: 0.8724    eval auc: 0.7431  acc: 0.6863    test auc: 0.7436  acc: 0.6831, time: 0.4974
epoch 35    train auc: 0.9661  acc: 0.8722    eval auc: 0.7416  acc: 0.6844    test auc: 0.7427  acc: 0.6818, time: 0.5042
epoch 36    train auc: 0.9675  acc: 0.8769    eval auc: 0.7423  acc: 0.6867    test auc: 0.7429  acc: 0.6838, time: 0.7640
epoch 37    train auc: 0.9681  acc: 0.8782    eval auc: 0.7392  acc: 0.6853    test auc: 0.7399  acc: 0.6804, time: 0.6430
epoch 38    train auc: 0.9697  acc: 0.8816    eval auc: 0.7396  acc: 0.6852    test auc: 0.7401  acc: 0.6815, time: 0.6378
epoch 39    train auc: 0.9706  acc: 0.8837    eval auc: 0.7399  acc: 0.6866    test auc: 0.7405  acc: 0.6836, time: 0.5550
epoch 40    train auc: 0.9714  acc: 0.8853    eval auc: 0.7375  acc: 0.6857    test auc: 0.7387  acc: 0.6823, time: 0.5110
epoch 41    train auc: 0.9722  acc: 0.8874    eval auc: 0.7389  acc: 0.6871    test auc: 0.7397  acc: 0.6827, time: 0.5400
epoch 42    train auc: 0.9726  acc: 0.8872    eval auc: 0.7384  acc: 0.6856    test auc: 0.7389  acc: 0.6838, time: 0.5630
epoch 43    train auc: 0.9742  acc: 0.8908    eval auc: 0.7370  acc: 0.6876    test auc: 0.7375  acc: 0.6851, time: 0.5610
epoch 44    train auc: 0.9745  acc: 0.8919    eval auc: 0.7380  acc: 0.6872    test auc: 0.7389  acc: 0.6863, time: 0.5221
epoch 45    train auc: 0.9760  acc: 0.8936    eval auc: 0.7354  acc: 0.6847    test auc: 0.7364  acc: 0.6832, time: 0.5203
epoch 46    train auc: 0.9765  acc: 0.8952    eval auc: 0.7359  acc: 0.6866    test auc: 0.7356  acc: 0.6826, time: 0.5547
epoch 47    train auc: 0.9771  acc: 0.8955    eval auc: 0.7344  acc: 0.6852    test auc: 0.7345  acc: 0.6817, time: 0.5436
epoch 48    train auc: 0.9769  acc: 0.8965    eval auc: 0.7346  acc: 0.6853    test auc: 0.7344  acc: 0.6825, time: 0.5300
epoch 49    train auc: 0.9777  acc: 0.8991    eval auc: 0.7349  acc: 0.6858    test auc: 0.7353  acc: 0.6818, time: 0.5334
avg time per epoch : 0.5252941989898682
--- 31.836708068847656 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:07:50.467227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:07:50.467579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5119  acc: 0.5089    eval auc: 0.5095  acc: 0.5048    test auc: 0.5171  acc: 0.5093, time: 0.9660
epoch 1    train auc: 0.5229  acc: 0.5044    eval auc: 0.5364  acc: 0.5010    test auc: 0.5327  acc: 0.5015, time: 0.5315
epoch 2    train auc: 0.5271  acc: 0.5052    eval auc: 0.5768  acc: 0.5055    test auc: 0.5721  acc: 0.5110, time: 0.5224
epoch 3    train auc: 0.5892  acc: 0.5588    eval auc: 0.4880  acc: 0.4943    test auc: 0.4993  acc: 0.4977, time: 0.5087
epoch 4    train auc: 0.5798  acc: 0.5492    eval auc: 0.4466  acc: 0.4643    test auc: 0.4578  acc: 0.4790, time: 0.5330
epoch 5    train auc: 0.5899  acc: 0.5596    eval auc: 0.4312  acc: 0.4505    test auc: 0.4408  acc: 0.4541, time: 0.5030
epoch 6    train auc: 0.6096  acc: 0.5752    eval auc: 0.4316  acc: 0.4473    test auc: 0.4400  acc: 0.4553, time: 0.5375
epoch 7    train auc: 0.6707  acc: 0.6179    eval auc: 0.4854  acc: 0.4855    test auc: 0.4943  acc: 0.4930, time: 0.6008
epoch 8    train auc: 0.7680  acc: 0.7012    eval auc: 0.6139  acc: 0.5920    test auc: 0.6246  acc: 0.5953, time: 0.5394
epoch 9    train auc: 0.8240  acc: 0.7481    eval auc: 0.6941  acc: 0.6801    test auc: 0.7060  acc: 0.6908, time: 0.5607
epoch 10    train auc: 0.8534  acc: 0.7623    eval auc: 0.7322  acc: 0.7197    test auc: 0.7410  acc: 0.7285, time: 0.5665
epoch 11    train auc: 0.8686  acc: 0.7718    eval auc: 0.7499  acc: 0.7301    test auc: 0.7570  acc: 0.7415, time: 0.5478
epoch 12    train auc: 0.8766  acc: 0.7765    eval auc: 0.7593  acc: 0.7366    test auc: 0.7653  acc: 0.7437, time: 0.5263
epoch 13    train auc: 0.8821  acc: 0.7825    eval auc: 0.7655  acc: 0.7395    test auc: 0.7705  acc: 0.7453, time: 0.5131
epoch 14    train auc: 0.8859  acc: 0.7838    eval auc: 0.7702  acc: 0.7414    test auc: 0.7746  acc: 0.7472, time: 0.5271
epoch 15    train auc: 0.8891  acc: 0.7884    eval auc: 0.7736  acc: 0.7393    test auc: 0.7776  acc: 0.7481, time: 0.5155
epoch 16    train auc: 0.8918  acc: 0.7907    eval auc: 0.7765  acc: 0.7398    test auc: 0.7798  acc: 0.7479, time: 0.5064
epoch 17    train auc: 0.8940  acc: 0.7920    eval auc: 0.7789  acc: 0.7408    test auc: 0.7818  acc: 0.7477, time: 0.5115
epoch 18    train auc: 0.8959  acc: 0.7942    eval auc: 0.7805  acc: 0.7405    test auc: 0.7832  acc: 0.7466, time: 0.5097
epoch 19    train auc: 0.8977  acc: 0.7960    eval auc: 0.7819  acc: 0.7394    test auc: 0.7843  acc: 0.7447, time: 0.5044
epoch 20    train auc: 0.8993  acc: 0.7972    eval auc: 0.7830  acc: 0.7406    test auc: 0.7852  acc: 0.7439, time: 0.5104
epoch 21    train auc: 0.9008  acc: 0.7987    eval auc: 0.7840  acc: 0.7395    test auc: 0.7860  acc: 0.7437, time: 0.5102
epoch 22    train auc: 0.9021  acc: 0.7997    eval auc: 0.7847  acc: 0.7403    test auc: 0.7865  acc: 0.7442, time: 0.5141
epoch 23    train auc: 0.9035  acc: 0.8020    eval auc: 0.7850  acc: 0.7374    test auc: 0.7868  acc: 0.7399, time: 0.5169
epoch 24    train auc: 0.9047  acc: 0.8030    eval auc: 0.7858  acc: 0.7359    test auc: 0.7874  acc: 0.7393, time: 0.5350
epoch 25    train auc: 0.9059  acc: 0.8044    eval auc: 0.7863  acc: 0.7368    test auc: 0.7878  acc: 0.7368, time: 0.5070
epoch 26    train auc: 0.9071  acc: 0.8062    eval auc: 0.7865  acc: 0.7353    test auc: 0.7878  acc: 0.7344, time: 0.5085
epoch 27    train auc: 0.9081  acc: 0.8077    eval auc: 0.7866  acc: 0.7314    test auc: 0.7878  acc: 0.7326, time: 0.5202
epoch 28    train auc: 0.9091  acc: 0.8081    eval auc: 0.7867  acc: 0.7303    test auc: 0.7879  acc: 0.7310, time: 0.6460
epoch 29    train auc: 0.9100  acc: 0.8085    eval auc: 0.7868  acc: 0.7289    test auc: 0.7879  acc: 0.7307, time: 0.5313
epoch 30    train auc: 0.9109  acc: 0.8108    eval auc: 0.7866  acc: 0.7281    test auc: 0.7877  acc: 0.7270, time: 0.5229
epoch 31    train auc: 0.9119  acc: 0.8112    eval auc: 0.7866  acc: 0.7281    test auc: 0.7876  acc: 0.7276, time: 0.5331
epoch 32    train auc: 0.9127  acc: 0.8122    eval auc: 0.7864  acc: 0.7274    test auc: 0.7874  acc: 0.7275, time: 0.5429
epoch 33    train auc: 0.9134  acc: 0.8129    eval auc: 0.7863  acc: 0.7277    test auc: 0.7873  acc: 0.7265, time: 0.5478
epoch 34    train auc: 0.9142  acc: 0.8138    eval auc: 0.7862  acc: 0.7272    test auc: 0.7870  acc: 0.7268, time: 0.5270
epoch 35    train auc: 0.9149  acc: 0.8145    eval auc: 0.7858  acc: 0.7267    test auc: 0.7867  acc: 0.7256, time: 0.5078
epoch 36    train auc: 0.9155  acc: 0.8141    eval auc: 0.7855  acc: 0.7258    test auc: 0.7863  acc: 0.7248, time: 0.6237
epoch 37    train auc: 0.9162  acc: 0.8153    eval auc: 0.7853  acc: 0.7255    test auc: 0.7860  acc: 0.7238, time: 0.5200
epoch 38    train auc: 0.9169  acc: 0.8155    eval auc: 0.7852  acc: 0.7257    test auc: 0.7858  acc: 0.7245, time: 0.5196
epoch 39    train auc: 0.9176  acc: 0.8162    eval auc: 0.7849  acc: 0.7248    test auc: 0.7855  acc: 0.7238, time: 0.5223
epoch 40    train auc: 0.9182  acc: 0.8171    eval auc: 0.7845  acc: 0.7259    test auc: 0.7851  acc: 0.7231, time: 0.5406
epoch 41    train auc: 0.9186  acc: 0.8164    eval auc: 0.7845  acc: 0.7255    test auc: 0.7851  acc: 0.7231, time: 0.5698
epoch 42    train auc: 0.9192  acc: 0.8187    eval auc: 0.7838  acc: 0.7244    test auc: 0.7843  acc: 0.7199, time: 0.5709
epoch 43    train auc: 0.9195  acc: 0.8184    eval auc: 0.7838  acc: 0.7250    test auc: 0.7844  acc: 0.7200, time: 0.5880
epoch 44    train auc: 0.9201  acc: 0.8192    eval auc: 0.7835  acc: 0.7235    test auc: 0.7839  acc: 0.7209, time: 0.5710
epoch 45    train auc: 0.9206  acc: 0.8195    eval auc: 0.7833  acc: 0.7230    test auc: 0.7837  acc: 0.7212, time: 0.7190
epoch 46    train auc: 0.9210  acc: 0.8197    eval auc: 0.7829  acc: 0.7224    test auc: 0.7832  acc: 0.7187, time: 0.6530
epoch 47    train auc: 0.9215  acc: 0.8195    eval auc: 0.7828  acc: 0.7219    test auc: 0.7831  acc: 0.7193, time: 0.5748
epoch 48    train auc: 0.9219  acc: 0.8202    eval auc: 0.7825  acc: 0.7222    test auc: 0.7826  acc: 0.7192, time: 0.6150
epoch 49    train auc: 0.9224  acc: 0.8208    eval auc: 0.7824  acc: 0.7205    test auc: 0.7824  acc: 0.7199, time: 0.5648
avg time per epoch : 0.5533006954193115
--- 33.644259452819824 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:08:24.167545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:08:24.167927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5006  acc: 0.5020    eval auc: 0.5091  acc: 0.5003    test auc: 0.4892  acc: 0.4938, time: 0.9058
epoch 1    train auc: 0.5226  acc: 0.5166    eval auc: 0.4695  acc: 0.4794    test auc: 0.4627  acc: 0.4708, time: 0.5531
epoch 2    train auc: 0.5538  acc: 0.5386    eval auc: 0.4277  acc: 0.4452    test auc: 0.4123  acc: 0.4390, time: 0.6044
epoch 3    train auc: 0.5750  acc: 0.5498    eval auc: 0.3949  acc: 0.4287    test auc: 0.3833  acc: 0.4218, time: 0.9220
epoch 4    train auc: 0.5848  acc: 0.5592    eval auc: 0.3807  acc: 0.4139    test auc: 0.3691  acc: 0.4084, time: 0.7400
epoch 5    train auc: 0.5897  acc: 0.5625    eval auc: 0.3737  acc: 0.4087    test auc: 0.3633  acc: 0.4037, time: 0.6980
epoch 6    train auc: 0.5921  acc: 0.5640    eval auc: 0.3704  acc: 0.4062    test auc: 0.3603  acc: 0.4019, time: 0.7050
epoch 7    train auc: 0.5935  acc: 0.5652    eval auc: 0.3685  acc: 0.4043    test auc: 0.3588  acc: 0.4000, time: 0.6560
epoch 8    train auc: 0.5944  acc: 0.5660    eval auc: 0.3669  acc: 0.4029    test auc: 0.3587  acc: 0.3992, time: 0.6165
epoch 9    train auc: 0.5950  acc: 0.5665    eval auc: 0.3662  acc: 0.4016    test auc: 0.3582  acc: 0.3990, time: 0.6224
epoch 10    train auc: 0.5954  acc: 0.5666    eval auc: 0.3656  acc: 0.4019    test auc: 0.3580  acc: 0.3983, time: 0.6450
epoch 11    train auc: 0.5958  acc: 0.5666    eval auc: 0.3653  acc: 0.4025    test auc: 0.3574  acc: 0.3977, time: 0.5960
epoch 12    train auc: 0.5960  acc: 0.5667    eval auc: 0.3651  acc: 0.4018    test auc: 0.3572  acc: 0.3982, time: 0.6110
epoch 13    train auc: 0.5961  acc: 0.5667    eval auc: 0.3650  acc: 0.4047    test auc: 0.3571  acc: 0.3952, time: 0.6127
epoch 14    train auc: 0.5963  acc: 0.5668    eval auc: 0.3646  acc: 0.4019    test auc: 0.3571  acc: 0.3978, time: 0.6300
epoch 15    train auc: 0.5965  acc: 0.5668    eval auc: 0.3645  acc: 0.4031    test auc: 0.3570  acc: 0.3966, time: 0.6230
epoch 16    train auc: 0.5965  acc: 0.5668    eval auc: 0.3642  acc: 0.4030    test auc: 0.3572  acc: 0.3967, time: 0.6150
epoch 17    train auc: 0.5967  acc: 0.5668    eval auc: 0.3642  acc: 0.4044    test auc: 0.3569  acc: 0.3953, time: 0.6019
epoch 18    train auc: 0.5967  acc: 0.5668    eval auc: 0.3642  acc: 0.4035    test auc: 0.3569  acc: 0.3962, time: 0.6048
epoch 19    train auc: 0.5968  acc: 0.5668    eval auc: 0.3642  acc: 0.4022    test auc: 0.3569  acc: 0.3976, time: 0.5980
epoch 20    train auc: 0.5968  acc: 0.5668    eval auc: 0.3640  acc: 0.4015    test auc: 0.3569  acc: 0.3982, time: 0.6176
epoch 21    train auc: 0.5969  acc: 0.5668    eval auc: 0.3641  acc: 0.4032    test auc: 0.3568  acc: 0.3963, time: 0.5979
epoch 22    train auc: 0.5969  acc: 0.5668    eval auc: 0.3638  acc: 0.4022    test auc: 0.3571  acc: 0.3973, time: 0.6036
epoch 23    train auc: 0.5970  acc: 0.5668    eval auc: 0.3638  acc: 0.4045    test auc: 0.3570  acc: 0.3950, time: 0.6280
epoch 24    train auc: 0.5970  acc: 0.5668    eval auc: 0.3636  acc: 0.4045    test auc: 0.3572  acc: 0.3950, time: 0.5860
epoch 25    train auc: 0.5970  acc: 0.5668    eval auc: 0.3636  acc: 0.4030    test auc: 0.3571  acc: 0.3965, time: 0.5810
epoch 26    train auc: 0.5971  acc: 0.5668    eval auc: 0.3636  acc: 0.4019    test auc: 0.3570  acc: 0.3976, time: 0.5950
epoch 27    train auc: 0.5971  acc: 0.5668    eval auc: 0.3635  acc: 0.4023    test auc: 0.3572  acc: 0.3972, time: 0.6000
epoch 28    train auc: 0.5971  acc: 0.5668    eval auc: 0.3633  acc: 0.4030    test auc: 0.3574  acc: 0.3965, time: 0.6170
epoch 29    train auc: 0.5971  acc: 0.5668    eval auc: 0.3633  acc: 0.4044    test auc: 0.3575  acc: 0.3951, time: 0.5980
epoch 30    train auc: 0.5971  acc: 0.5668    eval auc: 0.3631  acc: 0.4034    test auc: 0.3577  acc: 0.3962, time: 0.6230
epoch 31    train auc: 0.5971  acc: 0.5668    eval auc: 0.3630  acc: 0.3995    test auc: 0.3577  acc: 0.4000, time: 0.5919
epoch 32    train auc: 0.5971  acc: 0.5668    eval auc: 0.3625  acc: 0.4004    test auc: 0.3581  acc: 0.3991, time: 0.6110
epoch 33    train auc: 0.5972  acc: 0.5668    eval auc: 0.3631  acc: 0.4024    test auc: 0.3576  acc: 0.3971, time: 0.6275
epoch 34    train auc: 0.5972  acc: 0.5668    eval auc: 0.3630  acc: 0.4009    test auc: 0.3576  acc: 0.3986, time: 0.6078
epoch 35    train auc: 0.5972  acc: 0.5668    eval auc: 0.3627  acc: 0.4005    test auc: 0.3580  acc: 0.3990, time: 0.5967
epoch 36    train auc: 0.5972  acc: 0.5668    eval auc: 0.3630  acc: 0.4006    test auc: 0.3577  acc: 0.3989, time: 0.6116
epoch 37    train auc: 0.5972  acc: 0.5668    eval auc: 0.3628  acc: 0.4016    test auc: 0.3578  acc: 0.3979, time: 0.5981
epoch 38    train auc: 0.5972  acc: 0.5668    eval auc: 0.3626  acc: 0.4008    test auc: 0.3581  acc: 0.3987, time: 0.6042
epoch 39    train auc: 0.5972  acc: 0.5668    eval auc: 0.3626  acc: 0.3993    test auc: 0.3581  acc: 0.4002, time: 0.5860
epoch 40    train auc: 0.5972  acc: 0.5668    eval auc: 0.3624  acc: 0.3979    test auc: 0.3582  acc: 0.4016, time: 0.6021
epoch 41    train auc: 0.5972  acc: 0.5668    eval auc: 0.3625  acc: 0.4015    test auc: 0.3581  acc: 0.3980, time: 0.6061
epoch 42    train auc: 0.5972  acc: 0.5668    eval auc: 0.3624  acc: 0.4005    test auc: 0.3583  acc: 0.3990, time: 0.5900
epoch 43    train auc: 0.5972  acc: 0.5668    eval auc: 0.3627  acc: 0.4013    test auc: 0.3579  acc: 0.3982, time: 0.5850
epoch 44    train auc: 0.5972  acc: 0.5668    eval auc: 0.3627  acc: 0.4016    test auc: 0.3580  acc: 0.3979, time: 0.5840
epoch 45    train auc: 0.5972  acc: 0.5668    eval auc: 0.3627  acc: 0.3996    test auc: 0.3579  acc: 0.3999, time: 0.5940
epoch 46    train auc: 0.5972  acc: 0.5668    eval auc: 0.3631  acc: 0.4013    test auc: 0.3576  acc: 0.3982, time: 0.6011
epoch 47    train auc: 0.5972  acc: 0.5668    eval auc: 0.3632  acc: 0.4012    test auc: 0.3575  acc: 0.3983, time: 0.6070
epoch 48    train auc: 0.5972  acc: 0.5668    eval auc: 0.3631  acc: 0.4030    test auc: 0.3576  acc: 0.3965, time: 0.6360
epoch 49    train auc: 0.5972  acc: 0.5668    eval auc: 0.3631  acc: 0.4037    test auc: 0.3577  acc: 0.3958, time: 0.6138
avg time per epoch : 0.6252248430252075
--- 37.948068141937256 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:09:02.121010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:09:02.121428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5163  acc: 0.5022    eval auc: 0.4818  acc: 0.4982    test auc: 0.4861  acc: 0.4953, time: 0.9922
epoch 1    train auc: 0.5301  acc: 0.5062    eval auc: 0.4713  acc: 0.4926    test auc: 0.4711  acc: 0.4893, time: 0.6366
epoch 2    train auc: 0.5674  acc: 0.5113    eval auc: 0.4797  acc: 0.4976    test auc: 0.4807  acc: 0.4929, time: 0.6423
epoch 3    train auc: 0.6562  acc: 0.5548    eval auc: 0.5632  acc: 0.5479    test auc: 0.5689  acc: 0.5487, time: 0.6732
epoch 4    train auc: 0.7874  acc: 0.6435    eval auc: 0.6810  acc: 0.6309    test auc: 0.6912  acc: 0.6367, time: 0.6542
epoch 5    train auc: 0.8427  acc: 0.6840    eval auc: 0.7288  acc: 0.6701    test auc: 0.7356  acc: 0.6831, time: 0.6410
epoch 6    train auc: 0.8735  acc: 0.7237    eval auc: 0.7629  acc: 0.7024    test auc: 0.7658  acc: 0.7148, time: 0.6090
epoch 7    train auc: 0.8847  acc: 0.7459    eval auc: 0.7760  acc: 0.7199    test auc: 0.7787  acc: 0.7323, time: 0.6292
epoch 8    train auc: 0.8905  acc: 0.7637    eval auc: 0.7824  acc: 0.7342    test auc: 0.7854  acc: 0.7447, time: 0.6291
epoch 9    train auc: 0.8943  acc: 0.7724    eval auc: 0.7850  acc: 0.7429    test auc: 0.7881  acc: 0.7480, time: 0.6530
epoch 10    train auc: 0.8973  acc: 0.7783    eval auc: 0.7867  acc: 0.7450    test auc: 0.7894  acc: 0.7496, time: 0.6230
epoch 11    train auc: 0.9000  acc: 0.7868    eval auc: 0.7878  acc: 0.7478    test auc: 0.7906  acc: 0.7497, time: 0.6090
epoch 12    train auc: 0.9024  acc: 0.7907    eval auc: 0.7884  acc: 0.7457    test auc: 0.7910  acc: 0.7470, time: 0.6310
epoch 13    train auc: 0.9046  acc: 0.7964    eval auc: 0.7889  acc: 0.7432    test auc: 0.7913  acc: 0.7421, time: 0.6275
epoch 14    train auc: 0.9064  acc: 0.7971    eval auc: 0.7891  acc: 0.7416    test auc: 0.7909  acc: 0.7403, time: 0.6040
epoch 15    train auc: 0.9083  acc: 0.8010    eval auc: 0.7891  acc: 0.7388    test auc: 0.7907  acc: 0.7354, time: 0.6211
epoch 16    train auc: 0.9102  acc: 0.8056    eval auc: 0.7891  acc: 0.7354    test auc: 0.7903  acc: 0.7277, time: 0.6268
epoch 17    train auc: 0.9117  acc: 0.8063    eval auc: 0.7889  acc: 0.7329    test auc: 0.7896  acc: 0.7259, time: 0.6130
epoch 18    train auc: 0.9134  acc: 0.8087    eval auc: 0.7885  acc: 0.7302    test auc: 0.7889  acc: 0.7228, time: 0.6357
epoch 19    train auc: 0.9149  acc: 0.8100    eval auc: 0.7878  acc: 0.7278    test auc: 0.7877  acc: 0.7211, time: 0.6290
epoch 20    train auc: 0.9166  acc: 0.8143    eval auc: 0.7871  acc: 0.7249    test auc: 0.7867  acc: 0.7167, time: 0.6310
epoch 21    train auc: 0.9177  acc: 0.8131    eval auc: 0.7866  acc: 0.7245    test auc: 0.7859  acc: 0.7171, time: 0.6119
epoch 22    train auc: 0.9190  acc: 0.8158    eval auc: 0.7858  acc: 0.7225    test auc: 0.7846  acc: 0.7154, time: 0.6120
epoch 23    train auc: 0.9208  acc: 0.8200    eval auc: 0.7849  acc: 0.7203    test auc: 0.7840  acc: 0.7109, time: 0.6564
epoch 24    train auc: 0.9215  acc: 0.8192    eval auc: 0.7840  acc: 0.7209    test auc: 0.7825  acc: 0.7115, time: 0.6250
epoch 25    train auc: 0.9227  acc: 0.8205    eval auc: 0.7833  acc: 0.7194    test auc: 0.7818  acc: 0.7107, time: 0.6211
epoch 26    train auc: 0.9241  acc: 0.8237    eval auc: 0.7822  acc: 0.7147    test auc: 0.7809  acc: 0.7074, time: 0.6311
epoch 27    train auc: 0.9250  acc: 0.8245    eval auc: 0.7813  acc: 0.7124    test auc: 0.7797  acc: 0.7076, time: 0.6112
epoch 28    train auc: 0.9258  acc: 0.8243    eval auc: 0.7805  acc: 0.7126    test auc: 0.7787  acc: 0.7070, time: 0.6130
epoch 29    train auc: 0.9266  acc: 0.8244    eval auc: 0.7799  acc: 0.7126    test auc: 0.7780  acc: 0.7073, time: 0.6120
epoch 30    train auc: 0.9273  acc: 0.8255    eval auc: 0.7793  acc: 0.7118    test auc: 0.7775  acc: 0.7067, time: 0.6221
epoch 31    train auc: 0.9278  acc: 0.8255    eval auc: 0.7785  acc: 0.7119    test auc: 0.7762  acc: 0.7061, time: 0.6040
epoch 32    train auc: 0.9288  acc: 0.8271    eval auc: 0.7778  acc: 0.7080    test auc: 0.7758  acc: 0.7039, time: 0.6330
epoch 33    train auc: 0.9294  acc: 0.8270    eval auc: 0.7774  acc: 0.7068    test auc: 0.7755  acc: 0.7050, time: 0.6040
epoch 34    train auc: 0.9298  acc: 0.8273    eval auc: 0.7769  acc: 0.7082    test auc: 0.7747  acc: 0.7045, time: 0.6070
epoch 35    train auc: 0.9307  acc: 0.8299    eval auc: 0.7761  acc: 0.7035    test auc: 0.7744  acc: 0.7033, time: 0.6011
epoch 36    train auc: 0.9312  acc: 0.8297    eval auc: 0.7757  acc: 0.7036    test auc: 0.7738  acc: 0.7024, time: 0.6036
epoch 37    train auc: 0.9318  acc: 0.8316    eval auc: 0.7750  acc: 0.7015    test auc: 0.7733  acc: 0.7011, time: 0.6130
epoch 38    train auc: 0.9320  acc: 0.8300    eval auc: 0.7748  acc: 0.7030    test auc: 0.7727  acc: 0.7019, time: 0.6080
epoch 39    train auc: 0.9323  acc: 0.8299    eval auc: 0.7742  acc: 0.7034    test auc: 0.7720  acc: 0.7026, time: 0.6036
epoch 40    train auc: 0.9325  acc: 0.8295    eval auc: 0.7738  acc: 0.7049    test auc: 0.7712  acc: 0.7006, time: 0.5850
epoch 41    train auc: 0.9331  acc: 0.8306    eval auc: 0.7736  acc: 0.7034    test auc: 0.7714  acc: 0.7003, time: 0.5960
epoch 42    train auc: 0.9341  acc: 0.8349    eval auc: 0.7725  acc: 0.6996    test auc: 0.7710  acc: 0.6989, time: 0.5815
epoch 43    train auc: 0.9344  acc: 0.8346    eval auc: 0.7723  acc: 0.6990    test auc: 0.7708  acc: 0.6980, time: 0.5860
epoch 44    train auc: 0.9342  acc: 0.8315    eval auc: 0.7722  acc: 0.7030    test auc: 0.7700  acc: 0.6997, time: 0.5794
epoch 45    train auc: 0.9345  acc: 0.8321    eval auc: 0.7720  acc: 0.7029    test auc: 0.7698  acc: 0.7002, time: 0.5894
epoch 46    train auc: 0.9351  acc: 0.8341    eval auc: 0.7714  acc: 0.7014    test auc: 0.7693  acc: 0.6983, time: 0.5870
epoch 47    train auc: 0.9356  acc: 0.8354    eval auc: 0.7712  acc: 0.7001    test auc: 0.7694  acc: 0.6980, time: 0.5810
epoch 48    train auc: 0.9361  acc: 0.8365    eval auc: 0.7705  acc: 0.6998    test auc: 0.7688  acc: 0.6965, time: 0.5640
epoch 49    train auc: 0.9356  acc: 0.8337    eval auc: 0.7703  acc: 0.7007    test auc: 0.7682  acc: 0.6989, time: 0.5964
avg time per epoch : 0.6229899740219116
--- 37.51777386665344 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:09:39.725476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:09:39.725840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4932  acc: 0.4967    eval auc: 0.5110  acc: 0.5061    test auc: 0.5130  acc: 0.5136, time: 0.9110
epoch 1    train auc: 0.4877  acc: 0.4906    eval auc: 0.5136  acc: 0.5114    test auc: 0.5230  acc: 0.5168, time: 0.3460
epoch 2    train auc: 0.5397  acc: 0.5253    eval auc: 0.4407  acc: 0.4630    test auc: 0.4404  acc: 0.4612, time: 0.5760
epoch 3    train auc: 0.5723  acc: 0.5507    eval auc: 0.3953  acc: 0.4235    test auc: 0.3916  acc: 0.4245, time: 0.3259
epoch 4    train auc: 0.5830  acc: 0.5577    eval auc: 0.3817  acc: 0.4159    test auc: 0.3750  acc: 0.4109, time: 0.5380
epoch 5    train auc: 0.5884  acc: 0.5610    eval auc: 0.3731  acc: 0.4106    test auc: 0.3694  acc: 0.4064, time: 0.3250
epoch 6    train auc: 0.5926  acc: 0.5630    eval auc: 0.3707  acc: 0.4075    test auc: 0.3664  acc: 0.4041, time: 0.5350
epoch 7    train auc: 0.6145  acc: 0.5647    eval auc: 0.3743  acc: 0.4080    test auc: 0.3693  acc: 0.4005, time: 0.3268
epoch 8    train auc: 0.6788  acc: 0.5954    eval auc: 0.4276  acc: 0.4303    test auc: 0.4202  acc: 0.4261, time: 0.5327
epoch 9    train auc: 0.8085  acc: 0.7085    eval auc: 0.6298  acc: 0.5639    test auc: 0.6292  acc: 0.5654, time: 0.3350
epoch 10    train auc: 0.8458  acc: 0.7114    eval auc: 0.7091  acc: 0.5874    test auc: 0.7103  acc: 0.5891, time: 0.5339
epoch 11    train auc: 0.8695  acc: 0.7755    eval auc: 0.7173  acc: 0.6728    test auc: 0.7173  acc: 0.6760, time: 0.3250
epoch 12    train auc: 0.8799  acc: 0.7851    eval auc: 0.7361  acc: 0.6806    test auc: 0.7382  acc: 0.6801, time: 0.5580
epoch 13    train auc: 0.8917  acc: 0.7926    eval auc: 0.7335  acc: 0.6923    test auc: 0.7329  acc: 0.6886, time: 0.3360
epoch 14    train auc: 0.8947  acc: 0.7971    eval auc: 0.7415  acc: 0.6873    test auc: 0.7431  acc: 0.6866, time: 0.5280
epoch 15    train auc: 0.9032  acc: 0.7988    eval auc: 0.7401  acc: 0.6969    test auc: 0.7388  acc: 0.6930, time: 0.3290
epoch 16    train auc: 0.9057  acc: 0.8097    eval auc: 0.7452  acc: 0.6969    test auc: 0.7451  acc: 0.6976, time: 0.5398
epoch 17    train auc: 0.9118  acc: 0.8082    eval auc: 0.7455  acc: 0.7030    test auc: 0.7443  acc: 0.6990, time: 0.3282
epoch 18    train auc: 0.9143  acc: 0.8161    eval auc: 0.7388  acc: 0.6958    test auc: 0.7370  acc: 0.6918, time: 0.5320
epoch 19    train auc: 0.9238  acc: 0.8191    eval auc: 0.7468  acc: 0.7079    test auc: 0.7439  acc: 0.7016, time: 0.3296
epoch 20    train auc: 0.9306  acc: 0.8277    eval auc: 0.7457  acc: 0.6993    test auc: 0.7428  acc: 0.6993, time: 0.5443
epoch 21    train auc: 0.9420  acc: 0.8372    eval auc: 0.7460  acc: 0.7096    test auc: 0.7418  acc: 0.7028, time: 0.3486
epoch 22    train auc: 0.9436  acc: 0.8457    eval auc: 0.7408  acc: 0.6987    test auc: 0.7373  acc: 0.6942, time: 0.5291
epoch 23    train auc: 0.9518  acc: 0.8517    eval auc: 0.7434  acc: 0.7114    test auc: 0.7381  acc: 0.7066, time: 0.3323
epoch 24    train auc: 0.9524  acc: 0.8569    eval auc: 0.7416  acc: 0.6976    test auc: 0.7385  acc: 0.6983, time: 0.5360
epoch 25    train auc: 0.9592  acc: 0.8664    eval auc: 0.7398  acc: 0.7075    test auc: 0.7341  acc: 0.7020, time: 0.3190
epoch 26    train auc: 0.9609  acc: 0.8723    eval auc: 0.7371  acc: 0.7017    test auc: 0.7317  acc: 0.6972, time: 0.5358
epoch 27    train auc: 0.9650  acc: 0.8798    eval auc: 0.7378  acc: 0.7061    test auc: 0.7319  acc: 0.6995, time: 0.3300
epoch 28    train auc: 0.9651  acc: 0.8799    eval auc: 0.7344  acc: 0.6955    test auc: 0.7289  acc: 0.6939, time: 0.5349
epoch 29    train auc: 0.9687  acc: 0.8880    eval auc: 0.7382  acc: 0.7026    test auc: 0.7310  acc: 0.6957, time: 0.3379
epoch 30    train auc: 0.9673  acc: 0.8826    eval auc: 0.7317  acc: 0.6900    test auc: 0.7254  acc: 0.6921, time: 0.5508
epoch 31    train auc: 0.9715  acc: 0.8931    eval auc: 0.7337  acc: 0.7016    test auc: 0.7251  acc: 0.6913, time: 0.3340
epoch 32    train auc: 0.9716  acc: 0.8930    eval auc: 0.7310  acc: 0.6924    test auc: 0.7238  acc: 0.6911, time: 0.5396
epoch 33    train auc: 0.9736  acc: 0.8985    eval auc: 0.7392  acc: 0.7030    test auc: 0.7302  acc: 0.6936, time: 0.3372
epoch 34    train auc: 0.9739  acc: 0.8972    eval auc: 0.7255  acc: 0.6908    test auc: 0.7175  acc: 0.6863, time: 0.5122
epoch 35    train auc: 0.9758  acc: 0.9043    eval auc: 0.7317  acc: 0.6967    test auc: 0.7230  acc: 0.6909, time: 0.3360
epoch 36    train auc: 0.9754  acc: 0.9019    eval auc: 0.7263  acc: 0.6919    test auc: 0.7177  acc: 0.6891, time: 0.5350
epoch 37    train auc: 0.9775  acc: 0.9087    eval auc: 0.7324  acc: 0.6958    test auc: 0.7240  acc: 0.6926, time: 0.3258
epoch 38    train auc: 0.9775  acc: 0.9062    eval auc: 0.7229  acc: 0.6880    test auc: 0.7148  acc: 0.6836, time: 0.5418
epoch 39    train auc: 0.9788  acc: 0.9116    eval auc: 0.7332  acc: 0.6939    test auc: 0.7252  acc: 0.6935, time: 0.3250
epoch 40    train auc: 0.9788  acc: 0.9085    eval auc: 0.7231  acc: 0.6874    test auc: 0.7155  acc: 0.6839, time: 0.5385
epoch 41    train auc: 0.9806  acc: 0.9155    eval auc: 0.7285  acc: 0.6932    test auc: 0.7205  acc: 0.6883, time: 0.3470
epoch 42    train auc: 0.9804  acc: 0.9136    eval auc: 0.7205  acc: 0.6882    test auc: 0.7121  acc: 0.6828, time: 0.5300
epoch 43    train auc: 0.9814  acc: 0.9185    eval auc: 0.7302  acc: 0.6930    test auc: 0.7212  acc: 0.6908, time: 0.3390
epoch 44    train auc: 0.9813  acc: 0.9151    eval auc: 0.7228  acc: 0.6890    test auc: 0.7152  acc: 0.6861, time: 0.5420
epoch 45    train auc: 0.9826  acc: 0.9213    eval auc: 0.7272  acc: 0.6916    test auc: 0.7191  acc: 0.6886, time: 0.3489
epoch 46    train auc: 0.9824  acc: 0.9181    eval auc: 0.7231  acc: 0.6892    test auc: 0.7149  acc: 0.6847, time: 0.5937
epoch 47    train auc: 0.9830  acc: 0.9215    eval auc: 0.7284  acc: 0.6936    test auc: 0.7197  acc: 0.6877, time: 0.3670
epoch 48    train auc: 0.9833  acc: 0.9202    eval auc: 0.7213  acc: 0.6879    test auc: 0.7137  acc: 0.6845, time: 0.5490
epoch 49    train auc: 0.9848  acc: 0.9263    eval auc: 0.7257  acc: 0.6892    test auc: 0.7178  acc: 0.6860, time: 0.3520
avg time per epoch : 0.44565356731414796
--- 28.285322427749634 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:10:07.974123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:10:07.974475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5080  acc: 0.5094    eval auc: 0.5076  acc: 0.5074    test auc: 0.5013  acc: 0.5040, time: 0.9573
epoch 1    train auc: 0.5239  acc: 0.5151    eval auc: 0.4745  acc: 0.4938    test auc: 0.4660  acc: 0.4818, time: 0.3460
epoch 2    train auc: 0.4928  acc: 0.5033    eval auc: 0.5586  acc: 0.5430    test auc: 0.5605  acc: 0.5472, time: 0.5710
epoch 3    train auc: 0.5440  acc: 0.5257    eval auc: 0.4427  acc: 0.4702    test auc: 0.4314  acc: 0.4566, time: 0.3510
epoch 4    train auc: 0.5602  acc: 0.5411    eval auc: 0.4239  acc: 0.4486    test auc: 0.4137  acc: 0.4382, time: 0.5670
epoch 5    train auc: 0.5673  acc: 0.5474    eval auc: 0.4134  acc: 0.4392    test auc: 0.4032  acc: 0.4305, time: 0.3580
epoch 6    train auc: 0.5843  acc: 0.5568    eval auc: 0.4090  acc: 0.4316    test auc: 0.4001  acc: 0.4254, time: 0.5570
epoch 7    train auc: 0.6063  acc: 0.5725    eval auc: 0.4190  acc: 0.4381    test auc: 0.4112  acc: 0.4332, time: 0.3380
epoch 8    train auc: 0.7007  acc: 0.6381    eval auc: 0.5189  acc: 0.5049    test auc: 0.5203  acc: 0.5049, time: 0.5420
epoch 9    train auc: 0.7710  acc: 0.6988    eval auc: 0.6110  acc: 0.5819    test auc: 0.6180  acc: 0.5847, time: 0.3589
epoch 10    train auc: 0.8292  acc: 0.7515    eval auc: 0.6871  acc: 0.6686    test auc: 0.6936  acc: 0.6743, time: 0.5540
epoch 11    train auc: 0.8570  acc: 0.7521    eval auc: 0.7177  acc: 0.7030    test auc: 0.7234  acc: 0.7094, time: 0.3558
epoch 12    train auc: 0.8707  acc: 0.7517    eval auc: 0.7384  acc: 0.7144    test auc: 0.7429  acc: 0.7242, time: 0.5740
epoch 13    train auc: 0.8812  acc: 0.7796    eval auc: 0.7524  acc: 0.7218    test auc: 0.7566  acc: 0.7282, time: 0.3650
epoch 14    train auc: 0.8855  acc: 0.7724    eval auc: 0.7592  acc: 0.7269    test auc: 0.7626  acc: 0.7363, time: 0.5869
epoch 15    train auc: 0.8896  acc: 0.7898    eval auc: 0.7642  acc: 0.7311    test auc: 0.7679  acc: 0.7339, time: 0.3440
epoch 16    train auc: 0.8925  acc: 0.7810    eval auc: 0.7670  acc: 0.7318    test auc: 0.7698  acc: 0.7390, time: 0.5759
epoch 17    train auc: 0.8947  acc: 0.8000    eval auc: 0.7686  acc: 0.7295    test auc: 0.7718  acc: 0.7274, time: 0.3541
epoch 18    train auc: 0.8973  acc: 0.7905    eval auc: 0.7708  acc: 0.7350    test auc: 0.7729  acc: 0.7381, time: 0.5678
epoch 19    train auc: 0.8990  acc: 0.8009    eval auc: 0.7710  acc: 0.7304    test auc: 0.7732  acc: 0.7277, time: 0.3410
epoch 20    train auc: 0.9012  acc: 0.7944    eval auc: 0.7729  acc: 0.7334    test auc: 0.7744  acc: 0.7357, time: 0.6038
epoch 21    train auc: 0.9025  acc: 0.8066    eval auc: 0.7726  acc: 0.7267    test auc: 0.7745  acc: 0.7252, time: 0.3997
epoch 22    train auc: 0.9045  acc: 0.8009    eval auc: 0.7744  acc: 0.7329    test auc: 0.7754  acc: 0.7310, time: 0.6376
epoch 23    train auc: 0.9057  acc: 0.8104    eval auc: 0.7736  acc: 0.7213    test auc: 0.7748  acc: 0.7203, time: 0.4010
epoch 24    train auc: 0.9073  acc: 0.8044    eval auc: 0.7755  acc: 0.7294    test auc: 0.7761  acc: 0.7310, time: 0.6130
epoch 25    train auc: 0.9084  acc: 0.8121    eval auc: 0.7749  acc: 0.7222    test auc: 0.7757  acc: 0.7203, time: 0.3755
epoch 26    train auc: 0.9099  acc: 0.8079    eval auc: 0.7765  acc: 0.7295    test auc: 0.7767  acc: 0.7302, time: 0.6050
epoch 27    train auc: 0.9109  acc: 0.8128    eval auc: 0.7758  acc: 0.7225    test auc: 0.7761  acc: 0.7204, time: 0.3750
epoch 28    train auc: 0.9121  acc: 0.8123    eval auc: 0.7770  acc: 0.7257    test auc: 0.7768  acc: 0.7243, time: 0.6058
epoch 29    train auc: 0.9130  acc: 0.8139    eval auc: 0.7768  acc: 0.7248    test auc: 0.7768  acc: 0.7210, time: 0.3660
epoch 30    train auc: 0.9141  acc: 0.8138    eval auc: 0.7775  acc: 0.7264    test auc: 0.7770  acc: 0.7242, time: 0.6180
epoch 31    train auc: 0.9149  acc: 0.8192    eval auc: 0.7764  acc: 0.7184    test auc: 0.7762  acc: 0.7152, time: 0.3660
epoch 32    train auc: 0.9159  acc: 0.8136    eval auc: 0.7780  acc: 0.7264    test auc: 0.7771  acc: 0.7261, time: 0.6117
epoch 33    train auc: 0.9166  acc: 0.8211    eval auc: 0.7771  acc: 0.7180    test auc: 0.7766  acc: 0.7153, time: 0.3900
epoch 34    train auc: 0.9175  acc: 0.8174    eval auc: 0.7781  acc: 0.7249    test auc: 0.7772  acc: 0.7222, time: 0.6109
epoch 35    train auc: 0.9181  acc: 0.8226    eval auc: 0.7773  acc: 0.7148    test auc: 0.7768  acc: 0.7139, time: 0.3740
epoch 36    train auc: 0.9188  acc: 0.8161    eval auc: 0.7790  acc: 0.7264    test auc: 0.7778  acc: 0.7245, time: 0.5860
epoch 37    train auc: 0.9195  acc: 0.8238    eval auc: 0.7772  acc: 0.7134    test auc: 0.7766  acc: 0.7122, time: 0.3700
epoch 38    train auc: 0.9202  acc: 0.8200    eval auc: 0.7783  acc: 0.7233    test auc: 0.7770  acc: 0.7212, time: 0.6290
epoch 39    train auc: 0.9208  acc: 0.8247    eval auc: 0.7770  acc: 0.7121    test auc: 0.7761  acc: 0.7107, time: 0.3758
epoch 40    train auc: 0.9214  acc: 0.8203    eval auc: 0.7787  acc: 0.7231    test auc: 0.7773  acc: 0.7228, time: 0.6110
epoch 41    train auc: 0.9220  acc: 0.8247    eval auc: 0.7777  acc: 0.7154    test auc: 0.7766  acc: 0.7140, time: 0.3760
epoch 42    train auc: 0.9226  acc: 0.8223    eval auc: 0.7783  acc: 0.7219    test auc: 0.7767  acc: 0.7197, time: 0.5951
epoch 43    train auc: 0.9231  acc: 0.8252    eval auc: 0.7775  acc: 0.7146    test auc: 0.7762  acc: 0.7137, time: 0.3766
epoch 44    train auc: 0.9235  acc: 0.8225    eval auc: 0.7782  acc: 0.7215    test auc: 0.7765  acc: 0.7198, time: 0.6040
epoch 45    train auc: 0.9241  acc: 0.8245    eval auc: 0.7779  acc: 0.7196    test auc: 0.7764  acc: 0.7163, time: 0.3730
epoch 46    train auc: 0.9245  acc: 0.8231    eval auc: 0.7783  acc: 0.7212    test auc: 0.7765  acc: 0.7190, time: 0.6122
epoch 47    train auc: 0.9250  acc: 0.8247    eval auc: 0.7775  acc: 0.7184    test auc: 0.7760  acc: 0.7145, time: 0.3778
epoch 48    train auc: 0.9255  acc: 0.8254    eval auc: 0.7771  acc: 0.7181    test auc: 0.7754  acc: 0.7139, time: 0.6090
epoch 49    train auc: 0.9259  acc: 0.8255    eval auc: 0.7771  acc: 0.7172    test auc: 0.7756  acc: 0.7128, time: 0.3653
avg time per epoch : 0.48756363391876223
--- 30.79760503768921 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:10:38.884579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:10:38.884913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4898  acc: 0.4944    eval auc: 0.5208  acc: 0.5132    test auc: 0.5102  acc: 0.5037, time: 0.8980
epoch 1    train auc: 0.4859  acc: 0.4897    eval auc: 0.5177  acc: 0.5116    test auc: 0.5247  acc: 0.5192, time: 0.3760
epoch 2    train auc: 0.5277  acc: 0.5094    eval auc: 0.4624  acc: 0.4870    test auc: 0.4542  acc: 0.4847, time: 0.6230
epoch 3    train auc: 0.5653  acc: 0.5146    eval auc: 0.4072  acc: 0.4809    test auc: 0.3987  acc: 0.4751, time: 0.3750
epoch 4    train auc: 0.5703  acc: 0.5065    eval auc: 0.3992  acc: 0.4906    test auc: 0.3926  acc: 0.4898, time: 0.5962
epoch 5    train auc: 0.5803  acc: 0.5164    eval auc: 0.3831  acc: 0.4783    test auc: 0.3801  acc: 0.4724, time: 0.3659
epoch 6    train auc: 0.5837  acc: 0.5323    eval auc: 0.3796  acc: 0.4552    test auc: 0.3737  acc: 0.4479, time: 0.5977
epoch 7    train auc: 0.5848  acc: 0.5534    eval auc: 0.3803  acc: 0.4246    test auc: 0.3700  acc: 0.4150, time: 0.3800
epoch 8    train auc: 0.5872  acc: 0.5636    eval auc: 0.3759  acc: 0.4103    test auc: 0.3681  acc: 0.3987, time: 0.5930
epoch 9    train auc: 0.5917  acc: 0.5631    eval auc: 0.3699  acc: 0.4080    test auc: 0.3619  acc: 0.4029, time: 0.3620
epoch 10    train auc: 0.5934  acc: 0.5638    eval auc: 0.3672  acc: 0.4067    test auc: 0.3603  acc: 0.4021, time: 0.6079
epoch 11    train auc: 0.5944  acc: 0.5645    eval auc: 0.3663  acc: 0.4058    test auc: 0.3587  acc: 0.4006, time: 0.3760
epoch 12    train auc: 0.5950  acc: 0.5649    eval auc: 0.3653  acc: 0.4042    test auc: 0.3584  acc: 0.4012, time: 0.6088
epoch 13    train auc: 0.5956  acc: 0.5655    eval auc: 0.3648  acc: 0.4050    test auc: 0.3576  acc: 0.3984, time: 0.3754
epoch 14    train auc: 0.5959  acc: 0.5664    eval auc: 0.3644  acc: 0.4056    test auc: 0.3575  acc: 0.3951, time: 0.6060
epoch 15    train auc: 0.5961  acc: 0.5662    eval auc: 0.3644  acc: 0.4043    test auc: 0.3571  acc: 0.3970, time: 0.3759
epoch 16    train auc: 0.5963  acc: 0.5666    eval auc: 0.3644  acc: 0.4041    test auc: 0.3569  acc: 0.3963, time: 0.6029
epoch 17    train auc: 0.5965  acc: 0.5666    eval auc: 0.3639  acc: 0.4034    test auc: 0.3569  acc: 0.3969, time: 0.3800
epoch 18    train auc: 0.5966  acc: 0.5668    eval auc: 0.3640  acc: 0.4054    test auc: 0.3569  acc: 0.3943, time: 0.6119
epoch 19    train auc: 0.5967  acc: 0.5669    eval auc: 0.3638  acc: 0.4060    test auc: 0.3568  acc: 0.3934, time: 0.3730
epoch 20    train auc: 0.5968  acc: 0.5668    eval auc: 0.3636  acc: 0.4034    test auc: 0.3571  acc: 0.3962, time: 0.6177
epoch 21    train auc: 0.5968  acc: 0.5669    eval auc: 0.3639  acc: 0.4051    test auc: 0.3567  acc: 0.3943, time: 0.3940
epoch 22    train auc: 0.5969  acc: 0.5669    eval auc: 0.3636  acc: 0.4031    test auc: 0.3569  acc: 0.3963, time: 0.5990
epoch 23    train auc: 0.5969  acc: 0.5669    eval auc: 0.3638  acc: 0.4042    test auc: 0.3567  acc: 0.3952, time: 0.3640
epoch 24    train auc: 0.5970  acc: 0.5669    eval auc: 0.3636  acc: 0.4043    test auc: 0.3569  acc: 0.3951, time: 0.5930
epoch 25    train auc: 0.5970  acc: 0.5669    eval auc: 0.3636  acc: 0.4022    test auc: 0.3569  acc: 0.3972, time: 0.3570
epoch 26    train auc: 0.5970  acc: 0.5669    eval auc: 0.3636  acc: 0.4021    test auc: 0.3569  acc: 0.3973, time: 0.6026
epoch 27    train auc: 0.5971  acc: 0.5669    eval auc: 0.3635  acc: 0.4047    test auc: 0.3570  acc: 0.3947, time: 0.3870
epoch 28    train auc: 0.5971  acc: 0.5669    eval auc: 0.3636  acc: 0.4036    test auc: 0.3570  acc: 0.3958, time: 0.6260
epoch 29    train auc: 0.5971  acc: 0.5669    eval auc: 0.3633  acc: 0.4022    test auc: 0.3573  acc: 0.3972, time: 0.3670
epoch 30    train auc: 0.5971  acc: 0.5669    eval auc: 0.3636  acc: 0.4043    test auc: 0.3570  acc: 0.3951, time: 0.5780
epoch 31    train auc: 0.5971  acc: 0.5669    eval auc: 0.3635  acc: 0.4025    test auc: 0.3571  acc: 0.3969, time: 0.3719
epoch 32    train auc: 0.5971  acc: 0.5669    eval auc: 0.3637  acc: 0.4017    test auc: 0.3569  acc: 0.3977, time: 0.6160
epoch 33    train auc: 0.5971  acc: 0.5669    eval auc: 0.3638  acc: 0.4041    test auc: 0.3567  acc: 0.3953, time: 0.3690
epoch 34    train auc: 0.5971  acc: 0.5669    eval auc: 0.3636  acc: 0.4023    test auc: 0.3570  acc: 0.3971, time: 0.6060
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4041    test auc: 0.3572  acc: 0.3953, time: 0.3580
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4036    test auc: 0.3571  acc: 0.3958, time: 0.6050
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4009    test auc: 0.3568  acc: 0.3985, time: 0.3720
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4022    test auc: 0.3568  acc: 0.3972, time: 0.5230
epoch 39    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4032    test auc: 0.3568  acc: 0.3962, time: 0.3109
epoch 40    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4039    test auc: 0.3570  acc: 0.3954, time: 0.5071
epoch 41    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4047    test auc: 0.3568  acc: 0.3947, time: 0.3210
epoch 42    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4045    test auc: 0.3570  acc: 0.3949, time: 0.5136
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4034    test auc: 0.3570  acc: 0.3960, time: 0.3111
epoch 44    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4013    test auc: 0.3570  acc: 0.3980, time: 0.5090
epoch 45    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4048    test auc: 0.3571  acc: 0.3946, time: 0.4040
epoch 46    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4022    test auc: 0.3572  acc: 0.3972, time: 0.5670
epoch 47    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4043    test auc: 0.3570  acc: 0.3951, time: 0.3211
epoch 48    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4034    test auc: 0.3570  acc: 0.3960, time: 0.5068
epoch 49    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4019    test auc: 0.3572  acc: 0.3974, time: 0.3137
avg time per epoch : 0.47951733112335204
--- 30.437279224395752 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:11:09.262417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:11:09.262762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5163  acc: 0.5111    eval auc: 0.4803  acc: 0.4866    test auc: 0.4899  acc: 0.4917, time: 0.8028
epoch 1    train auc: 0.5234  acc: 0.5136    eval auc: 0.4698  acc: 0.4792    test auc: 0.4781  acc: 0.4852, time: 0.3150
epoch 2    train auc: 0.5383  acc: 0.5188    eval auc: 0.4544  acc: 0.4767    test auc: 0.4633  acc: 0.4801, time: 0.6870
epoch 3    train auc: 0.5646  acc: 0.5373    eval auc: 0.4541  acc: 0.4912    test auc: 0.4594  acc: 0.4924, time: 0.4330
epoch 4    train auc: 0.6531  acc: 0.5878    eval auc: 0.5246  acc: 0.5387    test auc: 0.5324  acc: 0.5430, time: 0.7070
epoch 5    train auc: 0.7540  acc: 0.6788    eval auc: 0.6300  acc: 0.6268    test auc: 0.6414  acc: 0.6429, time: 0.4150
epoch 6    train auc: 0.8265  acc: 0.7182    eval auc: 0.7029  acc: 0.6860    test auc: 0.7095  acc: 0.7013, time: 0.6430
epoch 7    train auc: 0.8627  acc: 0.7308    eval auc: 0.7397  acc: 0.7050    test auc: 0.7440  acc: 0.7152, time: 0.3617
epoch 8    train auc: 0.8798  acc: 0.7513    eval auc: 0.7613  acc: 0.7217    test auc: 0.7646  acc: 0.7316, time: 0.6010
epoch 9    train auc: 0.8874  acc: 0.7718    eval auc: 0.7703  acc: 0.7360    test auc: 0.7728  acc: 0.7416, time: 0.3750
epoch 10    train auc: 0.8922  acc: 0.7842    eval auc: 0.7747  acc: 0.7408    test auc: 0.7768  acc: 0.7468, time: 0.5990
epoch 11    train auc: 0.8961  acc: 0.7831    eval auc: 0.7768  acc: 0.7407    test auc: 0.7782  acc: 0.7470, time: 0.3638
epoch 12    train auc: 0.8994  acc: 0.7888    eval auc: 0.7780  acc: 0.7395    test auc: 0.7790  acc: 0.7432, time: 0.5930
epoch 13    train auc: 0.9022  acc: 0.7975    eval auc: 0.7784  acc: 0.7352    test auc: 0.7791  acc: 0.7355, time: 0.3640
epoch 14    train auc: 0.9049  acc: 0.8045    eval auc: 0.7786  acc: 0.7316    test auc: 0.7791  acc: 0.7296, time: 0.5880
epoch 15    train auc: 0.9073  acc: 0.8064    eval auc: 0.7790  acc: 0.7281    test auc: 0.7791  acc: 0.7277, time: 0.3960
epoch 16    train auc: 0.9096  acc: 0.8094    eval auc: 0.7789  acc: 0.7258    test auc: 0.7785  acc: 0.7236, time: 0.6159
epoch 17    train auc: 0.9117  acc: 0.8138    eval auc: 0.7790  acc: 0.7211    test auc: 0.7783  acc: 0.7177, time: 0.3730
epoch 18    train auc: 0.9136  acc: 0.8126    eval auc: 0.7794  acc: 0.7228    test auc: 0.7782  acc: 0.7215, time: 0.6409
epoch 19    train auc: 0.9153  acc: 0.8135    eval auc: 0.7794  acc: 0.7232    test auc: 0.7778  acc: 0.7204, time: 0.3778
epoch 20    train auc: 0.9170  acc: 0.8183    eval auc: 0.7786  acc: 0.7202    test auc: 0.7768  acc: 0.7156, time: 0.6118
epoch 21    train auc: 0.9183  acc: 0.8189    eval auc: 0.7789  acc: 0.7211    test auc: 0.7769  acc: 0.7158, time: 0.3783
epoch 22    train auc: 0.9197  acc: 0.8208    eval auc: 0.7787  acc: 0.7183    test auc: 0.7763  acc: 0.7147, time: 0.6181
epoch 23    train auc: 0.9208  acc: 0.8229    eval auc: 0.7784  acc: 0.7156    test auc: 0.7760  acc: 0.7135, time: 0.3820
epoch 24    train auc: 0.9219  acc: 0.8233    eval auc: 0.7786  acc: 0.7158    test auc: 0.7758  acc: 0.7137, time: 0.6412
epoch 25    train auc: 0.9229  acc: 0.8241    eval auc: 0.7784  acc: 0.7140    test auc: 0.7756  acc: 0.7122, time: 0.4100
epoch 26    train auc: 0.9239  acc: 0.8245    eval auc: 0.7780  acc: 0.7130    test auc: 0.7752  acc: 0.7107, time: 0.5858
epoch 27    train auc: 0.9247  acc: 0.8251    eval auc: 0.7777  acc: 0.7124    test auc: 0.7746  acc: 0.7113, time: 0.3559
epoch 28    train auc: 0.9256  acc: 0.8266    eval auc: 0.7770  acc: 0.7124    test auc: 0.7739  acc: 0.7065, time: 0.6134
epoch 29    train auc: 0.9262  acc: 0.8262    eval auc: 0.7777  acc: 0.7134    test auc: 0.7745  acc: 0.7114, time: 0.3600
epoch 30    train auc: 0.9271  acc: 0.8270    eval auc: 0.7763  acc: 0.7112    test auc: 0.7732  acc: 0.7066, time: 0.5833
epoch 31    train auc: 0.9278  acc: 0.8283    eval auc: 0.7753  acc: 0.7095    test auc: 0.7721  acc: 0.7056, time: 0.3619
epoch 32    train auc: 0.9283  acc: 0.8280    eval auc: 0.7763  acc: 0.7109    test auc: 0.7729  acc: 0.7096, time: 0.6045
epoch 33    train auc: 0.9290  acc: 0.8296    eval auc: 0.7752  acc: 0.7074    test auc: 0.7720  acc: 0.7050, time: 0.3609
epoch 34    train auc: 0.9296  acc: 0.8314    eval auc: 0.7742  acc: 0.7055    test auc: 0.7712  acc: 0.7029, time: 0.5740
epoch 35    train auc: 0.9301  acc: 0.8308    eval auc: 0.7744  acc: 0.7058    test auc: 0.7713  acc: 0.7036, time: 0.3520
epoch 36    train auc: 0.9304  acc: 0.8306    eval auc: 0.7755  acc: 0.7098    test auc: 0.7722  acc: 0.7062, time: 0.5757
epoch 37    train auc: 0.9311  acc: 0.8314    eval auc: 0.7738  acc: 0.7049    test auc: 0.7708  acc: 0.7020, time: 0.3677
epoch 38    train auc: 0.9317  acc: 0.8324    eval auc: 0.7732  acc: 0.7037    test auc: 0.7699  acc: 0.7014, time: 0.5910
epoch 39    train auc: 0.9322  acc: 0.8325    eval auc: 0.7721  acc: 0.7020    test auc: 0.7689  acc: 0.6995, time: 0.3569
epoch 40    train auc: 0.9325  acc: 0.8331    eval auc: 0.7732  acc: 0.7046    test auc: 0.7699  acc: 0.7026, time: 0.5770
epoch 41    train auc: 0.9330  acc: 0.8340    eval auc: 0.7722  acc: 0.7020    test auc: 0.7689  acc: 0.7004, time: 0.3500
epoch 42    train auc: 0.9336  acc: 0.8350    eval auc: 0.7711  acc: 0.7013    test auc: 0.7679  acc: 0.6997, time: 0.5870
epoch 43    train auc: 0.9338  acc: 0.8347    eval auc: 0.7715  acc: 0.7023    test auc: 0.7683  acc: 0.7001, time: 0.3540
epoch 44    train auc: 0.9342  acc: 0.8347    eval auc: 0.7711  acc: 0.7026    test auc: 0.7679  acc: 0.6996, time: 0.5752
epoch 45    train auc: 0.9344  acc: 0.8341    eval auc: 0.7715  acc: 0.7050    test auc: 0.7681  acc: 0.7006, time: 0.3499
epoch 46    train auc: 0.9349  acc: 0.8356    eval auc: 0.7708  acc: 0.7029    test auc: 0.7676  acc: 0.6998, time: 0.5700
epoch 47    train auc: 0.9352  acc: 0.8352    eval auc: 0.7705  acc: 0.7033    test auc: 0.7671  acc: 0.6998, time: 0.3480
epoch 48    train auc: 0.9357  acc: 0.8360    eval auc: 0.7684  acc: 0.6980    test auc: 0.7653  acc: 0.6939, time: 0.5940
epoch 49    train auc: 0.9359  acc: 0.8358    eval auc: 0.7696  acc: 0.7029    test auc: 0.7665  acc: 0.6994, time: 0.3560
avg time per epoch : 0.49193735599517824
--- 31.073887586593628 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:11:40.440074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:11:40.440412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4791  acc: 0.4947    eval auc: 0.5367  acc: 0.5123    test auc: 0.5335  acc: 0.5073, time: 0.8750
epoch 1    train auc: 0.5322  acc: 0.5236    eval auc: 0.4531  acc: 0.4631    test auc: 0.4586  acc: 0.4677, time: 0.3296
epoch 2    train auc: 0.7337  acc: 0.5897    eval auc: 0.5993  acc: 0.5774    test auc: 0.6168  acc: 0.5845, time: 0.5449
epoch 3    train auc: 0.8766  acc: 0.7706    eval auc: 0.7687  acc: 0.7334    test auc: 0.7747  acc: 0.7413, time: 0.3310
epoch 4    train auc: 0.8944  acc: 0.7732    eval auc: 0.7822  acc: 0.7359    test auc: 0.7841  acc: 0.7438, time: 0.5350
epoch 5    train auc: 0.9067  acc: 0.8055    eval auc: 0.7840  acc: 0.7244    test auc: 0.7849  acc: 0.7232, time: 0.3250
epoch 6    train auc: 0.9131  acc: 0.8029    eval auc: 0.7844  acc: 0.7256    test auc: 0.7837  acc: 0.7251, time: 0.5499
epoch 7    train auc: 0.9202  acc: 0.8182    eval auc: 0.7795  acc: 0.7115    test auc: 0.7783  acc: 0.7067, time: 0.3362
epoch 8    train auc: 0.9212  acc: 0.8089    eval auc: 0.7800  acc: 0.7151    test auc: 0.7777  acc: 0.7151, time: 0.5443
epoch 9    train auc: 0.9277  acc: 0.8273    eval auc: 0.7732  acc: 0.6996    test auc: 0.7720  acc: 0.6977, time: 0.3370
epoch 10    train auc: 0.9284  acc: 0.8223    eval auc: 0.7774  acc: 0.7073    test auc: 0.7755  acc: 0.7101, time: 0.5417
epoch 11    train auc: 0.9308  acc: 0.8271    eval auc: 0.7737  acc: 0.7034    test auc: 0.7713  acc: 0.7016, time: 0.3259
epoch 12    train auc: 0.9301  acc: 0.8213    eval auc: 0.7784  acc: 0.7119    test auc: 0.7757  acc: 0.7098, time: 0.5370
epoch 13    train auc: 0.9347  acc: 0.8335    eval auc: 0.7698  acc: 0.7000    test auc: 0.7677  acc: 0.6963, time: 0.3312
epoch 14    train auc: 0.9343  acc: 0.8307    eval auc: 0.7742  acc: 0.7048    test auc: 0.7721  acc: 0.7063, time: 0.5482
epoch 15    train auc: 0.9366  acc: 0.8353    eval auc: 0.7688  acc: 0.7013    test auc: 0.7663  acc: 0.6976, time: 0.3570
epoch 16    train auc: 0.9353  acc: 0.8288    eval auc: 0.7720  acc: 0.7039    test auc: 0.7687  acc: 0.7021, time: 0.5347
epoch 17    train auc: 0.9390  acc: 0.8386    eval auc: 0.7662  acc: 0.6955    test auc: 0.7644  acc: 0.6939, time: 0.3325
epoch 18    train auc: 0.9379  acc: 0.8348    eval auc: 0.7703  acc: 0.7033    test auc: 0.7678  acc: 0.7023, time: 0.5407
epoch 19    train auc: 0.9402  acc: 0.8397    eval auc: 0.7629  acc: 0.6932    test auc: 0.7618  acc: 0.6921, time: 0.3293
epoch 20    train auc: 0.9402  acc: 0.8369    eval auc: 0.7663  acc: 0.6995    test auc: 0.7640  acc: 0.6980, time: 0.5286
epoch 21    train auc: 0.9422  acc: 0.8416    eval auc: 0.7623  acc: 0.6922    test auc: 0.7601  acc: 0.6917, time: 0.3289
epoch 22    train auc: 0.9421  acc: 0.8398    eval auc: 0.7644  acc: 0.6980    test auc: 0.7619  acc: 0.6938, time: 0.5460
epoch 23    train auc: 0.9435  acc: 0.8422    eval auc: 0.7615  acc: 0.6936    test auc: 0.7590  acc: 0.6892, time: 0.3299
epoch 24    train auc: 0.9439  acc: 0.8408    eval auc: 0.7619  acc: 0.6958    test auc: 0.7593  acc: 0.6912, time: 0.5289
epoch 25    train auc: 0.9450  acc: 0.8435    eval auc: 0.7608  acc: 0.6937    test auc: 0.7580  acc: 0.6903, time: 0.3261
epoch 26    train auc: 0.9451  acc: 0.8416    eval auc: 0.7613  acc: 0.6955    test auc: 0.7584  acc: 0.6913, time: 0.5370
epoch 27    train auc: 0.9473  acc: 0.8466    eval auc: 0.7576  acc: 0.6912    test auc: 0.7550  acc: 0.6871, time: 0.3232
epoch 28    train auc: 0.9466  acc: 0.8438    eval auc: 0.7607  acc: 0.6957    test auc: 0.7575  acc: 0.6913, time: 0.5309
epoch 29    train auc: 0.9490  acc: 0.8475    eval auc: 0.7561  acc: 0.6891    test auc: 0.7534  acc: 0.6877, time: 0.3251
epoch 30    train auc: 0.9495  acc: 0.8473    eval auc: 0.7573  acc: 0.6908    test auc: 0.7542  acc: 0.6878, time: 0.5330
epoch 31    train auc: 0.9517  acc: 0.8506    eval auc: 0.7531  acc: 0.6883    test auc: 0.7505  acc: 0.6858, time: 0.3160
epoch 32    train auc: 0.9509  acc: 0.8469    eval auc: 0.7560  acc: 0.6897    test auc: 0.7532  acc: 0.6897, time: 0.5362
epoch 33    train auc: 0.9539  acc: 0.8523    eval auc: 0.7500  acc: 0.6826    test auc: 0.7466  acc: 0.6825, time: 0.3500
epoch 34    train auc: 0.9556  acc: 0.8541    eval auc: 0.7520  acc: 0.6889    test auc: 0.7490  acc: 0.6852, time: 0.5180
epoch 35    train auc: 0.9567  acc: 0.8553    eval auc: 0.7494  acc: 0.6843    test auc: 0.7462  acc: 0.6828, time: 0.3474
epoch 36    train auc: 0.9576  acc: 0.8548    eval auc: 0.7494  acc: 0.6873    test auc: 0.7465  acc: 0.6840, time: 0.5328
epoch 37    train auc: 0.9596  acc: 0.8589    eval auc: 0.7487  acc: 0.6870    test auc: 0.7451  acc: 0.6824, time: 0.3300
epoch 38    train auc: 0.9604  acc: 0.8598    eval auc: 0.7464  acc: 0.6864    test auc: 0.7428  acc: 0.6812, time: 0.5309
epoch 39    train auc: 0.9620  acc: 0.8629    eval auc: 0.7465  acc: 0.6847    test auc: 0.7428  acc: 0.6834, time: 0.3152
epoch 40    train auc: 0.9619  acc: 0.8646    eval auc: 0.7465  acc: 0.6863    test auc: 0.7425  acc: 0.6851, time: 0.5270
epoch 41    train auc: 0.9643  acc: 0.8670    eval auc: 0.7446  acc: 0.6849    test auc: 0.7416  acc: 0.6858, time: 0.3308
epoch 42    train auc: 0.9649  acc: 0.8687    eval auc: 0.7439  acc: 0.6856    test auc: 0.7398  acc: 0.6859, time: 0.5276
epoch 43    train auc: 0.9662  acc: 0.8711    eval auc: 0.7433  acc: 0.6851    test auc: 0.7405  acc: 0.6854, time: 0.3200
epoch 44    train auc: 0.9665  acc: 0.8711    eval auc: 0.7434  acc: 0.6873    test auc: 0.7402  acc: 0.6869, time: 0.5160
epoch 45    train auc: 0.9681  acc: 0.8746    eval auc: 0.7430  acc: 0.6859    test auc: 0.7400  acc: 0.6861, time: 0.3310
epoch 46    train auc: 0.9687  acc: 0.8758    eval auc: 0.7408  acc: 0.6838    test auc: 0.7375  acc: 0.6856, time: 0.5210
epoch 47    train auc: 0.9701  acc: 0.8785    eval auc: 0.7405  acc: 0.6828    test auc: 0.7379  acc: 0.6870, time: 0.3220
epoch 48    train auc: 0.9706  acc: 0.8797    eval auc: 0.7385  acc: 0.6824    test auc: 0.7362  acc: 0.6856, time: 0.5265
epoch 49    train auc: 0.9706  acc: 0.8794    eval auc: 0.7397  acc: 0.6845    test auc: 0.7372  acc: 0.6886, time: 0.3307
avg time per epoch : 0.4390499496459961
--- 27.955140829086304 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:12:08.414062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:12:08.414356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4945  acc: 0.4951    eval auc: 0.5216  acc: 0.5117    test auc: 0.5001  acc: 0.5002, time: 0.9459
epoch 1    train auc: 0.5187  acc: 0.5096    eval auc: 0.4779  acc: 0.4881    test auc: 0.4897  acc: 0.4925, time: 0.3765
epoch 2    train auc: 0.5571  acc: 0.5295    eval auc: 0.5982  acc: 0.5312    test auc: 0.5967  acc: 0.5429, time: 0.5760
epoch 3    train auc: 0.5710  acc: 0.5295    eval auc: 0.4743  acc: 0.4904    test auc: 0.4728  acc: 0.4912, time: 0.3690
epoch 4    train auc: 0.7399  acc: 0.6689    eval auc: 0.6371  acc: 0.6209    test auc: 0.6479  acc: 0.6285, time: 0.5944
epoch 5    train auc: 0.7732  acc: 0.6347    eval auc: 0.6629  acc: 0.6134    test auc: 0.6748  acc: 0.6240, time: 0.3659
epoch 6    train auc: 0.8441  acc: 0.7229    eval auc: 0.7329  acc: 0.6968    test auc: 0.7431  acc: 0.7088, time: 0.5739
epoch 7    train auc: 0.8661  acc: 0.7395    eval auc: 0.7542  acc: 0.7127    test auc: 0.7612  acc: 0.7241, time: 0.3538
epoch 8    train auc: 0.8812  acc: 0.7549    eval auc: 0.7736  acc: 0.7272    test auc: 0.7786  acc: 0.7368, time: 0.5858
epoch 9    train auc: 0.8873  acc: 0.7766    eval auc: 0.7791  acc: 0.7414    test auc: 0.7840  acc: 0.7470, time: 0.3359
epoch 10    train auc: 0.8922  acc: 0.7796    eval auc: 0.7849  acc: 0.7434    test auc: 0.7889  acc: 0.7499, time: 0.5697
epoch 11    train auc: 0.8949  acc: 0.7864    eval auc: 0.7856  acc: 0.7457    test auc: 0.7897  acc: 0.7503, time: 0.3510
epoch 12    train auc: 0.8984  acc: 0.7843    eval auc: 0.7895  acc: 0.7458    test auc: 0.7921  acc: 0.7514, time: 0.5701
epoch 13    train auc: 0.8999  acc: 0.7974    eval auc: 0.7880  acc: 0.7450    test auc: 0.7914  acc: 0.7463, time: 0.3841
epoch 14    train auc: 0.9027  acc: 0.7947    eval auc: 0.7912  acc: 0.7478    test auc: 0.7933  acc: 0.7500, time: 0.6263
epoch 15    train auc: 0.9042  acc: 0.8028    eval auc: 0.7893  acc: 0.7420    test auc: 0.7919  acc: 0.7408, time: 0.3831
epoch 16    train auc: 0.9061  acc: 0.7987    eval auc: 0.7921  acc: 0.7441    test auc: 0.7935  acc: 0.7459, time: 0.6520
epoch 17    train auc: 0.9078  acc: 0.8090    eval auc: 0.7898  acc: 0.7357    test auc: 0.7918  acc: 0.7336, time: 0.3780
epoch 18    train auc: 0.9090  acc: 0.8021    eval auc: 0.7924  acc: 0.7411    test auc: 0.7931  acc: 0.7413, time: 0.6060
epoch 19    train auc: 0.9108  acc: 0.8104    eval auc: 0.7903  acc: 0.7337    test auc: 0.7913  acc: 0.7316, time: 0.3660
epoch 20    train auc: 0.9117  acc: 0.8068    eval auc: 0.7919  acc: 0.7383    test auc: 0.7922  acc: 0.7352, time: 0.6013
epoch 21    train auc: 0.9134  acc: 0.8147    eval auc: 0.7901  acc: 0.7316    test auc: 0.7907  acc: 0.7289, time: 0.3730
epoch 22    train auc: 0.9141  acc: 0.8105    eval auc: 0.7914  acc: 0.7354    test auc: 0.7912  acc: 0.7305, time: 0.6129
epoch 23    train auc: 0.9158  acc: 0.8182    eval auc: 0.7892  acc: 0.7284    test auc: 0.7895  acc: 0.7229, time: 0.3580
epoch 24    train auc: 0.9163  acc: 0.8131    eval auc: 0.7905  acc: 0.7341    test auc: 0.7900  acc: 0.7303, time: 0.6065
epoch 25    train auc: 0.9178  acc: 0.8188    eval auc: 0.7885  acc: 0.7272    test auc: 0.7885  acc: 0.7205, time: 0.3580
epoch 26    train auc: 0.9184  acc: 0.8157    eval auc: 0.7892  acc: 0.7313    test auc: 0.7887  acc: 0.7269, time: 0.5918
epoch 27    train auc: 0.9197  acc: 0.8190    eval auc: 0.7876  acc: 0.7254    test auc: 0.7873  acc: 0.7200, time: 0.3700
epoch 28    train auc: 0.9204  acc: 0.8190    eval auc: 0.7879  acc: 0.7264    test auc: 0.7872  acc: 0.7213, time: 0.6121
epoch 29    train auc: 0.9213  acc: 0.8197    eval auc: 0.7867  acc: 0.7249    test auc: 0.7861  acc: 0.7179, time: 0.3750
epoch 30    train auc: 0.9220  acc: 0.8207    eval auc: 0.7867  acc: 0.7246    test auc: 0.7858  acc: 0.7193, time: 0.6110
epoch 31    train auc: 0.9230  acc: 0.8226    eval auc: 0.7848  acc: 0.7192    test auc: 0.7842  acc: 0.7160, time: 0.4000
epoch 32    train auc: 0.9235  acc: 0.8214    eval auc: 0.7854  acc: 0.7232    test auc: 0.7842  acc: 0.7181, time: 0.6334
epoch 33    train auc: 0.9244  acc: 0.8238    eval auc: 0.7839  acc: 0.7180    test auc: 0.7833  acc: 0.7120, time: 0.3739
epoch 34    train auc: 0.9250  acc: 0.8237    eval auc: 0.7839  acc: 0.7181    test auc: 0.7830  acc: 0.7150, time: 0.6210
epoch 35    train auc: 0.9255  acc: 0.8248    eval auc: 0.7831  acc: 0.7157    test auc: 0.7824  acc: 0.7112, time: 0.3739
epoch 36    train auc: 0.9260  acc: 0.8243    eval auc: 0.7835  acc: 0.7205    test auc: 0.7823  acc: 0.7164, time: 0.6080
epoch 37    train auc: 0.9267  acc: 0.8269    eval auc: 0.7819  acc: 0.7137    test auc: 0.7811  acc: 0.7093, time: 0.3800
epoch 38    train auc: 0.9273  acc: 0.8262    eval auc: 0.7818  acc: 0.7150    test auc: 0.7805  acc: 0.7105, time: 0.6009
epoch 39    train auc: 0.9277  acc: 0.8276    eval auc: 0.7808  acc: 0.7114    test auc: 0.7798  acc: 0.7078, time: 0.3930
epoch 40    train auc: 0.9282  acc: 0.8274    eval auc: 0.7811  acc: 0.7144    test auc: 0.7798  acc: 0.7109, time: 0.5940
epoch 41    train auc: 0.9287  acc: 0.8277    eval auc: 0.7805  acc: 0.7133    test auc: 0.7790  acc: 0.7078, time: 0.3716
epoch 42    train auc: 0.9291  acc: 0.8282    eval auc: 0.7797  acc: 0.7108    test auc: 0.7785  acc: 0.7075, time: 0.5988
epoch 43    train auc: 0.9297  acc: 0.8287    eval auc: 0.7795  acc: 0.7101    test auc: 0.7779  acc: 0.7063, time: 0.3830
epoch 44    train auc: 0.9300  acc: 0.8285    eval auc: 0.7790  acc: 0.7099    test auc: 0.7776  acc: 0.7070, time: 0.6190
epoch 45    train auc: 0.9303  acc: 0.8279    eval auc: 0.7793  acc: 0.7131    test auc: 0.7773  acc: 0.7075, time: 0.3790
epoch 46    train auc: 0.9307  acc: 0.8284    eval auc: 0.7784  acc: 0.7074    test auc: 0.7771  acc: 0.7068, time: 0.6040
epoch 47    train auc: 0.9311  acc: 0.8286    eval auc: 0.7784  acc: 0.7095    test auc: 0.7766  acc: 0.7062, time: 0.3783
epoch 48    train auc: 0.9314  acc: 0.8304    eval auc: 0.7769  acc: 0.7040    test auc: 0.7758  acc: 0.7037, time: 0.6185
epoch 49    train auc: 0.9319  acc: 0.8301    eval auc: 0.7775  acc: 0.7085    test auc: 0.7758  acc: 0.7052, time: 0.3699
avg time per epoch : 0.49465447902679444
--- 31.25500202178955 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:12:39.808548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:12:39.808875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4807  acc: 0.4987    eval auc: 0.5351  acc: 0.5009    test auc: 0.5226  acc: 0.5029, time: 0.9457
epoch 1    train auc: 0.5203  acc: 0.5040    eval auc: 0.4635  acc: 0.4936    test auc: 0.4757  acc: 0.4944, time: 0.3723
epoch 2    train auc: 0.5241  acc: 0.5137    eval auc: 0.4562  acc: 0.4733    test auc: 0.4723  acc: 0.4855, time: 0.6148
epoch 3    train auc: 0.5621  acc: 0.5393    eval auc: 0.4095  acc: 0.4416    test auc: 0.4062  acc: 0.4405, time: 0.3780
epoch 4    train auc: 0.5798  acc: 0.5556    eval auc: 0.3835  acc: 0.4158    test auc: 0.3808  acc: 0.4174, time: 0.6179
epoch 5    train auc: 0.5859  acc: 0.5598    eval auc: 0.3756  acc: 0.4101    test auc: 0.3724  acc: 0.4106, time: 0.3670
epoch 6    train auc: 0.5905  acc: 0.5622    eval auc: 0.3691  acc: 0.4065    test auc: 0.3661  acc: 0.4069, time: 0.6150
epoch 7    train auc: 0.5924  acc: 0.5637    eval auc: 0.3671  acc: 0.4069    test auc: 0.3634  acc: 0.4019, time: 0.3680
epoch 8    train auc: 0.5937  acc: 0.5650    eval auc: 0.3654  acc: 0.4048    test auc: 0.3617  acc: 0.4002, time: 0.6310
epoch 9    train auc: 0.5946  acc: 0.5655    eval auc: 0.3648  acc: 0.4034    test auc: 0.3603  acc: 0.4002, time: 0.3680
epoch 10    train auc: 0.5952  acc: 0.5663    eval auc: 0.3637  acc: 0.4024    test auc: 0.3600  acc: 0.3987, time: 0.6152
epoch 11    train auc: 0.5956  acc: 0.5663    eval auc: 0.3635  acc: 0.4025    test auc: 0.3593  acc: 0.3986, time: 0.3620
epoch 12    train auc: 0.5959  acc: 0.5666    eval auc: 0.3632  acc: 0.4023    test auc: 0.3589  acc: 0.3980, time: 0.6149
epoch 13    train auc: 0.5962  acc: 0.5666    eval auc: 0.3632  acc: 0.4036    test auc: 0.3584  acc: 0.3967, time: 0.3752
epoch 14    train auc: 0.5963  acc: 0.5669    eval auc: 0.3631  acc: 0.4003    test auc: 0.3584  acc: 0.3991, time: 0.6112
epoch 15    train auc: 0.5965  acc: 0.5668    eval auc: 0.3631  acc: 0.4013    test auc: 0.3579  acc: 0.3984, time: 0.3639
epoch 16    train auc: 0.5966  acc: 0.5669    eval auc: 0.3628  acc: 0.4013    test auc: 0.3581  acc: 0.3980, time: 0.6190
epoch 17    train auc: 0.5967  acc: 0.5669    eval auc: 0.3626  acc: 0.4021    test auc: 0.3580  acc: 0.3973, time: 0.3715
epoch 18    train auc: 0.5968  acc: 0.5669    eval auc: 0.3627  acc: 0.4009    test auc: 0.3581  acc: 0.3985, time: 0.6130
epoch 19    train auc: 0.5968  acc: 0.5668    eval auc: 0.3626  acc: 0.4016    test auc: 0.3579  acc: 0.3979, time: 0.3739
epoch 20    train auc: 0.5969  acc: 0.5669    eval auc: 0.3625  acc: 0.4006    test auc: 0.3580  acc: 0.3987, time: 0.6047
epoch 21    train auc: 0.5970  acc: 0.5669    eval auc: 0.3631  acc: 0.4026    test auc: 0.3575  acc: 0.3967, time: 0.3569
epoch 22    train auc: 0.5970  acc: 0.5669    eval auc: 0.3630  acc: 0.4028    test auc: 0.3575  acc: 0.3966, time: 0.6040
epoch 23    train auc: 0.5970  acc: 0.5669    eval auc: 0.3631  acc: 0.4025    test auc: 0.3574  acc: 0.3969, time: 0.3638
epoch 24    train auc: 0.5970  acc: 0.5669    eval auc: 0.3626  acc: 0.4021    test auc: 0.3579  acc: 0.3973, time: 0.5885
epoch 25    train auc: 0.5971  acc: 0.5669    eval auc: 0.3631  acc: 0.4031    test auc: 0.3573  acc: 0.3963, time: 0.3629
epoch 26    train auc: 0.5971  acc: 0.5669    eval auc: 0.3630  acc: 0.4037    test auc: 0.3574  acc: 0.3957, time: 0.6025
epoch 27    train auc: 0.5971  acc: 0.5669    eval auc: 0.3629  acc: 0.4043    test auc: 0.3575  acc: 0.3951, time: 0.3690
epoch 28    train auc: 0.5971  acc: 0.5669    eval auc: 0.3630  acc: 0.4026    test auc: 0.3576  acc: 0.3967, time: 0.6389
epoch 29    train auc: 0.5971  acc: 0.5669    eval auc: 0.3629  acc: 0.4025    test auc: 0.3576  acc: 0.3969, time: 0.3650
epoch 30    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4036    test auc: 0.3573  acc: 0.3958, time: 0.6056
epoch 31    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4037    test auc: 0.3574  acc: 0.3957, time: 0.3690
epoch 32    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4030    test auc: 0.3573  acc: 0.3964, time: 0.6212
epoch 33    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4026    test auc: 0.3572  acc: 0.3967, time: 0.3788
epoch 34    train auc: 0.5972  acc: 0.5669    eval auc: 0.3630  acc: 0.4024    test auc: 0.3576  acc: 0.3970, time: 0.6040
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3629  acc: 0.4023    test auc: 0.3577  acc: 0.3971, time: 0.3771
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3630  acc: 0.4023    test auc: 0.3576  acc: 0.3971, time: 0.5940
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4012    test auc: 0.3571  acc: 0.3982, time: 0.3745
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4018    test auc: 0.3571  acc: 0.3976, time: 0.5960
epoch 39    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4025    test auc: 0.3570  acc: 0.3969, time: 0.3690
epoch 40    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4005    test auc: 0.3573  acc: 0.3989, time: 0.6090
epoch 41    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4029    test auc: 0.3571  acc: 0.3965, time: 0.3600
epoch 42    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4043    test auc: 0.3572  acc: 0.3951, time: 0.6201
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4023    test auc: 0.3573  acc: 0.3971, time: 0.3790
epoch 44    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4010    test auc: 0.3571  acc: 0.3984, time: 0.6060
epoch 45    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4038    test auc: 0.3573  acc: 0.3956, time: 0.3800
epoch 46    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4032    test auc: 0.3573  acc: 0.3962, time: 0.6300
epoch 47    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4030    test auc: 0.3573  acc: 0.3964, time: 0.3620
epoch 48    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4026    test auc: 0.3572  acc: 0.3967, time: 0.5920
epoch 49    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4006    test auc: 0.3576  acc: 0.3987, time: 0.3620
avg time per epoch : 0.4968525791168213
--- 31.452935218811035 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:13:11.177335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:13:11.177675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5091  acc: 0.5035    eval auc: 0.4889  acc: 0.4986    test auc: 0.4838  acc: 0.4907, time: 0.9054
epoch 1    train auc: 0.5197  acc: 0.5045    eval auc: 0.4697  acc: 0.4929    test auc: 0.4713  acc: 0.4936, time: 0.3470
epoch 2    train auc: 0.5296  acc: 0.5121    eval auc: 0.4567  acc: 0.4822    test auc: 0.4544  acc: 0.4814, time: 0.6110
epoch 3    train auc: 0.5418  acc: 0.5157    eval auc: 0.4395  acc: 0.4748    test auc: 0.4352  acc: 0.4782, time: 0.3690
epoch 4    train auc: 0.5508  acc: 0.5240    eval auc: 0.4255  acc: 0.4637    test auc: 0.4223  acc: 0.4642, time: 0.6209
epoch 5    train auc: 0.5594  acc: 0.5411    eval auc: 0.4150  acc: 0.4396    test auc: 0.4105  acc: 0.4387, time: 0.3740
epoch 6    train auc: 0.5709  acc: 0.5466    eval auc: 0.4007  acc: 0.4305    test auc: 0.3955  acc: 0.4307, time: 0.6030
epoch 7    train auc: 0.5793  acc: 0.5535    eval auc: 0.3904  acc: 0.4241    test auc: 0.3846  acc: 0.4205, time: 0.3790
epoch 8    train auc: 0.5851  acc: 0.5577    eval auc: 0.3841  acc: 0.4214    test auc: 0.3787  acc: 0.4100, time: 0.6049
epoch 9    train auc: 0.5940  acc: 0.5631    eval auc: 0.3850  acc: 0.4188    test auc: 0.3796  acc: 0.4076, time: 0.3699
epoch 10    train auc: 0.6225  acc: 0.5707    eval auc: 0.4067  acc: 0.4294    test auc: 0.4033  acc: 0.4193, time: 0.5880
epoch 11    train auc: 0.7333  acc: 0.6447    eval auc: 0.5431  acc: 0.4998    test auc: 0.5475  acc: 0.4968, time: 0.3665
epoch 12    train auc: 0.7942  acc: 0.7411    eval auc: 0.6515  acc: 0.6034    test auc: 0.6570  acc: 0.6037, time: 0.6000
epoch 13    train auc: 0.8177  acc: 0.7665    eval auc: 0.6802  acc: 0.6640    test auc: 0.6862  acc: 0.6628, time: 0.3660
epoch 14    train auc: 0.8375  acc: 0.7739    eval auc: 0.6992  acc: 0.6880    test auc: 0.7057  acc: 0.6887, time: 0.6024
epoch 15    train auc: 0.8526  acc: 0.7811    eval auc: 0.7141  acc: 0.7003    test auc: 0.7210  acc: 0.7010, time: 0.3970
epoch 16    train auc: 0.8633  acc: 0.7828    eval auc: 0.7252  acc: 0.7091    test auc: 0.7317  acc: 0.7098, time: 0.6239
epoch 17    train auc: 0.8721  acc: 0.7947    eval auc: 0.7317  acc: 0.7001    test auc: 0.7384  acc: 0.6984, time: 0.3750
epoch 18    train auc: 0.8784  acc: 0.7949    eval auc: 0.7381  acc: 0.7066    test auc: 0.7440  acc: 0.7085, time: 0.5830
epoch 19    train auc: 0.8835  acc: 0.7993    eval auc: 0.7417  acc: 0.7050    test auc: 0.7471  acc: 0.7081, time: 0.3850
epoch 20    train auc: 0.8876  acc: 0.7998    eval auc: 0.7454  acc: 0.7082    test auc: 0.7502  acc: 0.7126, time: 0.5961
epoch 21    train auc: 0.8911  acc: 0.8073    eval auc: 0.7454  acc: 0.7027    test auc: 0.7499  acc: 0.7036, time: 0.3611
epoch 22    train auc: 0.8944  acc: 0.8068    eval auc: 0.7496  acc: 0.7074    test auc: 0.7530  acc: 0.7101, time: 0.5810
epoch 23    train auc: 0.8969  acc: 0.8128    eval auc: 0.7495  acc: 0.7029    test auc: 0.7528  acc: 0.7041, time: 0.3581
epoch 24    train auc: 0.8997  acc: 0.8118    eval auc: 0.7526  acc: 0.7063    test auc: 0.7550  acc: 0.7112, time: 0.5953
epoch 25    train auc: 0.9016  acc: 0.8162    eval auc: 0.7536  acc: 0.7034    test auc: 0.7555  acc: 0.7047, time: 0.3580
epoch 26    train auc: 0.9039  acc: 0.8153    eval auc: 0.7559  acc: 0.7067    test auc: 0.7572  acc: 0.7086, time: 0.5750
epoch 27    train auc: 0.9056  acc: 0.8173    eval auc: 0.7562  acc: 0.7048    test auc: 0.7571  acc: 0.7081, time: 0.3530
epoch 28    train auc: 0.9071  acc: 0.8201    eval auc: 0.7568  acc: 0.7045    test auc: 0.7573  acc: 0.7055, time: 0.5936
epoch 29    train auc: 0.9088  acc: 0.8203    eval auc: 0.7582  acc: 0.7050    test auc: 0.7583  acc: 0.7072, time: 0.3649
epoch 30    train auc: 0.9102  acc: 0.8204    eval auc: 0.7590  acc: 0.7045    test auc: 0.7587  acc: 0.7058, time: 0.5979
epoch 31    train auc: 0.9114  acc: 0.8227    eval auc: 0.7577  acc: 0.7032    test auc: 0.7572  acc: 0.7029, time: 0.3515
epoch 32    train auc: 0.9132  acc: 0.8211    eval auc: 0.7620  acc: 0.7075    test auc: 0.7610  acc: 0.7102, time: 0.5977
epoch 33    train auc: 0.9138  acc: 0.8242    eval auc: 0.7594  acc: 0.7054    test auc: 0.7583  acc: 0.7037, time: 0.3600
epoch 34    train auc: 0.9152  acc: 0.8243    eval auc: 0.7615  acc: 0.7066    test auc: 0.7602  acc: 0.7061, time: 0.5840
epoch 35    train auc: 0.9158  acc: 0.8251    eval auc: 0.7601  acc: 0.7020    test auc: 0.7587  acc: 0.7014, time: 0.3480
epoch 36    train auc: 0.9176  acc: 0.8234    eval auc: 0.7651  acc: 0.7087    test auc: 0.7632  acc: 0.7100, time: 0.6130
epoch 37    train auc: 0.9179  acc: 0.8266    eval auc: 0.7611  acc: 0.7003    test auc: 0.7596  acc: 0.7010, time: 0.3490
epoch 38    train auc: 0.9195  acc: 0.8261    eval auc: 0.7645  acc: 0.7061    test auc: 0.7623  acc: 0.7060, time: 0.5889
epoch 39    train auc: 0.9200  acc: 0.8283    eval auc: 0.7620  acc: 0.7004    test auc: 0.7600  acc: 0.7002, time: 0.3520
epoch 40    train auc: 0.9213  acc: 0.8251    eval auc: 0.7664  acc: 0.7055    test auc: 0.7641  acc: 0.7078, time: 0.5792
epoch 41    train auc: 0.9219  acc: 0.8283    eval auc: 0.7638  acc: 0.7019    test auc: 0.7616  acc: 0.7011, time: 0.3532
epoch 42    train auc: 0.9229  acc: 0.8281    eval auc: 0.7656  acc: 0.7040    test auc: 0.7632  acc: 0.7045, time: 0.5801
epoch 43    train auc: 0.9236  acc: 0.8291    eval auc: 0.7646  acc: 0.7019    test auc: 0.7620  acc: 0.7016, time: 0.3442
epoch 44    train auc: 0.9242  acc: 0.8286    eval auc: 0.7664  acc: 0.7045    test auc: 0.7638  acc: 0.7050, time: 0.5650
epoch 45    train auc: 0.9249  acc: 0.8293    eval auc: 0.7661  acc: 0.7035    test auc: 0.7634  acc: 0.7037, time: 0.3503
epoch 46    train auc: 0.9254  acc: 0.8290    eval auc: 0.7672  acc: 0.7042    test auc: 0.7644  acc: 0.7055, time: 0.5540
epoch 47    train auc: 0.9261  acc: 0.8314    eval auc: 0.7660  acc: 0.7015    test auc: 0.7632  acc: 0.7039, time: 0.3380
epoch 48    train auc: 0.9266  acc: 0.8323    eval auc: 0.7649  acc: 0.7000    test auc: 0.7622  acc: 0.7007, time: 0.5610
epoch 49    train auc: 0.9271  acc: 0.8318    eval auc: 0.7655  acc: 0.7004    test auc: 0.7628  acc: 0.7026, time: 0.3471
avg time per epoch : 0.4824104976654053
--- 30.52170419692993 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:13:41.824808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:13:41.825456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4831  acc: 0.4961    eval auc: 0.5275  acc: 0.5050    test auc: 0.5229  acc: 0.5062, time: 1.5300
epoch 1    train auc: 0.4989  acc: 0.5041    eval auc: 0.5418  acc: 0.5081    test auc: 0.5428  acc: 0.5213, time: 1.0690
epoch 2    train auc: 0.8702  acc: 0.7579    eval auc: 0.7811  acc: 0.7322    test auc: 0.7859  acc: 0.7409, time: 1.0600
epoch 3    train auc: 0.8938  acc: 0.7817    eval auc: 0.7948  acc: 0.7519    test auc: 0.7963  acc: 0.7558, time: 1.0470
epoch 4    train auc: 0.9050  acc: 0.7916    eval auc: 0.7983  acc: 0.7507    test auc: 0.7983  acc: 0.7512, time: 1.0410
epoch 5    train auc: 0.9124  acc: 0.7994    eval auc: 0.7965  acc: 0.7454    test auc: 0.7960  acc: 0.7414, time: 1.0480
epoch 6    train auc: 0.9162  acc: 0.8037    eval auc: 0.7947  acc: 0.7392    test auc: 0.7943  acc: 0.7324, time: 1.0380
epoch 7    train auc: 0.9198  acc: 0.8095    eval auc: 0.7923  acc: 0.7301    test auc: 0.7924  acc: 0.7270, time: 1.0670
epoch 8    train auc: 0.9235  acc: 0.8140    eval auc: 0.7885  acc: 0.7250    test auc: 0.7887  acc: 0.7225, time: 1.0150
epoch 9    train auc: 0.9248  acc: 0.8131    eval auc: 0.7883  acc: 0.7275    test auc: 0.7879  acc: 0.7257, time: 1.0240
epoch 10    train auc: 0.9261  acc: 0.8138    eval auc: 0.7868  acc: 0.7256    test auc: 0.7865  acc: 0.7255, time: 1.0400
epoch 11    train auc: 0.9276  acc: 0.8153    eval auc: 0.7855  acc: 0.7257    test auc: 0.7848  acc: 0.7222, time: 1.1060
epoch 12    train auc: 0.9304  acc: 0.8218    eval auc: 0.7809  acc: 0.7150    test auc: 0.7810  acc: 0.7147, time: 0.9670
epoch 13    train auc: 0.9305  acc: 0.8204    eval auc: 0.7817  acc: 0.7179    test auc: 0.7810  acc: 0.7168, time: 0.9620
epoch 14    train auc: 0.9318  acc: 0.8235    eval auc: 0.7776  acc: 0.7089    test auc: 0.7780  acc: 0.7079, time: 0.9840
epoch 15    train auc: 0.9330  acc: 0.8241    eval auc: 0.7780  acc: 0.7139    test auc: 0.7782  acc: 0.7132, time: 0.8980
epoch 16    train auc: 0.9332  acc: 0.8246    eval auc: 0.7759  acc: 0.7080    test auc: 0.7766  acc: 0.7079, time: 0.8930
epoch 17    train auc: 0.9349  acc: 0.8251    eval auc: 0.7748  acc: 0.7070    test auc: 0.7747  acc: 0.7066, time: 0.8930
epoch 18    train auc: 0.9356  acc: 0.8273    eval auc: 0.7734  acc: 0.7055    test auc: 0.7740  acc: 0.7058, time: 0.8790
epoch 19    train auc: 0.9355  acc: 0.8266    eval auc: 0.7737  acc: 0.7065    test auc: 0.7741  acc: 0.7075, time: 0.8720
epoch 20    train auc: 0.9364  acc: 0.8287    eval auc: 0.7709  acc: 0.7041    test auc: 0.7713  acc: 0.7027, time: 0.8740
epoch 21    train auc: 0.9375  acc: 0.8309    eval auc: 0.7701  acc: 0.7017    test auc: 0.7710  acc: 0.7030, time: 0.8690
epoch 22    train auc: 0.9372  acc: 0.8294    eval auc: 0.7706  acc: 0.7033    test auc: 0.7710  acc: 0.7048, time: 0.8670
epoch 23    train auc: 0.9378  acc: 0.8314    eval auc: 0.7682  acc: 0.7002    test auc: 0.7687  acc: 0.6983, time: 0.8760
epoch 24    train auc: 0.9381  acc: 0.8312    eval auc: 0.7684  acc: 0.7007    test auc: 0.7693  acc: 0.7027, time: 0.8650
epoch 25    train auc: 0.9384  acc: 0.8327    eval auc: 0.7661  acc: 0.6983    test auc: 0.7674  acc: 0.6978, time: 0.8830
epoch 26    train auc: 0.9397  acc: 0.8330    eval auc: 0.7660  acc: 0.6990    test auc: 0.7668  acc: 0.6981, time: 0.8870
epoch 27    train auc: 0.9408  acc: 0.8360    eval auc: 0.7641  acc: 0.6959    test auc: 0.7647  acc: 0.6970, time: 0.9000
epoch 28    train auc: 0.9413  acc: 0.8354    eval auc: 0.7635  acc: 0.6957    test auc: 0.7641  acc: 0.6962, time: 0.8720
epoch 29    train auc: 0.9410  acc: 0.8350    eval auc: 0.7645  acc: 0.6968    test auc: 0.7651  acc: 0.6976, time: 0.8880
epoch 30    train auc: 0.9427  acc: 0.8388    eval auc: 0.7626  acc: 0.6935    test auc: 0.7631  acc: 0.6928, time: 0.9320
epoch 31    train auc: 0.9430  acc: 0.8391    eval auc: 0.7616  acc: 0.6922    test auc: 0.7626  acc: 0.6921, time: 0.9300
epoch 32    train auc: 0.9423  acc: 0.8360    eval auc: 0.7618  acc: 0.6952    test auc: 0.7622  acc: 0.6924, time: 1.0160
epoch 33    train auc: 0.9435  acc: 0.8394    eval auc: 0.7609  acc: 0.6909    test auc: 0.7619  acc: 0.6899, time: 1.0550
epoch 34    train auc: 0.9450  acc: 0.8413    eval auc: 0.7587  acc: 0.6896    test auc: 0.7588  acc: 0.6874, time: 1.0310
epoch 35    train auc: 0.9452  acc: 0.8422    eval auc: 0.7600  acc: 0.6905    test auc: 0.7604  acc: 0.6889, time: 1.0060
epoch 36    train auc: 0.9465  acc: 0.8435    eval auc: 0.7583  acc: 0.6871    test auc: 0.7590  acc: 0.6893, time: 1.0130
epoch 37    train auc: 0.9476  acc: 0.8447    eval auc: 0.7575  acc: 0.6877    test auc: 0.7575  acc: 0.6850, time: 1.0280
epoch 38    train auc: 0.9477  acc: 0.8439    eval auc: 0.7587  acc: 0.6874    test auc: 0.7589  acc: 0.6866, time: 1.0470
epoch 39    train auc: 0.9499  acc: 0.8478    eval auc: 0.7561  acc: 0.6874    test auc: 0.7566  acc: 0.6836, time: 1.0240
epoch 40    train auc: 0.9503  acc: 0.8480    eval auc: 0.7557  acc: 0.6852    test auc: 0.7560  acc: 0.6839, time: 1.0180
epoch 41    train auc: 0.9516  acc: 0.8507    eval auc: 0.7553  acc: 0.6849    test auc: 0.7562  acc: 0.6851, time: 1.0290
epoch 42    train auc: 0.9536  acc: 0.8519    eval auc: 0.7548  acc: 0.6854    test auc: 0.7552  acc: 0.6826, time: 1.0350
epoch 43    train auc: 0.9539  acc: 0.8511    eval auc: 0.7537  acc: 0.6847    test auc: 0.7553  acc: 0.6864, time: 1.0280
epoch 44    train auc: 0.9559  acc: 0.8534    eval auc: 0.7539  acc: 0.6852    test auc: 0.7557  acc: 0.6867, time: 1.0390
epoch 45    train auc: 0.9571  acc: 0.8551    eval auc: 0.7521  acc: 0.6851    test auc: 0.7541  acc: 0.6846, time: 1.0600
epoch 46    train auc: 0.9585  acc: 0.8584    eval auc: 0.7508  acc: 0.6824    test auc: 0.7533  acc: 0.6857, time: 1.0780
epoch 47    train auc: 0.9605  acc: 0.8622    eval auc: 0.7492  acc: 0.6824    test auc: 0.7521  acc: 0.6844, time: 1.0530
epoch 48    train auc: 0.9623  acc: 0.8650    eval auc: 0.7488  acc: 0.6813    test auc: 0.7518  acc: 0.6869, time: 1.0410
epoch 49    train auc: 0.9644  acc: 0.8682    eval auc: 0.7458  acc: 0.6784    test auc: 0.7496  acc: 0.6843, time: 1.0160
avg time per epoch : 0.9938606882095337
--- 60.541929721832275 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:14:42.364118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:14:42.364450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5104  acc: 0.5074    eval auc: 0.5062  acc: 0.5027    test auc: 0.5221  acc: 0.5184, time: 1.4300
epoch 1    train auc: 0.5055  acc: 0.5017    eval auc: 0.5095  acc: 0.5070    test auc: 0.5066  acc: 0.5032, time: 1.1090
epoch 2    train auc: 0.5216  acc: 0.5071    eval auc: 0.4855  acc: 0.5053    test auc: 0.4656  acc: 0.4881, time: 1.0910
epoch 3    train auc: 0.5443  acc: 0.5148    eval auc: 0.4381  acc: 0.4839    test auc: 0.4306  acc: 0.4751, time: 1.1240
epoch 4    train auc: 0.5521  acc: 0.5288    eval auc: 0.4415  acc: 0.4664    test auc: 0.4441  acc: 0.4637, time: 1.0760
epoch 5    train auc: 0.5653  acc: 0.5321    eval auc: 0.4131  acc: 0.4546    test auc: 0.4132  acc: 0.4493, time: 1.0920
epoch 6    train auc: 0.5892  acc: 0.5410    eval auc: 0.4152  acc: 0.4454    test auc: 0.4150  acc: 0.4328, time: 1.1160
epoch 7    train auc: 0.6192  acc: 0.5393    eval auc: 0.4378  acc: 0.4502    test auc: 0.4388  acc: 0.4392, time: 1.0920
epoch 8    train auc: 0.7449  acc: 0.6319    eval auc: 0.5875  acc: 0.5864    test auc: 0.5931  acc: 0.5833, time: 1.0720
epoch 9    train auc: 0.8214  acc: 0.7217    eval auc: 0.7028  acc: 0.6889    test auc: 0.7129  acc: 0.7032, time: 1.0680
epoch 10    train auc: 0.8494  acc: 0.7690    eval auc: 0.7549  acc: 0.7122    test auc: 0.7571  acc: 0.7183, time: 1.1110
epoch 11    train auc: 0.8491  acc: 0.6224    eval auc: 0.7724  acc: 0.5415    test auc: 0.7754  acc: 0.5436, time: 1.0630
epoch 12    train auc: 0.8489  acc: 0.5758    eval auc: 0.7747  acc: 0.5241    test auc: 0.7787  acc: 0.5266, time: 1.0830
epoch 13    train auc: 0.8560  acc: 0.5864    eval auc: 0.7767  acc: 0.5286    test auc: 0.7802  acc: 0.5304, time: 1.0710
epoch 14    train auc: 0.8655  acc: 0.6285    eval auc: 0.7799  acc: 0.5492    test auc: 0.7829  acc: 0.5507, time: 1.0660
epoch 15    train auc: 0.8693  acc: 0.6868    eval auc: 0.7815  acc: 0.5845    test auc: 0.7846  acc: 0.5817, time: 1.0570
epoch 16    train auc: 0.8716  acc: 0.7149    eval auc: 0.7828  acc: 0.6050    test auc: 0.7859  acc: 0.6021, time: 1.0741
epoch 17    train auc: 0.8745  acc: 0.7460    eval auc: 0.7843  acc: 0.6355    test auc: 0.7873  acc: 0.6290, time: 1.0690
epoch 18    train auc: 0.8755  acc: 0.7508    eval auc: 0.7846  acc: 0.6409    test auc: 0.7879  acc: 0.6353, time: 1.0820
epoch 19    train auc: 0.8782  acc: 0.7656    eval auc: 0.7860  acc: 0.6592    test auc: 0.7892  acc: 0.6495, time: 1.0710
epoch 20    train auc: 0.8786  acc: 0.7661    eval auc: 0.7861  acc: 0.6595    test auc: 0.7894  acc: 0.6516, time: 1.0700
epoch 21    train auc: 0.8802  acc: 0.7699    eval auc: 0.7867  acc: 0.6663    test auc: 0.7901  acc: 0.6589, time: 1.0860
epoch 22    train auc: 0.8815  acc: 0.7713    eval auc: 0.7871  acc: 0.6688    test auc: 0.7903  acc: 0.6610, time: 1.2585
epoch 23    train auc: 0.8822  acc: 0.7718    eval auc: 0.7873  acc: 0.6688    test auc: 0.7908  acc: 0.6619, time: 1.1450
epoch 24    train auc: 0.8845  acc: 0.7760    eval auc: 0.7883  acc: 0.6749    test auc: 0.7916  acc: 0.6700, time: 1.1200
epoch 25    train auc: 0.8854  acc: 0.7756    eval auc: 0.7886  acc: 0.6749    test auc: 0.7916  acc: 0.6707, time: 1.1330
epoch 26    train auc: 0.8858  acc: 0.7749    eval auc: 0.7886  acc: 0.6754    test auc: 0.7916  acc: 0.6696, time: 1.1150
epoch 27    train auc: 0.8868  acc: 0.7755    eval auc: 0.7889  acc: 0.6762    test auc: 0.7918  acc: 0.6703, time: 1.1260
epoch 28    train auc: 0.8876  acc: 0.7761    eval auc: 0.7892  acc: 0.6784    test auc: 0.7919  acc: 0.6699, time: 1.1200
epoch 29    train auc: 0.8888  acc: 0.7770    eval auc: 0.7895  acc: 0.6795    test auc: 0.7920  acc: 0.6723, time: 1.1500
epoch 30    train auc: 0.8892  acc: 0.7761    eval auc: 0.7895  acc: 0.6787    test auc: 0.7920  acc: 0.6710, time: 1.1080
epoch 31    train auc: 0.8903  acc: 0.7775    eval auc: 0.7897  acc: 0.6801    test auc: 0.7922  acc: 0.6722, time: 1.1180
epoch 32    train auc: 0.8906  acc: 0.7768    eval auc: 0.7896  acc: 0.6791    test auc: 0.7921  acc: 0.6702, time: 1.1220
epoch 33    train auc: 0.8908  acc: 0.7761    eval auc: 0.7895  acc: 0.6781    test auc: 0.7922  acc: 0.6699, time: 1.1550
epoch 34    train auc: 0.8916  acc: 0.7765    eval auc: 0.7898  acc: 0.6784    test auc: 0.7922  acc: 0.6701, time: 1.2490
epoch 35    train auc: 0.8918  acc: 0.7761    eval auc: 0.7896  acc: 0.6761    test auc: 0.7921  acc: 0.6673, time: 1.2360
epoch 36    train auc: 0.8928  acc: 0.7771    eval auc: 0.7899  acc: 0.6781    test auc: 0.7922  acc: 0.6693, time: 1.1450
epoch 37    train auc: 0.8929  acc: 0.7764    eval auc: 0.7897  acc: 0.6766    test auc: 0.7920  acc: 0.6674, time: 1.1310
epoch 38    train auc: 0.8938  acc: 0.7766    eval auc: 0.7898  acc: 0.6766    test auc: 0.7921  acc: 0.6684, time: 1.1430
epoch 39    train auc: 0.8941  acc: 0.7763    eval auc: 0.7897  acc: 0.6740    test auc: 0.7919  acc: 0.6665, time: 1.1240
epoch 40    train auc: 0.8944  acc: 0.7754    eval auc: 0.7896  acc: 0.6738    test auc: 0.7917  acc: 0.6648, time: 1.1460
epoch 41    train auc: 0.8948  acc: 0.7756    eval auc: 0.7896  acc: 0.6734    test auc: 0.7917  acc: 0.6643, time: 1.1120
epoch 42    train auc: 0.8948  acc: 0.7740    eval auc: 0.7893  acc: 0.6684    test auc: 0.7914  acc: 0.6603, time: 1.1170
epoch 43    train auc: 0.8953  acc: 0.7741    eval auc: 0.7892  acc: 0.6688    test auc: 0.7913  acc: 0.6604, time: 1.1100
epoch 44    train auc: 0.8960  acc: 0.7745    eval auc: 0.7892  acc: 0.6682    test auc: 0.7912  acc: 0.6597, time: 1.1480
epoch 45    train auc: 0.8962  acc: 0.7742    eval auc: 0.7891  acc: 0.6665    test auc: 0.7909  acc: 0.6586, time: 1.1310
epoch 46    train auc: 0.8964  acc: 0.7733    eval auc: 0.7890  acc: 0.6640    test auc: 0.7907  acc: 0.6566, time: 1.0920
epoch 47    train auc: 0.8967  acc: 0.7726    eval auc: 0.7888  acc: 0.6628    test auc: 0.7905  acc: 0.6560, time: 1.3920
epoch 48    train auc: 0.8973  acc: 0.7726    eval auc: 0.7888  acc: 0.6632    test auc: 0.7902  acc: 0.6560, time: 1.2270
epoch 49    train auc: 0.8980  acc: 0.7731    eval auc: 0.7887  acc: 0.6635    test auc: 0.7902  acc: 0.6564, time: 1.1280
avg time per epoch : 1.1294893074035643
--- 68.1891725063324 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:15:50.645668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:15:50.646003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4914  acc: 0.4978    eval auc: 0.5203  acc: 0.5069    test auc: 0.5071  acc: 0.4996, time: 1.3310
epoch 1    train auc: 0.4922  acc: 0.4938    eval auc: 0.5063  acc: 0.5058    test auc: 0.5235  acc: 0.5151, time: 1.0080
epoch 2    train auc: 0.8562  acc: 0.7488    eval auc: 0.7679  acc: 0.7241    test auc: 0.7775  acc: 0.7356, time: 0.9950
epoch 3    train auc: 0.8923  acc: 0.7800    eval auc: 0.7958  acc: 0.7516    test auc: 0.7991  acc: 0.7572, time: 1.0420
epoch 4    train auc: 0.9055  acc: 0.7954    eval auc: 0.7966  acc: 0.7480    test auc: 0.7984  acc: 0.7497, time: 0.9910
epoch 5    train auc: 0.9155  acc: 0.8083    eval auc: 0.7904  acc: 0.7300    test auc: 0.7910  acc: 0.7257, time: 0.9920
epoch 6    train auc: 0.9215  acc: 0.8171    eval auc: 0.7869  acc: 0.7198    test auc: 0.7871  acc: 0.7154, time: 0.9930
epoch 7    train auc: 0.9255  acc: 0.8204    eval auc: 0.7836  acc: 0.7160    test auc: 0.7836  acc: 0.7120, time: 0.9810
epoch 8    train auc: 0.9290  acc: 0.8262    eval auc: 0.7767  acc: 0.7065    test auc: 0.7767  acc: 0.7008, time: 0.9860
epoch 9    train auc: 0.9311  acc: 0.8268    eval auc: 0.7768  acc: 0.7055    test auc: 0.7758  acc: 0.7036, time: 1.0670
epoch 10    train auc: 0.9323  acc: 0.8268    eval auc: 0.7773  acc: 0.7073    test auc: 0.7762  acc: 0.7083, time: 1.0670
epoch 11    train auc: 0.9342  acc: 0.8298    eval auc: 0.7748  acc: 0.7028    test auc: 0.7738  acc: 0.7040, time: 1.0450
epoch 12    train auc: 0.9353  acc: 0.8297    eval auc: 0.7726  acc: 0.7017    test auc: 0.7716  acc: 0.7020, time: 1.0340
epoch 13    train auc: 0.9365  acc: 0.8315    eval auc: 0.7727  acc: 0.7021    test auc: 0.7712  acc: 0.7023, time: 1.0310
epoch 14    train auc: 0.9382  acc: 0.8366    eval auc: 0.7685  acc: 0.6972    test auc: 0.7681  acc: 0.6968, time: 1.1820
epoch 15    train auc: 0.9385  acc: 0.8353    eval auc: 0.7692  acc: 0.6987    test auc: 0.7688  acc: 0.6984, time: 1.1920
epoch 16    train auc: 0.9394  acc: 0.8368    eval auc: 0.7666  acc: 0.6971    test auc: 0.7664  acc: 0.6958, time: 1.2160
epoch 17    train auc: 0.9393  acc: 0.8356    eval auc: 0.7664  acc: 0.6968    test auc: 0.7652  acc: 0.6958, time: 1.2050
epoch 18    train auc: 0.9396  acc: 0.8360    eval auc: 0.7678  acc: 0.6994    test auc: 0.7669  acc: 0.6996, time: 1.2070
epoch 19    train auc: 0.9410  acc: 0.8381    eval auc: 0.7654  acc: 0.6977    test auc: 0.7646  acc: 0.6964, time: 1.1790
epoch 20    train auc: 0.9412  acc: 0.8393    eval auc: 0.7611  acc: 0.6912    test auc: 0.7605  acc: 0.6895, time: 1.1770
epoch 21    train auc: 0.9421  acc: 0.8395    eval auc: 0.7627  acc: 0.6943    test auc: 0.7620  acc: 0.6916, time: 1.1950
epoch 22    train auc: 0.9431  acc: 0.8415    eval auc: 0.7621  acc: 0.6926    test auc: 0.7616  acc: 0.6938, time: 1.0480
epoch 23    train auc: 0.9437  acc: 0.8434    eval auc: 0.7604  acc: 0.6918    test auc: 0.7600  acc: 0.6917, time: 1.1800
epoch 24    train auc: 0.9448  acc: 0.8441    eval auc: 0.7583  acc: 0.6889    test auc: 0.7577  acc: 0.6905, time: 1.1610
epoch 25    train auc: 0.9449  acc: 0.8434    eval auc: 0.7589  acc: 0.6896    test auc: 0.7584  acc: 0.6921, time: 1.2000
epoch 26    train auc: 0.9457  acc: 0.8459    eval auc: 0.7570  acc: 0.6882    test auc: 0.7565  acc: 0.6889, time: 1.1310
epoch 27    train auc: 0.9461  acc: 0.8462    eval auc: 0.7570  acc: 0.6886    test auc: 0.7560  acc: 0.6880, time: 1.1350
epoch 28    train auc: 0.9468  acc: 0.8475    eval auc: 0.7554  acc: 0.6856    test auc: 0.7545  acc: 0.6861, time: 1.1050
epoch 29    train auc: 0.9476  acc: 0.8482    eval auc: 0.7548  acc: 0.6860    test auc: 0.7537  acc: 0.6857, time: 1.0850
epoch 30    train auc: 0.9484  acc: 0.8494    eval auc: 0.7540  acc: 0.6828    test auc: 0.7526  acc: 0.6854, time: 1.0960
epoch 31    train auc: 0.9485  acc: 0.8490    eval auc: 0.7536  acc: 0.6856    test auc: 0.7525  acc: 0.6859, time: 1.1130
epoch 32    train auc: 0.9488  acc: 0.8492    eval auc: 0.7535  acc: 0.6850    test auc: 0.7524  acc: 0.6867, time: 1.1040
epoch 33    train auc: 0.9500  acc: 0.8505    eval auc: 0.7519  acc: 0.6845    test auc: 0.7514  acc: 0.6850, time: 1.0400
epoch 34    train auc: 0.9508  acc: 0.8506    eval auc: 0.7500  acc: 0.6820    test auc: 0.7487  acc: 0.6836, time: 1.1200
epoch 35    train auc: 0.9526  acc: 0.8536    eval auc: 0.7493  acc: 0.6800    test auc: 0.7484  acc: 0.6820, time: 1.0980
epoch 36    train auc: 0.9541  acc: 0.8552    eval auc: 0.7483  acc: 0.6808    test auc: 0.7471  acc: 0.6805, time: 1.0250
epoch 37    train auc: 0.9552  acc: 0.8567    eval auc: 0.7469  acc: 0.6798    test auc: 0.7464  acc: 0.6805, time: 1.0320
epoch 38    train auc: 0.9567  acc: 0.8586    eval auc: 0.7478  acc: 0.6812    test auc: 0.7470  acc: 0.6817, time: 1.0310
epoch 39    train auc: 0.9594  acc: 0.8606    eval auc: 0.7433  acc: 0.6758    test auc: 0.7433  acc: 0.6758, time: 1.0940
epoch 40    train auc: 0.9607  acc: 0.8633    eval auc: 0.7440  acc: 0.6795    test auc: 0.7440  acc: 0.6774, time: 1.0670
epoch 41    train auc: 0.9621  acc: 0.8650    eval auc: 0.7458  acc: 0.6812    test auc: 0.7458  acc: 0.6802, time: 1.0400
epoch 42    train auc: 0.9654  acc: 0.8716    eval auc: 0.7409  acc: 0.6749    test auc: 0.7413  acc: 0.6773, time: 1.0430
epoch 43    train auc: 0.9672  acc: 0.8766    eval auc: 0.7407  acc: 0.6740    test auc: 0.7421  acc: 0.6808, time: 0.9110
epoch 44    train auc: 0.9692  acc: 0.8822    eval auc: 0.7389  acc: 0.6738    test auc: 0.7410  acc: 0.6818, time: 0.9859
epoch 45    train auc: 0.9712  acc: 0.8874    eval auc: 0.7381  acc: 0.6755    test auc: 0.7397  acc: 0.6787, time: 1.0035
epoch 46    train auc: 0.9727  acc: 0.8916    eval auc: 0.7376  acc: 0.6761    test auc: 0.7387  acc: 0.6778, time: 0.8900
epoch 47    train auc: 0.9745  acc: 0.8954    eval auc: 0.7371  acc: 0.6762    test auc: 0.7391  acc: 0.6814, time: 1.0710
epoch 48    train auc: 0.9763  acc: 0.9000    eval auc: 0.7360  acc: 0.6774    test auc: 0.7382  acc: 0.6799, time: 1.0770
epoch 49    train auc: 0.9779  acc: 0.9029    eval auc: 0.7343  acc: 0.6779    test auc: 0.7355  acc: 0.6780, time: 0.9360
avg time per epoch : 1.0787691497802734
--- 65.69946789741516 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:16:56.320238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:16:56.320573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5089  acc: 0.5052    eval auc: 0.4922  acc: 0.4936    test auc: 0.4836  acc: 0.4923, time: 1.2990
epoch 1    train auc: 0.5326  acc: 0.5207    eval auc: 0.4605  acc: 0.4701    test auc: 0.4674  acc: 0.4761, time: 0.8896
epoch 2    train auc: 0.5429  acc: 0.5294    eval auc: 0.4472  acc: 0.4658    test auc: 0.4473  acc: 0.4612, time: 0.8829
epoch 3    train auc: 0.5574  acc: 0.5309    eval auc: 0.4164  acc: 0.4581    test auc: 0.4208  acc: 0.4513, time: 0.8726
epoch 4    train auc: 0.5685  acc: 0.5458    eval auc: 0.4041  acc: 0.4383    test auc: 0.4004  acc: 0.4278, time: 0.8840
epoch 5    train auc: 0.5776  acc: 0.5544    eval auc: 0.3936  acc: 0.4261    test auc: 0.3902  acc: 0.4196, time: 0.8580
epoch 6    train auc: 0.5878  acc: 0.5634    eval auc: 0.3927  acc: 0.4248    test auc: 0.3884  acc: 0.4214, time: 0.8481
epoch 7    train auc: 0.6423  acc: 0.6004    eval auc: 0.4411  acc: 0.4554    test auc: 0.4380  acc: 0.4571, time: 0.8430
epoch 8    train auc: 0.7828  acc: 0.7080    eval auc: 0.6251  acc: 0.6064    test auc: 0.6312  acc: 0.6064, time: 0.8569
epoch 9    train auc: 0.8551  acc: 0.7528    eval auc: 0.7157  acc: 0.7021    test auc: 0.7225  acc: 0.7028, time: 0.8519
epoch 10    train auc: 0.8797  acc: 0.7699    eval auc: 0.7508  acc: 0.7245    test auc: 0.7565  acc: 0.7314, time: 0.8369
epoch 11    train auc: 0.8894  acc: 0.7844    eval auc: 0.7651  acc: 0.7348    test auc: 0.7697  acc: 0.7385, time: 0.8490
epoch 12    train auc: 0.8951  acc: 0.7908    eval auc: 0.7709  acc: 0.7381    test auc: 0.7750  acc: 0.7389, time: 0.8348
epoch 13    train auc: 0.8996  acc: 0.7978    eval auc: 0.7745  acc: 0.7333    test auc: 0.7777  acc: 0.7331, time: 0.8741
epoch 14    train auc: 0.9034  acc: 0.8001    eval auc: 0.7764  acc: 0.7320    test auc: 0.7789  acc: 0.7327, time: 0.9135
epoch 15    train auc: 0.9066  acc: 0.8053    eval auc: 0.7779  acc: 0.7285    test auc: 0.7799  acc: 0.7264, time: 0.9579
epoch 16    train auc: 0.9095  acc: 0.8081    eval auc: 0.7789  acc: 0.7244    test auc: 0.7803  acc: 0.7224, time: 0.9400
epoch 17    train auc: 0.9120  acc: 0.8119    eval auc: 0.7797  acc: 0.7215    test auc: 0.7807  acc: 0.7189, time: 0.9439
epoch 18    train auc: 0.9143  acc: 0.8155    eval auc: 0.7799  acc: 0.7184    test auc: 0.7806  acc: 0.7133, time: 0.9179
epoch 19    train auc: 0.9163  acc: 0.8162    eval auc: 0.7797  acc: 0.7173    test auc: 0.7798  acc: 0.7125, time: 0.9329
epoch 20    train auc: 0.9182  acc: 0.8188    eval auc: 0.7793  acc: 0.7138    test auc: 0.7793  acc: 0.7081, time: 0.9230
epoch 21    train auc: 0.9198  acc: 0.8195    eval auc: 0.7794  acc: 0.7134    test auc: 0.7792  acc: 0.7098, time: 1.0330
epoch 22    train auc: 0.9213  acc: 0.8205    eval auc: 0.7791  acc: 0.7132    test auc: 0.7786  acc: 0.7096, time: 1.0330
epoch 23    train auc: 0.9228  acc: 0.8233    eval auc: 0.7778  acc: 0.7073    test auc: 0.7773  acc: 0.7052, time: 0.9710
epoch 24    train auc: 0.9239  acc: 0.8219    eval auc: 0.7784  acc: 0.7118    test auc: 0.7776  acc: 0.7101, time: 1.0560
epoch 25    train auc: 0.9250  acc: 0.8235    eval auc: 0.7781  acc: 0.7099    test auc: 0.7772  acc: 0.7091, time: 1.0250
epoch 26    train auc: 0.9264  acc: 0.8275    eval auc: 0.7761  acc: 0.7050    test auc: 0.7751  acc: 0.7037, time: 1.0120
epoch 27    train auc: 0.9272  acc: 0.8276    eval auc: 0.7762  acc: 0.7053    test auc: 0.7751  acc: 0.7042, time: 1.0656
epoch 28    train auc: 0.9282  acc: 0.8279    eval auc: 0.7756  acc: 0.7069    test auc: 0.7742  acc: 0.7039, time: 1.0570
epoch 29    train auc: 0.9289  acc: 0.8282    eval auc: 0.7760  acc: 0.7076    test auc: 0.7745  acc: 0.7053, time: 0.9860
epoch 30    train auc: 0.9296  acc: 0.8295    eval auc: 0.7757  acc: 0.7061    test auc: 0.7743  acc: 0.7049, time: 0.9567
epoch 31    train auc: 0.9305  acc: 0.8301    eval auc: 0.7745  acc: 0.7046    test auc: 0.7729  acc: 0.7030, time: 1.0430
epoch 32    train auc: 0.9312  acc: 0.8320    eval auc: 0.7739  acc: 0.7045    test auc: 0.7724  acc: 0.7034, time: 1.1340
epoch 33    train auc: 0.9316  acc: 0.8312    eval auc: 0.7747  acc: 0.7052    test auc: 0.7732  acc: 0.7048, time: 0.9540
epoch 34    train auc: 0.9323  acc: 0.8324    eval auc: 0.7738  acc: 0.7041    test auc: 0.7721  acc: 0.7042, time: 0.9130
epoch 35    train auc: 0.9331  acc: 0.8339    eval auc: 0.7726  acc: 0.7004    test auc: 0.7712  acc: 0.7023, time: 0.9530
epoch 36    train auc: 0.9336  acc: 0.8341    eval auc: 0.7726  acc: 0.7009    test auc: 0.7711  acc: 0.7020, time: 1.0180
epoch 37    train auc: 0.9341  acc: 0.8346    eval auc: 0.7723  acc: 0.7007    test auc: 0.7707  acc: 0.7022, time: 1.2190
epoch 38    train auc: 0.9346  acc: 0.8347    eval auc: 0.7714  acc: 0.6988    test auc: 0.7696  acc: 0.7006, time: 1.0000
epoch 39    train auc: 0.9350  acc: 0.8351    eval auc: 0.7713  acc: 0.6995    test auc: 0.7696  acc: 0.7026, time: 1.1280
epoch 40    train auc: 0.9354  acc: 0.8357    eval auc: 0.7710  acc: 0.6993    test auc: 0.7692  acc: 0.7027, time: 1.1050
epoch 41    train auc: 0.9356  acc: 0.8352    eval auc: 0.7720  acc: 0.7022    test auc: 0.7702  acc: 0.7046, time: 1.0810
epoch 42    train auc: 0.9366  acc: 0.8368    eval auc: 0.7689  acc: 0.6965    test auc: 0.7674  acc: 0.6982, time: 1.0820
epoch 43    train auc: 0.9367  acc: 0.8380    eval auc: 0.7697  acc: 0.6967    test auc: 0.7683  acc: 0.6996, time: 1.1490
epoch 44    train auc: 0.9369  acc: 0.8370    eval auc: 0.7703  acc: 0.6994    test auc: 0.7686  acc: 0.7032, time: 1.0030
epoch 45    train auc: 0.9375  acc: 0.8382    eval auc: 0.7689  acc: 0.6969    test auc: 0.7670  acc: 0.7001, time: 0.9314
epoch 46    train auc: 0.9379  acc: 0.8396    eval auc: 0.7688  acc: 0.6988    test auc: 0.7672  acc: 0.7004, time: 0.9970
epoch 47    train auc: 0.9383  acc: 0.8395    eval auc: 0.7684  acc: 0.6985    test auc: 0.7669  acc: 0.6990, time: 0.9363
epoch 48    train auc: 0.9388  acc: 0.8419    eval auc: 0.7673  acc: 0.6972    test auc: 0.7655  acc: 0.6982, time: 1.0930
epoch 49    train auc: 0.9383  acc: 0.8378    eval auc: 0.7694  acc: 0.7007    test auc: 0.7676  acc: 0.7034, time: 0.9430
avg time per epoch : 0.9777633619308471
--- 59.4789936542511 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:17:55.776651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:17:55.776964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4761  acc: 0.4945    eval auc: 0.5398  acc: 0.5083    test auc: 0.5321  acc: 0.5083, time: 1.3453
epoch 1    train auc: 0.5297  acc: 0.5130    eval auc: 0.4549  acc: 0.4783    test auc: 0.4553  acc: 0.4827, time: 1.0630
epoch 2    train auc: 0.5653  acc: 0.5120    eval auc: 0.4015  acc: 0.4828    test auc: 0.4046  acc: 0.4810, time: 0.8590
epoch 3    train auc: 0.5797  acc: 0.5534    eval auc: 0.3843  acc: 0.4209    test auc: 0.3807  acc: 0.4188, time: 0.8919
epoch 4    train auc: 0.5878  acc: 0.5610    eval auc: 0.3732  acc: 0.4083    test auc: 0.3684  acc: 0.4087, time: 0.9239
epoch 5    train auc: 0.5909  acc: 0.5628    eval auc: 0.3691  acc: 0.4065    test auc: 0.3655  acc: 0.4051, time: 0.9360
epoch 6    train auc: 0.5968  acc: 0.5642    eval auc: 0.3672  acc: 0.4037    test auc: 0.3634  acc: 0.4038, time: 1.0180
epoch 7    train auc: 0.6399  acc: 0.5657    eval auc: 0.3964  acc: 0.4133    test auc: 0.3953  acc: 0.4132, time: 1.0071
epoch 8    train auc: 0.7787  acc: 0.7117    eval auc: 0.6697  acc: 0.6194    test auc: 0.6860  acc: 0.6259, time: 1.0900
epoch 9    train auc: 0.8444  acc: 0.7676    eval auc: 0.7530  acc: 0.6902    test auc: 0.7654  acc: 0.6959, time: 1.0446
epoch 10    train auc: 0.8915  acc: 0.7893    eval auc: 0.7712  acc: 0.7073    test auc: 0.7752  acc: 0.7089, time: 0.8550
epoch 11    train auc: 0.9113  acc: 0.8040    eval auc: 0.7751  acc: 0.7133    test auc: 0.7760  acc: 0.7150, time: 0.8530
epoch 12    train auc: 0.9200  acc: 0.8134    eval auc: 0.7669  acc: 0.7028    test auc: 0.7644  acc: 0.7026, time: 0.9489
epoch 13    train auc: 0.9335  acc: 0.8310    eval auc: 0.7691  acc: 0.7101    test auc: 0.7654  acc: 0.7066, time: 0.9930
epoch 14    train auc: 0.9389  acc: 0.8394    eval auc: 0.7565  acc: 0.7007    test auc: 0.7527  acc: 0.6962, time: 1.0470
epoch 15    train auc: 0.9416  acc: 0.8390    eval auc: 0.7614  acc: 0.7045    test auc: 0.7569  acc: 0.6981, time: 0.9576
epoch 16    train auc: 0.9501  acc: 0.8552    eval auc: 0.7584  acc: 0.7013    test auc: 0.7537  acc: 0.6998, time: 0.9815
epoch 17    train auc: 0.9503  acc: 0.8528    eval auc: 0.7541  acc: 0.6978    test auc: 0.7499  acc: 0.6962, time: 0.9100
epoch 18    train auc: 0.9580  acc: 0.8640    eval auc: 0.7491  acc: 0.6988    test auc: 0.7442  acc: 0.6917, time: 0.9268
epoch 19    train auc: 0.9619  acc: 0.8720    eval auc: 0.7455  acc: 0.6961    test auc: 0.7409  acc: 0.6910, time: 0.9604
epoch 20    train auc: 0.9682  acc: 0.8856    eval auc: 0.7432  acc: 0.6974    test auc: 0.7382  acc: 0.6893, time: 1.0050
epoch 21    train auc: 0.9660  acc: 0.8765    eval auc: 0.7443  acc: 0.6947    test auc: 0.7387  acc: 0.6890, time: 1.0670
epoch 22    train auc: 0.9705  acc: 0.8883    eval auc: 0.7417  acc: 0.6928    test auc: 0.7363  acc: 0.6885, time: 0.9870
epoch 23    train auc: 0.9728  acc: 0.8914    eval auc: 0.7344  acc: 0.6850    test auc: 0.7295  acc: 0.6823, time: 0.9649
epoch 24    train auc: 0.9732  acc: 0.8922    eval auc: 0.7390  acc: 0.6902    test auc: 0.7342  acc: 0.6871, time: 1.0680
epoch 25    train auc: 0.9748  acc: 0.8945    eval auc: 0.7329  acc: 0.6832    test auc: 0.7278  acc: 0.6799, time: 0.8880
epoch 26    train auc: 0.9769  acc: 0.9018    eval auc: 0.7303  acc: 0.6833    test auc: 0.7252  acc: 0.6780, time: 0.8700
epoch 27    train auc: 0.9762  acc: 0.9008    eval auc: 0.7325  acc: 0.6852    test auc: 0.7282  acc: 0.6830, time: 0.8810
epoch 28    train auc: 0.9778  acc: 0.9005    eval auc: 0.7247  acc: 0.6788    test auc: 0.7198  acc: 0.6716, time: 0.9030
epoch 29    train auc: 0.9779  acc: 0.9024    eval auc: 0.7278  acc: 0.6800    test auc: 0.7227  acc: 0.6755, time: 0.8569
epoch 30    train auc: 0.9808  acc: 0.9096    eval auc: 0.7267  acc: 0.6793    test auc: 0.7212  acc: 0.6741, time: 0.8445
epoch 31    train auc: 0.9813  acc: 0.9108    eval auc: 0.7269  acc: 0.6800    test auc: 0.7218  acc: 0.6736, time: 0.9220
epoch 32    train auc: 0.9802  acc: 0.9064    eval auc: 0.7238  acc: 0.6782    test auc: 0.7185  acc: 0.6702, time: 0.8690
epoch 33    train auc: 0.9810  acc: 0.9118    eval auc: 0.7278  acc: 0.6794    test auc: 0.7225  acc: 0.6751, time: 0.8280
epoch 34    train auc: 0.9817  acc: 0.9109    eval auc: 0.7226  acc: 0.6771    test auc: 0.7161  acc: 0.6674, time: 0.8430
epoch 35    train auc: 0.9837  acc: 0.9173    eval auc: 0.7177  acc: 0.6714    test auc: 0.7120  acc: 0.6638, time: 0.8320
epoch 36    train auc: 0.9850  acc: 0.9209    eval auc: 0.7197  acc: 0.6726    test auc: 0.7140  acc: 0.6684, time: 0.8752
epoch 37    train auc: 0.9860  acc: 0.9246    eval auc: 0.7172  acc: 0.6721    test auc: 0.7117  acc: 0.6651, time: 0.8360
epoch 38    train auc: 0.9837  acc: 0.9180    eval auc: 0.7236  acc: 0.6752    test auc: 0.7174  acc: 0.6707, time: 0.8160
epoch 39    train auc: 0.9861  acc: 0.9240    eval auc: 0.7180  acc: 0.6734    test auc: 0.7125  acc: 0.6660, time: 0.9960
epoch 40    train auc: 0.9845  acc: 0.9191    eval auc: 0.7203  acc: 0.6733    test auc: 0.7143  acc: 0.6680, time: 0.9660
epoch 41    train auc: 0.9863  acc: 0.9235    eval auc: 0.7192  acc: 0.6742    test auc: 0.7130  acc: 0.6657, time: 0.9290
epoch 42    train auc: 0.9876  acc: 0.9297    eval auc: 0.7186  acc: 0.6736    test auc: 0.7123  acc: 0.6655, time: 0.8500
epoch 43    train auc: 0.9881  acc: 0.9297    eval auc: 0.7186  acc: 0.6735    test auc: 0.7122  acc: 0.6675, time: 0.8392
epoch 44    train auc: 0.9874  acc: 0.9255    eval auc: 0.7146  acc: 0.6708    test auc: 0.7074  acc: 0.6628, time: 0.8370
epoch 45    train auc: 0.9887  acc: 0.9319    eval auc: 0.7175  acc: 0.6727    test auc: 0.7104  acc: 0.6655, time: 0.8160
epoch 46    train auc: 0.9853  acc: 0.9168    eval auc: 0.7135  acc: 0.6686    test auc: 0.7060  acc: 0.6615, time: 0.8140
epoch 47    train auc: 0.9883  acc: 0.9297    eval auc: 0.7107  acc: 0.6661    test auc: 0.7045  acc: 0.6616, time: 0.8386
epoch 48    train auc: 0.9900  acc: 0.9366    eval auc: 0.7150  acc: 0.6680    test auc: 0.7087  acc: 0.6641, time: 0.9699
epoch 49    train auc: 0.9888  acc: 0.9308    eval auc: 0.7131  acc: 0.6658    test auc: 0.7061  acc: 0.6606, time: 0.8620
avg time per epoch : 0.9297242498397827
--- 56.834903717041016 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:18:52.700513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:18:52.700872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5099  acc: 0.5050    eval auc: 0.5121  acc: 0.5093    test auc: 0.5163  acc: 0.5119, time: 1.2410
epoch 1    train auc: 0.5636  acc: 0.5504    eval auc: 0.5427  acc: 0.5329    test auc: 0.5482  acc: 0.5347, time: 0.8940
epoch 2    train auc: 0.4859  acc: 0.5019    eval auc: 0.5243  acc: 0.5018    test auc: 0.5248  acc: 0.5034, time: 0.8899
epoch 3    train auc: 0.5766  acc: 0.5266    eval auc: 0.4547  acc: 0.4857    test auc: 0.4594  acc: 0.4806, time: 0.8180
epoch 4    train auc: 0.6119  acc: 0.5412    eval auc: 0.4549  acc: 0.4896    test auc: 0.4572  acc: 0.4797, time: 0.8570
epoch 5    train auc: 0.7178  acc: 0.6418    eval auc: 0.5621  acc: 0.5585    test auc: 0.5767  acc: 0.5632, time: 0.8310
epoch 6    train auc: 0.7917  acc: 0.7155    eval auc: 0.6567  acc: 0.6068    test auc: 0.6732  acc: 0.6198, time: 0.8229
epoch 7    train auc: 0.8455  acc: 0.7527    eval auc: 0.7126  acc: 0.6869    test auc: 0.7234  acc: 0.6910, time: 0.8360
epoch 8    train auc: 0.8761  acc: 0.7792    eval auc: 0.7501  acc: 0.7137    test auc: 0.7581  acc: 0.7167, time: 0.8370
epoch 9    train auc: 0.8871  acc: 0.7865    eval auc: 0.7657  acc: 0.7254    test auc: 0.7718  acc: 0.7287, time: 0.8360
epoch 10    train auc: 0.8932  acc: 0.7887    eval auc: 0.7747  acc: 0.7315    test auc: 0.7790  acc: 0.7366, time: 0.8189
epoch 11    train auc: 0.8971  acc: 0.7970    eval auc: 0.7808  acc: 0.7337    test auc: 0.7843  acc: 0.7331, time: 0.8256
epoch 12    train auc: 0.8999  acc: 0.8011    eval auc: 0.7834  acc: 0.7339    test auc: 0.7866  acc: 0.7318, time: 0.8329
epoch 13    train auc: 0.9022  acc: 0.8051    eval auc: 0.7857  acc: 0.7300    test auc: 0.7883  acc: 0.7295, time: 0.8720
epoch 14    train auc: 0.9044  acc: 0.8041    eval auc: 0.7869  acc: 0.7331    test auc: 0.7892  acc: 0.7315, time: 0.9896
epoch 15    train auc: 0.9060  acc: 0.8073    eval auc: 0.7879  acc: 0.7302    test auc: 0.7901  acc: 0.7284, time: 0.9690
epoch 16    train auc: 0.9075  acc: 0.8113    eval auc: 0.7888  acc: 0.7272    test auc: 0.7908  acc: 0.7256, time: 1.0119
epoch 17    train auc: 0.9090  acc: 0.8104    eval auc: 0.7895  acc: 0.7289    test auc: 0.7911  acc: 0.7283, time: 1.0990
epoch 18    train auc: 0.9102  acc: 0.8121    eval auc: 0.7899  acc: 0.7291    test auc: 0.7913  acc: 0.7246, time: 1.0180
epoch 19    train auc: 0.9116  acc: 0.8132    eval auc: 0.7900  acc: 0.7279    test auc: 0.7912  acc: 0.7243, time: 1.0720
epoch 20    train auc: 0.9126  acc: 0.8156    eval auc: 0.7899  acc: 0.7219    test auc: 0.7911  acc: 0.7180, time: 0.9730
epoch 21    train auc: 0.9137  acc: 0.8145    eval auc: 0.7902  acc: 0.7259    test auc: 0.7911  acc: 0.7219, time: 0.9693
epoch 22    train auc: 0.9148  acc: 0.8147    eval auc: 0.7901  acc: 0.7259    test auc: 0.7908  acc: 0.7222, time: 1.0080
epoch 23    train auc: 0.9155  acc: 0.8165    eval auc: 0.7894  acc: 0.7172    test auc: 0.7903  acc: 0.7133, time: 0.9530
epoch 24    train auc: 0.9165  acc: 0.8169    eval auc: 0.7895  acc: 0.7200    test auc: 0.7902  acc: 0.7144, time: 0.9340
epoch 25    train auc: 0.9172  acc: 0.8172    eval auc: 0.7893  acc: 0.7179    test auc: 0.7899  acc: 0.7135, time: 0.9530
epoch 26    train auc: 0.9179  acc: 0.8186    eval auc: 0.7887  acc: 0.7115    test auc: 0.7893  acc: 0.7098, time: 0.9210
epoch 27    train auc: 0.9185  acc: 0.8196    eval auc: 0.7882  acc: 0.7111    test auc: 0.7887  acc: 0.7088, time: 0.9329
epoch 28    train auc: 0.9193  acc: 0.8201    eval auc: 0.7879  acc: 0.7102    test auc: 0.7883  acc: 0.7073, time: 0.9070
epoch 29    train auc: 0.9198  acc: 0.8199    eval auc: 0.7877  acc: 0.7114    test auc: 0.7879  acc: 0.7074, time: 0.9510
epoch 30    train auc: 0.9204  acc: 0.8201    eval auc: 0.7876  acc: 0.7121    test auc: 0.7878  acc: 0.7095, time: 0.9449
epoch 31    train auc: 0.9210  acc: 0.8207    eval auc: 0.7868  acc: 0.7093    test auc: 0.7869  acc: 0.7056, time: 0.9440
epoch 32    train auc: 0.9215  acc: 0.8206    eval auc: 0.7863  acc: 0.7083    test auc: 0.7863  acc: 0.7052, time: 0.9349
epoch 33    train auc: 0.9218  acc: 0.8210    eval auc: 0.7863  acc: 0.7102    test auc: 0.7864  acc: 0.7059, time: 0.9259
epoch 34    train auc: 0.9225  acc: 0.8212    eval auc: 0.7860  acc: 0.7112    test auc: 0.7859  acc: 0.7068, time: 0.9430
epoch 35    train auc: 0.9222  acc: 0.8200    eval auc: 0.7848  acc: 0.7056    test auc: 0.7850  acc: 0.7006, time: 0.9450
epoch 36    train auc: 0.9227  acc: 0.8212    eval auc: 0.7848  acc: 0.7061    test auc: 0.7848  acc: 0.7017, time: 0.9659
epoch 37    train auc: 0.9227  acc: 0.8187    eval auc: 0.7839  acc: 0.7027    test auc: 0.7841  acc: 0.6984, time: 0.9140
epoch 38    train auc: 0.9236  acc: 0.8216    eval auc: 0.7839  acc: 0.7053    test auc: 0.7839  acc: 0.7011, time: 0.9069
epoch 39    train auc: 0.9242  acc: 0.8219    eval auc: 0.7838  acc: 0.7058    test auc: 0.7837  acc: 0.7021, time: 0.9519
epoch 40    train auc: 0.9246  acc: 0.8222    eval auc: 0.7837  acc: 0.7059    test auc: 0.7835  acc: 0.7024, time: 0.9110
epoch 41    train auc: 0.9246  acc: 0.8221    eval auc: 0.7837  acc: 0.7059    test auc: 0.7835  acc: 0.7027, time: 0.9570
epoch 42    train auc: 0.9247  acc: 0.8203    eval auc: 0.7824  acc: 0.7041    test auc: 0.7824  acc: 0.6982, time: 0.9765
epoch 43    train auc: 0.9247  acc: 0.8200    eval auc: 0.7826  acc: 0.7045    test auc: 0.7827  acc: 0.6985, time: 0.9619
epoch 44    train auc: 0.9251  acc: 0.8212    eval auc: 0.7823  acc: 0.7049    test auc: 0.7823  acc: 0.6991, time: 0.9149
epoch 45    train auc: 0.9258  acc: 0.8227    eval auc: 0.7824  acc: 0.7054    test auc: 0.7822  acc: 0.7014, time: 0.9449
epoch 46    train auc: 0.9265  acc: 0.8236    eval auc: 0.7824  acc: 0.7062    test auc: 0.7821  acc: 0.7046, time: 0.8910
epoch 47    train auc: 0.9264  acc: 0.8230    eval auc: 0.7823  acc: 0.7067    test auc: 0.7820  acc: 0.7036, time: 0.8709
epoch 48    train auc: 0.9262  acc: 0.8217    eval auc: 0.7813  acc: 0.7048    test auc: 0.7811  acc: 0.6991, time: 0.8769
epoch 49    train auc: 0.9270  acc: 0.8241    eval auc: 0.7817  acc: 0.7061    test auc: 0.7815  acc: 0.7027, time: 0.9210
avg time per epoch : 0.9295314884185791
--- 56.65989565849304 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:19:49.272626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:19:49.272939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5044  acc: 0.5038    eval auc: 0.5018  acc: 0.5017    test auc: 0.4848  acc: 0.4868, time: 1.1674
epoch 1    train auc: 0.4954  acc: 0.4962    eval auc: 0.5094  acc: 0.5099    test auc: 0.5047  acc: 0.5015, time: 0.8680
epoch 2    train auc: 0.5575  acc: 0.5413    eval auc: 0.4177  acc: 0.4422    test auc: 0.4104  acc: 0.4339, time: 0.8719
epoch 3    train auc: 0.5825  acc: 0.5584    eval auc: 0.3836  acc: 0.4167    test auc: 0.3730  acc: 0.4081, time: 0.8522
epoch 4    train auc: 0.5874  acc: 0.5609    eval auc: 0.3754  acc: 0.4110    test auc: 0.3669  acc: 0.4062, time: 0.8599
epoch 5    train auc: 0.5925  acc: 0.5645    eval auc: 0.3688  acc: 0.4050    test auc: 0.3605  acc: 0.4016, time: 0.8500
epoch 6    train auc: 0.5939  acc: 0.5654    eval auc: 0.3665  acc: 0.4057    test auc: 0.3594  acc: 0.3982, time: 0.8420
epoch 7    train auc: 0.5949  acc: 0.5660    eval auc: 0.3653  acc: 0.4039    test auc: 0.3586  acc: 0.3980, time: 0.8550
epoch 8    train auc: 0.5955  acc: 0.5664    eval auc: 0.3642  acc: 0.4015    test auc: 0.3586  acc: 0.3992, time: 0.8920
epoch 9    train auc: 0.5959  acc: 0.5667    eval auc: 0.3640  acc: 0.4011    test auc: 0.3581  acc: 0.3989, time: 0.8622
epoch 10    train auc: 0.5962  acc: 0.5668    eval auc: 0.3636  acc: 0.4015    test auc: 0.3580  acc: 0.3980, time: 0.8719
epoch 11    train auc: 0.5964  acc: 0.5668    eval auc: 0.3634  acc: 0.4013    test auc: 0.3578  acc: 0.3982, time: 0.8402
epoch 12    train auc: 0.5965  acc: 0.5669    eval auc: 0.3635  acc: 0.4006    test auc: 0.3575  acc: 0.3987, time: 0.8285
epoch 13    train auc: 0.5967  acc: 0.5669    eval auc: 0.3637  acc: 0.4026    test auc: 0.3572  acc: 0.3967, time: 0.8389
epoch 14    train auc: 0.5968  acc: 0.5669    eval auc: 0.3634  acc: 0.4024    test auc: 0.3574  acc: 0.3970, time: 0.8530
epoch 15    train auc: 0.5968  acc: 0.5669    eval auc: 0.3633  acc: 0.4041    test auc: 0.3575  acc: 0.3953, time: 0.8410
epoch 16    train auc: 0.5969  acc: 0.5669    eval auc: 0.3632  acc: 0.4019    test auc: 0.3574  acc: 0.3974, time: 0.8563
epoch 17    train auc: 0.5969  acc: 0.5669    eval auc: 0.3631  acc: 0.4036    test auc: 0.3575  acc: 0.3958, time: 0.8019
epoch 18    train auc: 0.5970  acc: 0.5669    eval auc: 0.3632  acc: 0.4024    test auc: 0.3575  acc: 0.3970, time: 0.8232
epoch 19    train auc: 0.5970  acc: 0.5669    eval auc: 0.3634  acc: 0.4041    test auc: 0.3572  acc: 0.3953, time: 0.8239
epoch 20    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4037    test auc: 0.3573  acc: 0.3957, time: 0.8370
epoch 21    train auc: 0.5971  acc: 0.5669    eval auc: 0.3634  acc: 0.4049    test auc: 0.3572  acc: 0.3945, time: 0.8089
epoch 22    train auc: 0.5971  acc: 0.5669    eval auc: 0.3630  acc: 0.4025    test auc: 0.3576  acc: 0.3969, time: 0.8086
epoch 23    train auc: 0.5971  acc: 0.5669    eval auc: 0.3630  acc: 0.4026    test auc: 0.3577  acc: 0.3967, time: 0.8049
epoch 24    train auc: 0.5971  acc: 0.5669    eval auc: 0.3629  acc: 0.4022    test auc: 0.3576  acc: 0.3972, time: 0.8280
epoch 25    train auc: 0.5971  acc: 0.5669    eval auc: 0.3629  acc: 0.4015    test auc: 0.3577  acc: 0.3979, time: 0.8180
epoch 26    train auc: 0.5972  acc: 0.5669    eval auc: 0.3628  acc: 0.4021    test auc: 0.3577  acc: 0.3973, time: 0.8328
epoch 27    train auc: 0.5972  acc: 0.5669    eval auc: 0.3626  acc: 0.4013    test auc: 0.3579  acc: 0.3980, time: 0.8060
epoch 28    train auc: 0.5972  acc: 0.5669    eval auc: 0.3625  acc: 0.4010    test auc: 0.3580  acc: 0.3984, time: 0.8449
epoch 29    train auc: 0.5972  acc: 0.5669    eval auc: 0.3626  acc: 0.3999    test auc: 0.3580  acc: 0.3995, time: 0.8390
epoch 30    train auc: 0.5972  acc: 0.5669    eval auc: 0.3625  acc: 0.3999    test auc: 0.3581  acc: 0.3995, time: 0.8115
epoch 31    train auc: 0.5972  acc: 0.5669    eval auc: 0.3625  acc: 0.4019    test auc: 0.3581  acc: 0.3974, time: 0.7870
epoch 32    train auc: 0.5972  acc: 0.5669    eval auc: 0.3621  acc: 0.3989    test auc: 0.3584  acc: 0.4005, time: 0.8162
epoch 33    train auc: 0.5972  acc: 0.5669    eval auc: 0.3626  acc: 0.3996    test auc: 0.3581  acc: 0.3998, time: 0.7840
epoch 34    train auc: 0.5972  acc: 0.5669    eval auc: 0.3626  acc: 0.4016    test auc: 0.3580  acc: 0.3978, time: 0.7770
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3623  acc: 0.3974    test auc: 0.3583  acc: 0.4019, time: 0.7877
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3625  acc: 0.4002    test auc: 0.3581  acc: 0.3992, time: 0.8070
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3623  acc: 0.3991    test auc: 0.3582  acc: 0.4003, time: 0.7929
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3623  acc: 0.3977    test auc: 0.3584  acc: 0.4017, time: 0.8092
epoch 39    train auc: 0.5972  acc: 0.5669    eval auc: 0.3622  acc: 0.3989    test auc: 0.3584  acc: 0.4005, time: 0.8070
epoch 40    train auc: 0.5972  acc: 0.5669    eval auc: 0.3622  acc: 0.4002    test auc: 0.3584  acc: 0.3992, time: 0.8455
epoch 41    train auc: 0.5972  acc: 0.5669    eval auc: 0.3623  acc: 0.3991    test auc: 0.3582  acc: 0.4003, time: 0.8540
epoch 42    train auc: 0.5972  acc: 0.5669    eval auc: 0.3622  acc: 0.3984    test auc: 0.3584  acc: 0.4010, time: 0.8320
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3625  acc: 0.3977    test auc: 0.3581  acc: 0.4017, time: 0.8630
epoch 44    train auc: 0.5972  acc: 0.5669    eval auc: 0.3624  acc: 0.3993    test auc: 0.3582  acc: 0.4000, time: 0.8280
epoch 45    train auc: 0.5972  acc: 0.5669    eval auc: 0.3626  acc: 0.3997    test auc: 0.3580  acc: 0.3997, time: 0.8460
epoch 46    train auc: 0.5973  acc: 0.5669    eval auc: 0.3628  acc: 0.4024    test auc: 0.3578  acc: 0.3970, time: 0.8230
epoch 47    train auc: 0.5973  acc: 0.5669    eval auc: 0.3628  acc: 0.4006    test auc: 0.3578  acc: 0.3987, time: 0.8140
epoch 48    train auc: 0.5973  acc: 0.5669    eval auc: 0.3628  acc: 0.3995    test auc: 0.3578  acc: 0.3999, time: 0.8531
epoch 49    train auc: 0.5973  acc: 0.5669    eval auc: 0.3626  acc: 0.4000    test auc: 0.3581  acc: 0.3993, time: 0.8064
avg time per epoch : 0.8374381637573243
--- 51.02315163612366 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:20:40.395678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:20:40.396031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5287  acc: 0.5208    eval auc: 0.4823  acc: 0.4904    test auc: 0.4838  acc: 0.4904, time: 1.2350
epoch 1    train auc: 0.5594  acc: 0.5280    eval auc: 0.4882  acc: 0.4904    test auc: 0.4876  acc: 0.4930, time: 0.9249
epoch 2    train auc: 0.6852  acc: 0.5282    eval auc: 0.5993  acc: 0.5032    test auc: 0.6049  acc: 0.5100, time: 1.0120
epoch 3    train auc: 0.8034  acc: 0.6478    eval auc: 0.7025  acc: 0.6305    test auc: 0.7166  acc: 0.6410, time: 0.9970
epoch 4    train auc: 0.8520  acc: 0.7125    eval auc: 0.7386  acc: 0.6930    test auc: 0.7493  acc: 0.7029, time: 0.9311
epoch 5    train auc: 0.8763  acc: 0.7218    eval auc: 0.7692  acc: 0.7007    test auc: 0.7768  acc: 0.7099, time: 0.9570
epoch 6    train auc: 0.8872  acc: 0.7459    eval auc: 0.7803  acc: 0.7178    test auc: 0.7851  acc: 0.7279, time: 0.9750
epoch 7    train auc: 0.8930  acc: 0.7600    eval auc: 0.7836  acc: 0.7298    test auc: 0.7873  acc: 0.7379, time: 0.9414
epoch 8    train auc: 0.8979  acc: 0.7896    eval auc: 0.7803  acc: 0.7376    test auc: 0.7842  acc: 0.7422, time: 0.9339
epoch 9    train auc: 0.9020  acc: 0.7933    eval auc: 0.7806  acc: 0.7335    test auc: 0.7835  acc: 0.7366, time: 0.9310
epoch 10    train auc: 0.9054  acc: 0.7970    eval auc: 0.7807  acc: 0.7292    test auc: 0.7827  acc: 0.7329, time: 0.9274
epoch 11    train auc: 0.9090  acc: 0.8061    eval auc: 0.7803  acc: 0.7249    test auc: 0.7819  acc: 0.7268, time: 0.9359
epoch 12    train auc: 0.9114  acc: 0.8045    eval auc: 0.7808  acc: 0.7243    test auc: 0.7815  acc: 0.7254, time: 0.8997
epoch 13    train auc: 0.9147  acc: 0.8128    eval auc: 0.7797  acc: 0.7205    test auc: 0.7804  acc: 0.7186, time: 0.9090
epoch 14    train auc: 0.9169  acc: 0.8139    eval auc: 0.7797  acc: 0.7191    test auc: 0.7799  acc: 0.7190, time: 0.9080
epoch 15    train auc: 0.9190  acc: 0.8190    eval auc: 0.7788  acc: 0.7167    test auc: 0.7790  acc: 0.7139, time: 0.9350
epoch 16    train auc: 0.9206  acc: 0.8182    eval auc: 0.7790  acc: 0.7156    test auc: 0.7787  acc: 0.7157, time: 0.9134
epoch 17    train auc: 0.9221  acc: 0.8195    eval auc: 0.7789  acc: 0.7147    test auc: 0.7783  acc: 0.7147, time: 0.9271
epoch 18    train auc: 0.9233  acc: 0.8204    eval auc: 0.7783  acc: 0.7135    test auc: 0.7775  acc: 0.7137, time: 0.9690
epoch 19    train auc: 0.9248  acc: 0.8257    eval auc: 0.7766  acc: 0.7106    test auc: 0.7758  acc: 0.7063, time: 1.0010
epoch 20    train auc: 0.9259  acc: 0.8275    eval auc: 0.7753  acc: 0.7074    test auc: 0.7744  acc: 0.7039, time: 0.9040
epoch 21    train auc: 0.9267  acc: 0.8249    eval auc: 0.7768  acc: 0.7126    test auc: 0.7755  acc: 0.7096, time: 0.8800
epoch 22    train auc: 0.9276  acc: 0.8258    eval auc: 0.7760  acc: 0.7112    test auc: 0.7744  acc: 0.7081, time: 0.9520
epoch 23    train auc: 0.9287  acc: 0.8294    eval auc: 0.7741  acc: 0.7065    test auc: 0.7729  acc: 0.7054, time: 0.8900
epoch 24    train auc: 0.9293  acc: 0.8288    eval auc: 0.7746  acc: 0.7078    test auc: 0.7729  acc: 0.7055, time: 0.9248
epoch 25    train auc: 0.9301  acc: 0.8299    eval auc: 0.7740  acc: 0.7079    test auc: 0.7726  acc: 0.7055, time: 0.9229
epoch 26    train auc: 0.9309  acc: 0.8317    eval auc: 0.7726  acc: 0.7034    test auc: 0.7711  acc: 0.7026, time: 1.0302
epoch 27    train auc: 0.9314  acc: 0.8313    eval auc: 0.7726  acc: 0.7055    test auc: 0.7710  acc: 0.7040, time: 1.3780
epoch 28    train auc: 0.9321  acc: 0.8328    eval auc: 0.7717  acc: 0.7049    test auc: 0.7701  acc: 0.7020, time: 1.0930
epoch 29    train auc: 0.9327  acc: 0.8336    eval auc: 0.7713  acc: 0.7034    test auc: 0.7698  acc: 0.7017, time: 1.0400
epoch 30    train auc: 0.9329  acc: 0.8320    eval auc: 0.7719  acc: 0.7050    test auc: 0.7703  acc: 0.7032, time: 0.9790
epoch 31    train auc: 0.9338  acc: 0.8351    eval auc: 0.7701  acc: 0.7016    test auc: 0.7687  acc: 0.7006, time: 0.8999
epoch 32    train auc: 0.9343  acc: 0.8355    eval auc: 0.7695  acc: 0.7000    test auc: 0.7682  acc: 0.6991, time: 0.8850
epoch 33    train auc: 0.9346  acc: 0.8352    eval auc: 0.7697  acc: 0.7006    test auc: 0.7685  acc: 0.7001, time: 0.8860
epoch 34    train auc: 0.9348  acc: 0.8342    eval auc: 0.7696  acc: 0.7016    test auc: 0.7681  acc: 0.7017, time: 0.8950
epoch 35    train auc: 0.9357  acc: 0.8375    eval auc: 0.7674  acc: 0.6949    test auc: 0.7666  acc: 0.6949, time: 0.8890
epoch 36    train auc: 0.9361  acc: 0.8372    eval auc: 0.7674  acc: 0.6949    test auc: 0.7666  acc: 0.6944, time: 0.9437
epoch 37    train auc: 0.9365  acc: 0.8383    eval auc: 0.7661  acc: 0.6942    test auc: 0.7655  acc: 0.6932, time: 0.9750
epoch 38    train auc: 0.9369  acc: 0.8384    eval auc: 0.7672  acc: 0.6985    test auc: 0.7661  acc: 0.6978, time: 1.0630
epoch 39    train auc: 0.9369  acc: 0.8381    eval auc: 0.7670  acc: 0.6983    test auc: 0.7659  acc: 0.6990, time: 0.9790
epoch 40    train auc: 0.9377  acc: 0.8391    eval auc: 0.7658  acc: 0.6968    test auc: 0.7649  acc: 0.6957, time: 0.9310
epoch 41    train auc: 0.9380  acc: 0.8395    eval auc: 0.7659  acc: 0.6963    test auc: 0.7651  acc: 0.6955, time: 0.9490
epoch 42    train auc: 0.9384  acc: 0.8412    eval auc: 0.7639  acc: 0.6928    test auc: 0.7635  acc: 0.6913, time: 0.8440
epoch 43    train auc: 0.9384  acc: 0.8399    eval auc: 0.7658  acc: 0.6964    test auc: 0.7649  acc: 0.6980, time: 0.8209
epoch 44    train auc: 0.9391  acc: 0.8419    eval auc: 0.7642  acc: 0.6942    test auc: 0.7637  acc: 0.6939, time: 0.8580
epoch 45    train auc: 0.9393  acc: 0.8407    eval auc: 0.7641  acc: 0.6949    test auc: 0.7634  acc: 0.6948, time: 0.8300
epoch 46    train auc: 0.9389  acc: 0.8394    eval auc: 0.7645  acc: 0.6942    test auc: 0.7635  acc: 0.6983, time: 0.8209
epoch 47    train auc: 0.9396  acc: 0.8411    eval auc: 0.7642  acc: 0.6955    test auc: 0.7634  acc: 0.6965, time: 0.8400
epoch 48    train auc: 0.9402  acc: 0.8430    eval auc: 0.7624  acc: 0.6932    test auc: 0.7619  acc: 0.6928, time: 0.8300
epoch 49    train auc: 0.9401  acc: 0.8415    eval auc: 0.7632  acc: 0.6952    test auc: 0.7626  acc: 0.6948, time: 0.8729
avg time per epoch : 0.9433965921401978
--- 57.758742332458496 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:21:38.260204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:21:38.260517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4871  acc: 0.4952    eval auc: 0.5281  acc: 0.5042    test auc: 0.5209  acc: 0.5113, time: 1.1894
epoch 1    train auc: 0.8020  acc: 0.6454    eval auc: 0.7038  acc: 0.6291    test auc: 0.7189  acc: 0.6448, time: 0.5430
epoch 2    train auc: 0.8873  acc: 0.7859    eval auc: 0.7900  acc: 0.7526    test auc: 0.7955  acc: 0.7540, time: 0.9480
epoch 3    train auc: 0.9027  acc: 0.8042    eval auc: 0.7924  acc: 0.7374    test auc: 0.7947  acc: 0.7357, time: 0.5940
epoch 4    train auc: 0.9098  acc: 0.8060    eval auc: 0.7943  acc: 0.7373    test auc: 0.7955  acc: 0.7322, time: 0.9022
epoch 5    train auc: 0.9172  acc: 0.8162    eval auc: 0.7889  acc: 0.7203    test auc: 0.7891  acc: 0.7124, time: 0.5589
epoch 6    train auc: 0.9195  acc: 0.8128    eval auc: 0.7892  acc: 0.7279    test auc: 0.7889  acc: 0.7187, time: 0.8890
epoch 7    train auc: 0.9255  acc: 0.8221    eval auc: 0.7815  acc: 0.7098    test auc: 0.7799  acc: 0.7033, time: 0.5020
epoch 8    train auc: 0.9257  acc: 0.8181    eval auc: 0.7851  acc: 0.7209    test auc: 0.7834  acc: 0.7153, time: 0.8699
epoch 9    train auc: 0.9306  acc: 0.8290    eval auc: 0.7767  acc: 0.7027    test auc: 0.7747  acc: 0.6959, time: 0.5250
epoch 10    train auc: 0.9286  acc: 0.8227    eval auc: 0.7822  acc: 0.7152    test auc: 0.7803  acc: 0.7078, time: 0.8749
epoch 11    train auc: 0.9315  acc: 0.8240    eval auc: 0.7800  acc: 0.7118    test auc: 0.7768  acc: 0.7056, time: 0.5200
epoch 12    train auc: 0.9290  acc: 0.8194    eval auc: 0.7831  acc: 0.7178    test auc: 0.7808  acc: 0.7107, time: 0.8510
epoch 13    train auc: 0.9357  acc: 0.8332    eval auc: 0.7714  acc: 0.6980    test auc: 0.7695  acc: 0.6931, time: 0.5390
epoch 14    train auc: 0.9327  acc: 0.8260    eval auc: 0.7776  acc: 0.7081    test auc: 0.7762  acc: 0.7053, time: 0.8319
epoch 15    train auc: 0.9378  acc: 0.8379    eval auc: 0.7658  acc: 0.6923    test auc: 0.7638  acc: 0.6874, time: 0.5210
epoch 16    train auc: 0.9364  acc: 0.8321    eval auc: 0.7743  acc: 0.7063    test auc: 0.7725  acc: 0.7013, time: 0.8695
epoch 17    train auc: 0.9395  acc: 0.8406    eval auc: 0.7641  acc: 0.6884    test auc: 0.7632  acc: 0.6863, time: 0.5790
epoch 18    train auc: 0.9356  acc: 0.8305    eval auc: 0.7733  acc: 0.7033    test auc: 0.7721  acc: 0.6990, time: 0.9080
epoch 19    train auc: 0.9404  acc: 0.8398    eval auc: 0.7659  acc: 0.6949    test auc: 0.7652  acc: 0.6923, time: 0.5590
epoch 20    train auc: 0.9394  acc: 0.8371    eval auc: 0.7682  acc: 0.6988    test auc: 0.7674  acc: 0.6957, time: 1.0120
epoch 21    train auc: 0.9421  acc: 0.8425    eval auc: 0.7631  acc: 0.6910    test auc: 0.7617  acc: 0.6889, time: 0.6204
epoch 22    train auc: 0.9394  acc: 0.8362    eval auc: 0.7679  acc: 0.6977    test auc: 0.7670  acc: 0.6945, time: 1.0970
epoch 23    train auc: 0.9419  acc: 0.8396    eval auc: 0.7658  acc: 0.6968    test auc: 0.7644  acc: 0.6930, time: 0.6660
epoch 24    train auc: 0.9408  acc: 0.8386    eval auc: 0.7652  acc: 0.6962    test auc: 0.7649  acc: 0.6934, time: 1.0020
epoch 25    train auc: 0.9443  acc: 0.8440    eval auc: 0.7602  acc: 0.6911    test auc: 0.7598  acc: 0.6886, time: 0.5480
epoch 26    train auc: 0.9412  acc: 0.8375    eval auc: 0.7652  acc: 0.6965    test auc: 0.7650  acc: 0.6944, time: 0.9310
epoch 27    train auc: 0.9455  acc: 0.8456    eval auc: 0.7596  acc: 0.6905    test auc: 0.7591  acc: 0.6879, time: 0.5970
epoch 28    train auc: 0.9410  acc: 0.8365    eval auc: 0.7640  acc: 0.6971    test auc: 0.7641  acc: 0.6949, time: 1.0490
epoch 29    train auc: 0.9477  acc: 0.8490    eval auc: 0.7564  acc: 0.6854    test auc: 0.7565  acc: 0.6867, time: 0.7070
epoch 30    train auc: 0.9447  acc: 0.8417    eval auc: 0.7628  acc: 0.6961    test auc: 0.7628  acc: 0.6930, time: 0.9206
epoch 31    train auc: 0.9506  acc: 0.8523    eval auc: 0.7544  acc: 0.6839    test auc: 0.7556  acc: 0.6870, time: 0.5580
epoch 32    train auc: 0.9474  acc: 0.8444    eval auc: 0.7605  acc: 0.6951    test auc: 0.7611  acc: 0.6932, time: 0.9079
epoch 33    train auc: 0.9548  acc: 0.8562    eval auc: 0.7510  acc: 0.6827    test auc: 0.7514  acc: 0.6844, time: 0.5570
epoch 34    train auc: 0.9526  acc: 0.8510    eval auc: 0.7553  acc: 0.6923    test auc: 0.7557  acc: 0.6910, time: 0.9270
epoch 35    train auc: 0.9586  acc: 0.8600    eval auc: 0.7479  acc: 0.6814    test auc: 0.7479  acc: 0.6818, time: 0.5699
epoch 36    train auc: 0.9563  acc: 0.8551    eval auc: 0.7523  acc: 0.6913    test auc: 0.7524  acc: 0.6898, time: 1.0450
epoch 37    train auc: 0.9615  acc: 0.8635    eval auc: 0.7475  acc: 0.6833    test auc: 0.7469  acc: 0.6860, time: 0.6270
epoch 38    train auc: 0.9619  acc: 0.8639    eval auc: 0.7473  acc: 0.6890    test auc: 0.7474  acc: 0.6898, time: 0.9600
epoch 39    train auc: 0.9652  acc: 0.8698    eval auc: 0.7434  acc: 0.6836    test auc: 0.7436  acc: 0.6863, time: 0.6159
epoch 40    train auc: 0.9653  acc: 0.8729    eval auc: 0.7457  acc: 0.6903    test auc: 0.7461  acc: 0.6908, time: 1.0620
epoch 41    train auc: 0.9682  acc: 0.8765    eval auc: 0.7420  acc: 0.6851    test auc: 0.7422  acc: 0.6858, time: 0.6329
epoch 42    train auc: 0.9690  acc: 0.8832    eval auc: 0.7437  acc: 0.6903    test auc: 0.7435  acc: 0.6925, time: 1.0470
epoch 43    train auc: 0.9708  acc: 0.8835    eval auc: 0.7469  acc: 0.6918    test auc: 0.7465  acc: 0.6924, time: 0.6010
epoch 44    train auc: 0.9718  acc: 0.8888    eval auc: 0.7418  acc: 0.6910    test auc: 0.7422  acc: 0.6942, time: 0.9550
epoch 45    train auc: 0.9745  acc: 0.8912    eval auc: 0.7415  acc: 0.6878    test auc: 0.7413  acc: 0.6903, time: 0.6160
epoch 46    train auc: 0.9741  acc: 0.8932    eval auc: 0.7389  acc: 0.6880    test auc: 0.7400  acc: 0.6949, time: 0.9400
epoch 47    train auc: 0.9759  acc: 0.8959    eval auc: 0.7410  acc: 0.6871    test auc: 0.7403  acc: 0.6916, time: 0.6049
epoch 48    train auc: 0.9762  acc: 0.8961    eval auc: 0.7377  acc: 0.6878    test auc: 0.7387  acc: 0.6915, time: 1.0119
epoch 49    train auc: 0.9786  acc: 0.9000    eval auc: 0.7367  acc: 0.6814    test auc: 0.7363  acc: 0.6882, time: 0.6439
avg time per epoch : 0.7721334838867188
--- 49.13486289978027 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:22:27.661174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:22:27.661586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5137  acc: 0.5113    eval auc: 0.5073  acc: 0.5021    test auc: 0.5203  acc: 0.5132, time: 1.3029
epoch 1    train auc: 0.5145  acc: 0.5067    eval auc: 0.4871  acc: 0.4965    test auc: 0.4695  acc: 0.4835, time: 0.5639
epoch 2    train auc: 0.5222  acc: 0.5090    eval auc: 0.4808  acc: 0.4951    test auc: 0.4730  acc: 0.4890, time: 0.9879
epoch 3    train auc: 0.5472  acc: 0.5085    eval auc: 0.4283  acc: 0.4907    test auc: 0.4344  acc: 0.4833, time: 0.6480
epoch 4    train auc: 0.5667  acc: 0.5219    eval auc: 0.4116  acc: 0.4701    test auc: 0.4165  acc: 0.4648, time: 1.0160
epoch 5    train auc: 0.5685  acc: 0.5237    eval auc: 0.4024  acc: 0.4670    test auc: 0.4055  acc: 0.4616, time: 0.5580
epoch 6    train auc: 0.5853  acc: 0.5459    eval auc: 0.4003  acc: 0.4324    test auc: 0.4020  acc: 0.4286, time: 0.9040
epoch 7    train auc: 0.5889  acc: 0.5474    eval auc: 0.3962  acc: 0.4315    test auc: 0.3969  acc: 0.4270, time: 0.5409
epoch 8    train auc: 0.6546  acc: 0.5892    eval auc: 0.4610  acc: 0.4674    test auc: 0.4657  acc: 0.4705, time: 0.9140
epoch 9    train auc: 0.7721  acc: 0.6771    eval auc: 0.6174  acc: 0.6121    test auc: 0.6278  acc: 0.6186, time: 0.5410
epoch 10    train auc: 0.8598  acc: 0.7764    eval auc: 0.7446  acc: 0.6902    test auc: 0.7512  acc: 0.6922, time: 0.9069
epoch 11    train auc: 0.8713  acc: 0.7662    eval auc: 0.7524  acc: 0.7257    test auc: 0.7566  acc: 0.7314, time: 0.6150
epoch 12    train auc: 0.8825  acc: 0.7926    eval auc: 0.7770  acc: 0.7026    test auc: 0.7790  acc: 0.6957, time: 0.9289
epoch 13    train auc: 0.8882  acc: 0.7867    eval auc: 0.7750  acc: 0.7328    test auc: 0.7763  acc: 0.7359, time: 0.5666
epoch 14    train auc: 0.8906  acc: 0.7965    eval auc: 0.7850  acc: 0.7014    test auc: 0.7861  acc: 0.6928, time: 0.8980
epoch 15    train auc: 0.8956  acc: 0.7936    eval auc: 0.7835  acc: 0.7336    test auc: 0.7833  acc: 0.7336, time: 0.5560
epoch 16    train auc: 0.8966  acc: 0.8010    eval auc: 0.7892  acc: 0.7060    test auc: 0.7895  acc: 0.6998, time: 0.9340
epoch 17    train auc: 0.9009  acc: 0.8030    eval auc: 0.7888  acc: 0.7329    test auc: 0.7880  acc: 0.7254, time: 0.5470
epoch 18    train auc: 0.9007  acc: 0.8020    eval auc: 0.7915  acc: 0.7046    test auc: 0.7916  acc: 0.6957, time: 0.8690
epoch 19    train auc: 0.9047  acc: 0.8050    eval auc: 0.7910  acc: 0.7331    test auc: 0.7897  acc: 0.7249, time: 0.5684
epoch 20    train auc: 0.9041  acc: 0.8023    eval auc: 0.7923  acc: 0.7035    test auc: 0.7924  acc: 0.6941, time: 0.9220
epoch 21    train auc: 0.9080  acc: 0.8086    eval auc: 0.7924  acc: 0.7315    test auc: 0.7909  acc: 0.7230, time: 0.5327
epoch 22    train auc: 0.9072  acc: 0.8053    eval auc: 0.7924  acc: 0.7034    test auc: 0.7923  acc: 0.6948, time: 0.8810
epoch 23    train auc: 0.9110  acc: 0.8107    eval auc: 0.7925  acc: 0.7284    test auc: 0.7908  acc: 0.7212, time: 0.5330
epoch 24    train auc: 0.9093  acc: 0.8042    eval auc: 0.7914  acc: 0.6963    test auc: 0.7915  acc: 0.6866, time: 0.8992
epoch 25    train auc: 0.9136  acc: 0.8129    eval auc: 0.7921  acc: 0.7279    test auc: 0.7902  acc: 0.7187, time: 0.5280
epoch 26    train auc: 0.9116  acc: 0.8046    eval auc: 0.7901  acc: 0.6932    test auc: 0.7904  acc: 0.6840, time: 0.8770
epoch 27    train auc: 0.9160  acc: 0.8155    eval auc: 0.7914  acc: 0.7261    test auc: 0.7892  acc: 0.7176, time: 0.5960
epoch 28    train auc: 0.9131  acc: 0.8025    eval auc: 0.7883  acc: 0.6865    test auc: 0.7886  acc: 0.6774, time: 0.9540
epoch 29    train auc: 0.9182  acc: 0.8157    eval auc: 0.7903  acc: 0.7252    test auc: 0.7877  acc: 0.7159, time: 0.5570
epoch 30    train auc: 0.9150  acc: 0.8038    eval auc: 0.7864  acc: 0.6867    test auc: 0.7868  acc: 0.6760, time: 0.8519
epoch 31    train auc: 0.9206  acc: 0.8188    eval auc: 0.7886  acc: 0.7212    test auc: 0.7860  acc: 0.7102, time: 0.5309
epoch 32    train auc: 0.9171  acc: 0.8058    eval auc: 0.7846  acc: 0.6880    test auc: 0.7848  acc: 0.6775, time: 0.9420
epoch 33    train auc: 0.9226  acc: 0.8221    eval auc: 0.7871  acc: 0.7171    test auc: 0.7845  acc: 0.7070, time: 0.5630
epoch 34    train auc: 0.9179  acc: 0.8034    eval auc: 0.7817  acc: 0.6786    test auc: 0.7822  acc: 0.6721, time: 0.8430
epoch 35    train auc: 0.9241  acc: 0.8227    eval auc: 0.7859  acc: 0.7168    test auc: 0.7832  acc: 0.7059, time: 0.4930
epoch 36    train auc: 0.9190  acc: 0.8056    eval auc: 0.7806  acc: 0.6837    test auc: 0.7808  acc: 0.6748, time: 0.8910
epoch 37    train auc: 0.9256  acc: 0.8247    eval auc: 0.7844  acc: 0.7165    test auc: 0.7816  acc: 0.7060, time: 0.5680
epoch 38    train auc: 0.9201  acc: 0.8052    eval auc: 0.7782  acc: 0.6813    test auc: 0.7781  acc: 0.6715, time: 0.8640
epoch 39    train auc: 0.9271  acc: 0.8269    eval auc: 0.7830  acc: 0.7111    test auc: 0.7800  acc: 0.7036, time: 0.4929
epoch 40    train auc: 0.9203  acc: 0.8038    eval auc: 0.7764  acc: 0.6798    test auc: 0.7764  acc: 0.6703, time: 0.8830
epoch 41    train auc: 0.9281  acc: 0.8274    eval auc: 0.7821  acc: 0.7139    test auc: 0.7788  acc: 0.7041, time: 0.4970
epoch 42    train auc: 0.9203  acc: 0.8026    eval auc: 0.7745  acc: 0.6782    test auc: 0.7744  acc: 0.6681, time: 0.8580
epoch 43    train auc: 0.9291  acc: 0.8276    eval auc: 0.7809  acc: 0.7115    test auc: 0.7775  acc: 0.7029, time: 0.5090
epoch 44    train auc: 0.9206  acc: 0.8025    eval auc: 0.7733  acc: 0.6785    test auc: 0.7730  acc: 0.6691, time: 0.8160
epoch 45    train auc: 0.9296  acc: 0.8262    eval auc: 0.7805  acc: 0.7135    test auc: 0.7768  acc: 0.7052, time: 0.5009
epoch 46    train auc: 0.9207  acc: 0.8024    eval auc: 0.7724  acc: 0.6771    test auc: 0.7721  acc: 0.6678, time: 0.8170
epoch 47    train auc: 0.9306  acc: 0.8288    eval auc: 0.7794  acc: 0.7098    test auc: 0.7756  acc: 0.7036, time: 0.4899
epoch 48    train auc: 0.9208  acc: 0.8018    eval auc: 0.7708  acc: 0.6767    test auc: 0.7704  acc: 0.6658, time: 0.8030
epoch 49    train auc: 0.9315  acc: 0.8310    eval auc: 0.7785  acc: 0.7080    test auc: 0.7748  acc: 0.7020, time: 0.5190
avg time per epoch : 0.7275680303573608
--- 46.661630392074585 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:23:13.976998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:23:13.977328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4819  acc: 0.4867    eval auc: 0.5372  acc: 0.5296    test auc: 0.5174  acc: 0.5102, time: 1.2124
epoch 1    train auc: 0.4999  acc: 0.4999    eval auc: 0.4903  acc: 0.4937    test auc: 0.5099  acc: 0.5067, time: 0.5609
epoch 2    train auc: 0.5318  acc: 0.5166    eval auc: 0.4526  acc: 0.4760    test auc: 0.4516  acc: 0.4741, time: 0.7930
epoch 3    train auc: 0.5704  acc: 0.5092    eval auc: 0.3973  acc: 0.4884    test auc: 0.3939  acc: 0.4841, time: 0.4839
epoch 4    train auc: 0.5815  acc: 0.5490    eval auc: 0.3814  acc: 0.4267    test auc: 0.3784  acc: 0.4261, time: 0.8669
epoch 5    train auc: 0.5889  acc: 0.5625    eval auc: 0.3712  acc: 0.4097    test auc: 0.3688  acc: 0.4026, time: 0.5540
epoch 6    train auc: 0.5920  acc: 0.5627    eval auc: 0.3675  acc: 0.4077    test auc: 0.3640  acc: 0.4043, time: 0.8550
epoch 7    train auc: 0.5939  acc: 0.5653    eval auc: 0.3658  acc: 0.4055    test auc: 0.3612  acc: 0.3986, time: 0.5083
epoch 8    train auc: 0.5949  acc: 0.5658    eval auc: 0.3643  acc: 0.4026    test auc: 0.3602  acc: 0.4000, time: 0.8310
epoch 9    train auc: 0.5955  acc: 0.5664    eval auc: 0.3639  acc: 0.4015    test auc: 0.3592  acc: 0.3993, time: 0.4850
epoch 10    train auc: 0.5959  acc: 0.5666    eval auc: 0.3632  acc: 0.4023    test auc: 0.3591  acc: 0.3980, time: 0.8410
epoch 11    train auc: 0.5962  acc: 0.5668    eval auc: 0.3634  acc: 0.4013    test auc: 0.3584  acc: 0.3984, time: 0.4939
epoch 12    train auc: 0.5964  acc: 0.5668    eval auc: 0.3632  acc: 0.3998    test auc: 0.3583  acc: 0.3997, time: 0.8019
epoch 13    train auc: 0.5966  acc: 0.5669    eval auc: 0.3632  acc: 0.4022    test auc: 0.3578  acc: 0.3972, time: 0.5155
epoch 14    train auc: 0.5967  acc: 0.5668    eval auc: 0.3633  acc: 0.4010    test auc: 0.3577  acc: 0.3986, time: 0.8289
epoch 15    train auc: 0.5968  acc: 0.5669    eval auc: 0.3630  acc: 0.4013    test auc: 0.3578  acc: 0.3980, time: 0.5029
epoch 16    train auc: 0.5968  acc: 0.5669    eval auc: 0.3632  acc: 0.4025    test auc: 0.3577  acc: 0.3969, time: 0.8870
epoch 17    train auc: 0.5969  acc: 0.5669    eval auc: 0.3628  acc: 0.4000    test auc: 0.3578  acc: 0.3993, time: 0.5240
epoch 18    train auc: 0.5969  acc: 0.5669    eval auc: 0.3631  acc: 0.4030    test auc: 0.3577  acc: 0.3964, time: 0.8360
epoch 19    train auc: 0.5970  acc: 0.5668    eval auc: 0.3631  acc: 0.4018    test auc: 0.3575  acc: 0.3977, time: 0.5530
epoch 20    train auc: 0.5970  acc: 0.5669    eval auc: 0.3629  acc: 0.4009    test auc: 0.3578  acc: 0.3985, time: 0.8460
epoch 21    train auc: 0.5970  acc: 0.5669    eval auc: 0.3634  acc: 0.4025    test auc: 0.3573  acc: 0.3969, time: 0.5420
epoch 22    train auc: 0.5971  acc: 0.5669    eval auc: 0.3633  acc: 0.4028    test auc: 0.3573  acc: 0.3966, time: 0.8420
epoch 23    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4016    test auc: 0.3573  acc: 0.3978, time: 0.5419
epoch 24    train auc: 0.5971  acc: 0.5669    eval auc: 0.3634  acc: 0.4034    test auc: 0.3572  acc: 0.3960, time: 0.8379
epoch 25    train auc: 0.5971  acc: 0.5669    eval auc: 0.3630  acc: 0.4024    test auc: 0.3576  acc: 0.3970, time: 0.5260
epoch 26    train auc: 0.5971  acc: 0.5669    eval auc: 0.3633  acc: 0.4036    test auc: 0.3573  acc: 0.3958, time: 0.8960
epoch 27    train auc: 0.5971  acc: 0.5669    eval auc: 0.3633  acc: 0.4031    test auc: 0.3573  acc: 0.3963, time: 0.5370
epoch 28    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4022    test auc: 0.3576  acc: 0.3972, time: 0.8459
epoch 29    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4016    test auc: 0.3575  acc: 0.3978, time: 0.5030
epoch 30    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4036    test auc: 0.3572  acc: 0.3958, time: 0.8350
epoch 31    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4034    test auc: 0.3571  acc: 0.3960, time: 0.5710
epoch 32    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4042    test auc: 0.3571  acc: 0.3952, time: 0.8710
epoch 33    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4039    test auc: 0.3569  acc: 0.3954, time: 0.5410
epoch 34    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4032    test auc: 0.3573  acc: 0.3962, time: 0.8650
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4036    test auc: 0.3573  acc: 0.3958, time: 0.5250
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4038    test auc: 0.3572  acc: 0.3956, time: 0.8470
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4043    test auc: 0.3569  acc: 0.3951, time: 0.5320
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4034    test auc: 0.3570  acc: 0.3960, time: 0.8790
epoch 39    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4043    test auc: 0.3570  acc: 0.3951, time: 0.5520
epoch 40    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4041    test auc: 0.3569  acc: 0.3953, time: 0.9820
epoch 41    train auc: 0.5972  acc: 0.5669    eval auc: 0.3638  acc: 0.4032    test auc: 0.3568  acc: 0.3962, time: 0.5550
epoch 42    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4048    test auc: 0.3569  acc: 0.3946, time: 1.0430
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4042    test auc: 0.3570  acc: 0.3952, time: 0.5980
epoch 44    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4005    test auc: 0.3570  acc: 0.3989, time: 0.8860
epoch 45    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4047    test auc: 0.3571  acc: 0.3947, time: 0.6310
epoch 46    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4035    test auc: 0.3572  acc: 0.3959, time: 1.0980
epoch 47    train auc: 0.5972  acc: 0.5669    eval auc: 0.3639  acc: 0.4036    test auc: 0.3568  acc: 0.3958, time: 0.6140
epoch 48    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4035    test auc: 0.3570  acc: 0.3959, time: 1.0100
epoch 49    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4029    test auc: 0.3572  acc: 0.3965, time: 0.6212
avg time per epoch : 0.7181672430038453
--- 45.49247670173645 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:23:59.620514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:23:59.621025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5164  acc: 0.5081    eval auc: 0.4955  acc: 0.4955    test auc: 0.5105  acc: 0.5050, time: 1.2273
epoch 1    train auc: 0.5613  acc: 0.5077    eval auc: 0.4961  acc: 0.4975    test auc: 0.4927  acc: 0.4950, time: 0.5650
epoch 2    train auc: 0.6691  acc: 0.5962    eval auc: 0.5665  acc: 0.5616    test auc: 0.5725  acc: 0.5676, time: 0.9280
epoch 3    train auc: 0.7473  acc: 0.6581    eval auc: 0.6329  acc: 0.6216    test auc: 0.6407  acc: 0.6289, time: 0.5680
epoch 4    train auc: 0.7970  acc: 0.6893    eval auc: 0.6700  acc: 0.6559    test auc: 0.6754  acc: 0.6658, time: 0.9340
epoch 5    train auc: 0.8384  acc: 0.7225    eval auc: 0.7047  acc: 0.6874    test auc: 0.7108  acc: 0.6954, time: 0.6470
epoch 6    train auc: 0.8717  acc: 0.7515    eval auc: 0.7418  acc: 0.7108    test auc: 0.7466  acc: 0.7203, time: 1.1030
epoch 7    train auc: 0.8859  acc: 0.7748    eval auc: 0.7587  acc: 0.7190    test auc: 0.7624  acc: 0.7264, time: 0.6550
epoch 8    train auc: 0.8935  acc: 0.7773    eval auc: 0.7683  acc: 0.7254    test auc: 0.7711  acc: 0.7337, time: 1.0650
epoch 9    train auc: 0.8986  acc: 0.7985    eval auc: 0.7722  acc: 0.7231    test auc: 0.7743  acc: 0.7200, time: 0.6300
epoch 10    train auc: 0.9028  acc: 0.8061    eval auc: 0.7756  acc: 0.7179    test auc: 0.7772  acc: 0.7147, time: 1.0550
epoch 11    train auc: 0.9058  acc: 0.8045    eval auc: 0.7774  acc: 0.7209    test auc: 0.7780  acc: 0.7174, time: 0.7140
epoch 12    train auc: 0.9086  acc: 0.8038    eval auc: 0.7799  acc: 0.7230    test auc: 0.7797  acc: 0.7212, time: 0.9240
epoch 13    train auc: 0.9114  acc: 0.8124    eval auc: 0.7796  acc: 0.7183    test auc: 0.7792  acc: 0.7153, time: 0.5560
epoch 14    train auc: 0.9138  acc: 0.8154    eval auc: 0.7808  acc: 0.7178    test auc: 0.7800  acc: 0.7138, time: 0.9459
epoch 15    train auc: 0.9158  acc: 0.8165    eval auc: 0.7806  acc: 0.7164    test auc: 0.7794  acc: 0.7130, time: 0.5939
epoch 16    train auc: 0.9177  acc: 0.8172    eval auc: 0.7812  acc: 0.7173    test auc: 0.7795  acc: 0.7144, time: 1.0120
epoch 17    train auc: 0.9195  acc: 0.8216    eval auc: 0.7802  acc: 0.7112    test auc: 0.7786  acc: 0.7095, time: 0.5980
epoch 18    train auc: 0.9208  acc: 0.8198    eval auc: 0.7813  acc: 0.7165    test auc: 0.7791  acc: 0.7157, time: 0.9910
epoch 19    train auc: 0.9223  acc: 0.8222    eval auc: 0.7802  acc: 0.7135    test auc: 0.7779  acc: 0.7122, time: 0.6490
epoch 20    train auc: 0.9234  acc: 0.8227    eval auc: 0.7803  acc: 0.7151    test auc: 0.7777  acc: 0.7143, time: 0.9683
epoch 21    train auc: 0.9247  acc: 0.8246    eval auc: 0.7792  acc: 0.7118    test auc: 0.7766  acc: 0.7109, time: 0.6509
epoch 22    train auc: 0.9255  acc: 0.8241    eval auc: 0.7799  acc: 0.7143    test auc: 0.7767  acc: 0.7132, time: 0.9970
epoch 23    train auc: 0.9266  acc: 0.8266    eval auc: 0.7782  acc: 0.7100    test auc: 0.7753  acc: 0.7056, time: 0.5910
epoch 24    train auc: 0.9273  acc: 0.8268    eval auc: 0.7787  acc: 0.7134    test auc: 0.7756  acc: 0.7091, time: 0.9520
epoch 25    train auc: 0.9282  acc: 0.8284    eval auc: 0.7779  acc: 0.7098    test auc: 0.7747  acc: 0.7070, time: 0.6040
epoch 26    train auc: 0.9289  acc: 0.8293    eval auc: 0.7778  acc: 0.7092    test auc: 0.7747  acc: 0.7048, time: 0.9949
epoch 27    train auc: 0.9297  acc: 0.8290    eval auc: 0.7769  acc: 0.7093    test auc: 0.7735  acc: 0.7069, time: 0.5950
epoch 28    train auc: 0.9303  acc: 0.8310    eval auc: 0.7766  acc: 0.7049    test auc: 0.7734  acc: 0.7036, time: 0.9910
epoch 29    train auc: 0.9309  acc: 0.8301    eval auc: 0.7763  acc: 0.7089    test auc: 0.7728  acc: 0.7066, time: 0.5890
epoch 30    train auc: 0.9315  acc: 0.8319    eval auc: 0.7755  acc: 0.7054    test auc: 0.7725  acc: 0.7027, time: 0.9750
epoch 31    train auc: 0.9323  acc: 0.8330    eval auc: 0.7742  acc: 0.7034    test auc: 0.7709  acc: 0.7004, time: 0.6059
epoch 32    train auc: 0.9323  acc: 0.8295    eval auc: 0.7753  acc: 0.7082    test auc: 0.7717  acc: 0.7034, time: 0.9900
epoch 33    train auc: 0.9333  acc: 0.8339    eval auc: 0.7736  acc: 0.7040    test auc: 0.7703  acc: 0.7013, time: 0.6620
epoch 34    train auc: 0.9337  acc: 0.8345    eval auc: 0.7731  acc: 0.7023    test auc: 0.7701  acc: 0.7003, time: 0.9010
epoch 35    train auc: 0.9342  acc: 0.8348    eval auc: 0.7721  acc: 0.7014    test auc: 0.7693  acc: 0.6980, time: 0.6010
epoch 36    train auc: 0.9343  acc: 0.8338    eval auc: 0.7736  acc: 0.7049    test auc: 0.7704  acc: 0.7045, time: 0.9587
epoch 37    train auc: 0.9351  acc: 0.8366    eval auc: 0.7708  acc: 0.7003    test auc: 0.7682  acc: 0.6969, time: 0.5960
epoch 38    train auc: 0.9353  acc: 0.8350    eval auc: 0.7718  acc: 0.7026    test auc: 0.7687  acc: 0.6996, time: 0.9920
epoch 39    train auc: 0.9360  acc: 0.8375    eval auc: 0.7688  acc: 0.6989    test auc: 0.7662  acc: 0.6939, time: 0.5900
epoch 40    train auc: 0.9361  acc: 0.8358    eval auc: 0.7710  acc: 0.7004    test auc: 0.7683  acc: 0.6981, time: 0.9360
epoch 41    train auc: 0.9367  acc: 0.8378    eval auc: 0.7695  acc: 0.6983    test auc: 0.7669  acc: 0.6972, time: 0.6700
epoch 42    train auc: 0.9369  acc: 0.8369    eval auc: 0.7697  acc: 0.6988    test auc: 0.7671  acc: 0.6998, time: 0.9490
epoch 43    train auc: 0.9374  acc: 0.8382    eval auc: 0.7684  acc: 0.6980    test auc: 0.7659  acc: 0.6962, time: 0.5498
epoch 44    train auc: 0.9376  acc: 0.8380    eval auc: 0.7688  acc: 0.6984    test auc: 0.7663  acc: 0.6982, time: 0.8851
epoch 45    train auc: 0.9377  acc: 0.8379    eval auc: 0.7683  acc: 0.6980    test auc: 0.7657  acc: 0.6998, time: 0.5400
epoch 46    train auc: 0.9382  acc: 0.8393    eval auc: 0.7679  acc: 0.6970    test auc: 0.7655  acc: 0.6969, time: 0.9390
epoch 47    train auc: 0.9384  acc: 0.8394    eval auc: 0.7672  acc: 0.6964    test auc: 0.7649  acc: 0.6980, time: 0.5450
epoch 48    train auc: 0.9390  acc: 0.8411    eval auc: 0.7656  acc: 0.6957    test auc: 0.7637  acc: 0.6944, time: 0.9018
epoch 49    train auc: 0.9389  acc: 0.8395    eval auc: 0.7665  acc: 0.6963    test auc: 0.7642  acc: 0.6968, time: 0.5430
avg time per epoch : 0.7924809694290161
--- 50.500998735427856 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:24:50.054497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:24:50.054822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4941  acc: 0.4960    eval auc: 0.5154  acc: 0.5077    test auc: 0.5024  acc: 0.5042, time: 1.2730
epoch 1    train auc: 0.5011  acc: 0.5011    eval auc: 0.4908  acc: 0.4907    test auc: 0.5058  acc: 0.5060, time: 0.6180
epoch 2    train auc: 0.5295  acc: 0.5022    eval auc: 0.4577  acc: 0.4991    test auc: 0.4537  acc: 0.4940, time: 1.0330
epoch 3    train auc: 0.5727  acc: 0.5423    eval auc: 0.3959  acc: 0.4397    test auc: 0.3893  acc: 0.4307, time: 0.6470
epoch 4    train auc: 0.5829  acc: 0.5565    eval auc: 0.3804  acc: 0.4143    test auc: 0.3774  acc: 0.4137, time: 1.0170
epoch 5    train auc: 0.6005  acc: 0.5604    eval auc: 0.3762  acc: 0.4090    test auc: 0.3751  acc: 0.4101, time: 0.6520
epoch 6    train auc: 0.6630  acc: 0.6364    eval auc: 0.4207  acc: 0.4816    test auc: 0.4126  acc: 0.4735, time: 1.0630
epoch 7    train auc: 0.8086  acc: 0.7078    eval auc: 0.6487  acc: 0.5829    test auc: 0.6423  acc: 0.5740, time: 0.6790
epoch 8    train auc: 0.8511  acc: 0.7122    eval auc: 0.7192  acc: 0.5935    test auc: 0.7145  acc: 0.5837, time: 1.1270
epoch 9    train auc: 0.8746  acc: 0.7785    eval auc: 0.7229  acc: 0.6660    test auc: 0.7206  acc: 0.6645, time: 0.7290
epoch 10    train auc: 0.8756  acc: 0.7461    eval auc: 0.7354  acc: 0.6562    test auc: 0.7356  acc: 0.6494, time: 1.0240
epoch 11    train auc: 0.8947  acc: 0.7940    eval auc: 0.7397  acc: 0.6949    test auc: 0.7387  acc: 0.6947, time: 0.6390
epoch 12    train auc: 0.8940  acc: 0.7883    eval auc: 0.7388  acc: 0.6792    test auc: 0.7392  acc: 0.6782, time: 0.9280
epoch 13    train auc: 0.9099  acc: 0.8057    eval auc: 0.7425  acc: 0.6961    test auc: 0.7428  acc: 0.6974, time: 0.5120
epoch 14    train auc: 0.9066  acc: 0.7996    eval auc: 0.7393  acc: 0.6844    test auc: 0.7402  acc: 0.6844, time: 0.8479
epoch 15    train auc: 0.9208  acc: 0.8160    eval auc: 0.7436  acc: 0.7000    test auc: 0.7456  acc: 0.7006, time: 0.5169
epoch 16    train auc: 0.9199  acc: 0.8179    eval auc: 0.7418  acc: 0.6915    test auc: 0.7426  acc: 0.6919, time: 1.0080
epoch 17    train auc: 0.9296  acc: 0.8268    eval auc: 0.7448  acc: 0.6984    test auc: 0.7456  acc: 0.6987, time: 0.6520
epoch 18    train auc: 0.9309  acc: 0.8289    eval auc: 0.7406  acc: 0.6916    test auc: 0.7399  acc: 0.6936, time: 0.9620
epoch 19    train auc: 0.9382  acc: 0.8369    eval auc: 0.7446  acc: 0.6961    test auc: 0.7442  acc: 0.6956, time: 0.6010
epoch 20    train auc: 0.9375  acc: 0.8387    eval auc: 0.7418  acc: 0.6917    test auc: 0.7403  acc: 0.6919, time: 0.8384
epoch 21    train auc: 0.9440  acc: 0.8436    eval auc: 0.7417  acc: 0.6925    test auc: 0.7410  acc: 0.6947, time: 0.5150
epoch 22    train auc: 0.9401  acc: 0.8413    eval auc: 0.7404  acc: 0.6874    test auc: 0.7385  acc: 0.6873, time: 0.8591
epoch 23    train auc: 0.9510  acc: 0.8565    eval auc: 0.7446  acc: 0.6928    test auc: 0.7432  acc: 0.6928, time: 0.5660
epoch 24    train auc: 0.9534  acc: 0.8621    eval auc: 0.7444  acc: 0.6935    test auc: 0.7425  acc: 0.6925, time: 0.9519
epoch 25    train auc: 0.9625  acc: 0.8751    eval auc: 0.7472  acc: 0.6937    test auc: 0.7447  acc: 0.6975, time: 0.6020
epoch 26    train auc: 0.9626  acc: 0.8774    eval auc: 0.7429  acc: 0.6925    test auc: 0.7395  acc: 0.6911, time: 0.8590
epoch 27    train auc: 0.9697  acc: 0.8902    eval auc: 0.7375  acc: 0.6863    test auc: 0.7352  acc: 0.6876, time: 0.5320
epoch 28    train auc: 0.9682  acc: 0.8881    eval auc: 0.7382  acc: 0.6905    test auc: 0.7344  acc: 0.6876, time: 1.0230
epoch 29    train auc: 0.9739  acc: 0.8984    eval auc: 0.7343  acc: 0.6882    test auc: 0.7311  acc: 0.6857, time: 0.6550
epoch 30    train auc: 0.9724  acc: 0.8957    eval auc: 0.7344  acc: 0.6884    test auc: 0.7312  acc: 0.6864, time: 0.8430
epoch 31    train auc: 0.9769  acc: 0.9025    eval auc: 0.7321  acc: 0.6882    test auc: 0.7307  acc: 0.6890, time: 0.5110
epoch 32    train auc: 0.9752  acc: 0.9014    eval auc: 0.7311  acc: 0.6839    test auc: 0.7289  acc: 0.6852, time: 0.8490
epoch 33    train auc: 0.9795  acc: 0.9082    eval auc: 0.7309  acc: 0.6887    test auc: 0.7295  acc: 0.6889, time: 0.5140
epoch 34    train auc: 0.9780  acc: 0.9073    eval auc: 0.7290  acc: 0.6852    test auc: 0.7275  acc: 0.6832, time: 0.8560
epoch 35    train auc: 0.9814  acc: 0.9139    eval auc: 0.7299  acc: 0.6906    test auc: 0.7290  acc: 0.6880, time: 0.5200
epoch 36    train auc: 0.9804  acc: 0.9106    eval auc: 0.7224  acc: 0.6761    test auc: 0.7210  acc: 0.6765, time: 0.8129
epoch 37    train auc: 0.9839  acc: 0.9212    eval auc: 0.7230  acc: 0.6808    test auc: 0.7224  acc: 0.6830, time: 0.4980
epoch 38    train auc: 0.9830  acc: 0.9172    eval auc: 0.7259  acc: 0.6823    test auc: 0.7231  acc: 0.6794, time: 0.8009
epoch 39    train auc: 0.9857  acc: 0.9268    eval auc: 0.7263  acc: 0.6853    test auc: 0.7242  acc: 0.6824, time: 0.5067
epoch 40    train auc: 0.9841  acc: 0.9188    eval auc: 0.7267  acc: 0.6802    test auc: 0.7244  acc: 0.6801, time: 0.8460
epoch 41    train auc: 0.9873  acc: 0.9313    eval auc: 0.7233  acc: 0.6831    test auc: 0.7216  acc: 0.6814, time: 0.5099
epoch 42    train auc: 0.9848  acc: 0.9193    eval auc: 0.7230  acc: 0.6774    test auc: 0.7207  acc: 0.6725, time: 0.8290
epoch 43    train auc: 0.9884  acc: 0.9339    eval auc: 0.7270  acc: 0.6847    test auc: 0.7248  acc: 0.6811, time: 0.4900
epoch 44    train auc: 0.9867  acc: 0.9248    eval auc: 0.7252  acc: 0.6795    test auc: 0.7226  acc: 0.6776, time: 0.7970
epoch 45    train auc: 0.9899  acc: 0.9379    eval auc: 0.7232  acc: 0.6832    test auc: 0.7207  acc: 0.6772, time: 0.4830
epoch 46    train auc: 0.9883  acc: 0.9327    eval auc: 0.7219  acc: 0.6771    test auc: 0.7204  acc: 0.6754, time: 0.7969
epoch 47    train auc: 0.9912  acc: 0.9427    eval auc: 0.7214  acc: 0.6801    test auc: 0.7194  acc: 0.6751, time: 0.5189
epoch 48    train auc: 0.9897  acc: 0.9347    eval auc: 0.7200  acc: 0.6752    test auc: 0.7198  acc: 0.6720, time: 0.8110
epoch 49    train auc: 0.9921  acc: 0.9453    eval auc: 0.7228  acc: 0.6801    test auc: 0.7214  acc: 0.6778, time: 0.4983
avg time per epoch : 0.7444331026077271
--- 47.27265548706055 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:25:37.333219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:25:37.333553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4968  acc: 0.4981    eval auc: 0.5201  acc: 0.5064    test auc: 0.5214  acc: 0.5037, time: 1.2692
epoch 1    train auc: 0.5209  acc: 0.5043    eval auc: 0.4705  acc: 0.4959    test auc: 0.4692  acc: 0.4936, time: 0.5674
epoch 2    train auc: 0.4837  acc: 0.5008    eval auc: 0.5530  acc: 0.5060    test auc: 0.5522  acc: 0.5103, time: 0.8390
epoch 3    train auc: 0.5510  acc: 0.5250    eval auc: 0.4337  acc: 0.4699    test auc: 0.4170  acc: 0.4557, time: 0.5270
epoch 4    train auc: 0.5666  acc: 0.5402    eval auc: 0.4139  acc: 0.4462    test auc: 0.3997  acc: 0.4356, time: 0.7930
epoch 5    train auc: 0.5712  acc: 0.5483    eval auc: 0.4044  acc: 0.4323    test auc: 0.3919  acc: 0.4230, time: 0.5530
epoch 6    train auc: 0.5849  acc: 0.5595    eval auc: 0.3990  acc: 0.4311    test auc: 0.3881  acc: 0.4116, time: 0.8470
epoch 7    train auc: 0.5901  acc: 0.5612    eval auc: 0.3966  acc: 0.4280    test auc: 0.3859  acc: 0.4126, time: 0.5310
epoch 8    train auc: 0.6763  acc: 0.6255    eval auc: 0.4766  acc: 0.4872    test auc: 0.4714  acc: 0.4860, time: 0.8599
epoch 9    train auc: 0.7781  acc: 0.6972    eval auc: 0.6141  acc: 0.5775    test auc: 0.6177  acc: 0.5752, time: 0.5000
epoch 10    train auc: 0.8490  acc: 0.7365    eval auc: 0.7217  acc: 0.7078    test auc: 0.7269  acc: 0.7185, time: 0.8790
epoch 11    train auc: 0.8721  acc: 0.7711    eval auc: 0.7512  acc: 0.7156    test auc: 0.7538  acc: 0.7233, time: 0.5110
epoch 12    train auc: 0.8803  acc: 0.7642    eval auc: 0.7637  acc: 0.7271    test auc: 0.7633  acc: 0.7390, time: 0.8650
epoch 13    train auc: 0.8900  acc: 0.7900    eval auc: 0.7719  acc: 0.7268    test auc: 0.7728  acc: 0.7257, time: 0.5460
epoch 14    train auc: 0.8922  acc: 0.7783    eval auc: 0.7770  acc: 0.7388    test auc: 0.7762  acc: 0.7433, time: 0.7990
epoch 15    train auc: 0.8995  acc: 0.7974    eval auc: 0.7790  acc: 0.7276    test auc: 0.7792  acc: 0.7248, time: 0.4830
epoch 16    train auc: 0.8983  acc: 0.7844    eval auc: 0.7830  acc: 0.7387    test auc: 0.7817  acc: 0.7419, time: 0.8590
epoch 17    train auc: 0.9055  acc: 0.8055    eval auc: 0.7830  acc: 0.7224    test auc: 0.7826  acc: 0.7153, time: 0.6110
epoch 18    train auc: 0.9025  acc: 0.7885    eval auc: 0.7860  acc: 0.7369    test auc: 0.7843  acc: 0.7376, time: 0.9170
epoch 19    train auc: 0.9099  acc: 0.8095    eval auc: 0.7849  acc: 0.7193    test auc: 0.7838  acc: 0.7108, time: 0.5360
epoch 20    train auc: 0.9068  acc: 0.7939    eval auc: 0.7879  acc: 0.7334    test auc: 0.7858  acc: 0.7354, time: 0.8390
epoch 21    train auc: 0.9134  acc: 0.8100    eval auc: 0.7859  acc: 0.7226    test auc: 0.7842  acc: 0.7146, time: 0.5180
epoch 22    train auc: 0.9100  acc: 0.7963    eval auc: 0.7886  acc: 0.7317    test auc: 0.7859  acc: 0.7308, time: 0.8300
epoch 23    train auc: 0.9167  acc: 0.8153    eval auc: 0.7854  acc: 0.7180    test auc: 0.7832  acc: 0.7101, time: 0.5069
epoch 24    train auc: 0.9134  acc: 0.7999    eval auc: 0.7887  acc: 0.7298    test auc: 0.7858  acc: 0.7291, time: 0.8269
epoch 25    train auc: 0.9193  acc: 0.8164    eval auc: 0.7852  acc: 0.7181    test auc: 0.7826  acc: 0.7101, time: 0.5399
epoch 26    train auc: 0.9164  acc: 0.8026    eval auc: 0.7884  acc: 0.7290    test auc: 0.7850  acc: 0.7270, time: 0.8220
epoch 27    train auc: 0.9217  acc: 0.8181    eval auc: 0.7839  acc: 0.7159    test auc: 0.7809  acc: 0.7066, time: 0.5280
epoch 28    train auc: 0.9192  acc: 0.8068    eval auc: 0.7879  acc: 0.7279    test auc: 0.7840  acc: 0.7262, time: 0.9000
epoch 29    train auc: 0.9235  acc: 0.8190    eval auc: 0.7840  acc: 0.7166    test auc: 0.7806  acc: 0.7082, time: 0.5560
epoch 30    train auc: 0.9213  acc: 0.8087    eval auc: 0.7868  acc: 0.7265    test auc: 0.7829  acc: 0.7233, time: 0.9540
epoch 31    train auc: 0.9256  acc: 0.8225    eval auc: 0.7812  acc: 0.7115    test auc: 0.7777  acc: 0.7045, time: 0.5750
epoch 32    train auc: 0.9228  acc: 0.8090    eval auc: 0.7859  acc: 0.7244    test auc: 0.7816  acc: 0.7219, time: 1.0200
epoch 33    train auc: 0.9269  acc: 0.8241    eval auc: 0.7812  acc: 0.7101    test auc: 0.7776  acc: 0.7067, time: 0.5940
epoch 34    train auc: 0.9252  acc: 0.8132    eval auc: 0.7844  acc: 0.7222    test auc: 0.7803  acc: 0.7168, time: 0.9710
epoch 35    train auc: 0.9281  acc: 0.8269    eval auc: 0.7801  acc: 0.7070    test auc: 0.7769  acc: 0.7032, time: 0.5869
epoch 36    train auc: 0.9265  acc: 0.8140    eval auc: 0.7842  acc: 0.7222    test auc: 0.7802  acc: 0.7172, time: 0.9930
epoch 37    train auc: 0.9295  acc: 0.8283    eval auc: 0.7785  acc: 0.7048    test auc: 0.7754  acc: 0.7007, time: 0.6820
epoch 38    train auc: 0.9280  acc: 0.8176    eval auc: 0.7823  acc: 0.7173    test auc: 0.7781  acc: 0.7119, time: 0.9560
epoch 39    train auc: 0.9305  acc: 0.8293    eval auc: 0.7772  acc: 0.7016    test auc: 0.7741  acc: 0.6987, time: 0.5560
epoch 40    train auc: 0.9293  acc: 0.8193    eval auc: 0.7813  acc: 0.7171    test auc: 0.7774  acc: 0.7100, time: 1.0000
epoch 41    train auc: 0.9314  acc: 0.8296    eval auc: 0.7773  acc: 0.7034    test auc: 0.7741  acc: 0.7002, time: 0.6170
epoch 42    train auc: 0.9308  acc: 0.8217    eval auc: 0.7793  acc: 0.7122    test auc: 0.7755  acc: 0.7075, time: 1.0430
epoch 43    train auc: 0.9323  acc: 0.8297    eval auc: 0.7767  acc: 0.7043    test auc: 0.7734  acc: 0.7010, time: 0.6550
epoch 44    train auc: 0.9317  acc: 0.8231    eval auc: 0.7787  acc: 0.7117    test auc: 0.7751  acc: 0.7076, time: 1.0880
epoch 45    train auc: 0.9329  acc: 0.8287    eval auc: 0.7765  acc: 0.7063    test auc: 0.7731  acc: 0.7042, time: 0.7710
epoch 46    train auc: 0.9329  acc: 0.8267    eval auc: 0.7773  acc: 0.7093    test auc: 0.7738  acc: 0.7045, time: 1.3430
epoch 47    train auc: 0.9337  acc: 0.8304    eval auc: 0.7751  acc: 0.7047    test auc: 0.7719  acc: 0.7009, time: 0.7750
epoch 48    train auc: 0.9339  acc: 0.8289    eval auc: 0.7758  acc: 0.7070    test auc: 0.7725  acc: 0.7023, time: 1.1960
epoch 49    train auc: 0.9342  acc: 0.8296    eval auc: 0.7748  acc: 0.7048    test auc: 0.7716  acc: 0.7014, time: 0.8140
avg time per epoch : 0.766974663734436
--- 49.03931427001953 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:26:26.756000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:26:26.756560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5005  acc: 0.5023    eval auc: 0.5381  acc: 0.5037    test auc: 0.5241  acc: 0.5164, time: 1.6400
epoch 1    train auc: 0.8078  acc: 0.6900    eval auc: 0.7277  acc: 0.6749    test auc: 0.7463  acc: 0.6864, time: 0.6740
epoch 2    train auc: 0.8914  acc: 0.7641    eval auc: 0.7910  acc: 0.7367    test auc: 0.7977  acc: 0.7464, time: 1.0940
epoch 3    train auc: 0.9032  acc: 0.8033    eval auc: 0.7930  acc: 0.7421    test auc: 0.7972  acc: 0.7416, time: 0.6270
epoch 4    train auc: 0.9115  acc: 0.8010    eval auc: 0.7926  acc: 0.7398    test auc: 0.7940  acc: 0.7402, time: 1.0360
epoch 5    train auc: 0.9196  acc: 0.8191    eval auc: 0.7866  acc: 0.7180    test auc: 0.7871  acc: 0.7164, time: 0.6210
epoch 6    train auc: 0.9236  acc: 0.8182    eval auc: 0.7849  acc: 0.7203    test auc: 0.7835  acc: 0.7160, time: 0.9860
epoch 7    train auc: 0.9275  acc: 0.8253    eval auc: 0.7800  acc: 0.7096    test auc: 0.7780  acc: 0.7035, time: 0.6160
epoch 8    train auc: 0.9289  acc: 0.8227    eval auc: 0.7792  acc: 0.7112    test auc: 0.7763  acc: 0.7067, time: 1.0280
epoch 9    train auc: 0.9323  acc: 0.8314    eval auc: 0.7723  acc: 0.6983    test auc: 0.7706  acc: 0.6948, time: 0.6220
epoch 10    train auc: 0.9333  acc: 0.8296    eval auc: 0.7751  acc: 0.7045    test auc: 0.7727  acc: 0.7017, time: 0.9860
epoch 11    train auc: 0.9337  acc: 0.8267    eval auc: 0.7741  acc: 0.7040    test auc: 0.7714  acc: 0.7032, time: 0.5910
epoch 12    train auc: 0.9342  acc: 0.8275    eval auc: 0.7765  acc: 0.7081    test auc: 0.7740  acc: 0.7072, time: 0.9990
epoch 13    train auc: 0.9379  acc: 0.8365    eval auc: 0.7676  acc: 0.6956    test auc: 0.7660  acc: 0.6916, time: 0.6090
epoch 14    train auc: 0.9382  acc: 0.8356    eval auc: 0.7696  acc: 0.6990    test auc: 0.7686  acc: 0.6990, time: 1.0069
epoch 15    train auc: 0.9397  acc: 0.8388    eval auc: 0.7652  acc: 0.6935    test auc: 0.7639  acc: 0.6941, time: 0.5940
epoch 16    train auc: 0.9400  acc: 0.8382    eval auc: 0.7660  acc: 0.6955    test auc: 0.7647  acc: 0.6964, time: 0.9940
epoch 17    train auc: 0.9413  acc: 0.8399    eval auc: 0.7625  acc: 0.6893    test auc: 0.7623  acc: 0.6911, time: 0.6010
epoch 18    train auc: 0.9416  acc: 0.8397    eval auc: 0.7632  acc: 0.6936    test auc: 0.7632  acc: 0.6909, time: 0.9660
epoch 19    train auc: 0.9422  acc: 0.8398    eval auc: 0.7618  acc: 0.6924    test auc: 0.7618  acc: 0.6906, time: 0.5870
epoch 20    train auc: 0.9433  acc: 0.8416    eval auc: 0.7592  acc: 0.6892    test auc: 0.7592  acc: 0.6869, time: 0.9510
epoch 21    train auc: 0.9436  acc: 0.8425    eval auc: 0.7591  acc: 0.6890    test auc: 0.7587  acc: 0.6871, time: 0.5880
epoch 22    train auc: 0.9441  acc: 0.8422    eval auc: 0.7583  acc: 0.6872    test auc: 0.7586  acc: 0.6882, time: 0.9760
epoch 23    train auc: 0.9439  acc: 0.8411    eval auc: 0.7588  acc: 0.6897    test auc: 0.7586  acc: 0.6883, time: 0.5760
epoch 24    train auc: 0.9451  acc: 0.8425    eval auc: 0.7564  acc: 0.6859    test auc: 0.7565  acc: 0.6852, time: 0.9280
epoch 25    train auc: 0.9453  acc: 0.8428    eval auc: 0.7562  acc: 0.6859    test auc: 0.7568  acc: 0.6867, time: 0.5520
epoch 26    train auc: 0.9461  acc: 0.8441    eval auc: 0.7552  acc: 0.6852    test auc: 0.7558  acc: 0.6866, time: 0.8529
epoch 27    train auc: 0.9464  acc: 0.8450    eval auc: 0.7546  acc: 0.6853    test auc: 0.7554  acc: 0.6871, time: 0.5340
epoch 28    train auc: 0.9465  acc: 0.8454    eval auc: 0.7556  acc: 0.6838    test auc: 0.7564  acc: 0.6883, time: 0.8850
epoch 29    train auc: 0.9477  acc: 0.8481    eval auc: 0.7528  acc: 0.6837    test auc: 0.7532  acc: 0.6824, time: 0.5420
epoch 30    train auc: 0.9474  acc: 0.8474    eval auc: 0.7533  acc: 0.6830    test auc: 0.7537  acc: 0.6837, time: 0.8470
epoch 31    train auc: 0.9484  acc: 0.8472    eval auc: 0.7505  acc: 0.6811    test auc: 0.7520  acc: 0.6817, time: 0.5219
epoch 32    train auc: 0.9475  acc: 0.8451    eval auc: 0.7521  acc: 0.6827    test auc: 0.7529  acc: 0.6819, time: 0.8449
epoch 33    train auc: 0.9495  acc: 0.8497    eval auc: 0.7482  acc: 0.6785    test auc: 0.7496  acc: 0.6784, time: 0.5340
epoch 34    train auc: 0.9490  acc: 0.8487    eval auc: 0.7504  acc: 0.6813    test auc: 0.7511  acc: 0.6828, time: 0.9470
epoch 35    train auc: 0.9493  acc: 0.8502    eval auc: 0.7467  acc: 0.6771    test auc: 0.7488  acc: 0.6795, time: 0.5880
epoch 36    train auc: 0.9497  acc: 0.8495    eval auc: 0.7479  acc: 0.6778    test auc: 0.7501  acc: 0.6806, time: 0.9390
epoch 37    train auc: 0.9508  acc: 0.8514    eval auc: 0.7478  acc: 0.6768    test auc: 0.7493  acc: 0.6797, time: 0.5700
epoch 38    train auc: 0.9510  acc: 0.8513    eval auc: 0.7474  acc: 0.6776    test auc: 0.7495  acc: 0.6808, time: 0.9219
epoch 39    train auc: 0.9515  acc: 0.8517    eval auc: 0.7462  acc: 0.6756    test auc: 0.7481  acc: 0.6793, time: 0.5509
epoch 40    train auc: 0.9517  acc: 0.8517    eval auc: 0.7471  acc: 0.6778    test auc: 0.7492  acc: 0.6814, time: 0.9058
epoch 41    train auc: 0.9523  acc: 0.8527    eval auc: 0.7455  acc: 0.6763    test auc: 0.7476  acc: 0.6800, time: 0.5419
epoch 42    train auc: 0.9529  acc: 0.8537    eval auc: 0.7450  acc: 0.6767    test auc: 0.7465  acc: 0.6769, time: 0.8870
epoch 43    train auc: 0.9530  acc: 0.8526    eval auc: 0.7445  acc: 0.6758    test auc: 0.7465  acc: 0.6784, time: 0.5650
epoch 44    train auc: 0.9530  acc: 0.8527    eval auc: 0.7467  acc: 0.6782    test auc: 0.7480  acc: 0.6800, time: 0.8919
epoch 45    train auc: 0.9543  acc: 0.8537    eval auc: 0.7442  acc: 0.6754    test auc: 0.7457  acc: 0.6778, time: 0.5640
epoch 46    train auc: 0.9550  acc: 0.8548    eval auc: 0.7421  acc: 0.6741    test auc: 0.7439  acc: 0.6771, time: 0.9370
epoch 47    train auc: 0.9548  acc: 0.8541    eval auc: 0.7437  acc: 0.6760    test auc: 0.7448  acc: 0.6775, time: 0.5970
epoch 48    train auc: 0.9561  acc: 0.8563    eval auc: 0.7414  acc: 0.6733    test auc: 0.7428  acc: 0.6746, time: 0.8940
epoch 49    train auc: 0.9569  acc: 0.8568    eval auc: 0.7400  acc: 0.6726    test auc: 0.7418  acc: 0.6748, time: 0.5419
avg time per epoch : 0.7770537614822388
--- 49.328747510910034 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 8, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:27:15.870960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:27:15.871287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5147  acc: 0.5010    eval auc: 0.4797  acc: 0.5006    test auc: 0.4760  acc: 0.4963, time: 1.1545
epoch 1    train auc: 0.5266  acc: 0.5022    eval auc: 0.4611  acc: 0.4976    test auc: 0.4595  acc: 0.4958, time: 0.5350
epoch 2    train auc: 0.5434  acc: 0.5011    eval auc: 0.4376  acc: 0.5005    test auc: 0.4328  acc: 0.4962, time: 0.8810
epoch 3    train auc: 0.5555  acc: 0.5018    eval auc: 0.4213  acc: 0.4994    test auc: 0.4138  acc: 0.4953, time: 0.5020
epoch 4    train auc: 0.5639  acc: 0.5022    eval auc: 0.4086  acc: 0.4990    test auc: 0.4018  acc: 0.4944, time: 0.8770
epoch 5    train auc: 0.5706  acc: 0.5094    eval auc: 0.3989  acc: 0.4877    test auc: 0.3921  acc: 0.4842, time: 0.5399
epoch 6    train auc: 0.5759  acc: 0.5213    eval auc: 0.3915  acc: 0.4707    test auc: 0.3842  acc: 0.4656, time: 0.8501
epoch 7    train auc: 0.5800  acc: 0.5334    eval auc: 0.3857  acc: 0.4540    test auc: 0.3783  acc: 0.4457, time: 0.5700
epoch 8    train auc: 0.5835  acc: 0.5437    eval auc: 0.3806  acc: 0.4415    test auc: 0.3733  acc: 0.4274, time: 0.8680
epoch 9    train auc: 0.5863  acc: 0.5504    eval auc: 0.3768  acc: 0.4296    test auc: 0.3694  acc: 0.4192, time: 0.5080
epoch 10    train auc: 0.5881  acc: 0.5550    eval auc: 0.3742  acc: 0.4222    test auc: 0.3669  acc: 0.4128, time: 0.8459
epoch 11    train auc: 0.5896  acc: 0.5582    eval auc: 0.3722  acc: 0.4172    test auc: 0.3647  acc: 0.4081, time: 0.5160
epoch 12    train auc: 0.5907  acc: 0.5607    eval auc: 0.3706  acc: 0.4136    test auc: 0.3633  acc: 0.4042, time: 0.8450
epoch 13    train auc: 0.5916  acc: 0.5625    eval auc: 0.3697  acc: 0.4102    test auc: 0.3618  acc: 0.4023, time: 0.5370
epoch 14    train auc: 0.5924  acc: 0.5639    eval auc: 0.3687  acc: 0.4078    test auc: 0.3608  acc: 0.4005, time: 0.8330
epoch 15    train auc: 0.5930  acc: 0.5652    eval auc: 0.3680  acc: 0.4054    test auc: 0.3601  acc: 0.3991, time: 0.5120
epoch 16    train auc: 0.5935  acc: 0.5657    eval auc: 0.3673  acc: 0.4047    test auc: 0.3594  acc: 0.3982, time: 0.8390
epoch 17    train auc: 0.5939  acc: 0.5658    eval auc: 0.3667  acc: 0.4041    test auc: 0.3591  acc: 0.3985, time: 0.4950
epoch 18    train auc: 0.5943  acc: 0.5659    eval auc: 0.3663  acc: 0.4045    test auc: 0.3588  acc: 0.3977, time: 0.8231
epoch 19    train auc: 0.5945  acc: 0.5661    eval auc: 0.3660  acc: 0.4038    test auc: 0.3584  acc: 0.3979, time: 0.5120
epoch 20    train auc: 0.5948  acc: 0.5661    eval auc: 0.3655  acc: 0.4029    test auc: 0.3582  acc: 0.3987, time: 0.8346
epoch 21    train auc: 0.5951  acc: 0.5663    eval auc: 0.3654  acc: 0.4039    test auc: 0.3578  acc: 0.3971, time: 0.5070
epoch 22    train auc: 0.5953  acc: 0.5665    eval auc: 0.3652  acc: 0.4024    test auc: 0.3576  acc: 0.3982, time: 0.7910
epoch 23    train auc: 0.5955  acc: 0.5664    eval auc: 0.3650  acc: 0.4026    test auc: 0.3574  acc: 0.3982, time: 0.4840
epoch 24    train auc: 0.5956  acc: 0.5665    eval auc: 0.3647  acc: 0.4029    test auc: 0.3574  acc: 0.3976, time: 0.7980
epoch 25    train auc: 0.5959  acc: 0.5663    eval auc: 0.3647  acc: 0.4035    test auc: 0.3574  acc: 0.3978, time: 0.4840
epoch 26    train auc: 0.5970  acc: 0.5665    eval auc: 0.3653  acc: 0.4017    test auc: 0.3582  acc: 0.4002, time: 0.8099
epoch 27    train auc: 0.6149  acc: 0.5749    eval auc: 0.3811  acc: 0.4111    test auc: 0.3756  acc: 0.4089, time: 0.4980
epoch 28    train auc: 0.7673  acc: 0.6759    eval auc: 0.6083  acc: 0.5367    test auc: 0.6176  acc: 0.5435, time: 0.8169
epoch 29    train auc: 0.8114  acc: 0.7396    eval auc: 0.6742  acc: 0.6138    test auc: 0.6822  acc: 0.6139, time: 0.4810
epoch 30    train auc: 0.8289  acc: 0.7579    eval auc: 0.6915  acc: 0.6520    test auc: 0.6985  acc: 0.6564, time: 0.8134
epoch 31    train auc: 0.8518  acc: 0.7741    eval auc: 0.7125  acc: 0.6759    test auc: 0.7182  acc: 0.6765, time: 0.5016
epoch 32    train auc: 0.8566  acc: 0.7748    eval auc: 0.7231  acc: 0.6984    test auc: 0.7272  acc: 0.7040, time: 0.7860
epoch 33    train auc: 0.8781  acc: 0.7911    eval auc: 0.7419  acc: 0.7069    test auc: 0.7448  acc: 0.7047, time: 0.4780
epoch 34    train auc: 0.8800  acc: 0.7850    eval auc: 0.7476  acc: 0.7193    test auc: 0.7492  acc: 0.7232, time: 0.8360
epoch 35    train auc: 0.8933  acc: 0.8018    eval auc: 0.7578  acc: 0.7113    test auc: 0.7594  acc: 0.7069, time: 0.4889
epoch 36    train auc: 0.8956  acc: 0.7912    eval auc: 0.7639  acc: 0.7307    test auc: 0.7640  acc: 0.7315, time: 0.8309
epoch 37    train auc: 0.9021  acc: 0.8119    eval auc: 0.7637  acc: 0.7061    test auc: 0.7655  acc: 0.7023, time: 0.5170
epoch 38    train auc: 0.9041  acc: 0.7962    eval auc: 0.7692  acc: 0.7283    test auc: 0.7683  acc: 0.7291, time: 0.7990
epoch 39    train auc: 0.9080  acc: 0.8124    eval auc: 0.7649  acc: 0.7075    test auc: 0.7658  acc: 0.7027, time: 0.5160
epoch 40    train auc: 0.9095  acc: 0.8003    eval auc: 0.7724  acc: 0.7267    test auc: 0.7710  acc: 0.7258, time: 0.8349
epoch 41    train auc: 0.9126  acc: 0.8156    eval auc: 0.7657  acc: 0.7049    test auc: 0.7657  acc: 0.7042, time: 0.5360
epoch 42    train auc: 0.9136  acc: 0.8041    eval auc: 0.7725  acc: 0.7206    test auc: 0.7703  acc: 0.7216, time: 0.8269
epoch 43    train auc: 0.9162  acc: 0.8156    eval auc: 0.7683  acc: 0.7112    test auc: 0.7673  acc: 0.7083, time: 0.5420
epoch 44    train auc: 0.9167  acc: 0.8075    eval auc: 0.7738  acc: 0.7202    test auc: 0.7712  acc: 0.7199, time: 0.8000
epoch 45    train auc: 0.9189  acc: 0.8166    eval auc: 0.7700  acc: 0.7118    test auc: 0.7682  acc: 0.7087, time: 0.4919
epoch 46    train auc: 0.9192  acc: 0.8114    eval auc: 0.7741  acc: 0.7200    test auc: 0.7711  acc: 0.7183, time: 0.8210
epoch 47    train auc: 0.9211  acc: 0.8198    eval auc: 0.7694  acc: 0.7069    test auc: 0.7671  acc: 0.7041, time: 0.5150
epoch 48    train auc: 0.9209  acc: 0.8118    eval auc: 0.7745  acc: 0.7192    test auc: 0.7709  acc: 0.7152, time: 0.8589
epoch 49    train auc: 0.9229  acc: 0.8194    eval auc: 0.7708  acc: 0.7085    test auc: 0.7681  acc: 0.7063, time: 0.5070
avg time per epoch : 0.6769607067108154
--- 42.8494017124176 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:27:58.783292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:27:58.783692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4880  acc: 0.4995    eval auc: 0.5170  acc: 0.5021    test auc: 0.5217  acc: 0.5045, time: 0.9037
epoch 1    train auc: 0.7270  acc: 0.5226    eval auc: 0.7124  acc: 0.5145    test auc: 0.7317  acc: 0.5200, time: 0.5369
epoch 2    train auc: 0.8820  acc: 0.7591    eval auc: 0.7901  acc: 0.7335    test auc: 0.7922  acc: 0.7431, time: 0.5341
epoch 3    train auc: 0.8954  acc: 0.7815    eval auc: 0.7982  acc: 0.7500    test auc: 0.7993  acc: 0.7564, time: 0.5441
epoch 4    train auc: 0.9020  acc: 0.7914    eval auc: 0.7996  acc: 0.7507    test auc: 0.8000  acc: 0.7540, time: 0.5230
epoch 5    train auc: 0.9066  acc: 0.7993    eval auc: 0.7994  acc: 0.7433    test auc: 0.7993  acc: 0.7412, time: 0.5530
epoch 6    train auc: 0.9099  acc: 0.8029    eval auc: 0.7988  acc: 0.7409    test auc: 0.7982  acc: 0.7348, time: 0.5690
epoch 7    train auc: 0.9137  acc: 0.8050    eval auc: 0.7963  acc: 0.7363    test auc: 0.7959  acc: 0.7261, time: 0.5558
epoch 8    train auc: 0.9180  acc: 0.8117    eval auc: 0.7931  acc: 0.7255    test auc: 0.7928  acc: 0.7176, time: 0.5560
epoch 9    train auc: 0.9220  acc: 0.8128    eval auc: 0.7898  acc: 0.7251    test auc: 0.7884  acc: 0.7204, time: 0.5572
epoch 10    train auc: 0.9250  acc: 0.8136    eval auc: 0.7873  acc: 0.7251    test auc: 0.7854  acc: 0.7174, time: 0.5487
epoch 11    train auc: 0.9276  acc: 0.8175    eval auc: 0.7853  acc: 0.7215    test auc: 0.7833  acc: 0.7151, time: 0.5351
epoch 12    train auc: 0.9303  acc: 0.8238    eval auc: 0.7806  acc: 0.7146    test auc: 0.7788  acc: 0.7088, time: 0.5424
epoch 13    train auc: 0.9319  acc: 0.8260    eval auc: 0.7800  acc: 0.7126    test auc: 0.7779  acc: 0.7067, time: 0.5336
epoch 14    train auc: 0.9322  acc: 0.8275    eval auc: 0.7766  acc: 0.7065    test auc: 0.7761  acc: 0.7014, time: 0.5165
epoch 15    train auc: 0.9335  acc: 0.8272    eval auc: 0.7776  acc: 0.7120    test auc: 0.7767  acc: 0.7072, time: 0.5381
epoch 16    train auc: 0.9346  acc: 0.8299    eval auc: 0.7747  acc: 0.7063    test auc: 0.7742  acc: 0.7035, time: 0.5170
epoch 17    train auc: 0.9355  acc: 0.8296    eval auc: 0.7734  acc: 0.7052    test auc: 0.7711  acc: 0.7004, time: 0.5288
epoch 18    train auc: 0.9363  acc: 0.8317    eval auc: 0.7725  acc: 0.7050    test auc: 0.7709  acc: 0.7006, time: 0.5447
epoch 19    train auc: 0.9366  acc: 0.8314    eval auc: 0.7730  acc: 0.7048    test auc: 0.7716  acc: 0.7016, time: 0.5367
epoch 20    train auc: 0.9375  acc: 0.8336    eval auc: 0.7698  acc: 0.7009    test auc: 0.7687  acc: 0.6956, time: 0.5410
epoch 21    train auc: 0.9382  acc: 0.8334    eval auc: 0.7701  acc: 0.7033    test auc: 0.7684  acc: 0.6963, time: 0.6189
epoch 22    train auc: 0.9385  acc: 0.8344    eval auc: 0.7702  acc: 0.7033    test auc: 0.7684  acc: 0.6965, time: 0.5534
epoch 23    train auc: 0.9390  acc: 0.8360    eval auc: 0.7675  acc: 0.6987    test auc: 0.7664  acc: 0.6945, time: 0.5314
epoch 24    train auc: 0.9399  acc: 0.8367    eval auc: 0.7669  acc: 0.6991    test auc: 0.7655  acc: 0.6926, time: 0.5367
epoch 25    train auc: 0.9395  acc: 0.8363    eval auc: 0.7656  acc: 0.6967    test auc: 0.7648  acc: 0.6922, time: 0.5264
epoch 26    train auc: 0.9407  acc: 0.8378    eval auc: 0.7652  acc: 0.6963    test auc: 0.7635  acc: 0.6909, time: 0.5316
epoch 27    train auc: 0.9410  acc: 0.8375    eval auc: 0.7650  acc: 0.6964    test auc: 0.7635  acc: 0.6918, time: 0.5275
epoch 28    train auc: 0.9415  acc: 0.8383    eval auc: 0.7641  acc: 0.6963    test auc: 0.7623  acc: 0.6903, time: 0.5445
epoch 29    train auc: 0.9411  acc: 0.8358    eval auc: 0.7648  acc: 0.6970    test auc: 0.7628  acc: 0.6918, time: 0.6300
epoch 30    train auc: 0.9423  acc: 0.8397    eval auc: 0.7639  acc: 0.6949    test auc: 0.7622  acc: 0.6909, time: 0.6640
epoch 31    train auc: 0.9426  acc: 0.8399    eval auc: 0.7626  acc: 0.6948    test auc: 0.7611  acc: 0.6898, time: 0.5409
epoch 32    train auc: 0.9415  acc: 0.8356    eval auc: 0.7633  acc: 0.6963    test auc: 0.7613  acc: 0.6909, time: 0.5319
epoch 33    train auc: 0.9427  acc: 0.8385    eval auc: 0.7627  acc: 0.6949    test auc: 0.7610  acc: 0.6897, time: 0.5165
epoch 34    train auc: 0.9435  acc: 0.8406    eval auc: 0.7609  acc: 0.6929    test auc: 0.7587  acc: 0.6866, time: 0.5200
epoch 35    train auc: 0.9439  acc: 0.8414    eval auc: 0.7616  acc: 0.6929    test auc: 0.7598  acc: 0.6873, time: 0.5274
epoch 36    train auc: 0.9444  acc: 0.8417    eval auc: 0.7610  acc: 0.6934    test auc: 0.7594  acc: 0.6874, time: 0.5174
epoch 37    train auc: 0.9445  acc: 0.8411    eval auc: 0.7610  acc: 0.6928    test auc: 0.7597  acc: 0.6870, time: 0.5698
epoch 38    train auc: 0.9449  acc: 0.8411    eval auc: 0.7610  acc: 0.6926    test auc: 0.7597  acc: 0.6882, time: 0.5300
epoch 39    train auc: 0.9456  acc: 0.8425    eval auc: 0.7597  acc: 0.6932    test auc: 0.7586  acc: 0.6869, time: 0.5150
epoch 40    train auc: 0.9454  acc: 0.8416    eval auc: 0.7600  acc: 0.6937    test auc: 0.7586  acc: 0.6877, time: 0.5720
epoch 41    train auc: 0.9462  acc: 0.8435    eval auc: 0.7600  acc: 0.6928    test auc: 0.7591  acc: 0.6884, time: 0.5623
epoch 42    train auc: 0.9472  acc: 0.8443    eval auc: 0.7587  acc: 0.6908    test auc: 0.7578  acc: 0.6884, time: 0.5147
epoch 43    train auc: 0.9478  acc: 0.8443    eval auc: 0.7582  acc: 0.6892    test auc: 0.7577  acc: 0.6872, time: 0.5355
epoch 44    train auc: 0.9479  acc: 0.8446    eval auc: 0.7593  acc: 0.6924    test auc: 0.7586  acc: 0.6889, time: 0.5536
epoch 45    train auc: 0.9485  acc: 0.8447    eval auc: 0.7586  acc: 0.6918    test auc: 0.7581  acc: 0.6895, time: 0.5255
epoch 46    train auc: 0.9487  acc: 0.8443    eval auc: 0.7586  acc: 0.6930    test auc: 0.7577  acc: 0.6887, time: 0.5332
epoch 47    train auc: 0.9508  acc: 0.8480    eval auc: 0.7563  acc: 0.6895    test auc: 0.7559  acc: 0.6858, time: 0.5276
epoch 48    train auc: 0.9517  acc: 0.8485    eval auc: 0.7554  acc: 0.6885    test auc: 0.7555  acc: 0.6861, time: 0.5202
epoch 49    train auc: 0.9528  acc: 0.8495    eval auc: 0.7541  acc: 0.6884    test auc: 0.7542  acc: 0.6846, time: 0.5272
avg time per epoch : 0.5504028177261353
--- 33.52013826370239 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:28:32.245367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:28:32.245686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4969  acc: 0.4987    eval auc: 0.4928  acc: 0.4971    test auc: 0.5085  acc: 0.5054, time: 0.8021
epoch 1    train auc: 0.5294  acc: 0.5192    eval auc: 0.4942  acc: 0.4996    test auc: 0.5033  acc: 0.5094, time: 0.5187
epoch 2    train auc: 0.5338  acc: 0.5126    eval auc: 0.4969  acc: 0.5120    test auc: 0.5091  acc: 0.5117, time: 0.5131
epoch 3    train auc: 0.5605  acc: 0.5172    eval auc: 0.4657  acc: 0.4862    test auc: 0.4587  acc: 0.4841, time: 0.5196
epoch 4    train auc: 0.6059  acc: 0.5229    eval auc: 0.4772  acc: 0.4924    test auc: 0.4779  acc: 0.4947, time: 0.5227
epoch 5    train auc: 0.6927  acc: 0.6041    eval auc: 0.5783  acc: 0.5812    test auc: 0.5823  acc: 0.5899, time: 0.5166
epoch 6    train auc: 0.7842  acc: 0.6840    eval auc: 0.7056  acc: 0.6651    test auc: 0.7088  acc: 0.6753, time: 0.5121
epoch 7    train auc: 0.8290  acc: 0.7108    eval auc: 0.7458  acc: 0.6918    test auc: 0.7468  acc: 0.6987, time: 0.5130
epoch 8    train auc: 0.8584  acc: 0.7547    eval auc: 0.7719  acc: 0.7271    test auc: 0.7751  acc: 0.7333, time: 0.5124
epoch 9    train auc: 0.8700  acc: 0.7758    eval auc: 0.7820  acc: 0.7374    test auc: 0.7855  acc: 0.7421, time: 0.5109
epoch 10    train auc: 0.8753  acc: 0.7800    eval auc: 0.7870  acc: 0.7374    test auc: 0.7892  acc: 0.7461, time: 0.5140
epoch 11    train auc: 0.8784  acc: 0.7832    eval auc: 0.7900  acc: 0.7369    test auc: 0.7922  acc: 0.7465, time: 0.5204
epoch 12    train auc: 0.8804  acc: 0.7839    eval auc: 0.7917  acc: 0.7331    test auc: 0.7939  acc: 0.7420, time: 0.5120
epoch 13    train auc: 0.8816  acc: 0.7849    eval auc: 0.7931  acc: 0.7323    test auc: 0.7953  acc: 0.7387, time: 0.5063
epoch 14    train auc: 0.8828  acc: 0.7852    eval auc: 0.7938  acc: 0.7320    test auc: 0.7963  acc: 0.7389, time: 0.4990
epoch 15    train auc: 0.8834  acc: 0.7861    eval auc: 0.7943  acc: 0.7310    test auc: 0.7971  acc: 0.7355, time: 0.5056
epoch 16    train auc: 0.8839  acc: 0.7870    eval auc: 0.7946  acc: 0.7302    test auc: 0.7975  acc: 0.7324, time: 0.5035
epoch 17    train auc: 0.8844  acc: 0.7874    eval auc: 0.7949  acc: 0.7287    test auc: 0.7978  acc: 0.7320, time: 0.5172
epoch 18    train auc: 0.8848  acc: 0.7876    eval auc: 0.7946  acc: 0.7278    test auc: 0.7976  acc: 0.7294, time: 0.5132
epoch 19    train auc: 0.8854  acc: 0.7881    eval auc: 0.7947  acc: 0.7265    test auc: 0.7976  acc: 0.7294, time: 0.4972
epoch 20    train auc: 0.8856  acc: 0.7872    eval auc: 0.7944  acc: 0.7264    test auc: 0.7972  acc: 0.7276, time: 0.5584
epoch 21    train auc: 0.8861  acc: 0.7875    eval auc: 0.7942  acc: 0.7257    test auc: 0.7972  acc: 0.7263, time: 0.6074
epoch 22    train auc: 0.8865  acc: 0.7864    eval auc: 0.7938  acc: 0.7250    test auc: 0.7967  acc: 0.7245, time: 0.5304
epoch 23    train auc: 0.8867  acc: 0.7863    eval auc: 0.7934  acc: 0.7243    test auc: 0.7964  acc: 0.7236, time: 0.5225
epoch 24    train auc: 0.8876  acc: 0.7865    eval auc: 0.7934  acc: 0.7235    test auc: 0.7964  acc: 0.7237, time: 0.5267
epoch 25    train auc: 0.8880  acc: 0.7861    eval auc: 0.7932  acc: 0.7237    test auc: 0.7962  acc: 0.7219, time: 0.5640
epoch 26    train auc: 0.8884  acc: 0.7855    eval auc: 0.7926  acc: 0.7226    test auc: 0.7958  acc: 0.7198, time: 0.6620
epoch 27    train auc: 0.8887  acc: 0.7855    eval auc: 0.7922  acc: 0.7218    test auc: 0.7955  acc: 0.7183, time: 0.6540
epoch 28    train auc: 0.8892  acc: 0.7853    eval auc: 0.7919  acc: 0.7205    test auc: 0.7952  acc: 0.7173, time: 0.5880
epoch 29    train auc: 0.8900  acc: 0.7852    eval auc: 0.7920  acc: 0.7207    test auc: 0.7951  acc: 0.7180, time: 0.6890
epoch 30    train auc: 0.8904  acc: 0.7853    eval auc: 0.7917  acc: 0.7206    test auc: 0.7950  acc: 0.7172, time: 0.5980
epoch 31    train auc: 0.8914  acc: 0.7862    eval auc: 0.7918  acc: 0.7205    test auc: 0.7951  acc: 0.7174, time: 0.5390
epoch 32    train auc: 0.8916  acc: 0.7850    eval auc: 0.7913  acc: 0.7196    test auc: 0.7947  acc: 0.7164, time: 0.5340
epoch 33    train auc: 0.8916  acc: 0.7839    eval auc: 0.7907  acc: 0.7161    test auc: 0.7942  acc: 0.7135, time: 0.5295
epoch 34    train auc: 0.8922  acc: 0.7839    eval auc: 0.7905  acc: 0.7157    test auc: 0.7940  acc: 0.7133, time: 0.4868
epoch 35    train auc: 0.8922  acc: 0.7834    eval auc: 0.7898  acc: 0.7126    test auc: 0.7935  acc: 0.7092, time: 0.5181
epoch 36    train auc: 0.8929  acc: 0.7833    eval auc: 0.7898  acc: 0.7124    test auc: 0.7934  acc: 0.7091, time: 0.5114
epoch 37    train auc: 0.8932  acc: 0.7832    eval auc: 0.7895  acc: 0.7114    test auc: 0.7931  acc: 0.7072, time: 0.4937
epoch 38    train auc: 0.8939  acc: 0.7831    eval auc: 0.7895  acc: 0.7117    test auc: 0.7931  acc: 0.7072, time: 0.5572
epoch 39    train auc: 0.8941  acc: 0.7830    eval auc: 0.7891  acc: 0.7100    test auc: 0.7928  acc: 0.7060, time: 0.6080
epoch 40    train auc: 0.8938  acc: 0.7811    eval auc: 0.7882  acc: 0.7056    test auc: 0.7920  acc: 0.7020, time: 0.6059
epoch 41    train auc: 0.8940  acc: 0.7808    eval auc: 0.7879  acc: 0.7056    test auc: 0.7918  acc: 0.7015, time: 0.6020
epoch 42    train auc: 0.8935  acc: 0.7796    eval auc: 0.7869  acc: 0.7028    test auc: 0.7910  acc: 0.6995, time: 0.6110
epoch 43    train auc: 0.8933  acc: 0.7783    eval auc: 0.7862  acc: 0.7003    test auc: 0.7905  acc: 0.6982, time: 0.6050
epoch 44    train auc: 0.8938  acc: 0.7788    eval auc: 0.7862  acc: 0.7006    test auc: 0.7905  acc: 0.6993, time: 0.5750
epoch 45    train auc: 0.8938  acc: 0.7783    eval auc: 0.7857  acc: 0.7001    test auc: 0.7901  acc: 0.6985, time: 0.5700
epoch 46    train auc: 0.8932  acc: 0.7766    eval auc: 0.7848  acc: 0.6975    test auc: 0.7893  acc: 0.6942, time: 0.5620
epoch 47    train auc: 0.8929  acc: 0.7750    eval auc: 0.7842  acc: 0.6964    test auc: 0.7888  acc: 0.6929, time: 0.5700
epoch 48    train auc: 0.8932  acc: 0.7746    eval auc: 0.7842  acc: 0.6964    test auc: 0.7887  acc: 0.6919, time: 0.5689
epoch 49    train auc: 0.8935  acc: 0.7750    eval auc: 0.7842  acc: 0.6974    test auc: 0.7888  acc: 0.6926, time: 0.5630
avg time per epoch : 0.5528092765808106
--- 33.643759965896606 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:29:06.062416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:29:06.062763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4878  acc: 0.4934    eval auc: 0.5198  acc: 0.5119    test auc: 0.5169  acc: 0.5080, time: 0.8400
epoch 1    train auc: 0.5069  acc: 0.5084    eval auc: 0.4876  acc: 0.4858    test auc: 0.4914  acc: 0.4891, time: 0.5802
epoch 2    train auc: 0.5529  acc: 0.5145    eval auc: 0.4215  acc: 0.4785    test auc: 0.4215  acc: 0.4780, time: 0.5319
epoch 3    train auc: 0.5721  acc: 0.5220    eval auc: 0.3945  acc: 0.4685    test auc: 0.3941  acc: 0.4656, time: 0.5485
epoch 4    train auc: 0.5812  acc: 0.5496    eval auc: 0.3842  acc: 0.4296    test auc: 0.3790  acc: 0.4212, time: 0.5659
epoch 5    train auc: 0.7110  acc: 0.6380    eval auc: 0.5294  acc: 0.5115    test auc: 0.5415  acc: 0.5146, time: 0.5314
epoch 6    train auc: 0.8762  acc: 0.7690    eval auc: 0.7577  acc: 0.7314    test auc: 0.7623  acc: 0.7380, time: 0.5121
epoch 7    train auc: 0.8941  acc: 0.7889    eval auc: 0.7729  acc: 0.7288    test auc: 0.7759  acc: 0.7330, time: 0.5069
epoch 8    train auc: 0.9052  acc: 0.8034    eval auc: 0.7802  acc: 0.7167    test auc: 0.7823  acc: 0.7096, time: 0.5118
epoch 9    train auc: 0.9120  acc: 0.8059    eval auc: 0.7800  acc: 0.7167    test auc: 0.7807  acc: 0.7081, time: 0.5174
epoch 10    train auc: 0.9163  acc: 0.8050    eval auc: 0.7782  acc: 0.7190    test auc: 0.7772  acc: 0.7108, time: 0.5200
epoch 11    train auc: 0.9204  acc: 0.8127    eval auc: 0.7774  acc: 0.7118    test auc: 0.7756  acc: 0.7049, time: 0.5311
epoch 12    train auc: 0.9236  acc: 0.8166    eval auc: 0.7726  acc: 0.7045    test auc: 0.7699  acc: 0.6984, time: 0.5205
epoch 13    train auc: 0.9258  acc: 0.8203    eval auc: 0.7748  acc: 0.7055    test auc: 0.7719  acc: 0.7002, time: 0.5186
epoch 14    train auc: 0.9280  acc: 0.8236    eval auc: 0.7727  acc: 0.7026    test auc: 0.7699  acc: 0.6954, time: 0.5231
epoch 15    train auc: 0.9294  acc: 0.8258    eval auc: 0.7733  acc: 0.7027    test auc: 0.7705  acc: 0.6959, time: 0.5460
epoch 16    train auc: 0.9308  acc: 0.8273    eval auc: 0.7722  acc: 0.7026    test auc: 0.7694  acc: 0.6956, time: 0.5360
epoch 17    train auc: 0.9318  acc: 0.8276    eval auc: 0.7721  acc: 0.7027    test auc: 0.7691  acc: 0.6968, time: 0.5253
epoch 18    train auc: 0.9327  acc: 0.8274    eval auc: 0.7713  acc: 0.7019    test auc: 0.7685  acc: 0.6995, time: 0.5310
epoch 19    train auc: 0.9338  acc: 0.8303    eval auc: 0.7711  acc: 0.6978    test auc: 0.7686  acc: 0.6978, time: 0.5328
epoch 20    train auc: 0.9353  acc: 0.8329    eval auc: 0.7677  acc: 0.6943    test auc: 0.7655  acc: 0.6908, time: 0.5243
epoch 21    train auc: 0.9355  acc: 0.8315    eval auc: 0.7694  acc: 0.6961    test auc: 0.7673  acc: 0.6957, time: 0.5161
epoch 22    train auc: 0.9365  acc: 0.8334    eval auc: 0.7678  acc: 0.6955    test auc: 0.7657  acc: 0.6943, time: 0.5114
epoch 23    train auc: 0.9374  acc: 0.8349    eval auc: 0.7661  acc: 0.6941    test auc: 0.7641  acc: 0.6923, time: 0.5229
epoch 24    train auc: 0.9380  acc: 0.8365    eval auc: 0.7655  acc: 0.6944    test auc: 0.7636  acc: 0.6903, time: 0.5178
epoch 25    train auc: 0.9384  acc: 0.8362    eval auc: 0.7648  acc: 0.6931    test auc: 0.7628  acc: 0.6923, time: 0.5201
epoch 26    train auc: 0.9396  acc: 0.8379    eval auc: 0.7613  acc: 0.6885    test auc: 0.7596  acc: 0.6828, time: 0.5242
epoch 27    train auc: 0.9393  acc: 0.8363    eval auc: 0.7641  acc: 0.6912    test auc: 0.7623  acc: 0.6912, time: 0.5215
epoch 28    train auc: 0.9402  acc: 0.8394    eval auc: 0.7625  acc: 0.6910    test auc: 0.7608  acc: 0.6876, time: 0.5155
epoch 29    train auc: 0.9408  acc: 0.8393    eval auc: 0.7617  acc: 0.6892    test auc: 0.7597  acc: 0.6847, time: 0.5129
epoch 30    train auc: 0.9408  acc: 0.8399    eval auc: 0.7627  acc: 0.6918    test auc: 0.7605  acc: 0.6852, time: 0.5305
epoch 31    train auc: 0.9413  acc: 0.8409    eval auc: 0.7604  acc: 0.6890    test auc: 0.7586  acc: 0.6852, time: 0.5833
epoch 32    train auc: 0.9423  acc: 0.8426    eval auc: 0.7591  acc: 0.6879    test auc: 0.7571  acc: 0.6832, time: 0.5553
epoch 33    train auc: 0.9424  acc: 0.8428    eval auc: 0.7600  acc: 0.6891    test auc: 0.7585  acc: 0.6834, time: 0.5580
epoch 34    train auc: 0.9423  acc: 0.8413    eval auc: 0.7587  acc: 0.6871    test auc: 0.7565  acc: 0.6853, time: 0.5539
epoch 35    train auc: 0.9438  acc: 0.8452    eval auc: 0.7566  acc: 0.6821    test auc: 0.7555  acc: 0.6806, time: 0.5301
epoch 36    train auc: 0.9442  acc: 0.8452    eval auc: 0.7566  acc: 0.6836    test auc: 0.7552  acc: 0.6815, time: 0.5215
epoch 37    train auc: 0.9446  acc: 0.8458    eval auc: 0.7545  acc: 0.6800    test auc: 0.7534  acc: 0.6797, time: 0.5285
epoch 38    train auc: 0.9445  acc: 0.8455    eval auc: 0.7564  acc: 0.6837    test auc: 0.7545  acc: 0.6806, time: 0.5222
epoch 39    train auc: 0.9455  acc: 0.8460    eval auc: 0.7548  acc: 0.6826    test auc: 0.7534  acc: 0.6793, time: 0.5230
epoch 40    train auc: 0.9460  acc: 0.8485    eval auc: 0.7540  acc: 0.6825    test auc: 0.7523  acc: 0.6775, time: 0.5149
epoch 41    train auc: 0.9463  acc: 0.8477    eval auc: 0.7549  acc: 0.6831    test auc: 0.7532  acc: 0.6791, time: 0.5173
epoch 42    train auc: 0.9476  acc: 0.8504    eval auc: 0.7522  acc: 0.6800    test auc: 0.7505  acc: 0.6765, time: 0.5146
epoch 43    train auc: 0.9479  acc: 0.8496    eval auc: 0.7530  acc: 0.6812    test auc: 0.7514  acc: 0.6745, time: 0.5268
epoch 44    train auc: 0.9485  acc: 0.8515    eval auc: 0.7548  acc: 0.6817    test auc: 0.7532  acc: 0.6769, time: 0.5132
epoch 45    train auc: 0.9496  acc: 0.8512    eval auc: 0.7529  acc: 0.6811    test auc: 0.7509  acc: 0.6754, time: 0.5196
epoch 46    train auc: 0.9496  acc: 0.8514    eval auc: 0.7509  acc: 0.6792    test auc: 0.7492  acc: 0.6759, time: 0.5144
epoch 47    train auc: 0.9527  acc: 0.8578    eval auc: 0.7458  acc: 0.6713    test auc: 0.7448  acc: 0.6689, time: 0.5120
epoch 48    train auc: 0.9539  acc: 0.8593    eval auc: 0.7483  acc: 0.6743    test auc: 0.7475  acc: 0.6703, time: 0.5117
epoch 49    train auc: 0.9558  acc: 0.8622    eval auc: 0.7461  acc: 0.6717    test auc: 0.7466  acc: 0.6699, time: 0.5711
avg time per epoch : 0.5347840023040772
--- 32.36285614967346 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:29:38.365445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:29:38.365806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5156  acc: 0.5079    eval auc: 0.4847  acc: 0.4979    test auc: 0.4816  acc: 0.4867, time: 0.8679
epoch 1    train auc: 0.5271  acc: 0.5137    eval auc: 0.4666  acc: 0.4833    test auc: 0.4643  acc: 0.4796, time: 0.5650
epoch 2    train auc: 0.5350  acc: 0.5228    eval auc: 0.4561  acc: 0.4717    test auc: 0.4439  acc: 0.4625, time: 0.5300
epoch 3    train auc: 0.5495  acc: 0.5325    eval auc: 0.4343  acc: 0.4600    test auc: 0.4212  acc: 0.4439, time: 0.5690
epoch 4    train auc: 0.5607  acc: 0.5414    eval auc: 0.4179  acc: 0.4455    test auc: 0.4051  acc: 0.4333, time: 0.5607
epoch 5    train auc: 0.5697  acc: 0.5472    eval auc: 0.4066  acc: 0.4359    test auc: 0.3933  acc: 0.4267, time: 0.5420
epoch 6    train auc: 0.5782  acc: 0.5540    eval auc: 0.4008  acc: 0.4293    test auc: 0.3868  acc: 0.4205, time: 0.5624
epoch 7    train auc: 0.5963  acc: 0.5665    eval auc: 0.4073  acc: 0.4318    test auc: 0.3947  acc: 0.4241, time: 0.5443
epoch 8    train auc: 0.6817  acc: 0.6280    eval auc: 0.4932  acc: 0.4884    test auc: 0.4892  acc: 0.4862, time: 0.5332
epoch 9    train auc: 0.7863  acc: 0.7114    eval auc: 0.6319  acc: 0.6125    test auc: 0.6384  acc: 0.6153, time: 0.5166
epoch 10    train auc: 0.8466  acc: 0.7507    eval auc: 0.7058  acc: 0.6906    test auc: 0.7128  acc: 0.6955, time: 0.5029
epoch 11    train auc: 0.8708  acc: 0.7675    eval auc: 0.7387  acc: 0.7200    test auc: 0.7449  acc: 0.7233, time: 0.5166
epoch 12    train auc: 0.8813  acc: 0.7804    eval auc: 0.7530  acc: 0.7304    test auc: 0.7586  acc: 0.7334, time: 0.5263
epoch 13    train auc: 0.8873  acc: 0.7886    eval auc: 0.7606  acc: 0.7336    test auc: 0.7654  acc: 0.7362, time: 0.5824
epoch 14    train auc: 0.8917  acc: 0.7916    eval auc: 0.7642  acc: 0.7347    test auc: 0.7684  acc: 0.7361, time: 0.5100
epoch 15    train auc: 0.8953  acc: 0.7973    eval auc: 0.7669  acc: 0.7330    test auc: 0.7704  acc: 0.7310, time: 0.5522
epoch 16    train auc: 0.8985  acc: 0.7996    eval auc: 0.7685  acc: 0.7314    test auc: 0.7713  acc: 0.7294, time: 0.5529
epoch 17    train auc: 0.9014  acc: 0.8040    eval auc: 0.7701  acc: 0.7277    test auc: 0.7723  acc: 0.7272, time: 0.5560
epoch 18    train auc: 0.9040  acc: 0.8081    eval auc: 0.7708  acc: 0.7231    test auc: 0.7725  acc: 0.7217, time: 0.5453
epoch 19    train auc: 0.9064  acc: 0.8087    eval auc: 0.7716  acc: 0.7231    test auc: 0.7725  acc: 0.7230, time: 0.5487
epoch 20    train auc: 0.9085  acc: 0.8125    eval auc: 0.7722  acc: 0.7187    test auc: 0.7726  acc: 0.7198, time: 0.5539
epoch 21    train auc: 0.9105  acc: 0.8144    eval auc: 0.7731  acc: 0.7193    test auc: 0.7730  acc: 0.7198, time: 0.5714
epoch 22    train auc: 0.9123  acc: 0.8155    eval auc: 0.7736  acc: 0.7189    test auc: 0.7730  acc: 0.7193, time: 0.5519
epoch 23    train auc: 0.9139  acc: 0.8192    eval auc: 0.7734  acc: 0.7163    test auc: 0.7726  acc: 0.7156, time: 0.5240
epoch 24    train auc: 0.9155  acc: 0.8183    eval auc: 0.7744  acc: 0.7187    test auc: 0.7732  acc: 0.7185, time: 0.5324
epoch 25    train auc: 0.9169  acc: 0.8191    eval auc: 0.7750  acc: 0.7198    test auc: 0.7736  acc: 0.7180, time: 0.5146
epoch 26    train auc: 0.9182  acc: 0.8218    eval auc: 0.7746  acc: 0.7166    test auc: 0.7729  acc: 0.7138, time: 0.5138
epoch 27    train auc: 0.9194  acc: 0.8233    eval auc: 0.7747  acc: 0.7164    test auc: 0.7727  acc: 0.7133, time: 0.5050
epoch 28    train auc: 0.9206  acc: 0.8240    eval auc: 0.7747  acc: 0.7158    test auc: 0.7726  acc: 0.7134, time: 0.5213
epoch 29    train auc: 0.9215  acc: 0.8230    eval auc: 0.7754  acc: 0.7179    test auc: 0.7730  acc: 0.7143, time: 0.5089
epoch 30    train auc: 0.9226  acc: 0.8254    eval auc: 0.7748  acc: 0.7138    test auc: 0.7726  acc: 0.7107, time: 0.5134
epoch 31    train auc: 0.9235  acc: 0.8253    eval auc: 0.7749  acc: 0.7160    test auc: 0.7723  acc: 0.7117, time: 0.5239
epoch 32    train auc: 0.9243  acc: 0.8261    eval auc: 0.7749  acc: 0.7156    test auc: 0.7721  acc: 0.7106, time: 0.5428
epoch 33    train auc: 0.9251  acc: 0.8282    eval auc: 0.7749  acc: 0.7126    test auc: 0.7724  acc: 0.7109, time: 0.6029
epoch 34    train auc: 0.9258  acc: 0.8287    eval auc: 0.7747  acc: 0.7117    test auc: 0.7719  acc: 0.7094, time: 0.5620
epoch 35    train auc: 0.9266  acc: 0.8296    eval auc: 0.7741  acc: 0.7112    test auc: 0.7713  acc: 0.7085, time: 0.5408
epoch 36    train auc: 0.9273  acc: 0.8299    eval auc: 0.7738  acc: 0.7088    test auc: 0.7711  acc: 0.7088, time: 0.5337
epoch 37    train auc: 0.9279  acc: 0.8301    eval auc: 0.7738  acc: 0.7092    test auc: 0.7711  acc: 0.7083, time: 0.5260
epoch 38    train auc: 0.9285  acc: 0.8306    eval auc: 0.7735  acc: 0.7102    test auc: 0.7706  acc: 0.7078, time: 0.5830
epoch 39    train auc: 0.9291  acc: 0.8309    eval auc: 0.7733  acc: 0.7088    test auc: 0.7704  acc: 0.7075, time: 0.5745
epoch 40    train auc: 0.9297  acc: 0.8316    eval auc: 0.7731  acc: 0.7082    test auc: 0.7701  acc: 0.7067, time: 0.6670
epoch 41    train auc: 0.9300  acc: 0.8315    eval auc: 0.7738  acc: 0.7099    test auc: 0.7708  acc: 0.7075, time: 0.6040
epoch 42    train auc: 0.9309  acc: 0.8341    eval auc: 0.7716  acc: 0.7060    test auc: 0.7688  acc: 0.7049, time: 0.6410
epoch 43    train auc: 0.9312  acc: 0.8338    eval auc: 0.7723  acc: 0.7048    test auc: 0.7695  acc: 0.7065, time: 0.5899
epoch 44    train auc: 0.9317  acc: 0.8336    eval auc: 0.7721  acc: 0.7053    test auc: 0.7692  acc: 0.7061, time: 0.5545
epoch 45    train auc: 0.9322  acc: 0.8341    eval auc: 0.7716  acc: 0.7042    test auc: 0.7685  acc: 0.7058, time: 0.5138
epoch 46    train auc: 0.9327  acc: 0.8350    eval auc: 0.7709  acc: 0.7034    test auc: 0.7680  acc: 0.7036, time: 0.5113
epoch 47    train auc: 0.9330  acc: 0.8352    eval auc: 0.7713  acc: 0.7045    test auc: 0.7683  acc: 0.7048, time: 0.4982
epoch 48    train auc: 0.9335  acc: 0.8355    eval auc: 0.7708  acc: 0.7039    test auc: 0.7676  acc: 0.7039, time: 0.5236
epoch 49    train auc: 0.9336  acc: 0.8345    eval auc: 0.7719  acc: 0.7062    test auc: 0.7687  acc: 0.7066, time: 0.7400
avg time per epoch : 0.5565527296066284
--- 33.84437918663025 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:30:12.401129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:30:12.401453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4932  acc: 0.4958    eval auc: 0.5142  acc: 0.5081    test auc: 0.5115  acc: 0.5079, time: 0.8078
epoch 1    train auc: 0.8198  acc: 0.7028    eval auc: 0.7404  acc: 0.6834    test auc: 0.7453  acc: 0.6984, time: 0.5168
epoch 2    train auc: 0.8864  acc: 0.7620    eval auc: 0.7897  acc: 0.7328    test auc: 0.7911  acc: 0.7453, time: 0.5163
epoch 3    train auc: 0.8985  acc: 0.7909    eval auc: 0.7957  acc: 0.7453    test auc: 0.7960  acc: 0.7464, time: 0.5156
epoch 4    train auc: 0.9069  acc: 0.8065    eval auc: 0.7961  acc: 0.7360    test auc: 0.7958  acc: 0.7285, time: 0.5130
epoch 5    train auc: 0.9143  acc: 0.8136    eval auc: 0.7942  acc: 0.7275    test auc: 0.7929  acc: 0.7179, time: 0.5367
epoch 6    train auc: 0.9190  acc: 0.8182    eval auc: 0.7920  acc: 0.7218    test auc: 0.7902  acc: 0.7147, time: 0.5366
epoch 7    train auc: 0.9231  acc: 0.8216    eval auc: 0.7886  acc: 0.7146    test auc: 0.7868  acc: 0.7102, time: 0.5334
epoch 8    train auc: 0.9252  acc: 0.8204    eval auc: 0.7820  acc: 0.7021    test auc: 0.7806  acc: 0.6929, time: 0.5165
epoch 9    train auc: 0.9287  acc: 0.8254    eval auc: 0.7834  acc: 0.7125    test auc: 0.7810  acc: 0.7081, time: 0.5421
epoch 10    train auc: 0.9303  acc: 0.8274    eval auc: 0.7815  acc: 0.7106    test auc: 0.7797  acc: 0.7050, time: 0.5327
epoch 11    train auc: 0.9321  acc: 0.8286    eval auc: 0.7800  acc: 0.7102    test auc: 0.7779  acc: 0.7061, time: 0.5295
epoch 12    train auc: 0.9335  acc: 0.8312    eval auc: 0.7752  acc: 0.7006    test auc: 0.7737  acc: 0.6991, time: 0.5177
epoch 13    train auc: 0.9344  acc: 0.8321    eval auc: 0.7774  acc: 0.7058    test auc: 0.7753  acc: 0.7017, time: 0.5305
epoch 14    train auc: 0.9345  acc: 0.8315    eval auc: 0.7722  acc: 0.6959    test auc: 0.7714  acc: 0.6932, time: 0.5068
epoch 15    train auc: 0.9363  acc: 0.8340    eval auc: 0.7738  acc: 0.7017    test auc: 0.7726  acc: 0.7002, time: 0.5065
epoch 16    train auc: 0.9359  acc: 0.8327    eval auc: 0.7708  acc: 0.6957    test auc: 0.7707  acc: 0.6939, time: 0.4958
epoch 17    train auc: 0.9379  acc: 0.8354    eval auc: 0.7717  acc: 0.7026    test auc: 0.7695  acc: 0.6981, time: 0.4966
epoch 18    train auc: 0.9383  acc: 0.8356    eval auc: 0.7703  acc: 0.6981    test auc: 0.7692  acc: 0.6970, time: 0.5019
epoch 19    train auc: 0.9384  acc: 0.8343    eval auc: 0.7715  acc: 0.7015    test auc: 0.7704  acc: 0.6993, time: 0.4938
epoch 20    train auc: 0.9385  acc: 0.8354    eval auc: 0.7680  acc: 0.6950    test auc: 0.7676  acc: 0.6961, time: 0.5360
epoch 21    train auc: 0.9398  acc: 0.8370    eval auc: 0.7687  acc: 0.6997    test auc: 0.7677  acc: 0.6981, time: 0.4965
epoch 22    train auc: 0.9400  acc: 0.8376    eval auc: 0.7683  acc: 0.6968    test auc: 0.7677  acc: 0.6980, time: 0.6240
epoch 23    train auc: 0.9404  acc: 0.8379    eval auc: 0.7666  acc: 0.6963    test auc: 0.7662  acc: 0.6962, time: 0.5940
epoch 24    train auc: 0.9410  acc: 0.8378    eval auc: 0.7670  acc: 0.6994    test auc: 0.7661  acc: 0.6980, time: 0.5453
epoch 25    train auc: 0.9411  acc: 0.8381    eval auc: 0.7649  acc: 0.6951    test auc: 0.7650  acc: 0.6948, time: 0.5403
epoch 26    train auc: 0.9420  acc: 0.8387    eval auc: 0.7648  acc: 0.6954    test auc: 0.7639  acc: 0.6942, time: 0.5297
epoch 27    train auc: 0.9420  acc: 0.8393    eval auc: 0.7651  acc: 0.6962    test auc: 0.7645  acc: 0.6952, time: 0.5288
epoch 28    train auc: 0.9426  acc: 0.8397    eval auc: 0.7641  acc: 0.6958    test auc: 0.7629  acc: 0.6942, time: 0.5271
epoch 29    train auc: 0.9425  acc: 0.8383    eval auc: 0.7650  acc: 0.6977    test auc: 0.7636  acc: 0.6954, time: 0.5197
epoch 30    train auc: 0.9437  acc: 0.8413    eval auc: 0.7633  acc: 0.6945    test auc: 0.7623  acc: 0.6929, time: 0.5139
epoch 31    train auc: 0.9437  acc: 0.8395    eval auc: 0.7625  acc: 0.6948    test auc: 0.7617  acc: 0.6939, time: 0.5074
epoch 32    train auc: 0.9425  acc: 0.8363    eval auc: 0.7635  acc: 0.6971    test auc: 0.7625  acc: 0.6955, time: 0.5140
epoch 33    train auc: 0.9440  acc: 0.8395    eval auc: 0.7625  acc: 0.6949    test auc: 0.7621  acc: 0.6947, time: 0.5142
epoch 34    train auc: 0.9446  acc: 0.8417    eval auc: 0.7612  acc: 0.6939    test auc: 0.7597  acc: 0.6916, time: 0.5147
epoch 35    train auc: 0.9454  acc: 0.8423    eval auc: 0.7611  acc: 0.6937    test auc: 0.7602  acc: 0.6919, time: 0.5047
epoch 36    train auc: 0.9462  acc: 0.8432    eval auc: 0.7602  acc: 0.6921    test auc: 0.7595  acc: 0.6925, time: 0.5286
epoch 37    train auc: 0.9467  acc: 0.8439    eval auc: 0.7598  acc: 0.6918    test auc: 0.7588  acc: 0.6919, time: 0.5214
epoch 38    train auc: 0.9462  acc: 0.8415    eval auc: 0.7602  acc: 0.6923    test auc: 0.7591  acc: 0.6912, time: 0.4973
epoch 39    train auc: 0.9473  acc: 0.8445    eval auc: 0.7598  acc: 0.6930    test auc: 0.7588  acc: 0.6930, time: 0.5057
epoch 40    train auc: 0.9472  acc: 0.8425    eval auc: 0.7599  acc: 0.6935    test auc: 0.7584  acc: 0.6925, time: 0.5004
epoch 41    train auc: 0.9484  acc: 0.8447    eval auc: 0.7598  acc: 0.6925    test auc: 0.7584  acc: 0.6925, time: 0.5000
epoch 42    train auc: 0.9497  acc: 0.8466    eval auc: 0.7584  acc: 0.6915    test auc: 0.7567  acc: 0.6908, time: 0.4872
epoch 43    train auc: 0.9497  acc: 0.8456    eval auc: 0.7592  acc: 0.6926    test auc: 0.7578  acc: 0.6947, time: 0.4981
epoch 44    train auc: 0.9503  acc: 0.8460    eval auc: 0.7588  acc: 0.6928    test auc: 0.7572  acc: 0.6943, time: 0.5247
epoch 45    train auc: 0.9516  acc: 0.8487    eval auc: 0.7576  acc: 0.6919    test auc: 0.7554  acc: 0.6915, time: 0.5039
epoch 46    train auc: 0.9510  acc: 0.8462    eval auc: 0.7581  acc: 0.6932    test auc: 0.7558  acc: 0.6931, time: 0.5394
epoch 47    train auc: 0.9536  acc: 0.8510    eval auc: 0.7557  acc: 0.6903    test auc: 0.7539  acc: 0.6921, time: 0.5925
epoch 48    train auc: 0.9545  acc: 0.8527    eval auc: 0.7561  acc: 0.6902    test auc: 0.7541  acc: 0.6932, time: 0.6390
epoch 49    train auc: 0.9552  acc: 0.8537    eval auc: 0.7555  acc: 0.6906    test auc: 0.7532  acc: 0.6917, time: 0.5384
avg time per epoch : 0.5306696128845215
--- 32.57191205024719 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:30:44.831442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:30:44.831767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5118  acc: 0.5092    eval auc: 0.5134  acc: 0.5090    test auc: 0.5120  acc: 0.5128, time: 0.8851
epoch 1    train auc: 0.4907  acc: 0.4914    eval auc: 0.5101  acc: 0.5011    test auc: 0.5122  acc: 0.5032, time: 0.5211
epoch 2    train auc: 0.4932  acc: 0.4953    eval auc: 0.5127  acc: 0.4976    test auc: 0.5120  acc: 0.4979, time: 0.4907
epoch 3    train auc: 0.5469  acc: 0.5239    eval auc: 0.4429  acc: 0.4777    test auc: 0.4614  acc: 0.4819, time: 0.5381
epoch 4    train auc: 0.6179  acc: 0.5462    eval auc: 0.4876  acc: 0.4832    test auc: 0.5002  acc: 0.4864, time: 0.4897
epoch 5    train auc: 0.7428  acc: 0.6571    eval auc: 0.6302  acc: 0.6152    test auc: 0.6486  acc: 0.6226, time: 0.4999
epoch 6    train auc: 0.8232  acc: 0.7210    eval auc: 0.7302  acc: 0.6961    test auc: 0.7400  acc: 0.7089, time: 0.4931
epoch 7    train auc: 0.8602  acc: 0.7572    eval auc: 0.7683  acc: 0.7254    test auc: 0.7715  acc: 0.7380, time: 0.5265
epoch 8    train auc: 0.8738  acc: 0.7809    eval auc: 0.7822  acc: 0.7346    test auc: 0.7838  acc: 0.7381, time: 0.4992
epoch 9    train auc: 0.8797  acc: 0.7853    eval auc: 0.7875  acc: 0.7367    test auc: 0.7890  acc: 0.7369, time: 0.5360
epoch 10    train auc: 0.8835  acc: 0.7868    eval auc: 0.7906  acc: 0.7368    test auc: 0.7917  acc: 0.7369, time: 0.5341
epoch 11    train auc: 0.8858  acc: 0.7890    eval auc: 0.7921  acc: 0.7349    test auc: 0.7936  acc: 0.7343, time: 0.4879
epoch 12    train auc: 0.8873  acc: 0.7901    eval auc: 0.7930  acc: 0.7321    test auc: 0.7949  acc: 0.7321, time: 0.4902
epoch 13    train auc: 0.8882  acc: 0.7901    eval auc: 0.7933  acc: 0.7297    test auc: 0.7954  acc: 0.7290, time: 0.5355
epoch 14    train auc: 0.8893  acc: 0.7899    eval auc: 0.7943  acc: 0.7295    test auc: 0.7965  acc: 0.7300, time: 0.5213
epoch 15    train auc: 0.8899  acc: 0.7894    eval auc: 0.7942  acc: 0.7275    test auc: 0.7966  acc: 0.7259, time: 0.5481
epoch 16    train auc: 0.8902  acc: 0.7888    eval auc: 0.7940  acc: 0.7250    test auc: 0.7963  acc: 0.7235, time: 0.6160
epoch 17    train auc: 0.8904  acc: 0.7876    eval auc: 0.7939  acc: 0.7237    test auc: 0.7962  acc: 0.7225, time: 0.5990
epoch 18    train auc: 0.8905  acc: 0.7874    eval auc: 0.7932  acc: 0.7207    test auc: 0.7955  acc: 0.7197, time: 0.5750
epoch 19    train auc: 0.8908  acc: 0.7871    eval auc: 0.7932  acc: 0.7190    test auc: 0.7952  acc: 0.7184, time: 0.5970
epoch 20    train auc: 0.8907  acc: 0.7856    eval auc: 0.7924  acc: 0.7163    test auc: 0.7945  acc: 0.7160, time: 0.5970
epoch 21    train auc: 0.8910  acc: 0.7850    eval auc: 0.7920  acc: 0.7167    test auc: 0.7940  acc: 0.7151, time: 0.5378
epoch 22    train auc: 0.8912  acc: 0.7846    eval auc: 0.7916  acc: 0.7150    test auc: 0.7935  acc: 0.7133, time: 0.5930
epoch 23    train auc: 0.8910  acc: 0.7832    eval auc: 0.7907  acc: 0.7121    test auc: 0.7927  acc: 0.7089, time: 0.6600
epoch 24    train auc: 0.8914  acc: 0.7831    eval auc: 0.7907  acc: 0.7128    test auc: 0.7925  acc: 0.7093, time: 0.6030
epoch 25    train auc: 0.8914  acc: 0.7826    eval auc: 0.7902  acc: 0.7111    test auc: 0.7919  acc: 0.7070, time: 0.5139
epoch 26    train auc: 0.8911  acc: 0.7816    eval auc: 0.7890  acc: 0.7060    test auc: 0.7908  acc: 0.7026, time: 0.5190
epoch 27    train auc: 0.8910  acc: 0.7809    eval auc: 0.7882  acc: 0.7047    test auc: 0.7898  acc: 0.6995, time: 0.5047
epoch 28    train auc: 0.8908  acc: 0.7801    eval auc: 0.7875  acc: 0.7035    test auc: 0.7891  acc: 0.6981, time: 0.4999
epoch 29    train auc: 0.8907  acc: 0.7796    eval auc: 0.7870  acc: 0.7036    test auc: 0.7884  acc: 0.6977, time: 0.5018
epoch 30    train auc: 0.8905  acc: 0.7788    eval auc: 0.7863  acc: 0.7023    test auc: 0.7877  acc: 0.6969, time: 0.5095
epoch 31    train auc: 0.8905  acc: 0.7784    eval auc: 0.7860  acc: 0.7016    test auc: 0.7873  acc: 0.6970, time: 0.5173
epoch 32    train auc: 0.8902  acc: 0.7772    eval auc: 0.7851  acc: 0.7002    test auc: 0.7863  acc: 0.6934, time: 0.5108
epoch 33    train auc: 0.8897  acc: 0.7754    eval auc: 0.7842  acc: 0.6975    test auc: 0.7853  acc: 0.6911, time: 0.5040
epoch 34    train auc: 0.8895  acc: 0.7751    eval auc: 0.7836  acc: 0.6952    test auc: 0.7846  acc: 0.6899, time: 0.5118
epoch 35    train auc: 0.8892  acc: 0.7741    eval auc: 0.7828  acc: 0.6923    test auc: 0.7838  acc: 0.6874, time: 0.5201
epoch 36    train auc: 0.8888  acc: 0.7728    eval auc: 0.7821  acc: 0.6895    test auc: 0.7831  acc: 0.6865, time: 0.5428
epoch 37    train auc: 0.8885  acc: 0.7718    eval auc: 0.7815  acc: 0.6878    test auc: 0.7824  acc: 0.6831, time: 0.5185
epoch 38    train auc: 0.8889  acc: 0.7719    eval auc: 0.7815  acc: 0.6884    test auc: 0.7824  acc: 0.6825, time: 0.5079
epoch 39    train auc: 0.8885  acc: 0.7705    eval auc: 0.7808  acc: 0.6866    test auc: 0.7816  acc: 0.6814, time: 0.5029
epoch 40    train auc: 0.8880  acc: 0.7691    eval auc: 0.7798  acc: 0.6846    test auc: 0.7807  acc: 0.6784, time: 0.5195
epoch 41    train auc: 0.8881  acc: 0.7695    eval auc: 0.7796  acc: 0.6837    test auc: 0.7806  acc: 0.6779, time: 0.5215
epoch 42    train auc: 0.8877  acc: 0.7679    eval auc: 0.7787  acc: 0.6804    test auc: 0.7799  acc: 0.6747, time: 0.5125
epoch 43    train auc: 0.8868  acc: 0.7658    eval auc: 0.7776  acc: 0.6769    test auc: 0.7789  acc: 0.6716, time: 0.5189
epoch 44    train auc: 0.8864  acc: 0.7645    eval auc: 0.7770  acc: 0.6767    test auc: 0.7783  acc: 0.6707, time: 0.5208
epoch 45    train auc: 0.8868  acc: 0.7649    eval auc: 0.7770  acc: 0.6765    test auc: 0.7783  acc: 0.6708, time: 0.5236
epoch 46    train auc: 0.8859  acc: 0.7622    eval auc: 0.7758  acc: 0.6746    test auc: 0.7772  acc: 0.6676, time: 0.5153
epoch 47    train auc: 0.8859  acc: 0.7615    eval auc: 0.7754  acc: 0.6742    test auc: 0.7769  acc: 0.6673, time: 0.5217
epoch 48    train auc: 0.8856  acc: 0.7601    eval auc: 0.7750  acc: 0.6736    test auc: 0.7764  acc: 0.6641, time: 0.5126
epoch 49    train auc: 0.8856  acc: 0.7601    eval auc: 0.7747  acc: 0.6729    test auc: 0.7762  acc: 0.6636, time: 0.5147
avg time per epoch : 0.5368017482757569
--- 32.5216281414032 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:31:17.377937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:31:17.378260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4949  acc: 0.4991    eval auc: 0.5079  acc: 0.4971    test auc: 0.5077  acc: 0.5056, time: 0.8497
epoch 1    train auc: 0.5250  acc: 0.5122    eval auc: 0.4628  acc: 0.4820    test auc: 0.4618  acc: 0.4813, time: 0.5204
epoch 2    train auc: 0.5645  acc: 0.5469    eval auc: 0.4072  acc: 0.4280    test auc: 0.4024  acc: 0.4312, time: 0.5096
epoch 3    train auc: 0.5799  acc: 0.5563    eval auc: 0.3864  acc: 0.4219    test auc: 0.3795  acc: 0.4093, time: 0.5262
epoch 4    train auc: 0.5880  acc: 0.5619    eval auc: 0.3743  acc: 0.4085    test auc: 0.3679  acc: 0.4058, time: 0.5200
epoch 5    train auc: 0.5916  acc: 0.5645    eval auc: 0.3699  acc: 0.4075    test auc: 0.3633  acc: 0.3991, time: 0.5215
epoch 6    train auc: 0.5933  acc: 0.5658    eval auc: 0.3676  acc: 0.4050    test auc: 0.3609  acc: 0.3977, time: 0.5108
epoch 7    train auc: 0.5943  acc: 0.5664    eval auc: 0.3663  acc: 0.4035    test auc: 0.3598  acc: 0.3973, time: 0.5124
epoch 8    train auc: 0.5949  acc: 0.5666    eval auc: 0.3652  acc: 0.4025    test auc: 0.3596  acc: 0.3978, time: 0.5395
epoch 9    train auc: 0.5954  acc: 0.5668    eval auc: 0.3648  acc: 0.4039    test auc: 0.3590  acc: 0.3957, time: 0.5256
epoch 10    train auc: 0.5957  acc: 0.5668    eval auc: 0.3644  acc: 0.4025    test auc: 0.3588  acc: 0.3970, time: 0.5169
epoch 11    train auc: 0.5960  acc: 0.5669    eval auc: 0.3642  acc: 0.4023    test auc: 0.3583  acc: 0.3971, time: 0.5370
epoch 12    train auc: 0.5962  acc: 0.5668    eval auc: 0.3642  acc: 0.4019    test auc: 0.3579  acc: 0.3977, time: 0.5524
epoch 13    train auc: 0.5964  acc: 0.5669    eval auc: 0.3640  acc: 0.4038    test auc: 0.3577  acc: 0.3956, time: 0.5280
epoch 14    train auc: 0.5965  acc: 0.5669    eval auc: 0.3637  acc: 0.4031    test auc: 0.3578  acc: 0.3963, time: 0.5169
epoch 15    train auc: 0.5966  acc: 0.5669    eval auc: 0.3637  acc: 0.4024    test auc: 0.3577  acc: 0.3970, time: 0.5222
epoch 16    train auc: 0.5967  acc: 0.5669    eval auc: 0.3636  acc: 0.4032    test auc: 0.3577  acc: 0.3962, time: 0.5558
epoch 17    train auc: 0.5968  acc: 0.5669    eval auc: 0.3636  acc: 0.4051    test auc: 0.3575  acc: 0.3943, time: 0.5224
epoch 18    train auc: 0.5969  acc: 0.5669    eval auc: 0.3636  acc: 0.4022    test auc: 0.3575  acc: 0.3972, time: 0.5208
epoch 19    train auc: 0.5969  acc: 0.5669    eval auc: 0.3636  acc: 0.4036    test auc: 0.3574  acc: 0.3958, time: 0.5240
epoch 20    train auc: 0.5970  acc: 0.5669    eval auc: 0.3633  acc: 0.4012    test auc: 0.3576  acc: 0.3982, time: 0.5339
epoch 21    train auc: 0.5970  acc: 0.5669    eval auc: 0.3636  acc: 0.4048    test auc: 0.3574  acc: 0.3946, time: 0.6190
epoch 22    train auc: 0.5970  acc: 0.5669    eval auc: 0.3633  acc: 0.4025    test auc: 0.3576  acc: 0.3969, time: 0.5470
epoch 23    train auc: 0.5971  acc: 0.5669    eval auc: 0.3631  acc: 0.4025    test auc: 0.3578  acc: 0.3969, time: 0.5484
epoch 24    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4042    test auc: 0.3575  acc: 0.3952, time: 0.5538
epoch 25    train auc: 0.5971  acc: 0.5669    eval auc: 0.3631  acc: 0.4022    test auc: 0.3576  acc: 0.3972, time: 0.5612
epoch 26    train auc: 0.5971  acc: 0.5669    eval auc: 0.3631  acc: 0.4018    test auc: 0.3576  acc: 0.3976, time: 0.5783
epoch 27    train auc: 0.5971  acc: 0.5669    eval auc: 0.3629  acc: 0.4016    test auc: 0.3577  acc: 0.3978, time: 0.5600
epoch 28    train auc: 0.5971  acc: 0.5669    eval auc: 0.3628  acc: 0.4010    test auc: 0.3579  acc: 0.3984, time: 0.5370
epoch 29    train auc: 0.5972  acc: 0.5669    eval auc: 0.3626  acc: 0.4019    test auc: 0.3581  acc: 0.3974, time: 0.5131
epoch 30    train auc: 0.5972  acc: 0.5669    eval auc: 0.3625  acc: 0.4009    test auc: 0.3582  acc: 0.3985, time: 0.5185
epoch 31    train auc: 0.5972  acc: 0.5669    eval auc: 0.3626  acc: 0.3990    test auc: 0.3580  acc: 0.4004, time: 0.5454
epoch 32    train auc: 0.5972  acc: 0.5669    eval auc: 0.3623  acc: 0.3998    test auc: 0.3584  acc: 0.3996, time: 0.5173
epoch 33    train auc: 0.5972  acc: 0.5669    eval auc: 0.3626  acc: 0.4003    test auc: 0.3580  acc: 0.3991, time: 0.5219
epoch 34    train auc: 0.5972  acc: 0.5669    eval auc: 0.3627  acc: 0.4002    test auc: 0.3579  acc: 0.3992, time: 0.5656
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3625  acc: 0.4004    test auc: 0.3582  acc: 0.3990, time: 0.5177
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3627  acc: 0.3992    test auc: 0.3579  acc: 0.4002, time: 0.5228
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3625  acc: 0.3997    test auc: 0.3580  acc: 0.3997, time: 0.5128
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3625  acc: 0.3982    test auc: 0.3581  acc: 0.4012, time: 0.5440
epoch 39    train auc: 0.5972  acc: 0.5669    eval auc: 0.3625  acc: 0.3982    test auc: 0.3582  acc: 0.4012, time: 0.5510
epoch 40    train auc: 0.5972  acc: 0.5669    eval auc: 0.3624  acc: 0.3997    test auc: 0.3582  acc: 0.3997, time: 0.5750
epoch 41    train auc: 0.5972  acc: 0.5669    eval auc: 0.3624  acc: 0.4002    test auc: 0.3582  acc: 0.3992, time: 0.5369
epoch 42    train auc: 0.5972  acc: 0.5669    eval auc: 0.3623  acc: 0.3993    test auc: 0.3583  acc: 0.4000, time: 0.5750
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3626  acc: 0.4006    test auc: 0.3580  acc: 0.3987, time: 0.6060
epoch 44    train auc: 0.5972  acc: 0.5669    eval auc: 0.3625  acc: 0.4005    test auc: 0.3581  acc: 0.3989, time: 0.5660
epoch 45    train auc: 0.5972  acc: 0.5669    eval auc: 0.3626  acc: 0.3980    test auc: 0.3579  acc: 0.4013, time: 0.5140
epoch 46    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4012    test auc: 0.3576  acc: 0.3982, time: 0.5529
epoch 47    train auc: 0.5973  acc: 0.5669    eval auc: 0.3630  acc: 0.4003    test auc: 0.3575  acc: 0.3991, time: 0.5319
epoch 48    train auc: 0.5973  acc: 0.5669    eval auc: 0.3629  acc: 0.3999    test auc: 0.3576  acc: 0.3995, time: 0.5246
epoch 49    train auc: 0.5973  acc: 0.5669    eval auc: 0.3629  acc: 0.4031    test auc: 0.3577  acc: 0.3963, time: 0.5288
avg time per epoch : 0.5442438697814942
--- 32.89238524436951 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:31:50.345189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:31:50.345509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5047  acc: 0.5031    eval auc: 0.4941  acc: 0.4968    test auc: 0.4924  acc: 0.4938, time: 0.8788
epoch 1    train auc: 0.5166  acc: 0.5060    eval auc: 0.4814  acc: 0.4932    test auc: 0.4798  acc: 0.4900, time: 0.5622
epoch 2    train auc: 0.5330  acc: 0.5124    eval auc: 0.4689  acc: 0.4949    test auc: 0.4663  acc: 0.4910, time: 0.5564
epoch 3    train auc: 0.5552  acc: 0.5196    eval auc: 0.4593  acc: 0.4867    test auc: 0.4515  acc: 0.4862, time: 0.5379
epoch 4    train auc: 0.5990  acc: 0.5540    eval auc: 0.4818  acc: 0.5040    test auc: 0.4757  acc: 0.4953, time: 0.5337
epoch 5    train auc: 0.6916  acc: 0.6381    eval auc: 0.5592  acc: 0.5641    test auc: 0.5649  acc: 0.5688, time: 0.5300
epoch 6    train auc: 0.7720  acc: 0.7052    eval auc: 0.6412  acc: 0.6320    test auc: 0.6497  acc: 0.6412, time: 0.5469
epoch 7    train auc: 0.8339  acc: 0.7346    eval auc: 0.7027  acc: 0.6942    test auc: 0.7080  acc: 0.7010, time: 0.5399
epoch 8    train auc: 0.8660  acc: 0.7598    eval auc: 0.7374  acc: 0.7159    test auc: 0.7422  acc: 0.7215, time: 0.5223
epoch 9    train auc: 0.8798  acc: 0.7720    eval auc: 0.7531  acc: 0.7245    test auc: 0.7566  acc: 0.7321, time: 0.5245
epoch 10    train auc: 0.8877  acc: 0.7820    eval auc: 0.7616  acc: 0.7268    test auc: 0.7637  acc: 0.7328, time: 0.5168
epoch 11    train auc: 0.8929  acc: 0.7929    eval auc: 0.7661  acc: 0.7264    test auc: 0.7676  acc: 0.7278, time: 0.5254
epoch 12    train auc: 0.8968  acc: 0.7970    eval auc: 0.7686  acc: 0.7248    test auc: 0.7694  acc: 0.7241, time: 0.5342
epoch 13    train auc: 0.9002  acc: 0.8056    eval auc: 0.7704  acc: 0.7218    test auc: 0.7707  acc: 0.7156, time: 0.5245
epoch 14    train auc: 0.9030  acc: 0.8038    eval auc: 0.7716  acc: 0.7237    test auc: 0.7715  acc: 0.7228, time: 0.5287
epoch 15    train auc: 0.9056  acc: 0.8091    eval auc: 0.7731  acc: 0.7223    test auc: 0.7727  acc: 0.7172, time: 0.5223
epoch 16    train auc: 0.9079  acc: 0.8131    eval auc: 0.7741  acc: 0.7177    test auc: 0.7733  acc: 0.7145, time: 0.5217
epoch 17    train auc: 0.9099  acc: 0.8141    eval auc: 0.7751  acc: 0.7176    test auc: 0.7740  acc: 0.7168, time: 0.5210
epoch 18    train auc: 0.9117  acc: 0.8170    eval auc: 0.7753  acc: 0.7171    test auc: 0.7739  acc: 0.7158, time: 0.5392
epoch 19    train auc: 0.9134  acc: 0.8177    eval auc: 0.7755  acc: 0.7173    test auc: 0.7736  acc: 0.7178, time: 0.5208
epoch 20    train auc: 0.9150  acc: 0.8214    eval auc: 0.7752  acc: 0.7157    test auc: 0.7732  acc: 0.7118, time: 0.5229
epoch 21    train auc: 0.9164  acc: 0.8212    eval auc: 0.7763  acc: 0.7170    test auc: 0.7741  acc: 0.7154, time: 0.5200
epoch 22    train auc: 0.9177  acc: 0.8211    eval auc: 0.7763  acc: 0.7179    test auc: 0.7738  acc: 0.7178, time: 0.5230
epoch 23    train auc: 0.9189  acc: 0.8245    eval auc: 0.7756  acc: 0.7145    test auc: 0.7731  acc: 0.7088, time: 0.5180
epoch 24    train auc: 0.9200  acc: 0.8236    eval auc: 0.7757  acc: 0.7160    test auc: 0.7729  acc: 0.7144, time: 0.5211
epoch 25    train auc: 0.9211  acc: 0.8249    eval auc: 0.7759  acc: 0.7166    test auc: 0.7731  acc: 0.7134, time: 0.5323
epoch 26    train auc: 0.9222  acc: 0.8261    eval auc: 0.7752  acc: 0.7124    test auc: 0.7723  acc: 0.7074, time: 0.5281
epoch 27    train auc: 0.9231  acc: 0.8269    eval auc: 0.7751  acc: 0.7114    test auc: 0.7720  acc: 0.7065, time: 0.5234
epoch 28    train auc: 0.9240  acc: 0.8259    eval auc: 0.7751  acc: 0.7130    test auc: 0.7719  acc: 0.7094, time: 0.5390
epoch 29    train auc: 0.9248  acc: 0.8266    eval auc: 0.7754  acc: 0.7141    test auc: 0.7721  acc: 0.7100, time: 0.5182
epoch 30    train auc: 0.9257  acc: 0.8286    eval auc: 0.7751  acc: 0.7120    test auc: 0.7720  acc: 0.7069, time: 0.5163
epoch 31    train auc: 0.9264  acc: 0.8274    eval auc: 0.7745  acc: 0.7125    test auc: 0.7711  acc: 0.7100, time: 0.5189
epoch 32    train auc: 0.9272  acc: 0.8292    eval auc: 0.7740  acc: 0.7117    test auc: 0.7707  acc: 0.7063, time: 0.5311
epoch 33    train auc: 0.9278  acc: 0.8290    eval auc: 0.7744  acc: 0.7122    test auc: 0.7712  acc: 0.7086, time: 0.5248
epoch 34    train auc: 0.9284  acc: 0.8297    eval auc: 0.7738  acc: 0.7113    test auc: 0.7705  acc: 0.7075, time: 0.5137
epoch 35    train auc: 0.9291  acc: 0.8311    eval auc: 0.7731  acc: 0.7075    test auc: 0.7700  acc: 0.7035, time: 0.5234
epoch 36    train auc: 0.9296  acc: 0.8317    eval auc: 0.7730  acc: 0.7074    test auc: 0.7699  acc: 0.7052, time: 0.5280
epoch 37    train auc: 0.9302  acc: 0.8321    eval auc: 0.7725  acc: 0.7066    test auc: 0.7694  acc: 0.7046, time: 0.5223
epoch 38    train auc: 0.9307  acc: 0.8319    eval auc: 0.7723  acc: 0.7083    test auc: 0.7690  acc: 0.7058, time: 0.5346
epoch 39    train auc: 0.9312  acc: 0.8325    eval auc: 0.7716  acc: 0.7075    test auc: 0.7684  acc: 0.7048, time: 0.5161
epoch 40    train auc: 0.9316  acc: 0.8323    eval auc: 0.7716  acc: 0.7079    test auc: 0.7682  acc: 0.7056, time: 0.5188
epoch 41    train auc: 0.9320  acc: 0.8328    eval auc: 0.7720  acc: 0.7087    test auc: 0.7688  acc: 0.7048, time: 0.5340
epoch 42    train auc: 0.9327  acc: 0.8349    eval auc: 0.7698  acc: 0.7041    test auc: 0.7667  acc: 0.7017, time: 0.5244
epoch 43    train auc: 0.9329  acc: 0.8353    eval auc: 0.7701  acc: 0.7027    test auc: 0.7670  acc: 0.7024, time: 0.5254
epoch 44    train auc: 0.9333  acc: 0.8343    eval auc: 0.7705  acc: 0.7065    test auc: 0.7672  acc: 0.7019, time: 0.5248
epoch 45    train auc: 0.9337  acc: 0.8346    eval auc: 0.7699  acc: 0.7047    test auc: 0.7664  acc: 0.7008, time: 0.5235
epoch 46    train auc: 0.9342  acc: 0.8359    eval auc: 0.7693  acc: 0.7027    test auc: 0.7659  acc: 0.7006, time: 0.5243
epoch 47    train auc: 0.9345  acc: 0.8363    eval auc: 0.7695  acc: 0.7036    test auc: 0.7662  acc: 0.7011, time: 0.5142
epoch 48    train auc: 0.9350  acc: 0.8368    eval auc: 0.7687  acc: 0.7024    test auc: 0.7653  acc: 0.7000, time: 0.5276
epoch 49    train auc: 0.9349  acc: 0.8360    eval auc: 0.7694  acc: 0.7061    test auc: 0.7660  acc: 0.7026, time: 0.5173
avg time per epoch : 0.5339346647262573
--- 32.39322590827942 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:32:22.798788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:32:22.799132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4970  acc: 0.5007    eval auc: 0.5217  acc: 0.5037    test auc: 0.5014  acc: 0.5016, time: 0.8351
epoch 1    train auc: 0.7816  acc: 0.6569    eval auc: 0.7197  acc: 0.6449    test auc: 0.7376  acc: 0.6562, time: 0.3117
epoch 2    train auc: 0.8852  acc: 0.7628    eval auc: 0.7913  acc: 0.7373    test auc: 0.7968  acc: 0.7457, time: 0.5232
epoch 3    train auc: 0.8969  acc: 0.7841    eval auc: 0.7962  acc: 0.7520    test auc: 0.8002  acc: 0.7581, time: 0.3119
epoch 4    train auc: 0.9031  acc: 0.7947    eval auc: 0.7975  acc: 0.7507    test auc: 0.8018  acc: 0.7529, time: 0.5208
epoch 5    train auc: 0.9081  acc: 0.8014    eval auc: 0.7962  acc: 0.7461    test auc: 0.7998  acc: 0.7459, time: 0.3170
epoch 6    train auc: 0.9141  acc: 0.8080    eval auc: 0.7944  acc: 0.7349    test auc: 0.7965  acc: 0.7298, time: 0.5158
epoch 7    train auc: 0.9218  acc: 0.8190    eval auc: 0.7863  acc: 0.7170    test auc: 0.7875  acc: 0.7120, time: 0.3183
epoch 8    train auc: 0.9242  acc: 0.8180    eval auc: 0.7860  acc: 0.7257    test auc: 0.7865  acc: 0.7183, time: 0.5279
epoch 9    train auc: 0.9289  acc: 0.8267    eval auc: 0.7784  acc: 0.7107    test auc: 0.7783  acc: 0.7053, time: 0.3190
epoch 10    train auc: 0.9290  acc: 0.8263    eval auc: 0.7813  acc: 0.7160    test auc: 0.7812  acc: 0.7092, time: 0.5305
epoch 11    train auc: 0.9316  acc: 0.8261    eval auc: 0.7784  acc: 0.7139    test auc: 0.7773  acc: 0.7073, time: 0.3286
epoch 12    train auc: 0.9300  acc: 0.8237    eval auc: 0.7821  acc: 0.7203    test auc: 0.7816  acc: 0.7122, time: 0.5241
epoch 13    train auc: 0.9354  acc: 0.8349    eval auc: 0.7713  acc: 0.6985    test auc: 0.7706  acc: 0.6981, time: 0.3100
epoch 14    train auc: 0.9338  acc: 0.8298    eval auc: 0.7775  acc: 0.7112    test auc: 0.7771  acc: 0.7069, time: 0.5146
epoch 15    train auc: 0.9373  acc: 0.8355    eval auc: 0.7679  acc: 0.6959    test auc: 0.7662  acc: 0.6911, time: 0.3064
epoch 16    train auc: 0.9366  acc: 0.8336    eval auc: 0.7742  acc: 0.7050    test auc: 0.7728  acc: 0.7011, time: 0.5141
epoch 17    train auc: 0.9394  acc: 0.8390    eval auc: 0.7667  acc: 0.6930    test auc: 0.7655  acc: 0.6899, time: 0.3059
epoch 18    train auc: 0.9374  acc: 0.8342    eval auc: 0.7743  acc: 0.7061    test auc: 0.7730  acc: 0.7033, time: 0.5072
epoch 19    train auc: 0.9407  acc: 0.8411    eval auc: 0.7655  acc: 0.6929    test auc: 0.7645  acc: 0.6899, time: 0.3168
epoch 20    train auc: 0.9408  acc: 0.8395    eval auc: 0.7691  acc: 0.6997    test auc: 0.7676  acc: 0.6950, time: 0.5276
epoch 21    train auc: 0.9428  acc: 0.8435    eval auc: 0.7646  acc: 0.6939    test auc: 0.7626  acc: 0.6896, time: 0.3079
epoch 22    train auc: 0.9413  acc: 0.8405    eval auc: 0.7698  acc: 0.7006    test auc: 0.7681  acc: 0.6961, time: 0.5290
epoch 23    train auc: 0.9433  acc: 0.8435    eval auc: 0.7664  acc: 0.6970    test auc: 0.7642  acc: 0.6925, time: 0.2973
epoch 24    train auc: 0.9434  acc: 0.8430    eval auc: 0.7674  acc: 0.6987    test auc: 0.7655  acc: 0.6952, time: 0.4997
epoch 25    train auc: 0.9452  acc: 0.8466    eval auc: 0.7636  acc: 0.6919    test auc: 0.7616  acc: 0.6909, time: 0.3121
epoch 26    train auc: 0.9438  acc: 0.8428    eval auc: 0.7681  acc: 0.7007    test auc: 0.7664  acc: 0.6972, time: 0.5155
epoch 27    train auc: 0.9462  acc: 0.8487    eval auc: 0.7626  acc: 0.6942    test auc: 0.7607  acc: 0.6910, time: 0.3204
epoch 28    train auc: 0.9448  acc: 0.8442    eval auc: 0.7668  acc: 0.6985    test auc: 0.7653  acc: 0.6964, time: 0.5171
epoch 29    train auc: 0.9477  acc: 0.8508    eval auc: 0.7595  acc: 0.6892    test auc: 0.7580  acc: 0.6886, time: 0.3214
epoch 30    train auc: 0.9448  acc: 0.8447    eval auc: 0.7664  acc: 0.6984    test auc: 0.7647  acc: 0.6972, time: 0.5392
epoch 31    train auc: 0.9482  acc: 0.8512    eval auc: 0.7597  acc: 0.6905    test auc: 0.7584  acc: 0.6902, time: 0.3100
epoch 32    train auc: 0.9455  acc: 0.8457    eval auc: 0.7646  acc: 0.6978    test auc: 0.7628  acc: 0.6962, time: 0.5172
epoch 33    train auc: 0.9498  acc: 0.8547    eval auc: 0.7562  acc: 0.6860    test auc: 0.7544  acc: 0.6860, time: 0.3052
epoch 34    train auc: 0.9479  acc: 0.8523    eval auc: 0.7625  acc: 0.6938    test auc: 0.7605  acc: 0.6916, time: 0.5225
epoch 35    train auc: 0.9505  acc: 0.8567    eval auc: 0.7545  acc: 0.6849    test auc: 0.7536  acc: 0.6857, time: 0.3062
epoch 36    train auc: 0.9497  acc: 0.8555    eval auc: 0.7598  acc: 0.6908    test auc: 0.7590  acc: 0.6900, time: 0.5117
epoch 37    train auc: 0.9513  acc: 0.8580    eval auc: 0.7561  acc: 0.6858    test auc: 0.7546  acc: 0.6840, time: 0.3081
epoch 38    train auc: 0.9509  acc: 0.8569    eval auc: 0.7582  acc: 0.6898    test auc: 0.7566  acc: 0.6866, time: 0.5243
epoch 39    train auc: 0.9521  acc: 0.8595    eval auc: 0.7550  acc: 0.6853    test auc: 0.7533  acc: 0.6846, time: 0.3169
epoch 40    train auc: 0.9505  acc: 0.8566    eval auc: 0.7588  acc: 0.6887    test auc: 0.7569  acc: 0.6859, time: 0.5264
epoch 41    train auc: 0.9532  acc: 0.8604    eval auc: 0.7527  acc: 0.6824    test auc: 0.7515  acc: 0.6843, time: 0.3195
epoch 42    train auc: 0.9522  acc: 0.8578    eval auc: 0.7575  acc: 0.6887    test auc: 0.7554  acc: 0.6876, time: 0.5112
epoch 43    train auc: 0.9535  acc: 0.8599    eval auc: 0.7540  acc: 0.6841    test auc: 0.7519  acc: 0.6836, time: 0.3068
epoch 44    train auc: 0.9528  acc: 0.8589    eval auc: 0.7568  acc: 0.6890    test auc: 0.7549  acc: 0.6865, time: 0.5048
epoch 45    train auc: 0.9548  acc: 0.8613    eval auc: 0.7528  acc: 0.6845    test auc: 0.7512  acc: 0.6830, time: 0.3057
epoch 46    train auc: 0.9553  acc: 0.8625    eval auc: 0.7534  acc: 0.6852    test auc: 0.7514  acc: 0.6856, time: 0.5159
epoch 47    train auc: 0.9559  acc: 0.8638    eval auc: 0.7494  acc: 0.6808    test auc: 0.7474  acc: 0.6792, time: 0.3064
epoch 48    train auc: 0.9558  acc: 0.8628    eval auc: 0.7535  acc: 0.6841    test auc: 0.7515  acc: 0.6853, time: 0.5094
epoch 49    train auc: 0.9570  acc: 0.8654    eval auc: 0.7483  acc: 0.6814    test auc: 0.7465  acc: 0.6802, time: 0.3039
avg time per epoch : 0.42157390117645266
--- 26.90424394607544 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:32:49.623741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:32:49.624052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5303  acc: 0.5178    eval auc: 0.5118  acc: 0.5034    test auc: 0.5177  acc: 0.5148, time: 0.8229
epoch 1    train auc: 0.5175  acc: 0.5018    eval auc: 0.4722  acc: 0.4988    test auc: 0.4816  acc: 0.4970, time: 0.3158
epoch 2    train auc: 0.5399  acc: 0.5218    eval auc: 0.4728  acc: 0.4937    test auc: 0.4899  acc: 0.5005, time: 0.5292
epoch 3    train auc: 0.5459  acc: 0.5051    eval auc: 0.4366  acc: 0.4957    test auc: 0.4399  acc: 0.4890, time: 0.3119
epoch 4    train auc: 0.5916  acc: 0.5074    eval auc: 0.4521  acc: 0.4924    test auc: 0.4568  acc: 0.4854, time: 0.5646
epoch 5    train auc: 0.5996  acc: 0.5020    eval auc: 0.4569  acc: 0.4994    test auc: 0.4632  acc: 0.4946, time: 0.3332
epoch 6    train auc: 0.7833  acc: 0.6749    eval auc: 0.6769  acc: 0.6593    test auc: 0.6928  acc: 0.6743, time: 0.5140
epoch 7    train auc: 0.8345  acc: 0.7116    eval auc: 0.7264  acc: 0.6916    test auc: 0.7364  acc: 0.7032, time: 0.3110
epoch 8    train auc: 0.8706  acc: 0.7632    eval auc: 0.7682  acc: 0.7314    test auc: 0.7734  acc: 0.7448, time: 0.5057
epoch 9    train auc: 0.8809  acc: 0.7730    eval auc: 0.7759  acc: 0.7401    test auc: 0.7801  acc: 0.7527, time: 0.3299
epoch 10    train auc: 0.8820  acc: 0.7934    eval auc: 0.7830  acc: 0.7333    test auc: 0.7868  acc: 0.7327, time: 0.5104
epoch 11    train auc: 0.8904  acc: 0.7842    eval auc: 0.7841  acc: 0.7447    test auc: 0.7864  acc: 0.7531, time: 0.3339
epoch 12    train auc: 0.8890  acc: 0.7943    eval auc: 0.7864  acc: 0.7355    test auc: 0.7894  acc: 0.7363, time: 0.4956
epoch 13    train auc: 0.8952  acc: 0.7895    eval auc: 0.7879  acc: 0.7474    test auc: 0.7899  acc: 0.7514, time: 0.3116
epoch 14    train auc: 0.8922  acc: 0.7944    eval auc: 0.7881  acc: 0.7298    test auc: 0.7915  acc: 0.7269, time: 0.4880
epoch 15    train auc: 0.8983  acc: 0.7949    eval auc: 0.7903  acc: 0.7438    test auc: 0.7923  acc: 0.7457, time: 0.2979
epoch 16    train auc: 0.8956  acc: 0.7960    eval auc: 0.7901  acc: 0.7301    test auc: 0.7934  acc: 0.7254, time: 0.4956
epoch 17    train auc: 0.9005  acc: 0.7979    eval auc: 0.7921  acc: 0.7422    test auc: 0.7939  acc: 0.7399, time: 0.3032
epoch 18    train auc: 0.8986  acc: 0.7988    eval auc: 0.7916  acc: 0.7272    test auc: 0.7943  acc: 0.7220, time: 0.4959
epoch 19    train auc: 0.9027  acc: 0.7998    eval auc: 0.7935  acc: 0.7402    test auc: 0.7948  acc: 0.7362, time: 0.3161
epoch 20    train auc: 0.9018  acc: 0.8026    eval auc: 0.7918  acc: 0.7237    test auc: 0.7940  acc: 0.7148, time: 0.4828
epoch 21    train auc: 0.9049  acc: 0.8023    eval auc: 0.7941  acc: 0.7392    test auc: 0.7950  acc: 0.7322, time: 0.3061
epoch 22    train auc: 0.9053  acc: 0.8066    eval auc: 0.7920  acc: 0.7222    test auc: 0.7933  acc: 0.7156, time: 0.4922
epoch 23    train auc: 0.9073  acc: 0.8039    eval auc: 0.7941  acc: 0.7350    test auc: 0.7942  acc: 0.7303, time: 0.3091
epoch 24    train auc: 0.9087  acc: 0.8105    eval auc: 0.7911  acc: 0.7179    test auc: 0.7921  acc: 0.7102, time: 0.4897
epoch 25    train auc: 0.9100  acc: 0.8060    eval auc: 0.7937  acc: 0.7326    test auc: 0.7936  acc: 0.7269, time: 0.2942
epoch 26    train auc: 0.9122  acc: 0.8137    eval auc: 0.7900  acc: 0.7159    test auc: 0.7906  acc: 0.7086, time: 0.4870
epoch 27    train auc: 0.9126  acc: 0.8088    eval auc: 0.7931  acc: 0.7292    test auc: 0.7925  acc: 0.7248, time: 0.2976
epoch 28    train auc: 0.9149  acc: 0.8169    eval auc: 0.7883  acc: 0.7086    test auc: 0.7886  acc: 0.7030, time: 0.4868
epoch 29    train auc: 0.9150  acc: 0.8101    eval auc: 0.7923  acc: 0.7282    test auc: 0.7913  acc: 0.7226, time: 0.3076
epoch 30    train auc: 0.9177  acc: 0.8190    eval auc: 0.7864  acc: 0.7087    test auc: 0.7865  acc: 0.7013, time: 0.5034
epoch 31    train auc: 0.9177  acc: 0.8151    eval auc: 0.7903  acc: 0.7235    test auc: 0.7893  acc: 0.7183, time: 0.3147
epoch 32    train auc: 0.9201  acc: 0.8220    eval auc: 0.7844  acc: 0.7067    test auc: 0.7842  acc: 0.7006, time: 0.5030
epoch 33    train auc: 0.9197  acc: 0.8186    eval auc: 0.7887  acc: 0.7218    test auc: 0.7876  acc: 0.7131, time: 0.3145
epoch 34    train auc: 0.9219  acc: 0.8220    eval auc: 0.7820  acc: 0.6994    test auc: 0.7818  acc: 0.6950, time: 0.4955
epoch 35    train auc: 0.9214  acc: 0.8192    eval auc: 0.7878  acc: 0.7207    test auc: 0.7864  acc: 0.7121, time: 0.2999
epoch 36    train auc: 0.9234  acc: 0.8234    eval auc: 0.7808  acc: 0.6985    test auc: 0.7804  acc: 0.6963, time: 0.4829
epoch 37    train auc: 0.9228  acc: 0.8201    eval auc: 0.7867  acc: 0.7196    test auc: 0.7851  acc: 0.7102, time: 0.3175
epoch 38    train auc: 0.9247  acc: 0.8241    eval auc: 0.7780  acc: 0.6928    test auc: 0.7773  acc: 0.6934, time: 0.5114
epoch 39    train auc: 0.9242  acc: 0.8213    eval auc: 0.7850  acc: 0.7146    test auc: 0.7832  acc: 0.7055, time: 0.3111
epoch 40    train auc: 0.9258  acc: 0.8243    eval auc: 0.7763  acc: 0.6916    test auc: 0.7756  acc: 0.6916, time: 0.5088
epoch 41    train auc: 0.9256  acc: 0.8227    eval auc: 0.7844  acc: 0.7167    test auc: 0.7820  acc: 0.7061, time: 0.3133
epoch 42    train auc: 0.9266  acc: 0.8243    eval auc: 0.7743  acc: 0.6883    test auc: 0.7735  acc: 0.6884, time: 0.5115
epoch 43    train auc: 0.9266  acc: 0.8234    eval auc: 0.7837  acc: 0.7160    test auc: 0.7810  acc: 0.7062, time: 0.3090
epoch 44    train auc: 0.9273  acc: 0.8240    eval auc: 0.7728  acc: 0.6861    test auc: 0.7719  acc: 0.6863, time: 0.5124
epoch 45    train auc: 0.9273  acc: 0.8218    eval auc: 0.7834  acc: 0.7179    test auc: 0.7805  acc: 0.7101, time: 0.3050
epoch 46    train auc: 0.9277  acc: 0.8239    eval auc: 0.7715  acc: 0.6845    test auc: 0.7705  acc: 0.6824, time: 0.5129
epoch 47    train auc: 0.9281  acc: 0.8227    eval auc: 0.7826  acc: 0.7167    test auc: 0.7794  acc: 0.7088, time: 0.3178
epoch 48    train auc: 0.9278  acc: 0.8223    eval auc: 0.7694  acc: 0.6800    test auc: 0.7685  acc: 0.6804, time: 0.5089
epoch 49    train auc: 0.9290  acc: 0.8252    eval auc: 0.7816  acc: 0.7133    test auc: 0.7786  acc: 0.7065, time: 0.3114
avg time per epoch : 0.41409386157989503
--- 26.142714023590088 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:33:15.844007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:33:15.844366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4898  acc: 0.4926    eval auc: 0.5308  acc: 0.5198    test auc: 0.5292  acc: 0.5162, time: 0.8722
epoch 1    train auc: 0.7066  acc: 0.6468    eval auc: 0.6601  acc: 0.6311    test auc: 0.6789  acc: 0.6445, time: 0.3350
epoch 2    train auc: 0.8831  acc: 0.7641    eval auc: 0.7909  acc: 0.7380    test auc: 0.7935  acc: 0.7464, time: 0.5357
epoch 3    train auc: 0.8952  acc: 0.7855    eval auc: 0.7936  acc: 0.7516    test auc: 0.7967  acc: 0.7598, time: 0.3139
epoch 4    train auc: 0.9052  acc: 0.7988    eval auc: 0.7943  acc: 0.7475    test auc: 0.7969  acc: 0.7507, time: 0.5262
epoch 5    train auc: 0.9133  acc: 0.8121    eval auc: 0.7901  acc: 0.7267    test auc: 0.7924  acc: 0.7259, time: 0.3257
epoch 6    train auc: 0.9196  acc: 0.8181    eval auc: 0.7863  acc: 0.7189    test auc: 0.7875  acc: 0.7157, time: 0.5262
epoch 7    train auc: 0.9245  acc: 0.8226    eval auc: 0.7820  acc: 0.7112    test auc: 0.7822  acc: 0.7078, time: 0.3303
epoch 8    train auc: 0.9275  acc: 0.8230    eval auc: 0.7801  acc: 0.7104    test auc: 0.7795  acc: 0.7096, time: 0.5323
epoch 9    train auc: 0.9305  acc: 0.8302    eval auc: 0.7777  acc: 0.7068    test auc: 0.7767  acc: 0.7045, time: 0.3205
epoch 10    train auc: 0.9322  acc: 0.8298    eval auc: 0.7760  acc: 0.7055    test auc: 0.7755  acc: 0.7010, time: 0.5229
epoch 11    train auc: 0.9331  acc: 0.8297    eval auc: 0.7776  acc: 0.7088    test auc: 0.7762  acc: 0.7049, time: 0.3184
epoch 12    train auc: 0.9334  acc: 0.8289    eval auc: 0.7785  acc: 0.7099    test auc: 0.7774  acc: 0.7069, time: 0.5225
epoch 13    train auc: 0.9368  acc: 0.8358    eval auc: 0.7713  acc: 0.7002    test auc: 0.7701  acc: 0.6995, time: 0.3212
epoch 14    train auc: 0.9371  acc: 0.8351    eval auc: 0.7726  acc: 0.7033    test auc: 0.7718  acc: 0.7040, time: 0.5305
epoch 15    train auc: 0.9385  acc: 0.8391    eval auc: 0.7658  acc: 0.6964    test auc: 0.7642  acc: 0.6954, time: 0.3430
epoch 16    train auc: 0.9391  acc: 0.8391    eval auc: 0.7673  acc: 0.6987    test auc: 0.7660  acc: 0.6963, time: 0.5268
epoch 17    train auc: 0.9407  acc: 0.8421    eval auc: 0.7644  acc: 0.6925    test auc: 0.7636  acc: 0.6926, time: 0.3209
epoch 18    train auc: 0.9398  acc: 0.8389    eval auc: 0.7688  acc: 0.6983    test auc: 0.7685  acc: 0.6984, time: 0.5165
epoch 19    train auc: 0.9410  acc: 0.8402    eval auc: 0.7622  acc: 0.6898    test auc: 0.7626  acc: 0.6926, time: 0.3222
epoch 20    train auc: 0.9427  acc: 0.8449    eval auc: 0.7608  acc: 0.6909    test auc: 0.7605  acc: 0.6905, time: 0.5285
epoch 21    train auc: 0.9431  acc: 0.8447    eval auc: 0.7616  acc: 0.6913    test auc: 0.7612  acc: 0.6908, time: 0.3201
epoch 22    train auc: 0.9432  acc: 0.8439    eval auc: 0.7624  acc: 0.6934    test auc: 0.7620  acc: 0.6926, time: 0.5259
epoch 23    train auc: 0.9433  acc: 0.8431    eval auc: 0.7631  acc: 0.6954    test auc: 0.7629  acc: 0.6935, time: 0.3246
epoch 24    train auc: 0.9446  acc: 0.8455    eval auc: 0.7594  acc: 0.6912    test auc: 0.7590  acc: 0.6903, time: 0.5325
epoch 25    train auc: 0.9448  acc: 0.8466    eval auc: 0.7603  acc: 0.6913    test auc: 0.7603  acc: 0.6925, time: 0.3237
epoch 26    train auc: 0.9453  acc: 0.8477    eval auc: 0.7596  acc: 0.6908    test auc: 0.7596  acc: 0.6926, time: 0.5289
epoch 27    train auc: 0.9457  acc: 0.8471    eval auc: 0.7587  acc: 0.6912    test auc: 0.7585  acc: 0.6913, time: 0.3191
epoch 28    train auc: 0.9456  acc: 0.8470    eval auc: 0.7596  acc: 0.6900    test auc: 0.7594  acc: 0.6921, time: 0.5216
epoch 29    train auc: 0.9468  acc: 0.8494    eval auc: 0.7567  acc: 0.6864    test auc: 0.7566  acc: 0.6904, time: 0.3157
epoch 30    train auc: 0.9464  acc: 0.8484    eval auc: 0.7579  acc: 0.6873    test auc: 0.7572  acc: 0.6908, time: 0.5273
epoch 31    train auc: 0.9476  acc: 0.8496    eval auc: 0.7555  acc: 0.6869    test auc: 0.7556  acc: 0.6902, time: 0.3195
epoch 32    train auc: 0.9457  acc: 0.8450    eval auc: 0.7582  acc: 0.6915    test auc: 0.7566  acc: 0.6905, time: 0.5219
epoch 33    train auc: 0.9486  acc: 0.8528    eval auc: 0.7529  acc: 0.6861    test auc: 0.7517  acc: 0.6860, time: 0.3220
epoch 34    train auc: 0.9491  acc: 0.8537    eval auc: 0.7543  acc: 0.6859    test auc: 0.7533  acc: 0.6878, time: 0.5238
epoch 35    train auc: 0.9494  acc: 0.8534    eval auc: 0.7531  acc: 0.6849    test auc: 0.7521  acc: 0.6874, time: 0.3179
epoch 36    train auc: 0.9501  acc: 0.8540    eval auc: 0.7528  acc: 0.6840    test auc: 0.7522  acc: 0.6872, time: 0.5208
epoch 37    train auc: 0.9509  acc: 0.8547    eval auc: 0.7515  acc: 0.6839    test auc: 0.7504  acc: 0.6838, time: 0.3215
epoch 38    train auc: 0.9516  acc: 0.8557    eval auc: 0.7507  acc: 0.6817    test auc: 0.7499  acc: 0.6845, time: 0.5228
epoch 39    train auc: 0.9529  acc: 0.8574    eval auc: 0.7488  acc: 0.6806    test auc: 0.7479  acc: 0.6812, time: 0.3214
epoch 40    train auc: 0.9536  acc: 0.8591    eval auc: 0.7499  acc: 0.6798    test auc: 0.7490  acc: 0.6834, time: 0.5377
epoch 41    train auc: 0.9552  acc: 0.8610    eval auc: 0.7466  acc: 0.6782    test auc: 0.7460  acc: 0.6818, time: 0.3360
epoch 42    train auc: 0.9565  acc: 0.8624    eval auc: 0.7483  acc: 0.6807    test auc: 0.7472  acc: 0.6815, time: 0.5430
epoch 43    train auc: 0.9574  acc: 0.8641    eval auc: 0.7495  acc: 0.6839    test auc: 0.7485  acc: 0.6824, time: 0.3294
epoch 44    train auc: 0.9595  acc: 0.8669    eval auc: 0.7472  acc: 0.6791    test auc: 0.7466  acc: 0.6799, time: 0.5284
epoch 45    train auc: 0.9612  acc: 0.8689    eval auc: 0.7450  acc: 0.6752    test auc: 0.7448  acc: 0.6798, time: 0.3359
epoch 46    train auc: 0.9628  acc: 0.8726    eval auc: 0.7430  acc: 0.6745    test auc: 0.7420  acc: 0.6767, time: 0.5209
epoch 47    train auc: 0.9641  acc: 0.8752    eval auc: 0.7442  acc: 0.6755    test auc: 0.7430  acc: 0.6738, time: 0.3244
epoch 48    train auc: 0.9656  acc: 0.8765    eval auc: 0.7449  acc: 0.6781    test auc: 0.7435  acc: 0.6774, time: 0.5650
epoch 49    train auc: 0.9673  acc: 0.8805    eval auc: 0.7422  acc: 0.6766    test auc: 0.7408  acc: 0.6740, time: 0.3540
avg time per epoch : 0.4339427137374878
--- 27.23001265525818 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:33:43.178761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:33:43.179095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5131  acc: 0.5095    eval auc: 0.4872  acc: 0.4908    test auc: 0.4963  acc: 0.4965, time: 0.8899
epoch 1    train auc: 0.5239  acc: 0.5068    eval auc: 0.4796  acc: 0.4969    test auc: 0.4689  acc: 0.4845, time: 0.3380
epoch 2    train auc: 0.5467  acc: 0.5140    eval auc: 0.4663  acc: 0.4923    test auc: 0.4582  acc: 0.4770, time: 0.5560
epoch 3    train auc: 0.5789  acc: 0.5357    eval auc: 0.4783  acc: 0.4997    test auc: 0.4738  acc: 0.4977, time: 0.3420
epoch 4    train auc: 0.6837  acc: 0.6074    eval auc: 0.5656  acc: 0.5785    test auc: 0.5707  acc: 0.5826, time: 0.5570
epoch 5    train auc: 0.7669  acc: 0.6804    eval auc: 0.6476  acc: 0.6434    test auc: 0.6564  acc: 0.6540, time: 0.3500
epoch 6    train auc: 0.8247  acc: 0.7211    eval auc: 0.7059  acc: 0.6911    test auc: 0.7128  acc: 0.7015, time: 0.5350
epoch 7    train auc: 0.8632  acc: 0.7404    eval auc: 0.7417  acc: 0.7127    test auc: 0.7466  acc: 0.7189, time: 0.3280
epoch 8    train auc: 0.8792  acc: 0.7438    eval auc: 0.7630  acc: 0.7185    test auc: 0.7661  acc: 0.7255, time: 0.5410
epoch 9    train auc: 0.8890  acc: 0.7753    eval auc: 0.7719  acc: 0.7336    test auc: 0.7752  acc: 0.7414, time: 0.3410
epoch 10    train auc: 0.8938  acc: 0.7831    eval auc: 0.7771  acc: 0.7360    test auc: 0.7796  acc: 0.7440, time: 0.5170
epoch 11    train auc: 0.8975  acc: 0.7852    eval auc: 0.7793  acc: 0.7366    test auc: 0.7812  acc: 0.7421, time: 0.3189
epoch 12    train auc: 0.9006  acc: 0.7858    eval auc: 0.7807  acc: 0.7361    test auc: 0.7821  acc: 0.7421, time: 0.5209
epoch 13    train auc: 0.9035  acc: 0.7997    eval auc: 0.7802  acc: 0.7305    test auc: 0.7816  acc: 0.7310, time: 0.3180
epoch 14    train auc: 0.9062  acc: 0.8016    eval auc: 0.7807  acc: 0.7262    test auc: 0.7817  acc: 0.7287, time: 0.5109
epoch 15    train auc: 0.9087  acc: 0.8057    eval auc: 0.7805  acc: 0.7231    test auc: 0.7814  acc: 0.7254, time: 0.3310
epoch 16    train auc: 0.9110  acc: 0.8072    eval auc: 0.7808  acc: 0.7226    test auc: 0.7813  acc: 0.7239, time: 0.5050
epoch 17    train auc: 0.9131  acc: 0.8152    eval auc: 0.7802  acc: 0.7171    test auc: 0.7808  acc: 0.7181, time: 0.3250
epoch 18    train auc: 0.9149  acc: 0.8099    eval auc: 0.7812  acc: 0.7206    test auc: 0.7812  acc: 0.7222, time: 0.5636
epoch 19    train auc: 0.9167  acc: 0.8161    eval auc: 0.7807  acc: 0.7168    test auc: 0.7806  acc: 0.7181, time: 0.3332
epoch 20    train auc: 0.9182  acc: 0.8142    eval auc: 0.7808  acc: 0.7183    test auc: 0.7804  acc: 0.7192, time: 0.5244
epoch 21    train auc: 0.9197  acc: 0.8196    eval auc: 0.7802  acc: 0.7150    test auc: 0.7799  acc: 0.7154, time: 0.3689
epoch 22    train auc: 0.9208  acc: 0.8171    eval auc: 0.7807  acc: 0.7170    test auc: 0.7798  acc: 0.7180, time: 0.5577
epoch 23    train auc: 0.9221  acc: 0.8221    eval auc: 0.7796  acc: 0.7152    test auc: 0.7789  acc: 0.7147, time: 0.3710
epoch 24    train auc: 0.9231  acc: 0.8211    eval auc: 0.7802  acc: 0.7161    test auc: 0.7792  acc: 0.7150, time: 0.5630
epoch 25    train auc: 0.9241  acc: 0.8232    eval auc: 0.7796  acc: 0.7141    test auc: 0.7786  acc: 0.7150, time: 0.3360
epoch 26    train auc: 0.9250  acc: 0.8238    eval auc: 0.7794  acc: 0.7133    test auc: 0.7783  acc: 0.7140, time: 0.5340
epoch 27    train auc: 0.9259  acc: 0.8238    eval auc: 0.7788  acc: 0.7122    test auc: 0.7776  acc: 0.7128, time: 0.3310
epoch 28    train auc: 0.9267  acc: 0.8268    eval auc: 0.7783  acc: 0.7093    test auc: 0.7771  acc: 0.7101, time: 0.5480
epoch 29    train auc: 0.9273  acc: 0.8241    eval auc: 0.7788  acc: 0.7124    test auc: 0.7772  acc: 0.7121, time: 0.3190
epoch 30    train auc: 0.9281  acc: 0.8274    eval auc: 0.7777  acc: 0.7102    test auc: 0.7763  acc: 0.7088, time: 0.5580
epoch 31    train auc: 0.9288  acc: 0.8276    eval auc: 0.7767  acc: 0.7093    test auc: 0.7752  acc: 0.7089, time: 0.3420
epoch 32    train auc: 0.9291  acc: 0.8249    eval auc: 0.7776  acc: 0.7126    test auc: 0.7756  acc: 0.7096, time: 0.5463
epoch 33    train auc: 0.9300  acc: 0.8287    eval auc: 0.7764  acc: 0.7094    test auc: 0.7748  acc: 0.7065, time: 0.3373
epoch 34    train auc: 0.9306  acc: 0.8306    eval auc: 0.7757  acc: 0.7067    test auc: 0.7742  acc: 0.7050, time: 0.5479
epoch 35    train auc: 0.9310  acc: 0.8312    eval auc: 0.7752  acc: 0.7048    test auc: 0.7738  acc: 0.7030, time: 0.3381
epoch 36    train auc: 0.9311  acc: 0.8270    eval auc: 0.7766  acc: 0.7096    test auc: 0.7746  acc: 0.7076, time: 0.5784
epoch 37    train auc: 0.9319  acc: 0.8324    eval auc: 0.7741  acc: 0.7028    test auc: 0.7729  acc: 0.7033, time: 0.3264
epoch 38    train auc: 0.9323  acc: 0.8303    eval auc: 0.7750  acc: 0.7058    test auc: 0.7729  acc: 0.7046, time: 0.5290
epoch 39    train auc: 0.9329  acc: 0.8337    eval auc: 0.7729  acc: 0.7007    test auc: 0.7715  acc: 0.7013, time: 0.3249
epoch 40    train auc: 0.9332  acc: 0.8320    eval auc: 0.7743  acc: 0.7046    test auc: 0.7724  acc: 0.7052, time: 0.5247
epoch 41    train auc: 0.9338  acc: 0.8341    eval auc: 0.7730  acc: 0.7028    test auc: 0.7714  acc: 0.7024, time: 0.3231
epoch 42    train auc: 0.9341  acc: 0.8327    eval auc: 0.7732  acc: 0.7035    test auc: 0.7712  acc: 0.7040, time: 0.5436
epoch 43    train auc: 0.9346  acc: 0.8343    eval auc: 0.7723  acc: 0.7023    test auc: 0.7706  acc: 0.7017, time: 0.3216
epoch 44    train auc: 0.9348  acc: 0.8335    eval auc: 0.7725  acc: 0.7027    test auc: 0.7706  acc: 0.7028, time: 0.5281
epoch 45    train auc: 0.9350  acc: 0.8334    eval auc: 0.7724  acc: 0.7028    test auc: 0.7704  acc: 0.7026, time: 0.3196
epoch 46    train auc: 0.9355  acc: 0.8347    eval auc: 0.7718  acc: 0.7022    test auc: 0.7699  acc: 0.7019, time: 0.5274
epoch 47    train auc: 0.9357  acc: 0.8345    eval auc: 0.7714  acc: 0.7033    test auc: 0.7695  acc: 0.7017, time: 0.3201
epoch 48    train auc: 0.9363  acc: 0.8358    eval auc: 0.7697  acc: 0.6989    test auc: 0.7682  acc: 0.6990, time: 0.5252
epoch 49    train auc: 0.9363  acc: 0.8350    eval auc: 0.7707  acc: 0.7017    test auc: 0.7688  acc: 0.7017, time: 0.3168
avg time per epoch : 0.44305914878845215
--- 28.166457414627075 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:34:11.417515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:34:11.417884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4956  acc: 0.4978    eval auc: 0.5087  acc: 0.5045    test auc: 0.5043  acc: 0.5019, time: 0.8402
epoch 1    train auc: 0.7299  acc: 0.6559    eval auc: 0.6449  acc: 0.6125    test auc: 0.6558  acc: 0.6168, time: 0.3258
epoch 2    train auc: 0.8683  acc: 0.7384    eval auc: 0.7640  acc: 0.7173    test auc: 0.7723  acc: 0.7263, time: 0.5180
epoch 3    train auc: 0.8939  acc: 0.7801    eval auc: 0.7896  acc: 0.7480    test auc: 0.7930  acc: 0.7558, time: 0.3244
epoch 4    train auc: 0.9032  acc: 0.7968    eval auc: 0.7927  acc: 0.7447    test auc: 0.7952  acc: 0.7428, time: 0.5194
epoch 5    train auc: 0.9096  acc: 0.8073    eval auc: 0.7934  acc: 0.7340    test auc: 0.7946  acc: 0.7259, time: 0.3389
epoch 6    train auc: 0.9151  acc: 0.8127    eval auc: 0.7924  acc: 0.7304    test auc: 0.7923  acc: 0.7223, time: 0.5237
epoch 7    train auc: 0.9217  acc: 0.8200    eval auc: 0.7861  acc: 0.7133    test auc: 0.7845  acc: 0.7080, time: 0.3186
epoch 8    train auc: 0.9244  acc: 0.8197    eval auc: 0.7857  acc: 0.7196    test auc: 0.7841  acc: 0.7134, time: 0.5210
epoch 9    train auc: 0.9286  acc: 0.8262    eval auc: 0.7792  acc: 0.7087    test auc: 0.7771  acc: 0.7022, time: 0.3218
epoch 10    train auc: 0.9295  acc: 0.8260    eval auc: 0.7805  acc: 0.7106    test auc: 0.7788  acc: 0.7039, time: 0.5232
epoch 11    train auc: 0.9322  acc: 0.8278    eval auc: 0.7770  acc: 0.7054    test auc: 0.7746  acc: 0.7040, time: 0.3154
epoch 12    train auc: 0.9311  acc: 0.8262    eval auc: 0.7814  acc: 0.7159    test auc: 0.7789  acc: 0.7086, time: 0.5119
epoch 13    train auc: 0.9354  acc: 0.8358    eval auc: 0.7721  acc: 0.6983    test auc: 0.7697  acc: 0.6958, time: 0.3223
epoch 14    train auc: 0.9350  acc: 0.8334    eval auc: 0.7763  acc: 0.7065    test auc: 0.7746  acc: 0.7049, time: 0.5131
epoch 15    train auc: 0.9373  acc: 0.8383    eval auc: 0.7687  acc: 0.6976    test auc: 0.7654  acc: 0.6943, time: 0.3149
epoch 16    train auc: 0.9375  acc: 0.8351    eval auc: 0.7726  acc: 0.7015    test auc: 0.7702  acc: 0.6981, time: 0.5116
epoch 17    train auc: 0.9402  acc: 0.8427    eval auc: 0.7675  acc: 0.6948    test auc: 0.7653  acc: 0.6921, time: 0.3170
epoch 18    train auc: 0.9389  acc: 0.8356    eval auc: 0.7733  acc: 0.7042    test auc: 0.7711  acc: 0.7019, time: 0.5147
epoch 19    train auc: 0.9415  acc: 0.8425    eval auc: 0.7649  acc: 0.6919    test auc: 0.7637  acc: 0.6906, time: 0.3172
epoch 20    train auc: 0.9422  acc: 0.8415    eval auc: 0.7671  acc: 0.6959    test auc: 0.7652  acc: 0.6935, time: 0.5166
epoch 21    train auc: 0.9440  acc: 0.8450    eval auc: 0.7638  acc: 0.6926    test auc: 0.7618  acc: 0.6900, time: 0.3160
epoch 22    train auc: 0.9429  acc: 0.8419    eval auc: 0.7683  acc: 0.6980    test auc: 0.7662  acc: 0.6942, time: 0.5341
epoch 23    train auc: 0.9442  acc: 0.8446    eval auc: 0.7662  acc: 0.6968    test auc: 0.7642  acc: 0.6945, time: 0.3160
epoch 24    train auc: 0.9452  acc: 0.8452    eval auc: 0.7631  acc: 0.6930    test auc: 0.7615  acc: 0.6922, time: 0.5366
epoch 25    train auc: 0.9464  acc: 0.8480    eval auc: 0.7617  acc: 0.6906    test auc: 0.7598  acc: 0.6893, time: 0.3161
epoch 26    train auc: 0.9453  acc: 0.8446    eval auc: 0.7648  acc: 0.6945    test auc: 0.7631  acc: 0.6928, time: 0.5293
epoch 27    train auc: 0.9475  acc: 0.8501    eval auc: 0.7601  acc: 0.6886    test auc: 0.7580  acc: 0.6889, time: 0.3321
epoch 28    train auc: 0.9471  acc: 0.8470    eval auc: 0.7626  acc: 0.6913    test auc: 0.7607  acc: 0.6906, time: 0.5233
epoch 29    train auc: 0.9484  acc: 0.8500    eval auc: 0.7597  acc: 0.6887    test auc: 0.7580  acc: 0.6892, time: 0.3172
epoch 30    train auc: 0.9458  acc: 0.8450    eval auc: 0.7623  acc: 0.6916    test auc: 0.7597  acc: 0.6906, time: 0.5270
epoch 31    train auc: 0.9494  acc: 0.8517    eval auc: 0.7577  acc: 0.6846    test auc: 0.7563  acc: 0.6884, time: 0.3116
epoch 32    train auc: 0.9473  acc: 0.8464    eval auc: 0.7598  acc: 0.6887    test auc: 0.7577  acc: 0.6892, time: 0.5427
epoch 33    train auc: 0.9505  acc: 0.8549    eval auc: 0.7548  acc: 0.6817    test auc: 0.7528  acc: 0.6813, time: 0.3395
epoch 34    train auc: 0.9500  acc: 0.8539    eval auc: 0.7572  acc: 0.6838    test auc: 0.7550  acc: 0.6841, time: 0.5288
epoch 35    train auc: 0.9520  acc: 0.8568    eval auc: 0.7525  acc: 0.6794    test auc: 0.7516  acc: 0.6813, time: 0.3104
epoch 36    train auc: 0.9523  acc: 0.8573    eval auc: 0.7553  acc: 0.6814    test auc: 0.7545  acc: 0.6834, time: 0.5258
epoch 37    train auc: 0.9538  acc: 0.8605    eval auc: 0.7536  acc: 0.6791    test auc: 0.7523  acc: 0.6780, time: 0.3446
epoch 38    train auc: 0.9544  acc: 0.8611    eval auc: 0.7540  acc: 0.6795    test auc: 0.7526  acc: 0.6801, time: 0.5529
epoch 39    train auc: 0.9566  acc: 0.8658    eval auc: 0.7515  acc: 0.6775    test auc: 0.7503  acc: 0.6774, time: 0.3160
epoch 40    train auc: 0.9572  acc: 0.8682    eval auc: 0.7529  acc: 0.6828    test auc: 0.7519  acc: 0.6799, time: 0.5327
epoch 41    train auc: 0.9607  acc: 0.8744    eval auc: 0.7493  acc: 0.6755    test auc: 0.7490  acc: 0.6766, time: 0.3250
epoch 42    train auc: 0.9630  acc: 0.8812    eval auc: 0.7504  acc: 0.6787    test auc: 0.7500  acc: 0.6780, time: 0.6610
epoch 43    train auc: 0.9651  acc: 0.8841    eval auc: 0.7506  acc: 0.6815    test auc: 0.7502  acc: 0.6801, time: 0.3500
epoch 44    train auc: 0.9668  acc: 0.8889    eval auc: 0.7502  acc: 0.6800    test auc: 0.7498  acc: 0.6787, time: 0.5810
epoch 45    train auc: 0.9698  acc: 0.8953    eval auc: 0.7464  acc: 0.6760    test auc: 0.7456  acc: 0.6754, time: 0.3540
epoch 46    train auc: 0.9708  acc: 0.8949    eval auc: 0.7481  acc: 0.6794    test auc: 0.7476  acc: 0.6747, time: 0.6000
epoch 47    train auc: 0.9729  acc: 0.9021    eval auc: 0.7460  acc: 0.6799    test auc: 0.7450  acc: 0.6788, time: 0.3549
epoch 48    train auc: 0.9741  acc: 0.9048    eval auc: 0.7474  acc: 0.6812    test auc: 0.7468  acc: 0.6788, time: 0.5630
epoch 49    train auc: 0.9753  acc: 0.9069    eval auc: 0.7438  acc: 0.6784    test auc: 0.7429  acc: 0.6746, time: 0.3560
avg time per epoch : 0.4385432863235474
--- 27.962337970733643 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:34:39.302711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:34:39.303052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5453  acc: 0.5285    eval auc: 0.5276  acc: 0.5139    test auc: 0.5224  acc: 0.5143, time: 0.8075
epoch 1    train auc: 0.5287  acc: 0.5153    eval auc: 0.4953  acc: 0.4929    test auc: 0.4886  acc: 0.4864, time: 0.3569
epoch 2    train auc: 0.6573  acc: 0.5243    eval auc: 0.6227  acc: 0.5038    test auc: 0.6221  acc: 0.5016, time: 0.5381
epoch 3    train auc: 0.5601  acc: 0.5367    eval auc: 0.4768  acc: 0.4823    test auc: 0.4721  acc: 0.4777, time: 0.3097
epoch 4    train auc: 0.7174  acc: 0.6542    eval auc: 0.6043  acc: 0.5736    test auc: 0.6149  acc: 0.5834, time: 0.5109
epoch 5    train auc: 0.7467  acc: 0.6785    eval auc: 0.6226  acc: 0.5995    test auc: 0.6343  acc: 0.6121, time: 0.3149
epoch 6    train auc: 0.8449  acc: 0.7534    eval auc: 0.7250  acc: 0.6991    test auc: 0.7313  acc: 0.7048, time: 0.5131
epoch 7    train auc: 0.8635  acc: 0.7565    eval auc: 0.7410  acc: 0.7172    test auc: 0.7451  acc: 0.7202, time: 0.3193
epoch 8    train auc: 0.8831  acc: 0.7775    eval auc: 0.7655  acc: 0.7328    test auc: 0.7678  acc: 0.7365, time: 0.5123
epoch 9    train auc: 0.8875  acc: 0.7819    eval auc: 0.7658  acc: 0.7302    test auc: 0.7675  acc: 0.7328, time: 0.3124
epoch 10    train auc: 0.8940  acc: 0.8000    eval auc: 0.7744  acc: 0.7313    test auc: 0.7757  acc: 0.7278, time: 0.5421
epoch 11    train auc: 0.8967  acc: 0.7915    eval auc: 0.7714  acc: 0.7292    test auc: 0.7722  acc: 0.7321, time: 0.3206
epoch 12    train auc: 0.9008  acc: 0.8018    eval auc: 0.7772  acc: 0.7330    test auc: 0.7776  acc: 0.7304, time: 0.5084
epoch 13    train auc: 0.9028  acc: 0.8050    eval auc: 0.7739  acc: 0.7281    test auc: 0.7740  acc: 0.7222, time: 0.3084
epoch 14    train auc: 0.9058  acc: 0.8116    eval auc: 0.7787  acc: 0.7269    test auc: 0.7785  acc: 0.7216, time: 0.5041
epoch 15    train auc: 0.9076  acc: 0.8108    eval auc: 0.7759  acc: 0.7237    test auc: 0.7753  acc: 0.7198, time: 0.3019
epoch 16    train auc: 0.9098  acc: 0.8151    eval auc: 0.7794  acc: 0.7259    test auc: 0.7785  acc: 0.7212, time: 0.5039
epoch 17    train auc: 0.9113  acc: 0.8176    eval auc: 0.7766  acc: 0.7186    test auc: 0.7755  acc: 0.7143, time: 0.3036
epoch 18    train auc: 0.9130  acc: 0.8174    eval auc: 0.7802  acc: 0.7245    test auc: 0.7788  acc: 0.7199, time: 0.5115
epoch 19    train auc: 0.9142  acc: 0.8181    eval auc: 0.7774  acc: 0.7226    test auc: 0.7756  acc: 0.7167, time: 0.3410
epoch 20    train auc: 0.9156  acc: 0.8197    eval auc: 0.7803  acc: 0.7229    test auc: 0.7784  acc: 0.7194, time: 0.5458
epoch 21    train auc: 0.9167  acc: 0.8202    eval auc: 0.7775  acc: 0.7219    test auc: 0.7752  acc: 0.7151, time: 0.3236
epoch 22    train auc: 0.9178  acc: 0.8210    eval auc: 0.7805  acc: 0.7244    test auc: 0.7780  acc: 0.7187, time: 0.5138
epoch 23    train auc: 0.9188  acc: 0.8235    eval auc: 0.7772  acc: 0.7170    test auc: 0.7747  acc: 0.7120, time: 0.3022
epoch 24    train auc: 0.9196  acc: 0.8225    eval auc: 0.7801  acc: 0.7193    test auc: 0.7776  acc: 0.7145, time: 0.4964
epoch 25    train auc: 0.9206  acc: 0.8244    eval auc: 0.7776  acc: 0.7190    test auc: 0.7748  acc: 0.7140, time: 0.3034
epoch 26    train auc: 0.9213  acc: 0.8240    eval auc: 0.7799  acc: 0.7194    test auc: 0.7773  acc: 0.7143, time: 0.5021
epoch 27    train auc: 0.9222  acc: 0.8258    eval auc: 0.7773  acc: 0.7179    test auc: 0.7743  acc: 0.7140, time: 0.3002
epoch 28    train auc: 0.9227  acc: 0.8254    eval auc: 0.7792  acc: 0.7156    test auc: 0.7765  acc: 0.7111, time: 0.4957
epoch 29    train auc: 0.9236  acc: 0.8253    eval auc: 0.7773  acc: 0.7192    test auc: 0.7741  acc: 0.7146, time: 0.3022
epoch 30    train auc: 0.9240  acc: 0.8257    eval auc: 0.7788  acc: 0.7153    test auc: 0.7759  acc: 0.7118, time: 0.5222
epoch 31    train auc: 0.9250  acc: 0.8273    eval auc: 0.7760  acc: 0.7140    test auc: 0.7728  acc: 0.7105, time: 0.3470
epoch 32    train auc: 0.9252  acc: 0.8251    eval auc: 0.7787  acc: 0.7206    test auc: 0.7755  acc: 0.7166, time: 0.5255
epoch 33    train auc: 0.9261  acc: 0.8274    eval auc: 0.7759  acc: 0.7120    test auc: 0.7727  acc: 0.7096, time: 0.2993
epoch 34    train auc: 0.9263  acc: 0.8272    eval auc: 0.7775  acc: 0.7139    test auc: 0.7746  acc: 0.7101, time: 0.5013
epoch 35    train auc: 0.9272  acc: 0.8290    eval auc: 0.7753  acc: 0.7069    test auc: 0.7722  acc: 0.7059, time: 0.3320
epoch 36    train auc: 0.9271  acc: 0.8263    eval auc: 0.7781  acc: 0.7180    test auc: 0.7750  acc: 0.7151, time: 0.4936
epoch 37    train auc: 0.9281  acc: 0.8301    eval auc: 0.7745  acc: 0.7073    test auc: 0.7715  acc: 0.7059, time: 0.3119
epoch 38    train auc: 0.9282  acc: 0.8287    eval auc: 0.7769  acc: 0.7148    test auc: 0.7736  acc: 0.7128, time: 0.4903
epoch 39    train auc: 0.9291  acc: 0.8304    eval auc: 0.7735  acc: 0.7069    test auc: 0.7703  acc: 0.7050, time: 0.3096
epoch 40    train auc: 0.9289  acc: 0.8293    eval auc: 0.7767  acc: 0.7152    test auc: 0.7737  acc: 0.7118, time: 0.4878
epoch 41    train auc: 0.9298  acc: 0.8309    eval auc: 0.7739  acc: 0.7080    test auc: 0.7707  acc: 0.7059, time: 0.3033
epoch 42    train auc: 0.9297  acc: 0.8297    eval auc: 0.7759  acc: 0.7130    test auc: 0.7728  acc: 0.7095, time: 0.4875
epoch 43    train auc: 0.9306  acc: 0.8311    eval auc: 0.7733  acc: 0.7087    test auc: 0.7699  acc: 0.7062, time: 0.2969
epoch 44    train auc: 0.9305  acc: 0.8307    eval auc: 0.7753  acc: 0.7127    test auc: 0.7721  acc: 0.7093, time: 0.4998
epoch 45    train auc: 0.9311  acc: 0.8310    eval auc: 0.7735  acc: 0.7118    test auc: 0.7699  acc: 0.7088, time: 0.3211
epoch 46    train auc: 0.9311  acc: 0.8308    eval auc: 0.7748  acc: 0.7117    test auc: 0.7717  acc: 0.7092, time: 0.4788
epoch 47    train auc: 0.9319  acc: 0.8322    eval auc: 0.7727  acc: 0.7109    test auc: 0.7691  acc: 0.7067, time: 0.2974
epoch 48    train auc: 0.9320  acc: 0.8321    eval auc: 0.7733  acc: 0.7087    test auc: 0.7702  acc: 0.7078, time: 0.4860
epoch 49    train auc: 0.9325  acc: 0.8330    eval auc: 0.7724  acc: 0.7100    test auc: 0.7688  acc: 0.7060, time: 0.2998
avg time per epoch : 0.4163366222381592
--- 26.604307174682617 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:35:05.879982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:35:05.880300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5038  acc: 0.5039    eval auc: 0.4989  acc: 0.4946    test auc: 0.4898  acc: 0.4940, time: 0.8552
epoch 1    train auc: 0.4920  acc: 0.4988    eval auc: 0.5346  acc: 0.5032    test auc: 0.5383  acc: 0.5024, time: 0.3110
epoch 2    train auc: 0.8412  acc: 0.7465    eval auc: 0.7709  acc: 0.7205    test auc: 0.7786  acc: 0.7314, time: 0.4830
epoch 3    train auc: 0.8683  acc: 0.7686    eval auc: 0.7789  acc: 0.7411    test auc: 0.7866  acc: 0.7485, time: 0.2889
epoch 4    train auc: 0.8917  acc: 0.7763    eval auc: 0.7970  acc: 0.7459    test auc: 0.8002  acc: 0.7525, time: 0.4800
epoch 5    train auc: 0.9053  acc: 0.7970    eval auc: 0.7891  acc: 0.7408    test auc: 0.7919  acc: 0.7435, time: 0.2897
epoch 6    train auc: 0.9135  acc: 0.8015    eval auc: 0.7907  acc: 0.7339    test auc: 0.7895  acc: 0.7337, time: 0.4709
epoch 7    train auc: 0.9214  acc: 0.8181    eval auc: 0.7798  acc: 0.7126    test auc: 0.7786  acc: 0.7101, time: 0.3110
epoch 8    train auc: 0.9233  acc: 0.8133    eval auc: 0.7837  acc: 0.7164    test auc: 0.7810  acc: 0.7132, time: 0.4727
epoch 9    train auc: 0.9282  acc: 0.8249    eval auc: 0.7732  acc: 0.6948    test auc: 0.7719  acc: 0.6950, time: 0.3041
epoch 10    train auc: 0.9279  acc: 0.8158    eval auc: 0.7823  acc: 0.7126    test auc: 0.7790  acc: 0.7115, time: 0.4710
epoch 11    train auc: 0.9305  acc: 0.8211    eval auc: 0.7791  acc: 0.7107    test auc: 0.7758  acc: 0.7083, time: 0.2869
epoch 12    train auc: 0.9317  acc: 0.8252    eval auc: 0.7802  acc: 0.7095    test auc: 0.7776  acc: 0.7118, time: 0.4705
epoch 13    train auc: 0.9357  acc: 0.8337    eval auc: 0.7694  acc: 0.6924    test auc: 0.7681  acc: 0.6942, time: 0.2952
epoch 14    train auc: 0.9370  acc: 0.8355    eval auc: 0.7719  acc: 0.6965    test auc: 0.7706  acc: 0.7009, time: 0.4734
epoch 15    train auc: 0.9391  acc: 0.8388    eval auc: 0.7658  acc: 0.6908    test auc: 0.7648  acc: 0.6929, time: 0.2977
epoch 16    train auc: 0.9386  acc: 0.8365    eval auc: 0.7705  acc: 0.6964    test auc: 0.7686  acc: 0.7019, time: 0.4866
epoch 17    train auc: 0.9418  acc: 0.8430    eval auc: 0.7645  acc: 0.6905    test auc: 0.7635  acc: 0.6919, time: 0.3163
epoch 18    train auc: 0.9420  acc: 0.8408    eval auc: 0.7684  acc: 0.6948    test auc: 0.7671  acc: 0.6969, time: 0.4968
epoch 19    train auc: 0.9442  acc: 0.8444    eval auc: 0.7616  acc: 0.6886    test auc: 0.7604  acc: 0.6880, time: 0.2870
epoch 20    train auc: 0.9443  acc: 0.8452    eval auc: 0.7649  acc: 0.6929    test auc: 0.7626  acc: 0.6934, time: 0.4936
epoch 21    train auc: 0.9465  acc: 0.8480    eval auc: 0.7605  acc: 0.6876    test auc: 0.7590  acc: 0.6882, time: 0.2970
epoch 22    train auc: 0.9457  acc: 0.8463    eval auc: 0.7642  acc: 0.6919    test auc: 0.7620  acc: 0.6916, time: 0.5980
epoch 23    train auc: 0.9472  acc: 0.8489    eval auc: 0.7614  acc: 0.6909    test auc: 0.7596  acc: 0.6902, time: 0.3680
epoch 24    train auc: 0.9482  acc: 0.8503    eval auc: 0.7593  acc: 0.6876    test auc: 0.7573  acc: 0.6890, time: 0.5820
epoch 25    train auc: 0.9492  acc: 0.8535    eval auc: 0.7587  acc: 0.6870    test auc: 0.7573  acc: 0.6872, time: 0.3760
epoch 26    train auc: 0.9494  acc: 0.8531    eval auc: 0.7587  acc: 0.6858    test auc: 0.7574  acc: 0.6890, time: 0.5780
epoch 27    train auc: 0.9509  acc: 0.8556    eval auc: 0.7556  acc: 0.6852    test auc: 0.7547  acc: 0.6874, time: 0.3235
epoch 28    train auc: 0.9501  acc: 0.8538    eval auc: 0.7586  acc: 0.6854    test auc: 0.7571  acc: 0.6912, time: 0.5503
epoch 29    train auc: 0.9521  acc: 0.8576    eval auc: 0.7538  acc: 0.6817    test auc: 0.7535  acc: 0.6845, time: 0.3166
epoch 30    train auc: 0.9501  acc: 0.8541    eval auc: 0.7574  acc: 0.6846    test auc: 0.7555  acc: 0.6878, time: 0.4834
epoch 31    train auc: 0.9533  acc: 0.8606    eval auc: 0.7514  acc: 0.6792    test auc: 0.7515  acc: 0.6828, time: 0.2989
epoch 32    train auc: 0.9510  acc: 0.8551    eval auc: 0.7554  acc: 0.6845    test auc: 0.7541  acc: 0.6839, time: 0.5359
epoch 33    train auc: 0.9548  acc: 0.8631    eval auc: 0.7501  acc: 0.6773    test auc: 0.7496  acc: 0.6804, time: 0.3393
epoch 34    train auc: 0.9532  acc: 0.8583    eval auc: 0.7533  acc: 0.6811    test auc: 0.7517  acc: 0.6834, time: 0.5140
epoch 35    train auc: 0.9551  acc: 0.8632    eval auc: 0.7470  acc: 0.6755    test auc: 0.7476  acc: 0.6787, time: 0.3393
epoch 36    train auc: 0.9562  acc: 0.8645    eval auc: 0.7505  acc: 0.6773    test auc: 0.7506  acc: 0.6818, time: 0.5547
epoch 37    train auc: 0.9571  acc: 0.8648    eval auc: 0.7484  acc: 0.6760    test auc: 0.7487  acc: 0.6801, time: 0.3359
epoch 38    train auc: 0.9569  acc: 0.8641    eval auc: 0.7503  acc: 0.6795    test auc: 0.7495  acc: 0.6812, time: 0.5089
epoch 39    train auc: 0.9580  acc: 0.8656    eval auc: 0.7481  acc: 0.6759    test auc: 0.7479  acc: 0.6800, time: 0.3303
epoch 40    train auc: 0.9575  acc: 0.8642    eval auc: 0.7501  acc: 0.6789    test auc: 0.7496  acc: 0.6819, time: 0.5371
epoch 41    train auc: 0.9599  acc: 0.8698    eval auc: 0.7466  acc: 0.6759    test auc: 0.7472  acc: 0.6806, time: 0.3106
epoch 42    train auc: 0.9604  acc: 0.8695    eval auc: 0.7469  acc: 0.6734    test auc: 0.7469  acc: 0.6775, time: 0.5217
epoch 43    train auc: 0.9613  acc: 0.8702    eval auc: 0.7453  acc: 0.6704    test auc: 0.7458  acc: 0.6765, time: 0.3145
epoch 44    train auc: 0.9605  acc: 0.8687    eval auc: 0.7474  acc: 0.6761    test auc: 0.7474  acc: 0.6778, time: 0.5314
epoch 45    train auc: 0.9632  acc: 0.8749    eval auc: 0.7440  acc: 0.6726    test auc: 0.7446  acc: 0.6774, time: 0.3188
epoch 46    train auc: 0.9641  acc: 0.8750    eval auc: 0.7433  acc: 0.6732    test auc: 0.7433  acc: 0.6752, time: 0.5059
epoch 47    train auc: 0.9646  acc: 0.8786    eval auc: 0.7436  acc: 0.6704    test auc: 0.7434  acc: 0.6768, time: 0.3068
epoch 48    train auc: 0.9652  acc: 0.8770    eval auc: 0.7432  acc: 0.6730    test auc: 0.7427  acc: 0.6772, time: 0.5012
epoch 49    train auc: 0.9661  acc: 0.8804    eval auc: 0.7408  acc: 0.6712    test auc: 0.7410  acc: 0.6756, time: 0.3096
avg time per epoch : 0.42059375286102296
--- 26.60173010826111 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 8, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:35:32.623134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:35:32.623433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5078  acc: 0.5054    eval auc: 0.4911  acc: 0.4926    test auc: 0.5064  acc: 0.5055, time: 0.8076
epoch 1    train auc: 0.5266  acc: 0.5180    eval auc: 0.4865  acc: 0.4916    test auc: 0.4904  acc: 0.4930, time: 0.3145
epoch 2    train auc: 0.5597  acc: 0.5354    eval auc: 0.4906  acc: 0.4977    test auc: 0.4880  acc: 0.4904, time: 0.5288
epoch 3    train auc: 0.6768  acc: 0.6130    eval auc: 0.5863  acc: 0.5779    test auc: 0.5906  acc: 0.5773, time: 0.3362
epoch 4    train auc: 0.7719  acc: 0.6577    eval auc: 0.6690  acc: 0.6368    test auc: 0.6764  acc: 0.6498, time: 0.5151
epoch 5    train auc: 0.8272  acc: 0.7040    eval auc: 0.7129  acc: 0.6806    test auc: 0.7197  acc: 0.6929, time: 0.3140
epoch 6    train auc: 0.8648  acc: 0.7281    eval auc: 0.7496  acc: 0.7039    test auc: 0.7542  acc: 0.7140, time: 0.5061
epoch 7    train auc: 0.8793  acc: 0.7569    eval auc: 0.7643  acc: 0.7272    test auc: 0.7687  acc: 0.7367, time: 0.3340
epoch 8    train auc: 0.8874  acc: 0.7628    eval auc: 0.7725  acc: 0.7331    test auc: 0.7763  acc: 0.7406, time: 0.5090
epoch 9    train auc: 0.8919  acc: 0.7814    eval auc: 0.7746  acc: 0.7405    test auc: 0.7788  acc: 0.7442, time: 0.3144
epoch 10    train auc: 0.8956  acc: 0.7938    eval auc: 0.7755  acc: 0.7385    test auc: 0.7797  acc: 0.7400, time: 0.5153
epoch 11    train auc: 0.8997  acc: 0.7914    eval auc: 0.7767  acc: 0.7392    test auc: 0.7796  acc: 0.7394, time: 0.3199
epoch 12    train auc: 0.9030  acc: 0.7949    eval auc: 0.7769  acc: 0.7344    test auc: 0.7793  acc: 0.7379, time: 0.5150
epoch 13    train auc: 0.9056  acc: 0.8070    eval auc: 0.7759  acc: 0.7251    test auc: 0.7782  acc: 0.7244, time: 0.3142
epoch 14    train auc: 0.9083  acc: 0.8124    eval auc: 0.7760  acc: 0.7186    test auc: 0.7780  acc: 0.7194, time: 0.5087
epoch 15    train auc: 0.9107  acc: 0.8136    eval auc: 0.7764  acc: 0.7206    test auc: 0.7778  acc: 0.7194, time: 0.3139
epoch 16    train auc: 0.9128  acc: 0.8164    eval auc: 0.7764  acc: 0.7183    test auc: 0.7774  acc: 0.7177, time: 0.5158
epoch 17    train auc: 0.9147  acc: 0.8194    eval auc: 0.7760  acc: 0.7115    test auc: 0.7771  acc: 0.7138, time: 0.3089
epoch 18    train auc: 0.9165  acc: 0.8177    eval auc: 0.7770  acc: 0.7186    test auc: 0.7776  acc: 0.7189, time: 0.5126
epoch 19    train auc: 0.9180  acc: 0.8203    eval auc: 0.7763  acc: 0.7117    test auc: 0.7768  acc: 0.7121, time: 0.3208
epoch 20    train auc: 0.9194  acc: 0.8206    eval auc: 0.7763  acc: 0.7146    test auc: 0.7764  acc: 0.7140, time: 0.5136
epoch 21    train auc: 0.9207  acc: 0.8227    eval auc: 0.7758  acc: 0.7113    test auc: 0.7759  acc: 0.7115, time: 0.3169
epoch 22    train auc: 0.9218  acc: 0.8215    eval auc: 0.7766  acc: 0.7157    test auc: 0.7761  acc: 0.7125, time: 0.5273
epoch 23    train auc: 0.9229  acc: 0.8243    eval auc: 0.7753  acc: 0.7086    test auc: 0.7749  acc: 0.7073, time: 0.3365
epoch 24    train auc: 0.9239  acc: 0.8250    eval auc: 0.7758  acc: 0.7106    test auc: 0.7753  acc: 0.7092, time: 0.5053
epoch 25    train auc: 0.9248  acc: 0.8251    eval auc: 0.7756  acc: 0.7102    test auc: 0.7749  acc: 0.7080, time: 0.3060
epoch 26    train auc: 0.9257  acc: 0.8263    eval auc: 0.7751  acc: 0.7095    test auc: 0.7744  acc: 0.7066, time: 0.5059
epoch 27    train auc: 0.9264  acc: 0.8254    eval auc: 0.7747  acc: 0.7105    test auc: 0.7736  acc: 0.7068, time: 0.3100
epoch 28    train auc: 0.9272  acc: 0.8299    eval auc: 0.7739  acc: 0.7069    test auc: 0.7731  acc: 0.7016, time: 0.5030
epoch 29    train auc: 0.9278  acc: 0.8263    eval auc: 0.7749  acc: 0.7099    test auc: 0.7735  acc: 0.7076, time: 0.3222
epoch 30    train auc: 0.9286  acc: 0.8312    eval auc: 0.7731  acc: 0.7062    test auc: 0.7721  acc: 0.7024, time: 0.5142
epoch 31    train auc: 0.9293  acc: 0.8306    eval auc: 0.7721  acc: 0.7058    test auc: 0.7708  acc: 0.7021, time: 0.3067
epoch 32    train auc: 0.9296  acc: 0.8281    eval auc: 0.7740  acc: 0.7091    test auc: 0.7724  acc: 0.7068, time: 0.5329
epoch 33    train auc: 0.9304  acc: 0.8326    eval auc: 0.7722  acc: 0.7049    test auc: 0.7708  acc: 0.7011, time: 0.3164
epoch 34    train auc: 0.9310  acc: 0.8339    eval auc: 0.7713  acc: 0.7021    test auc: 0.7701  acc: 0.6993, time: 0.5415
epoch 35    train auc: 0.9315  acc: 0.8345    eval auc: 0.7710  acc: 0.7019    test auc: 0.7697  acc: 0.6989, time: 0.3215
epoch 36    train auc: 0.9317  acc: 0.8314    eval auc: 0.7730  acc: 0.7069    test auc: 0.7713  acc: 0.7043, time: 0.5127
epoch 37    train auc: 0.9324  acc: 0.8356    eval auc: 0.7704  acc: 0.7009    test auc: 0.7692  acc: 0.6991, time: 0.3117
epoch 38    train auc: 0.9329  acc: 0.8334    eval auc: 0.7709  acc: 0.7040    test auc: 0.7690  acc: 0.7002, time: 0.5065
epoch 39    train auc: 0.9334  acc: 0.8364    eval auc: 0.7687  acc: 0.6993    test auc: 0.7674  acc: 0.6967, time: 0.3129
epoch 40    train auc: 0.9337  acc: 0.8344    eval auc: 0.7709  acc: 0.7030    test auc: 0.7692  acc: 0.6998, time: 0.5039
epoch 41    train auc: 0.9343  acc: 0.8364    eval auc: 0.7690  acc: 0.7011    test auc: 0.7674  acc: 0.6987, time: 0.3122
epoch 42    train auc: 0.9346  acc: 0.8362    eval auc: 0.7691  acc: 0.7006    test auc: 0.7673  acc: 0.6987, time: 0.5073
epoch 43    train auc: 0.9351  acc: 0.8371    eval auc: 0.7686  acc: 0.6997    test auc: 0.7669  acc: 0.6980, time: 0.3088
epoch 44    train auc: 0.9353  acc: 0.8360    eval auc: 0.7690  acc: 0.6998    test auc: 0.7671  acc: 0.6970, time: 0.5339
epoch 45    train auc: 0.9356  acc: 0.8374    eval auc: 0.7687  acc: 0.6983    test auc: 0.7666  acc: 0.6983, time: 0.3435
epoch 46    train auc: 0.9360  acc: 0.8382    eval auc: 0.7685  acc: 0.7006    test auc: 0.7666  acc: 0.6967, time: 0.5107
epoch 47    train auc: 0.9364  acc: 0.8380    eval auc: 0.7677  acc: 0.6985    test auc: 0.7657  acc: 0.6971, time: 0.3059
epoch 48    train auc: 0.9368  acc: 0.8387    eval auc: 0.7664  acc: 0.6967    test auc: 0.7648  acc: 0.6957, time: 0.5419
epoch 49    train auc: 0.9369  acc: 0.8382    eval auc: 0.7675  acc: 0.6987    test auc: 0.7654  acc: 0.6978, time: 0.3223
avg time per epoch : 0.42278374671936036
--- 26.63208246231079 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:35:59.282150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:35:59.282520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4907  acc: 0.4983    eval auc: 0.5129  acc: 0.5022    test auc: 0.5179  acc: 0.5042, time: 1.1833
epoch 1    train auc: 0.5116  acc: 0.5130    eval auc: 0.4992  acc: 0.4972    test auc: 0.4993  acc: 0.4904, time: 0.8259
epoch 2    train auc: 0.8667  acc: 0.7637    eval auc: 0.7812  acc: 0.7347    test auc: 0.7890  acc: 0.7464, time: 0.7819
epoch 3    train auc: 0.8932  acc: 0.7855    eval auc: 0.7919  acc: 0.7463    test auc: 0.7959  acc: 0.7539, time: 0.7999
epoch 4    train auc: 0.9045  acc: 0.7951    eval auc: 0.7930  acc: 0.7414    test auc: 0.7946  acc: 0.7432, time: 0.8100
epoch 5    train auc: 0.9123  acc: 0.8033    eval auc: 0.7905  acc: 0.7317    test auc: 0.7899  acc: 0.7315, time: 0.8219
epoch 6    train auc: 0.9164  acc: 0.8080    eval auc: 0.7883  acc: 0.7271    test auc: 0.7878  acc: 0.7252, time: 0.8579
epoch 7    train auc: 0.9206  acc: 0.8116    eval auc: 0.7857  acc: 0.7233    test auc: 0.7853  acc: 0.7202, time: 0.8500
epoch 8    train auc: 0.9245  acc: 0.8139    eval auc: 0.7827  acc: 0.7172    test auc: 0.7817  acc: 0.7156, time: 0.8149
epoch 9    train auc: 0.9254  acc: 0.8133    eval auc: 0.7833  acc: 0.7200    test auc: 0.7818  acc: 0.7190, time: 0.8089
epoch 10    train auc: 0.9275  acc: 0.8152    eval auc: 0.7817  acc: 0.7197    test auc: 0.7801  acc: 0.7173, time: 0.8259
epoch 11    train auc: 0.9295  acc: 0.8181    eval auc: 0.7801  acc: 0.7160    test auc: 0.7784  acc: 0.7163, time: 0.7870
epoch 12    train auc: 0.9317  acc: 0.8229    eval auc: 0.7776  acc: 0.7118    test auc: 0.7759  acc: 0.7096, time: 0.7900
epoch 13    train auc: 0.9321  acc: 0.8235    eval auc: 0.7781  acc: 0.7138    test auc: 0.7760  acc: 0.7127, time: 0.7949
epoch 14    train auc: 0.9344  acc: 0.8283    eval auc: 0.7734  acc: 0.7046    test auc: 0.7730  acc: 0.7055, time: 0.7979
epoch 15    train auc: 0.9353  acc: 0.8277    eval auc: 0.7734  acc: 0.7054    test auc: 0.7725  acc: 0.7074, time: 0.8420
epoch 16    train auc: 0.9360  acc: 0.8281    eval auc: 0.7719  acc: 0.7020    test auc: 0.7721  acc: 0.7070, time: 0.8140
epoch 17    train auc: 0.9371  acc: 0.8293    eval auc: 0.7707  acc: 0.7001    test auc: 0.7695  acc: 0.7039, time: 0.8230
epoch 18    train auc: 0.9385  acc: 0.8329    eval auc: 0.7692  acc: 0.7008    test auc: 0.7692  acc: 0.7045, time: 0.7589
epoch 19    train auc: 0.9394  acc: 0.8339    eval auc: 0.7677  acc: 0.6980    test auc: 0.7682  acc: 0.7045, time: 0.7929
epoch 20    train auc: 0.9402  acc: 0.8358    eval auc: 0.7663  acc: 0.6981    test auc: 0.7669  acc: 0.7029, time: 0.8033
epoch 21    train auc: 0.9413  acc: 0.8364    eval auc: 0.7659  acc: 0.6967    test auc: 0.7664  acc: 0.7007, time: 0.7650
epoch 22    train auc: 0.9409  acc: 0.8370    eval auc: 0.7659  acc: 0.6994    test auc: 0.7670  acc: 0.7024, time: 0.7950
epoch 23    train auc: 0.9425  acc: 0.8384    eval auc: 0.7641  acc: 0.6967    test auc: 0.7653  acc: 0.7013, time: 0.7909
epoch 24    train auc: 0.9429  acc: 0.8388    eval auc: 0.7641  acc: 0.6984    test auc: 0.7655  acc: 0.7028, time: 0.7990
epoch 25    train auc: 0.9439  acc: 0.8402    eval auc: 0.7625  acc: 0.6969    test auc: 0.7641  acc: 0.7016, time: 0.8169
epoch 26    train auc: 0.9444  acc: 0.8397    eval auc: 0.7626  acc: 0.6974    test auc: 0.7634  acc: 0.7015, time: 0.8290
epoch 27    train auc: 0.9459  acc: 0.8425    eval auc: 0.7604  acc: 0.6943    test auc: 0.7610  acc: 0.6981, time: 0.8090
epoch 28    train auc: 0.9467  acc: 0.8437    eval auc: 0.7598  acc: 0.6948    test auc: 0.7602  acc: 0.6971, time: 0.8870
epoch 29    train auc: 0.9468  acc: 0.8437    eval auc: 0.7602  acc: 0.6965    test auc: 0.7605  acc: 0.6987, time: 0.8939
epoch 30    train auc: 0.9486  acc: 0.8476    eval auc: 0.7584  acc: 0.6931    test auc: 0.7589  acc: 0.6967, time: 0.9109
epoch 31    train auc: 0.9495  acc: 0.8472    eval auc: 0.7568  acc: 0.6926    test auc: 0.7572  acc: 0.6951, time: 0.9059
epoch 32    train auc: 0.9480  acc: 0.8443    eval auc: 0.7588  acc: 0.6951    test auc: 0.7591  acc: 0.6991, time: 0.8799
epoch 33    train auc: 0.9520  acc: 0.8529    eval auc: 0.7542  acc: 0.6897    test auc: 0.7554  acc: 0.6939, time: 0.8983
epoch 34    train auc: 0.9529  acc: 0.8538    eval auc: 0.7524  acc: 0.6866    test auc: 0.7527  acc: 0.6912, time: 0.8839
epoch 35    train auc: 0.9547  acc: 0.8565    eval auc: 0.7525  acc: 0.6871    test auc: 0.7544  acc: 0.6945, time: 0.8999
epoch 36    train auc: 0.9566  acc: 0.8574    eval auc: 0.7507  acc: 0.6872    test auc: 0.7524  acc: 0.6945, time: 0.8920
epoch 37    train auc: 0.9573  acc: 0.8585    eval auc: 0.7520  acc: 0.6889    test auc: 0.7546  acc: 0.6975, time: 0.9250
epoch 38    train auc: 0.9585  acc: 0.8595    eval auc: 0.7517  acc: 0.6890    test auc: 0.7540  acc: 0.6967, time: 0.9149
epoch 39    train auc: 0.9612  acc: 0.8648    eval auc: 0.7500  acc: 0.6895    test auc: 0.7525  acc: 0.6956, time: 0.9179
epoch 40    train auc: 0.9621  acc: 0.8674    eval auc: 0.7511  acc: 0.6910    test auc: 0.7544  acc: 0.6967, time: 0.9423
epoch 41    train auc: 0.9641  acc: 0.8720    eval auc: 0.7510  acc: 0.6909    test auc: 0.7548  acc: 0.6969, time: 0.8760
epoch 42    train auc: 0.9643  acc: 0.8715    eval auc: 0.7520  acc: 0.6917    test auc: 0.7552  acc: 0.6972, time: 0.8840
epoch 43    train auc: 0.9676  acc: 0.8780    eval auc: 0.7491  acc: 0.6879    test auc: 0.7514  acc: 0.6962, time: 0.8819
epoch 44    train auc: 0.9685  acc: 0.8793    eval auc: 0.7500  acc: 0.6903    test auc: 0.7522  acc: 0.6952, time: 0.8870
epoch 45    train auc: 0.9701  acc: 0.8836    eval auc: 0.7485  acc: 0.6873    test auc: 0.7507  acc: 0.6975, time: 0.8809
epoch 46    train auc: 0.9719  acc: 0.8873    eval auc: 0.7475  acc: 0.6886    test auc: 0.7498  acc: 0.6972, time: 0.8997
epoch 47    train auc: 0.9739  acc: 0.8899    eval auc: 0.7456  acc: 0.6878    test auc: 0.7472  acc: 0.6948, time: 0.9230
epoch 48    train auc: 0.9751  acc: 0.8925    eval auc: 0.7440  acc: 0.6852    test auc: 0.7461  acc: 0.6951, time: 0.9089
epoch 49    train auc: 0.9756  acc: 0.8943    eval auc: 0.7439  acc: 0.6839    test auc: 0.7455  acc: 0.6943, time: 0.9180
avg time per epoch : 0.856020245552063
--- 52.366681814193726 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:36:51.636218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:36:51.636565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5379  acc: 0.5271    eval auc: 0.5524  acc: 0.5396    test auc: 0.5453  acc: 0.5321, time: 1.1544
epoch 1    train auc: 0.5488  acc: 0.5283    eval auc: 0.5806  acc: 0.5407    test auc: 0.5789  acc: 0.5394, time: 0.8820
epoch 2    train auc: 0.6537  acc: 0.5601    eval auc: 0.5587  acc: 0.5473    test auc: 0.5617  acc: 0.5426, time: 0.8749
epoch 3    train auc: 0.7106  acc: 0.5606    eval auc: 0.6793  acc: 0.5365    test auc: 0.6947  acc: 0.5454, time: 0.8700
epoch 4    train auc: 0.7812  acc: 0.4990    eval auc: 0.7600  acc: 0.4992    test auc: 0.7687  acc: 0.5038, time: 0.8740
epoch 5    train auc: 0.8373  acc: 0.4998    eval auc: 0.7692  acc: 0.4996    test auc: 0.7761  acc: 0.5037, time: 0.8660
epoch 6    train auc: 0.8654  acc: 0.7220    eval auc: 0.7783  acc: 0.6140    test auc: 0.7829  acc: 0.6099, time: 0.8740
epoch 7    train auc: 0.8758  acc: 0.7846    eval auc: 0.7839  acc: 0.7215    test auc: 0.7874  acc: 0.7238, time: 0.9080
epoch 8    train auc: 0.8801  acc: 0.7857    eval auc: 0.7871  acc: 0.7210    test auc: 0.7901  acc: 0.7218, time: 0.8881
epoch 9    train auc: 0.8832  acc: 0.7861    eval auc: 0.7895  acc: 0.7215    test auc: 0.7922  acc: 0.7233, time: 0.8769
epoch 10    train auc: 0.8859  acc: 0.7875    eval auc: 0.7918  acc: 0.7207    test auc: 0.7933  acc: 0.7235, time: 0.8900
epoch 11    train auc: 0.8876  acc: 0.7876    eval auc: 0.7923  acc: 0.7215    test auc: 0.7939  acc: 0.7211, time: 0.8710
epoch 12    train auc: 0.8896  acc: 0.7885    eval auc: 0.7929  acc: 0.7185    test auc: 0.7946  acc: 0.7180, time: 0.8700
epoch 13    train auc: 0.8912  acc: 0.7889    eval auc: 0.7931  acc: 0.7158    test auc: 0.7946  acc: 0.7154, time: 0.8789
epoch 14    train auc: 0.8939  acc: 0.7923    eval auc: 0.7939  acc: 0.7173    test auc: 0.7956  acc: 0.7150, time: 0.8680
epoch 15    train auc: 0.8956  acc: 0.7929    eval auc: 0.7942  acc: 0.7167    test auc: 0.7958  acc: 0.7140, time: 0.8619
epoch 16    train auc: 0.8978  acc: 0.7937    eval auc: 0.7947  acc: 0.7180    test auc: 0.7960  acc: 0.7138, time: 0.8880
epoch 17    train auc: 0.8994  acc: 0.7946    eval auc: 0.7950  acc: 0.7181    test auc: 0.7964  acc: 0.7140, time: 0.8770
epoch 18    train auc: 0.9012  acc: 0.7972    eval auc: 0.7952  acc: 0.7185    test auc: 0.7968  acc: 0.7131, time: 0.8799
epoch 19    train auc: 0.9019  acc: 0.7979    eval auc: 0.7949  acc: 0.7172    test auc: 0.7966  acc: 0.7131, time: 0.8730
epoch 20    train auc: 0.9023  acc: 0.7978    eval auc: 0.7945  acc: 0.7151    test auc: 0.7963  acc: 0.7120, time: 0.8720
epoch 21    train auc: 0.9027  acc: 0.7984    eval auc: 0.7941  acc: 0.7163    test auc: 0.7961  acc: 0.7122, time: 0.8750
epoch 22    train auc: 0.9028  acc: 0.7977    eval auc: 0.7935  acc: 0.7165    test auc: 0.7955  acc: 0.7134, time: 0.8590
epoch 23    train auc: 0.9025  acc: 0.7968    eval auc: 0.7927  acc: 0.7147    test auc: 0.7949  acc: 0.7109, time: 0.8530
epoch 24    train auc: 0.9031  acc: 0.7966    eval auc: 0.7925  acc: 0.7161    test auc: 0.7948  acc: 0.7112, time: 0.8500
epoch 25    train auc: 0.9032  acc: 0.7966    eval auc: 0.7919  acc: 0.7147    test auc: 0.7943  acc: 0.7096, time: 0.9280
epoch 26    train auc: 0.9033  acc: 0.7966    eval auc: 0.7913  acc: 0.7140    test auc: 0.7938  acc: 0.7088, time: 0.9010
epoch 27    train auc: 0.9033  acc: 0.7956    eval auc: 0.7906  acc: 0.7122    test auc: 0.7931  acc: 0.7062, time: 0.8690
epoch 28    train auc: 0.9037  acc: 0.7952    eval auc: 0.7902  acc: 0.7124    test auc: 0.7928  acc: 0.7061, time: 0.8529
epoch 29    train auc: 0.9040  acc: 0.7955    eval auc: 0.7898  acc: 0.7117    test auc: 0.7924  acc: 0.7048, time: 0.8970
epoch 30    train auc: 0.9044  acc: 0.7957    eval auc: 0.7895  acc: 0.7119    test auc: 0.7921  acc: 0.7049, time: 0.8690
epoch 31    train auc: 0.9048  acc: 0.7969    eval auc: 0.7891  acc: 0.7126    test auc: 0.7918  acc: 0.7050, time: 0.8370
epoch 32    train auc: 0.9051  acc: 0.7965    eval auc: 0.7886  acc: 0.7114    test auc: 0.7913  acc: 0.7042, time: 0.8263
epoch 33    train auc: 0.9054  acc: 0.7965    eval auc: 0.7880  acc: 0.7108    test auc: 0.7908  acc: 0.7028, time: 0.8500
epoch 34    train auc: 0.9060  acc: 0.7972    eval auc: 0.7878  acc: 0.7108    test auc: 0.7904  acc: 0.7028, time: 0.8180
epoch 35    train auc: 0.9062  acc: 0.7968    eval auc: 0.7871  acc: 0.7100    test auc: 0.7898  acc: 0.7002, time: 0.8690
epoch 36    train auc: 0.9072  acc: 0.7975    eval auc: 0.7871  acc: 0.7100    test auc: 0.7896  acc: 0.7008, time: 0.8099
epoch 37    train auc: 0.9076  acc: 0.7963    eval auc: 0.7867  acc: 0.7095    test auc: 0.7890  acc: 0.6989, time: 0.8329
epoch 38    train auc: 0.9085  acc: 0.7972    eval auc: 0.7863  acc: 0.7104    test auc: 0.7888  acc: 0.7003, time: 0.8140
epoch 39    train auc: 0.9090  acc: 0.7980    eval auc: 0.7857  acc: 0.7099    test auc: 0.7883  acc: 0.7004, time: 0.8343
epoch 40    train auc: 0.9097  acc: 0.7990    eval auc: 0.7853  acc: 0.7108    test auc: 0.7878  acc: 0.7019, time: 0.8080
epoch 41    train auc: 0.9101  acc: 0.7989    eval auc: 0.7847  acc: 0.7091    test auc: 0.7873  acc: 0.6994, time: 0.8020
epoch 42    train auc: 0.9107  acc: 0.7992    eval auc: 0.7842  acc: 0.7068    test auc: 0.7869  acc: 0.6972, time: 0.7909
epoch 43    train auc: 0.9113  acc: 0.7991    eval auc: 0.7838  acc: 0.7076    test auc: 0.7863  acc: 0.6957, time: 0.7830
epoch 44    train auc: 0.9121  acc: 0.8001    eval auc: 0.7833  acc: 0.7078    test auc: 0.7859  acc: 0.6972, time: 0.7918
epoch 45    train auc: 0.9127  acc: 0.8014    eval auc: 0.7828  acc: 0.7074    test auc: 0.7855  acc: 0.6977, time: 0.8070
epoch 46    train auc: 0.9133  acc: 0.8019    eval auc: 0.7824  acc: 0.7065    test auc: 0.7849  acc: 0.6983, time: 0.7928
epoch 47    train auc: 0.9135  acc: 0.8020    eval auc: 0.7820  acc: 0.7049    test auc: 0.7844  acc: 0.6977, time: 0.7829
epoch 48    train auc: 0.9142  acc: 0.8024    eval auc: 0.7817  acc: 0.7039    test auc: 0.7840  acc: 0.6952, time: 0.7809
epoch 49    train auc: 0.9150  acc: 0.8033    eval auc: 0.7815  acc: 0.7055    test auc: 0.7837  acc: 0.6980, time: 0.7769
avg time per epoch : 0.8571973609924316
--- 52.3797721862793 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:37:44.095748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:37:44.096089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4887  acc: 0.4961    eval auc: 0.5227  acc: 0.5077    test auc: 0.5118  acc: 0.5040, time: 1.1570
epoch 1    train auc: 0.5067  acc: 0.5008    eval auc: 0.4888  acc: 0.5014    test auc: 0.4911  acc: 0.4962, time: 0.7950
epoch 2    train auc: 0.5503  acc: 0.5355    eval auc: 0.4318  acc: 0.4558    test auc: 0.4184  acc: 0.4378, time: 0.8120
epoch 3    train auc: 0.5761  acc: 0.5494    eval auc: 0.3906  acc: 0.4292    test auc: 0.3848  acc: 0.4225, time: 0.7760
epoch 4    train auc: 0.5866  acc: 0.5609    eval auc: 0.3767  acc: 0.4149    test auc: 0.3688  acc: 0.4024, time: 0.8279
epoch 5    train auc: 0.5910  acc: 0.5635    eval auc: 0.3711  acc: 0.4090    test auc: 0.3632  acc: 0.4004, time: 0.7830
epoch 6    train auc: 0.5933  acc: 0.5652    eval auc: 0.3684  acc: 0.4064    test auc: 0.3602  acc: 0.3979, time: 0.7819
epoch 7    train auc: 0.5944  acc: 0.5655    eval auc: 0.3667  acc: 0.4061    test auc: 0.3590  acc: 0.3976, time: 0.7639
epoch 8    train auc: 0.5951  acc: 0.5661    eval auc: 0.3658  acc: 0.4052    test auc: 0.3585  acc: 0.3965, time: 0.7579
epoch 9    train auc: 0.5955  acc: 0.5663    eval auc: 0.3656  acc: 0.4042    test auc: 0.3580  acc: 0.3969, time: 0.7874
epoch 10    train auc: 0.5958  acc: 0.5665    eval auc: 0.3651  acc: 0.4049    test auc: 0.3578  acc: 0.3957, time: 0.7549
epoch 11    train auc: 0.5961  acc: 0.5667    eval auc: 0.3650  acc: 0.4043    test auc: 0.3573  acc: 0.3957, time: 0.7939
epoch 12    train auc: 0.5963  acc: 0.5666    eval auc: 0.3649  acc: 0.4049    test auc: 0.3571  acc: 0.3953, time: 0.7940
epoch 13    train auc: 0.5964  acc: 0.5668    eval auc: 0.3649  acc: 0.4054    test auc: 0.3569  acc: 0.3941, time: 0.7739
epoch 14    train auc: 0.5965  acc: 0.5668    eval auc: 0.3645  acc: 0.4061    test auc: 0.3571  acc: 0.3934, time: 0.7629
epoch 15    train auc: 0.5966  acc: 0.5668    eval auc: 0.3644  acc: 0.4045    test auc: 0.3571  acc: 0.3951, time: 0.7539
epoch 16    train auc: 0.5967  acc: 0.5668    eval auc: 0.3644  acc: 0.4038    test auc: 0.3571  acc: 0.3957, time: 0.8168
epoch 17    train auc: 0.5968  acc: 0.5668    eval auc: 0.3641  acc: 0.4038    test auc: 0.3571  acc: 0.3957, time: 0.7817
epoch 18    train auc: 0.5968  acc: 0.5668    eval auc: 0.3642  acc: 0.4043    test auc: 0.3570  acc: 0.3952, time: 0.7799
epoch 19    train auc: 0.5969  acc: 0.5668    eval auc: 0.3642  acc: 0.4041    test auc: 0.3569  acc: 0.3954, time: 0.7529
epoch 20    train auc: 0.5969  acc: 0.5668    eval auc: 0.3640  acc: 0.4037    test auc: 0.3569  acc: 0.3958, time: 0.7620
epoch 21    train auc: 0.5970  acc: 0.5668    eval auc: 0.3642  acc: 0.4039    test auc: 0.3567  acc: 0.3956, time: 0.7959
epoch 22    train auc: 0.5970  acc: 0.5669    eval auc: 0.3640  acc: 0.4038    test auc: 0.3570  acc: 0.3956, time: 0.7866
epoch 23    train auc: 0.5970  acc: 0.5669    eval auc: 0.3638  acc: 0.4039    test auc: 0.3571  acc: 0.3954, time: 0.7945
epoch 24    train auc: 0.5970  acc: 0.5669    eval auc: 0.3638  acc: 0.4034    test auc: 0.3571  acc: 0.3960, time: 0.8050
epoch 25    train auc: 0.5970  acc: 0.5669    eval auc: 0.3638  acc: 0.4034    test auc: 0.3571  acc: 0.3960, time: 0.7919
epoch 26    train auc: 0.5971  acc: 0.5669    eval auc: 0.3637  acc: 0.4031    test auc: 0.3571  acc: 0.3963, time: 0.8040
epoch 27    train auc: 0.5971  acc: 0.5669    eval auc: 0.3634  acc: 0.4016    test auc: 0.3574  acc: 0.3978, time: 0.7890
epoch 28    train auc: 0.5971  acc: 0.5669    eval auc: 0.3633  acc: 0.4037    test auc: 0.3574  acc: 0.3957, time: 0.7961
epoch 29    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4023    test auc: 0.3576  acc: 0.3971, time: 0.7900
epoch 30    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4006    test auc: 0.3577  acc: 0.3987, time: 0.8075
epoch 31    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4011    test auc: 0.3576  acc: 0.3983, time: 0.8019
epoch 32    train auc: 0.5971  acc: 0.5669    eval auc: 0.3629  acc: 0.4000    test auc: 0.3578  acc: 0.3993, time: 0.8389
epoch 33    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4012    test auc: 0.3576  acc: 0.3982, time: 0.9189
epoch 34    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4011    test auc: 0.3574  acc: 0.3983, time: 0.9250
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3629  acc: 0.4004    test auc: 0.3578  acc: 0.3990, time: 0.9170
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4015    test auc: 0.3575  acc: 0.3979, time: 0.8700
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3630  acc: 0.4008    test auc: 0.3576  acc: 0.3986, time: 0.8790
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4011    test auc: 0.3576  acc: 0.3983, time: 0.8980
epoch 39    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4021    test auc: 0.3576  acc: 0.3973, time: 0.9750
epoch 40    train auc: 0.5972  acc: 0.5669    eval auc: 0.3630  acc: 0.4015    test auc: 0.3577  acc: 0.3979, time: 0.9520
epoch 41    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4016    test auc: 0.3576  acc: 0.3978, time: 0.9530
epoch 42    train auc: 0.5972  acc: 0.5669    eval auc: 0.3629  acc: 0.4009    test auc: 0.3578  acc: 0.3985, time: 0.9069
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4030    test auc: 0.3576  acc: 0.3964, time: 0.9069
epoch 44    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4011    test auc: 0.3576  acc: 0.3983, time: 0.8750
epoch 45    train auc: 0.5990  acc: 0.5679    eval auc: 0.3642  acc: 0.4029    test auc: 0.3581  acc: 0.3990, time: 0.8809
epoch 46    train auc: 0.7725  acc: 0.6783    eval auc: 0.6249  acc: 0.6075    test auc: 0.6318  acc: 0.6201, time: 0.9490
epoch 47    train auc: 0.8568  acc: 0.7577    eval auc: 0.7147  acc: 0.6814    test auc: 0.7148  acc: 0.6858, time: 0.9070
epoch 48    train auc: 0.8808  acc: 0.7759    eval auc: 0.7410  acc: 0.6778    test auc: 0.7407  acc: 0.6766, time: 0.9030
epoch 49    train auc: 0.8948  acc: 0.7840    eval auc: 0.7622  acc: 0.7180    test auc: 0.7643  acc: 0.7218, time: 0.8669
avg time per epoch : 0.8370827531814575
--- 51.16873860359192 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:38:35.258536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:38:35.258885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5168  acc: 0.5092    eval auc: 0.4923  acc: 0.4994    test auc: 0.4889  acc: 0.4942, time: 1.1433
epoch 1    train auc: 0.5288  acc: 0.5135    eval auc: 0.4658  acc: 0.4803    test auc: 0.4607  acc: 0.4816, time: 0.8839
epoch 2    train auc: 0.5469  acc: 0.5260    eval auc: 0.4418  acc: 0.4648    test auc: 0.4343  acc: 0.4645, time: 0.8790
epoch 3    train auc: 0.5605  acc: 0.5248    eval auc: 0.4187  acc: 0.4645    test auc: 0.4099  acc: 0.4623, time: 0.9290
epoch 4    train auc: 0.5738  acc: 0.5499    eval auc: 0.4052  acc: 0.4343    test auc: 0.3954  acc: 0.4292, time: 0.9319
epoch 5    train auc: 0.5871  acc: 0.5612    eval auc: 0.4030  acc: 0.4291    test auc: 0.3943  acc: 0.4235, time: 0.9140
epoch 6    train auc: 0.6468  acc: 0.5989    eval auc: 0.4548  acc: 0.4676    test auc: 0.4486  acc: 0.4591, time: 1.0480
epoch 7    train auc: 0.7555  acc: 0.6874    eval auc: 0.5908  acc: 0.5709    test auc: 0.5955  acc: 0.5688, time: 0.9710
epoch 8    train auc: 0.8428  acc: 0.7457    eval auc: 0.7014  acc: 0.6902    test auc: 0.7082  acc: 0.6978, time: 0.9880
epoch 9    train auc: 0.8755  acc: 0.7619    eval auc: 0.7444  acc: 0.7210    test auc: 0.7484  acc: 0.7310, time: 1.0010
epoch 10    train auc: 0.8884  acc: 0.7704    eval auc: 0.7628  acc: 0.7313    test auc: 0.7648  acc: 0.7407, time: 0.9210
epoch 11    train auc: 0.8950  acc: 0.7836    eval auc: 0.7706  acc: 0.7359    test auc: 0.7717  acc: 0.7408, time: 0.8881
epoch 12    train auc: 0.8996  acc: 0.7919    eval auc: 0.7737  acc: 0.7355    test auc: 0.7744  acc: 0.7392, time: 0.8689
epoch 13    train auc: 0.9036  acc: 0.7994    eval auc: 0.7757  acc: 0.7317    test auc: 0.7760  acc: 0.7278, time: 0.9349
epoch 14    train auc: 0.9070  acc: 0.7994    eval auc: 0.7764  acc: 0.7311    test auc: 0.7762  acc: 0.7291, time: 0.9219
epoch 15    train auc: 0.9101  acc: 0.8057    eval auc: 0.7769  acc: 0.7272    test auc: 0.7766  acc: 0.7217, time: 0.9170
epoch 16    train auc: 0.9130  acc: 0.8122    eval auc: 0.7771  acc: 0.7183    test auc: 0.7765  acc: 0.7153, time: 0.8540
epoch 17    train auc: 0.9153  acc: 0.8119    eval auc: 0.7780  acc: 0.7222    test auc: 0.7768  acc: 0.7194, time: 0.8820
epoch 18    train auc: 0.9175  acc: 0.8160    eval auc: 0.7780  acc: 0.7181    test auc: 0.7766  acc: 0.7144, time: 0.9190
epoch 19    train auc: 0.9194  acc: 0.8168    eval auc: 0.7779  acc: 0.7180    test auc: 0.7760  acc: 0.7139, time: 0.9319
epoch 20    train auc: 0.9211  acc: 0.8203    eval auc: 0.7776  acc: 0.7153    test auc: 0.7755  acc: 0.7096, time: 0.8450
epoch 21    train auc: 0.9224  acc: 0.8182    eval auc: 0.7782  acc: 0.7174    test auc: 0.7757  acc: 0.7138, time: 0.8450
epoch 22    train auc: 0.9236  acc: 0.8187    eval auc: 0.7783  acc: 0.7174    test auc: 0.7753  acc: 0.7147, time: 0.9069
epoch 23    train auc: 0.9252  acc: 0.8243    eval auc: 0.7763  acc: 0.7118    test auc: 0.7737  acc: 0.7041, time: 0.9410
epoch 24    train auc: 0.9261  acc: 0.8228    eval auc: 0.7773  acc: 0.7140    test auc: 0.7741  acc: 0.7102, time: 0.8584
epoch 25    train auc: 0.9271  acc: 0.8250    eval auc: 0.7769  acc: 0.7131    test auc: 0.7738  acc: 0.7081, time: 0.8739
epoch 26    train auc: 0.9283  acc: 0.8279    eval auc: 0.7747  acc: 0.7098    test auc: 0.7717  acc: 0.7011, time: 0.8349
epoch 27    train auc: 0.9291  acc: 0.8286    eval auc: 0.7750  acc: 0.7095    test auc: 0.7717  acc: 0.7016, time: 0.8809
epoch 28    train auc: 0.9299  acc: 0.8292    eval auc: 0.7747  acc: 0.7095    test auc: 0.7711  acc: 0.7014, time: 0.8809
epoch 29    train auc: 0.9306  acc: 0.8292    eval auc: 0.7749  acc: 0.7114    test auc: 0.7711  acc: 0.7033, time: 0.8489
epoch 30    train auc: 0.9312  acc: 0.8304    eval auc: 0.7750  acc: 0.7104    test auc: 0.7713  acc: 0.7047, time: 0.8410
epoch 31    train auc: 0.9319  acc: 0.8299    eval auc: 0.7738  acc: 0.7098    test auc: 0.7698  acc: 0.7043, time: 0.8359
epoch 32    train auc: 0.9327  acc: 0.8328    eval auc: 0.7728  acc: 0.7067    test auc: 0.7690  acc: 0.7008, time: 0.8180
epoch 33    train auc: 0.9331  acc: 0.8316    eval auc: 0.7736  acc: 0.7080    test auc: 0.7698  acc: 0.7034, time: 0.8140
epoch 34    train auc: 0.9336  acc: 0.8316    eval auc: 0.7729  acc: 0.7069    test auc: 0.7689  acc: 0.7029, time: 0.8100
epoch 35    train auc: 0.9344  acc: 0.8342    eval auc: 0.7711  acc: 0.7007    test auc: 0.7677  acc: 0.6991, time: 0.8029
epoch 36    train auc: 0.9348  acc: 0.8343    eval auc: 0.7716  acc: 0.7022    test auc: 0.7680  acc: 0.7008, time: 0.7939
epoch 37    train auc: 0.9354  acc: 0.8347    eval auc: 0.7707  acc: 0.7015    test auc: 0.7672  acc: 0.6988, time: 0.8100
epoch 38    train auc: 0.9357  acc: 0.8340    eval auc: 0.7710  acc: 0.7022    test auc: 0.7672  acc: 0.7004, time: 0.7930
epoch 39    train auc: 0.9361  acc: 0.8338    eval auc: 0.7703  acc: 0.7023    test auc: 0.7666  acc: 0.7014, time: 0.7849
epoch 40    train auc: 0.9361  acc: 0.8327    eval auc: 0.7708  acc: 0.7033    test auc: 0.7669  acc: 0.7027, time: 0.7889
epoch 41    train auc: 0.9367  acc: 0.8351    eval auc: 0.7705  acc: 0.7032    test auc: 0.7669  acc: 0.7009, time: 0.8079
epoch 42    train auc: 0.9377  acc: 0.8376    eval auc: 0.7678  acc: 0.7004    test auc: 0.7646  acc: 0.6964, time: 0.7899
epoch 43    train auc: 0.9378  acc: 0.8380    eval auc: 0.7687  acc: 0.7009    test auc: 0.7656  acc: 0.6965, time: 0.7919
epoch 44    train auc: 0.9379  acc: 0.8360    eval auc: 0.7690  acc: 0.7010    test auc: 0.7656  acc: 0.6998, time: 0.7960
epoch 45    train auc: 0.9383  acc: 0.8370    eval auc: 0.7679  acc: 0.7004    test auc: 0.7642  acc: 0.6998, time: 0.7918
epoch 46    train auc: 0.9385  acc: 0.8369    eval auc: 0.7679  acc: 0.7020    test auc: 0.7643  acc: 0.6996, time: 0.7850
epoch 47    train auc: 0.9391  acc: 0.8385    eval auc: 0.7675  acc: 0.6998    test auc: 0.7643  acc: 0.6983, time: 0.7780
epoch 48    train auc: 0.9398  acc: 0.8411    eval auc: 0.7659  acc: 0.6988    test auc: 0.7628  acc: 0.6945, time: 0.7880
epoch 49    train auc: 0.9392  acc: 0.8379    eval auc: 0.7676  acc: 0.7027    test auc: 0.7643  acc: 0.7002, time: 0.7825
avg time per epoch : 0.8689583396911621
--- 52.896198987960815 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:39:28.189298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:39:28.189652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4795  acc: 0.4989    eval auc: 0.5343  acc: 0.4992    test auc: 0.5322  acc: 0.5036, time: 1.1853
epoch 1    train auc: 0.7994  acc: 0.6850    eval auc: 0.7184  acc: 0.6739    test auc: 0.7380  acc: 0.6831, time: 0.8860
epoch 2    train auc: 0.8863  acc: 0.7800    eval auc: 0.7928  acc: 0.7516    test auc: 0.7984  acc: 0.7594, time: 0.9091
epoch 3    train auc: 0.9007  acc: 0.7916    eval auc: 0.7959  acc: 0.7532    test auc: 0.7991  acc: 0.7549, time: 0.8994
epoch 4    train auc: 0.9103  acc: 0.8019    eval auc: 0.7939  acc: 0.7442    test auc: 0.7952  acc: 0.7415, time: 0.7919
epoch 5    train auc: 0.9161  acc: 0.8060    eval auc: 0.7918  acc: 0.7374    test auc: 0.7924  acc: 0.7342, time: 0.7619
epoch 6    train auc: 0.9193  acc: 0.8102    eval auc: 0.7902  acc: 0.7316    test auc: 0.7910  acc: 0.7301, time: 0.7579
epoch 7    train auc: 0.9225  acc: 0.8132    eval auc: 0.7880  acc: 0.7255    test auc: 0.7888  acc: 0.7249, time: 0.7719
epoch 8    train auc: 0.9264  acc: 0.8198    eval auc: 0.7830  acc: 0.7146    test auc: 0.7833  acc: 0.7111, time: 0.7620
epoch 9    train auc: 0.9274  acc: 0.8180    eval auc: 0.7841  acc: 0.7199    test auc: 0.7840  acc: 0.7180, time: 0.7799
epoch 10    train auc: 0.9290  acc: 0.8194    eval auc: 0.7824  acc: 0.7183    test auc: 0.7823  acc: 0.7165, time: 0.7925
epoch 11    train auc: 0.9305  acc: 0.8214    eval auc: 0.7813  acc: 0.7186    test auc: 0.7806  acc: 0.7156, time: 0.8040
epoch 12    train auc: 0.9324  acc: 0.8276    eval auc: 0.7788  acc: 0.7146    test auc: 0.7778  acc: 0.7118, time: 0.7919
epoch 13    train auc: 0.9332  acc: 0.8287    eval auc: 0.7785  acc: 0.7124    test auc: 0.7772  acc: 0.7115, time: 0.8043
epoch 14    train auc: 0.9348  acc: 0.8333    eval auc: 0.7738  acc: 0.7037    test auc: 0.7740  acc: 0.7046, time: 0.8059
epoch 15    train auc: 0.9348  acc: 0.8296    eval auc: 0.7757  acc: 0.7124    test auc: 0.7751  acc: 0.7098, time: 0.7859
epoch 16    train auc: 0.9365  acc: 0.8345    eval auc: 0.7731  acc: 0.7059    test auc: 0.7731  acc: 0.7059, time: 0.8170
epoch 17    train auc: 0.9372  acc: 0.8321    eval auc: 0.7726  acc: 0.7062    test auc: 0.7714  acc: 0.7055, time: 0.7980
epoch 18    train auc: 0.9389  acc: 0.8369    eval auc: 0.7710  acc: 0.7028    test auc: 0.7705  acc: 0.7045, time: 0.7989
epoch 19    train auc: 0.9380  acc: 0.8327    eval auc: 0.7724  acc: 0.7045    test auc: 0.7714  acc: 0.7058, time: 0.8050
epoch 20    train auc: 0.9403  acc: 0.8389    eval auc: 0.7697  acc: 0.7024    test auc: 0.7686  acc: 0.7003, time: 0.8019
epoch 21    train auc: 0.9413  acc: 0.8397    eval auc: 0.7685  acc: 0.7019    test auc: 0.7676  acc: 0.6985, time: 0.8189
epoch 22    train auc: 0.9416  acc: 0.8403    eval auc: 0.7691  acc: 0.7001    test auc: 0.7679  acc: 0.6991, time: 0.8049
epoch 23    train auc: 0.9427  acc: 0.8412    eval auc: 0.7671  acc: 0.6987    test auc: 0.7664  acc: 0.6983, time: 0.8249
epoch 24    train auc: 0.9434  acc: 0.8415    eval auc: 0.7666  acc: 0.6998    test auc: 0.7653  acc: 0.6989, time: 0.7820
epoch 25    train auc: 0.9442  acc: 0.8432    eval auc: 0.7636  acc: 0.6937    test auc: 0.7634  acc: 0.6955, time: 0.7999
epoch 26    train auc: 0.9445  acc: 0.8430    eval auc: 0.7644  acc: 0.6969    test auc: 0.7624  acc: 0.6952, time: 0.7889
epoch 27    train auc: 0.9455  acc: 0.8447    eval auc: 0.7628  acc: 0.6958    test auc: 0.7602  acc: 0.6939, time: 0.8060
epoch 28    train auc: 0.9450  acc: 0.8429    eval auc: 0.7625  acc: 0.6956    test auc: 0.7598  acc: 0.6934, time: 0.8850
epoch 29    train auc: 0.9449  acc: 0.8417    eval auc: 0.7628  acc: 0.6978    test auc: 0.7600  acc: 0.6956, time: 0.8840
epoch 30    train auc: 0.9474  acc: 0.8471    eval auc: 0.7607  acc: 0.6925    test auc: 0.7585  acc: 0.6930, time: 0.8880
epoch 31    train auc: 0.9475  acc: 0.8471    eval auc: 0.7592  acc: 0.6904    test auc: 0.7569  acc: 0.6890, time: 0.8869
epoch 32    train auc: 0.9448  acc: 0.8402    eval auc: 0.7607  acc: 0.6943    test auc: 0.7580  acc: 0.6934, time: 0.8920
epoch 33    train auc: 0.9472  acc: 0.8461    eval auc: 0.7593  acc: 0.6930    test auc: 0.7576  acc: 0.6911, time: 0.8940
epoch 34    train auc: 0.9472  acc: 0.8459    eval auc: 0.7553  acc: 0.6869    test auc: 0.7530  acc: 0.6872, time: 0.8759
epoch 35    train auc: 0.9487  acc: 0.8478    eval auc: 0.7569  acc: 0.6900    test auc: 0.7554  acc: 0.6892, time: 0.8800
epoch 36    train auc: 0.9476  acc: 0.8454    eval auc: 0.7569  acc: 0.6899    test auc: 0.7550  acc: 0.6885, time: 0.8739
epoch 37    train auc: 0.9498  acc: 0.8493    eval auc: 0.7550  acc: 0.6886    test auc: 0.7531  acc: 0.6872, time: 0.9040
epoch 38    train auc: 0.9478  acc: 0.8452    eval auc: 0.7560  acc: 0.6879    test auc: 0.7539  acc: 0.6878, time: 0.8740
epoch 39    train auc: 0.9499  acc: 0.8479    eval auc: 0.7533  acc: 0.6852    test auc: 0.7521  acc: 0.6861, time: 0.8700
epoch 40    train auc: 0.9501  acc: 0.8495    eval auc: 0.7544  acc: 0.6874    test auc: 0.7529  acc: 0.6872, time: 0.8900
epoch 41    train auc: 0.9516  acc: 0.8515    eval auc: 0.7537  acc: 0.6870    test auc: 0.7525  acc: 0.6876, time: 0.9010
epoch 42    train auc: 0.9512  acc: 0.8508    eval auc: 0.7538  acc: 0.6882    test auc: 0.7521  acc: 0.6866, time: 0.8620
epoch 43    train auc: 0.9536  acc: 0.8558    eval auc: 0.7529  acc: 0.6865    test auc: 0.7519  acc: 0.6849, time: 0.8700
epoch 44    train auc: 0.9535  acc: 0.8539    eval auc: 0.7551  acc: 0.6916    test auc: 0.7536  acc: 0.6884, time: 0.8640
epoch 45    train auc: 0.9544  acc: 0.8555    eval auc: 0.7547  acc: 0.6906    test auc: 0.7533  acc: 0.6863, time: 0.8820
epoch 46    train auc: 0.9553  acc: 0.8580    eval auc: 0.7551  acc: 0.6908    test auc: 0.7537  acc: 0.6884, time: 0.8649
epoch 47    train auc: 0.9581  acc: 0.8642    eval auc: 0.7538  acc: 0.6890    test auc: 0.7531  acc: 0.6892, time: 0.8770
epoch 48    train auc: 0.9605  acc: 0.8687    eval auc: 0.7539  acc: 0.6889    test auc: 0.7531  acc: 0.6885, time: 0.8590
epoch 49    train auc: 0.9628  acc: 0.8704    eval auc: 0.7516  acc: 0.6871    test auc: 0.7507  acc: 0.6859, time: 0.8729
avg time per epoch : 0.8457460594177246
--- 51.560683488845825 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:40:19.852312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:40:19.852664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5304  acc: 0.5200    eval auc: 0.5076  acc: 0.5062    test auc: 0.5114  acc: 0.5041, time: 1.1360
epoch 1    train auc: 0.6307  acc: 0.5300    eval auc: 0.5436  acc: 0.4933    test auc: 0.5567  acc: 0.5002, time: 0.9069
epoch 2    train auc: 0.5552  acc: 0.5394    eval auc: 0.4369  acc: 0.4524    test auc: 0.4443  acc: 0.4598, time: 0.8669
epoch 3    train auc: 0.5597  acc: 0.5430    eval auc: 0.4125  acc: 0.4372    test auc: 0.4181  acc: 0.4431, time: 0.8789
epoch 4    train auc: 0.5682  acc: 0.5469    eval auc: 0.4007  acc: 0.4299    test auc: 0.4040  acc: 0.4313, time: 0.8649
epoch 5    train auc: 0.5757  acc: 0.5519    eval auc: 0.3917  acc: 0.4214    test auc: 0.3936  acc: 0.4246, time: 0.8760
epoch 6    train auc: 0.5809  acc: 0.5543    eval auc: 0.3870  acc: 0.4173    test auc: 0.3888  acc: 0.4213, time: 0.8850
epoch 7    train auc: 0.5862  acc: 0.5557    eval auc: 0.3846  acc: 0.4160    test auc: 0.3857  acc: 0.4182, time: 0.8680
epoch 8    train auc: 0.5922  acc: 0.5582    eval auc: 0.3825  acc: 0.4140    test auc: 0.3835  acc: 0.4146, time: 0.8519
epoch 9    train auc: 0.5982  acc: 0.5598    eval auc: 0.3819  acc: 0.4134    test auc: 0.3818  acc: 0.4104, time: 0.8639
epoch 10    train auc: 0.6106  acc: 0.5592    eval auc: 0.3873  acc: 0.4119    test auc: 0.3867  acc: 0.4136, time: 0.8520
epoch 11    train auc: 0.6356  acc: 0.5582    eval auc: 0.4058  acc: 0.4132    test auc: 0.4043  acc: 0.4175, time: 0.8639
epoch 12    train auc: 0.7239  acc: 0.5348    eval auc: 0.5487  acc: 0.4532    test auc: 0.5481  acc: 0.4592, time: 0.8510
epoch 13    train auc: 0.7836  acc: 0.6886    eval auc: 0.6860  acc: 0.6213    test auc: 0.6919  acc: 0.6213, time: 0.8619
epoch 14    train auc: 0.8009  acc: 0.7210    eval auc: 0.7170  acc: 0.6482    test auc: 0.7250  acc: 0.6518, time: 0.8690
epoch 15    train auc: 0.8122  acc: 0.7369    eval auc: 0.7267  acc: 0.6624    test auc: 0.7351  acc: 0.6628, time: 0.8990
epoch 16    train auc: 0.8205  acc: 0.7504    eval auc: 0.7333  acc: 0.6733    test auc: 0.7419  acc: 0.6753, time: 0.8810
epoch 17    train auc: 0.8267  acc: 0.7605    eval auc: 0.7418  acc: 0.6833    test auc: 0.7503  acc: 0.6865, time: 0.8649
epoch 18    train auc: 0.8332  acc: 0.7665    eval auc: 0.7449  acc: 0.6852    test auc: 0.7522  acc: 0.6917, time: 0.8559
epoch 19    train auc: 0.8387  acc: 0.7694    eval auc: 0.7493  acc: 0.6850    test auc: 0.7559  acc: 0.6923, time: 0.8689
epoch 20    train auc: 0.8439  acc: 0.7710    eval auc: 0.7517  acc: 0.6880    test auc: 0.7581  acc: 0.6906, time: 0.8449
epoch 21    train auc: 0.8485  acc: 0.7744    eval auc: 0.7561  acc: 0.6904    test auc: 0.7615  acc: 0.6937, time: 0.8540
epoch 22    train auc: 0.8531  acc: 0.7754    eval auc: 0.7584  acc: 0.6931    test auc: 0.7632  acc: 0.6944, time: 0.8419
epoch 23    train auc: 0.8577  acc: 0.7769    eval auc: 0.7591  acc: 0.6916    test auc: 0.7637  acc: 0.6949, time: 0.8550
epoch 24    train auc: 0.8615  acc: 0.7783    eval auc: 0.7606  acc: 0.6910    test auc: 0.7650  acc: 0.6944, time: 0.8429
epoch 25    train auc: 0.8660  acc: 0.7794    eval auc: 0.7612  acc: 0.6911    test auc: 0.7655  acc: 0.6944, time: 0.8465
epoch 26    train auc: 0.8699  acc: 0.7802    eval auc: 0.7623  acc: 0.6917    test auc: 0.7665  acc: 0.6965, time: 0.8279
epoch 27    train auc: 0.8735  acc: 0.7811    eval auc: 0.7637  acc: 0.6922    test auc: 0.7677  acc: 0.6948, time: 0.8359
epoch 28    train auc: 0.8782  acc: 0.7812    eval auc: 0.7642  acc: 0.6916    test auc: 0.7680  acc: 0.6950, time: 0.8310
epoch 29    train auc: 0.8818  acc: 0.7830    eval auc: 0.7654  acc: 0.6928    test auc: 0.7692  acc: 0.6956, time: 0.8300
epoch 30    train auc: 0.8861  acc: 0.7822    eval auc: 0.7673  acc: 0.6921    test auc: 0.7712  acc: 0.6969, time: 0.8439
epoch 31    train auc: 0.8909  acc: 0.7780    eval auc: 0.7678  acc: 0.6878    test auc: 0.7716  acc: 0.6910, time: 0.8286
epoch 32    train auc: 0.8948  acc: 0.7772    eval auc: 0.7683  acc: 0.6871    test auc: 0.7725  acc: 0.6913, time: 0.8440
epoch 33    train auc: 0.8982  acc: 0.7783    eval auc: 0.7694  acc: 0.6878    test auc: 0.7736  acc: 0.6924, time: 0.8159
epoch 34    train auc: 0.9020  acc: 0.7715    eval auc: 0.7699  acc: 0.6859    test auc: 0.7737  acc: 0.6882, time: 0.8060
epoch 35    train auc: 0.9050  acc: 0.7733    eval auc: 0.7699  acc: 0.6859    test auc: 0.7740  acc: 0.6892, time: 0.8080
epoch 36    train auc: 0.9079  acc: 0.7726    eval auc: 0.7698  acc: 0.6861    test auc: 0.7737  acc: 0.6896, time: 0.8129
epoch 37    train auc: 0.9105  acc: 0.7703    eval auc: 0.7684  acc: 0.6857    test auc: 0.7724  acc: 0.6861, time: 0.7990
epoch 38    train auc: 0.9122  acc: 0.7661    eval auc: 0.7682  acc: 0.6825    test auc: 0.7719  acc: 0.6825, time: 0.7989
epoch 39    train auc: 0.9138  acc: 0.7613    eval auc: 0.7662  acc: 0.6785    test auc: 0.7697  acc: 0.6775, time: 0.7990
epoch 40    train auc: 0.9149  acc: 0.7571    eval auc: 0.7639  acc: 0.6734    test auc: 0.7669  acc: 0.6748, time: 0.7950
epoch 41    train auc: 0.9159  acc: 0.7574    eval auc: 0.7636  acc: 0.6748    test auc: 0.7663  acc: 0.6767, time: 0.7910
epoch 42    train auc: 0.9170  acc: 0.7572    eval auc: 0.7625  acc: 0.6745    test auc: 0.7648  acc: 0.6765, time: 0.7909
epoch 43    train auc: 0.9181  acc: 0.7596    eval auc: 0.7628  acc: 0.6752    test auc: 0.7647  acc: 0.6795, time: 0.7860
epoch 44    train auc: 0.9185  acc: 0.7567    eval auc: 0.7607  acc: 0.6729    test auc: 0.7619  acc: 0.6769, time: 0.7950
epoch 45    train auc: 0.9173  acc: 0.7496    eval auc: 0.7589  acc: 0.6684    test auc: 0.7593  acc: 0.6740, time: 0.9850
epoch 46    train auc: 0.9172  acc: 0.7472    eval auc: 0.7560  acc: 0.6650    test auc: 0.7557  acc: 0.6706, time: 0.8860
epoch 47    train auc: 0.9170  acc: 0.7455    eval auc: 0.7546  acc: 0.6649    test auc: 0.7542  acc: 0.6699, time: 0.8610
epoch 48    train auc: 0.9175  acc: 0.7471    eval auc: 0.7545  acc: 0.6661    test auc: 0.7538  acc: 0.6710, time: 0.8270
epoch 49    train auc: 0.9150  acc: 0.7408    eval auc: 0.7509  acc: 0.6610    test auc: 0.7497  acc: 0.6665, time: 0.8490
avg time per epoch : 0.851970067024231
--- 52.05405879020691 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:41:11.918767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:41:11.919102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4885  acc: 0.4982    eval auc: 0.5184  acc: 0.5014    test auc: 0.5164  acc: 0.5040, time: 1.1830
epoch 1    train auc: 0.5223  acc: 0.5076    eval auc: 0.4677  acc: 0.4888    test auc: 0.4647  acc: 0.4885, time: 0.8160
epoch 2    train auc: 0.5683  acc: 0.5457    eval auc: 0.4003  acc: 0.4339    test auc: 0.3969  acc: 0.4289, time: 0.7989
epoch 3    train auc: 0.5831  acc: 0.5577    eval auc: 0.3822  acc: 0.4172    test auc: 0.3737  acc: 0.4097, time: 0.8359
epoch 4    train auc: 0.5897  acc: 0.5624    eval auc: 0.3725  acc: 0.4083    test auc: 0.3638  acc: 0.4045, time: 0.8460
epoch 5    train auc: 0.6690  acc: 0.6088    eval auc: 0.4605  acc: 0.4579    test auc: 0.4578  acc: 0.4531, time: 0.8330
epoch 6    train auc: 0.8807  acc: 0.7848    eval auc: 0.7633  acc: 0.7368    test auc: 0.7665  acc: 0.7412, time: 0.8580
epoch 7    train auc: 0.9012  acc: 0.7966    eval auc: 0.7759  acc: 0.7398    test auc: 0.7779  acc: 0.7393, time: 0.8270
epoch 8    train auc: 0.9121  acc: 0.8133    eval auc: 0.7740  acc: 0.7117    test auc: 0.7744  acc: 0.7118, time: 0.8097
epoch 9    train auc: 0.9187  acc: 0.8156    eval auc: 0.7753  acc: 0.7121    test auc: 0.7748  acc: 0.7107, time: 0.7649
epoch 10    train auc: 0.9227  acc: 0.8138    eval auc: 0.7760  acc: 0.7167    test auc: 0.7741  acc: 0.7132, time: 0.8429
epoch 11    train auc: 0.9265  acc: 0.8212    eval auc: 0.7741  acc: 0.7070    test auc: 0.7726  acc: 0.7055, time: 0.8289
epoch 12    train auc: 0.9294  acc: 0.8239    eval auc: 0.7684  acc: 0.7023    test auc: 0.7663  acc: 0.6984, time: 0.8649
epoch 13    train auc: 0.9321  acc: 0.8271    eval auc: 0.7700  acc: 0.7022    test auc: 0.7686  acc: 0.6991, time: 0.8940
epoch 14    train auc: 0.9346  acc: 0.8293    eval auc: 0.7653  acc: 0.6951    test auc: 0.7646  acc: 0.6942, time: 0.8920
epoch 15    train auc: 0.9363  acc: 0.8320    eval auc: 0.7665  acc: 0.6968    test auc: 0.7661  acc: 0.6948, time: 0.8939
epoch 16    train auc: 0.9375  acc: 0.8321    eval auc: 0.7670  acc: 0.6969    test auc: 0.7663  acc: 0.6970, time: 0.8210
epoch 17    train auc: 0.9401  acc: 0.8362    eval auc: 0.7643  acc: 0.6931    test auc: 0.7632  acc: 0.6941, time: 0.8238
epoch 18    train auc: 0.9416  acc: 0.8382    eval auc: 0.7653  acc: 0.6944    test auc: 0.7637  acc: 0.6949, time: 0.8220
epoch 19    train auc: 0.9447  acc: 0.8431    eval auc: 0.7634  acc: 0.6911    test auc: 0.7608  acc: 0.6911, time: 0.8289
epoch 20    train auc: 0.9479  acc: 0.8466    eval auc: 0.7621  acc: 0.6893    test auc: 0.7594  acc: 0.6877, time: 0.8239
epoch 21    train auc: 0.9516  acc: 0.8522    eval auc: 0.7581  acc: 0.6854    test auc: 0.7546  acc: 0.6811, time: 0.8060
epoch 22    train auc: 0.9560  acc: 0.8566    eval auc: 0.7587  acc: 0.6865    test auc: 0.7558  acc: 0.6847, time: 0.8069
epoch 23    train auc: 0.9604  acc: 0.8644    eval auc: 0.7555  acc: 0.6849    test auc: 0.7537  acc: 0.6856, time: 0.8119
epoch 24    train auc: 0.9646  acc: 0.8710    eval auc: 0.7553  acc: 0.6870    test auc: 0.7526  acc: 0.6856, time: 0.8259
epoch 25    train auc: 0.9681  acc: 0.8783    eval auc: 0.7541  acc: 0.6879    test auc: 0.7510  acc: 0.6852, time: 0.7909
epoch 26    train auc: 0.9727  acc: 0.8878    eval auc: 0.7514  acc: 0.6867    test auc: 0.7477  acc: 0.6831, time: 0.7990
epoch 27    train auc: 0.9756  acc: 0.8965    eval auc: 0.7532  acc: 0.6878    test auc: 0.7499  acc: 0.6892, time: 0.7930
epoch 28    train auc: 0.9787  acc: 0.9034    eval auc: 0.7486  acc: 0.6854    test auc: 0.7430  acc: 0.6830, time: 0.7799
epoch 29    train auc: 0.9810  acc: 0.9099    eval auc: 0.7508  acc: 0.6904    test auc: 0.7453  acc: 0.6853, time: 0.7799
epoch 30    train auc: 0.9838  acc: 0.9181    eval auc: 0.7462  acc: 0.6843    test auc: 0.7399  acc: 0.6798, time: 0.7749
epoch 31    train auc: 0.9847  acc: 0.9201    eval auc: 0.7498  acc: 0.6873    test auc: 0.7434  acc: 0.6838, time: 0.8829
epoch 32    train auc: 0.9868  acc: 0.9287    eval auc: 0.7476  acc: 0.6831    test auc: 0.7405  acc: 0.6801, time: 0.8870
epoch 33    train auc: 0.9885  acc: 0.9323    eval auc: 0.7439  acc: 0.6812    test auc: 0.7372  acc: 0.6758, time: 0.8719
epoch 34    train auc: 0.9891  acc: 0.9333    eval auc: 0.7400  acc: 0.6772    test auc: 0.7336  acc: 0.6729, time: 0.8685
epoch 35    train auc: 0.9905  acc: 0.9392    eval auc: 0.7426  acc: 0.6810    test auc: 0.7364  acc: 0.6751, time: 0.8857
epoch 36    train auc: 0.9917  acc: 0.9439    eval auc: 0.7386  acc: 0.6763    test auc: 0.7323  acc: 0.6732, time: 0.8559
epoch 37    train auc: 0.9926  acc: 0.9477    eval auc: 0.7384  acc: 0.6759    test auc: 0.7311  acc: 0.6725, time: 0.8769
epoch 38    train auc: 0.9930  acc: 0.9491    eval auc: 0.7402  acc: 0.6793    test auc: 0.7342  acc: 0.6755, time: 0.8510
epoch 39    train auc: 0.9936  acc: 0.9521    eval auc: 0.7354  acc: 0.6730    test auc: 0.7289  acc: 0.6707, time: 0.8500
epoch 40    train auc: 0.9942  acc: 0.9532    eval auc: 0.7370  acc: 0.6758    test auc: 0.7298  acc: 0.6704, time: 0.8319
epoch 41    train auc: 0.9946  acc: 0.9551    eval auc: 0.7353  acc: 0.6765    test auc: 0.7283  acc: 0.6682, time: 0.8409
epoch 42    train auc: 0.9951  acc: 0.9574    eval auc: 0.7333  acc: 0.6717    test auc: 0.7260  acc: 0.6648, time: 0.8469
epoch 43    train auc: 0.9954  acc: 0.9591    eval auc: 0.7344  acc: 0.6752    test auc: 0.7274  acc: 0.6695, time: 0.8259
epoch 44    train auc: 0.9958  acc: 0.9602    eval auc: 0.7330  acc: 0.6742    test auc: 0.7253  acc: 0.6656, time: 0.8299
epoch 45    train auc: 0.9961  acc: 0.9626    eval auc: 0.7318  acc: 0.6712    test auc: 0.7238  acc: 0.6657, time: 0.8439
epoch 46    train auc: 0.9965  acc: 0.9642    eval auc: 0.7301  acc: 0.6725    test auc: 0.7225  acc: 0.6660, time: 0.8260
epoch 47    train auc: 0.9966  acc: 0.9655    eval auc: 0.7276  acc: 0.6694    test auc: 0.7206  acc: 0.6642, time: 0.8410
epoch 48    train auc: 0.9966  acc: 0.9658    eval auc: 0.7306  acc: 0.6739    test auc: 0.7231  acc: 0.6640, time: 0.8209
epoch 49    train auc: 0.9971  acc: 0.9674    eval auc: 0.7274  acc: 0.6712    test auc: 0.7205  acc: 0.6619, time: 0.8129
avg time per epoch : 0.8405586528778076
--- 51.22989630699158 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 1, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:42:03.128609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:42:03.128958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5324  acc: 0.5231    eval auc: 0.4994  acc: 0.4997    test auc: 0.5069  acc: 0.5040, time: 1.2112
epoch 1    train auc: 0.5881  acc: 0.5554    eval auc: 0.5143  acc: 0.5061    test auc: 0.5192  acc: 0.5095, time: 0.8560
epoch 2    train auc: 0.6016  acc: 0.5561    eval auc: 0.4899  acc: 0.4951    test auc: 0.5013  acc: 0.5003, time: 0.8690
epoch 3    train auc: 0.7092  acc: 0.5893    eval auc: 0.5818  acc: 0.5646    test auc: 0.5969  acc: 0.5654, time: 0.8870
epoch 4    train auc: 0.8040  acc: 0.7132    eval auc: 0.6769  acc: 0.6584    test auc: 0.6877  acc: 0.6665, time: 0.9630
epoch 5    train auc: 0.8583  acc: 0.7394    eval auc: 0.7319  acc: 0.7037    test auc: 0.7411  acc: 0.7111, time: 0.9610
epoch 6    train auc: 0.8809  acc: 0.7692    eval auc: 0.7582  acc: 0.7236    test auc: 0.7652  acc: 0.7314, time: 0.9370
epoch 7    train auc: 0.8908  acc: 0.7757    eval auc: 0.7688  acc: 0.7305    test auc: 0.7746  acc: 0.7390, time: 0.9370
epoch 8    train auc: 0.8976  acc: 0.7944    eval auc: 0.7739  acc: 0.7289    test auc: 0.7785  acc: 0.7269, time: 0.9480
epoch 9    train auc: 0.9020  acc: 0.7981    eval auc: 0.7764  acc: 0.7295    test auc: 0.7798  acc: 0.7259, time: 0.9160
epoch 10    train auc: 0.9057  acc: 0.8014    eval auc: 0.7776  acc: 0.7271    test auc: 0.7799  acc: 0.7270, time: 0.9534
epoch 11    train auc: 0.9093  acc: 0.8092    eval auc: 0.7786  acc: 0.7241    test auc: 0.7802  acc: 0.7219, time: 0.9229
epoch 12    train auc: 0.9122  acc: 0.8138    eval auc: 0.7781  acc: 0.7216    test auc: 0.7790  acc: 0.7192, time: 0.9490
epoch 13    train auc: 0.9150  acc: 0.8177    eval auc: 0.7783  acc: 0.7189    test auc: 0.7788  acc: 0.7166, time: 0.9500
epoch 14    train auc: 0.9172  acc: 0.8165    eval auc: 0.7783  acc: 0.7194    test auc: 0.7783  acc: 0.7189, time: 0.9439
epoch 15    train auc: 0.9193  acc: 0.8202    eval auc: 0.7781  acc: 0.7177    test auc: 0.7781  acc: 0.7153, time: 0.9295
epoch 16    train auc: 0.9212  acc: 0.8236    eval auc: 0.7776  acc: 0.7140    test auc: 0.7772  acc: 0.7107, time: 0.9537
epoch 17    train auc: 0.9226  acc: 0.8226    eval auc: 0.7779  acc: 0.7171    test auc: 0.7770  acc: 0.7146, time: 0.9301
epoch 18    train auc: 0.9240  acc: 0.8240    eval auc: 0.7773  acc: 0.7146    test auc: 0.7760  acc: 0.7124, time: 0.9160
epoch 19    train auc: 0.9254  acc: 0.8269    eval auc: 0.7764  acc: 0.7114    test auc: 0.7750  acc: 0.7087, time: 0.9160
epoch 20    train auc: 0.9267  acc: 0.8278    eval auc: 0.7751  acc: 0.7075    test auc: 0.7735  acc: 0.7069, time: 0.9210
epoch 21    train auc: 0.9274  acc: 0.8263    eval auc: 0.7766  acc: 0.7124    test auc: 0.7749  acc: 0.7119, time: 0.9030
epoch 22    train auc: 0.9283  acc: 0.8268    eval auc: 0.7764  acc: 0.7124    test auc: 0.7743  acc: 0.7121, time: 0.9190
epoch 23    train auc: 0.9296  acc: 0.8293    eval auc: 0.7731  acc: 0.7041    test auc: 0.7715  acc: 0.7020, time: 0.9200
epoch 24    train auc: 0.9303  acc: 0.8298    eval auc: 0.7742  acc: 0.7081    test auc: 0.7721  acc: 0.7076, time: 0.8890
epoch 25    train auc: 0.9312  acc: 0.8315    eval auc: 0.7731  acc: 0.7060    test auc: 0.7712  acc: 0.7035, time: 0.8950
epoch 26    train auc: 0.9322  acc: 0.8339    eval auc: 0.7704  acc: 0.7003    test auc: 0.7684  acc: 0.6988, time: 0.9140
epoch 27    train auc: 0.9325  acc: 0.8328    eval auc: 0.7722  acc: 0.7050    test auc: 0.7701  acc: 0.7037, time: 0.8850
epoch 28    train auc: 0.9333  acc: 0.8337    eval auc: 0.7706  acc: 0.7014    test auc: 0.7686  acc: 0.7015, time: 0.8690
epoch 29    train auc: 0.9339  acc: 0.8348    eval auc: 0.7702  acc: 0.7000    test auc: 0.7684  acc: 0.7014, time: 0.8790
epoch 30    train auc: 0.9343  acc: 0.8339    eval auc: 0.7710  acc: 0.7020    test auc: 0.7691  acc: 0.7035, time: 0.8780
epoch 31    train auc: 0.9352  acc: 0.8356    eval auc: 0.7687  acc: 0.6984    test auc: 0.7666  acc: 0.6996, time: 0.8900
epoch 32    train auc: 0.9357  acc: 0.8359    eval auc: 0.7679  acc: 0.6978    test auc: 0.7661  acc: 0.7000, time: 0.8700
epoch 33    train auc: 0.9359  acc: 0.8358    eval auc: 0.7690  acc: 0.7002    test auc: 0.7674  acc: 0.7008, time: 0.8620
epoch 34    train auc: 0.9362  acc: 0.8351    eval auc: 0.7684  acc: 0.6994    test auc: 0.7663  acc: 0.7011, time: 0.8570
epoch 35    train auc: 0.9369  acc: 0.8395    eval auc: 0.7661  acc: 0.6942    test auc: 0.7648  acc: 0.6978, time: 0.8390
epoch 36    train auc: 0.9374  acc: 0.8392    eval auc: 0.7667  acc: 0.6965    test auc: 0.7652  acc: 0.6996, time: 0.8640
epoch 37    train auc: 0.9378  acc: 0.8394    eval auc: 0.7656  acc: 0.6952    test auc: 0.7642  acc: 0.6988, time: 0.8490
epoch 38    train auc: 0.9381  acc: 0.8381    eval auc: 0.7666  acc: 0.6968    test auc: 0.7648  acc: 0.7004, time: 0.9000
epoch 39    train auc: 0.9381  acc: 0.8382    eval auc: 0.7662  acc: 0.6993    test auc: 0.7641  acc: 0.6988, time: 0.8457
epoch 40    train auc: 0.9391  acc: 0.8404    eval auc: 0.7645  acc: 0.6958    test auc: 0.7627  acc: 0.6976, time: 0.8430
epoch 41    train auc: 0.9392  acc: 0.8404    eval auc: 0.7654  acc: 0.6957    test auc: 0.7639  acc: 0.7000, time: 0.8370
epoch 42    train auc: 0.9398  acc: 0.8416    eval auc: 0.7623  acc: 0.6922    test auc: 0.7611  acc: 0.6947, time: 0.8469
epoch 43    train auc: 0.9399  acc: 0.8414    eval auc: 0.7644  acc: 0.6956    test auc: 0.7630  acc: 0.6987, time: 0.8561
epoch 44    train auc: 0.9403  acc: 0.8416    eval auc: 0.7637  acc: 0.6950    test auc: 0.7624  acc: 0.6984, time: 0.8360
epoch 45    train auc: 0.9408  acc: 0.8425    eval auc: 0.7626  acc: 0.6931    test auc: 0.7610  acc: 0.6963, time: 0.8339
epoch 46    train auc: 0.9403  acc: 0.8406    eval auc: 0.7634  acc: 0.6962    test auc: 0.7615  acc: 0.6965, time: 0.8414
epoch 47    train auc: 0.9410  acc: 0.8420    eval auc: 0.7631  acc: 0.6948    test auc: 0.7614  acc: 0.6970, time: 0.8289
epoch 48    train auc: 0.9418  acc: 0.8439    eval auc: 0.7607  acc: 0.6917    test auc: 0.7593  acc: 0.6931, time: 0.8370
epoch 49    train auc: 0.9417  acc: 0.8426    eval auc: 0.7622  acc: 0.6945    test auc: 0.7608  acc: 0.6955, time: 0.7670
avg time per epoch : 0.8965178537368774
--- 54.11030340194702 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:42:57.338717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:42:57.339014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4963  acc: 0.5020    eval auc: 0.5121  acc: 0.4977    test auc: 0.4991  acc: 0.4959, time: 1.1840
epoch 1    train auc: 0.4841  acc: 0.4974    eval auc: 0.5249  acc: 0.5034    test auc: 0.5256  acc: 0.5063, time: 0.5490
epoch 2    train auc: 0.7412  acc: 0.5962    eval auc: 0.6262  acc: 0.5089    test auc: 0.6373  acc: 0.5120, time: 0.8069
epoch 3    train auc: 0.8771  acc: 0.7679    eval auc: 0.7862  acc: 0.7379    test auc: 0.7906  acc: 0.7484, time: 0.5120
epoch 4    train auc: 0.8984  acc: 0.7895    eval auc: 0.7917  acc: 0.7441    test auc: 0.7942  acc: 0.7478, time: 0.8579
epoch 5    train auc: 0.9112  acc: 0.8089    eval auc: 0.7870  acc: 0.7267    test auc: 0.7894  acc: 0.7241, time: 0.5270
epoch 6    train auc: 0.9163  acc: 0.8106    eval auc: 0.7901  acc: 0.7279    test auc: 0.7909  acc: 0.7248, time: 0.8730
epoch 7    train auc: 0.9236  acc: 0.8199    eval auc: 0.7794  acc: 0.7099    test auc: 0.7785  acc: 0.7030, time: 0.5070
epoch 8    train auc: 0.9243  acc: 0.8189    eval auc: 0.7848  acc: 0.7173    test auc: 0.7849  acc: 0.7128, time: 0.8159
epoch 9    train auc: 0.9293  acc: 0.8262    eval auc: 0.7737  acc: 0.6963    test auc: 0.7734  acc: 0.6952, time: 0.4980
epoch 10    train auc: 0.9280  acc: 0.8215    eval auc: 0.7823  acc: 0.7132    test auc: 0.7816  acc: 0.7106, time: 0.8224
epoch 11    train auc: 0.9308  acc: 0.8222    eval auc: 0.7776  acc: 0.7089    test auc: 0.7750  acc: 0.7019, time: 0.5160
epoch 12    train auc: 0.9280  acc: 0.8195    eval auc: 0.7834  acc: 0.7171    test auc: 0.7817  acc: 0.7137, time: 0.8039
epoch 13    train auc: 0.9352  acc: 0.8329    eval auc: 0.7713  acc: 0.6961    test auc: 0.7692  acc: 0.6929, time: 0.5099
epoch 14    train auc: 0.9318  acc: 0.8245    eval auc: 0.7793  acc: 0.7092    test auc: 0.7779  acc: 0.7081, time: 0.8280
epoch 15    train auc: 0.9377  acc: 0.8366    eval auc: 0.7651  acc: 0.6903    test auc: 0.7623  acc: 0.6871, time: 0.5243
epoch 16    train auc: 0.9351  acc: 0.8295    eval auc: 0.7744  acc: 0.7035    test auc: 0.7723  acc: 0.7001, time: 0.8180
epoch 17    train auc: 0.9391  acc: 0.8380    eval auc: 0.7652  acc: 0.6924    test auc: 0.7627  acc: 0.6887, time: 0.5159
epoch 18    train auc: 0.9358  acc: 0.8304    eval auc: 0.7736  acc: 0.7048    test auc: 0.7715  acc: 0.7015, time: 0.8380
epoch 19    train auc: 0.9393  acc: 0.8365    eval auc: 0.7667  acc: 0.6956    test auc: 0.7641  acc: 0.6938, time: 0.5174
epoch 20    train auc: 0.9380  acc: 0.8319    eval auc: 0.7703  acc: 0.7008    test auc: 0.7678  acc: 0.7002, time: 0.8310
epoch 21    train auc: 0.9415  acc: 0.8412    eval auc: 0.7623  acc: 0.6893    test auc: 0.7598  acc: 0.6885, time: 0.5950
epoch 22    train auc: 0.9392  acc: 0.8343    eval auc: 0.7691  acc: 0.7004    test auc: 0.7662  acc: 0.6990, time: 0.8750
epoch 23    train auc: 0.9420  acc: 0.8409    eval auc: 0.7633  acc: 0.6916    test auc: 0.7606  acc: 0.6909, time: 0.5520
epoch 24    train auc: 0.9400  acc: 0.8356    eval auc: 0.7680  acc: 0.6994    test auc: 0.7649  acc: 0.6972, time: 0.8580
epoch 25    train auc: 0.9430  acc: 0.8426    eval auc: 0.7623  acc: 0.6923    test auc: 0.7593  acc: 0.6895, time: 0.5360
epoch 26    train auc: 0.9408  acc: 0.8375    eval auc: 0.7675  acc: 0.6988    test auc: 0.7643  acc: 0.6971, time: 0.8470
epoch 27    train auc: 0.9438  acc: 0.8432    eval auc: 0.7614  acc: 0.6922    test auc: 0.7582  acc: 0.6886, time: 0.5140
epoch 28    train auc: 0.9393  acc: 0.8336    eval auc: 0.7690  acc: 0.7017    test auc: 0.7656  acc: 0.6998, time: 0.8520
epoch 29    train auc: 0.9446  acc: 0.8446    eval auc: 0.7581  acc: 0.6886    test auc: 0.7553  acc: 0.6859, time: 0.5210
epoch 30    train auc: 0.9424  acc: 0.8398    eval auc: 0.7649  acc: 0.6964    test auc: 0.7617  acc: 0.6943, time: 0.8550
epoch 31    train auc: 0.9446  acc: 0.8434    eval auc: 0.7598  acc: 0.6900    test auc: 0.7570  acc: 0.6891, time: 0.5359
epoch 32    train auc: 0.9424  acc: 0.8388    eval auc: 0.7641  acc: 0.6944    test auc: 0.7610  acc: 0.6942, time: 0.8470
epoch 33    train auc: 0.9452  acc: 0.8449    eval auc: 0.7562  acc: 0.6852    test auc: 0.7529  acc: 0.6847, time: 0.5240
epoch 34    train auc: 0.9437  acc: 0.8406    eval auc: 0.7625  acc: 0.6948    test auc: 0.7590  acc: 0.6937, time: 0.8570
epoch 35    train auc: 0.9464  acc: 0.8468    eval auc: 0.7544  acc: 0.6854    test auc: 0.7519  acc: 0.6844, time: 0.5300
epoch 36    train auc: 0.9458  acc: 0.8455    eval auc: 0.7577  acc: 0.6900    test auc: 0.7553  acc: 0.6877, time: 0.8520
epoch 37    train auc: 0.9460  acc: 0.8462    eval auc: 0.7528  acc: 0.6844    test auc: 0.7504  acc: 0.6815, time: 0.5310
epoch 38    train auc: 0.9473  acc: 0.8494    eval auc: 0.7578  acc: 0.6912    test auc: 0.7542  acc: 0.6870, time: 0.8610
epoch 39    train auc: 0.9474  acc: 0.8500    eval auc: 0.7517  acc: 0.6841    test auc: 0.7493  acc: 0.6838, time: 0.5390
epoch 40    train auc: 0.9484  acc: 0.8523    eval auc: 0.7573  acc: 0.6908    test auc: 0.7542  acc: 0.6869, time: 0.9770
epoch 41    train auc: 0.9503  acc: 0.8533    eval auc: 0.7536  acc: 0.6857    test auc: 0.7510  acc: 0.6834, time: 0.6120
epoch 42    train auc: 0.9505  acc: 0.8541    eval auc: 0.7554  acc: 0.6876    test auc: 0.7521  acc: 0.6851, time: 0.9910
epoch 43    train auc: 0.9513  acc: 0.8547    eval auc: 0.7535  acc: 0.6877    test auc: 0.7510  acc: 0.6841, time: 0.6180
epoch 44    train auc: 0.9519  acc: 0.8545    eval auc: 0.7542  acc: 0.6882    test auc: 0.7511  acc: 0.6825, time: 0.9920
epoch 45    train auc: 0.9528  acc: 0.8578    eval auc: 0.7524  acc: 0.6849    test auc: 0.7495  acc: 0.6811, time: 0.6240
epoch 46    train auc: 0.9535  acc: 0.8579    eval auc: 0.7508  acc: 0.6821    test auc: 0.7482  acc: 0.6818, time: 1.0240
epoch 47    train auc: 0.9549  acc: 0.8615    eval auc: 0.7507  acc: 0.6827    test auc: 0.7477  acc: 0.6795, time: 0.6270
epoch 48    train auc: 0.9546  acc: 0.8594    eval auc: 0.7514  acc: 0.6826    test auc: 0.7490  acc: 0.6840, time: 1.0170
epoch 49    train auc: 0.9567  acc: 0.8644    eval auc: 0.7479  acc: 0.6804    test auc: 0.7453  acc: 0.6788, time: 0.6600
avg time per epoch : 0.7175890398025513
--- 45.46519756317139 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:43:43.204472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:43:43.204928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5378  acc: 0.5251    eval auc: 0.5176  acc: 0.5122    test auc: 0.5333  acc: 0.5244, time: 1.4840
epoch 1    train auc: 0.5237  acc: 0.5114    eval auc: 0.4648  acc: 0.4858    test auc: 0.4675  acc: 0.4806, time: 0.6740
epoch 2    train auc: 0.5526  acc: 0.5234    eval auc: 0.4782  acc: 0.4901    test auc: 0.4860  acc: 0.4951, time: 1.0920
epoch 3    train auc: 0.5535  acc: 0.5145    eval auc: 0.4234  acc: 0.4828    test auc: 0.4194  acc: 0.4737, time: 0.6700
epoch 4    train auc: 0.5720  acc: 0.5375    eval auc: 0.4099  acc: 0.4495    test auc: 0.4050  acc: 0.4426, time: 1.0620
epoch 5    train auc: 0.5716  acc: 0.5345    eval auc: 0.4037  acc: 0.4513    test auc: 0.4002  acc: 0.4457, time: 0.6960
epoch 6    train auc: 0.6001  acc: 0.5619    eval auc: 0.4153  acc: 0.4369    test auc: 0.4125  acc: 0.4285, time: 1.0660
epoch 7    train auc: 0.6518  acc: 0.6043    eval auc: 0.4669  acc: 0.4759    test auc: 0.4679  acc: 0.4770, time: 0.6490
epoch 8    train auc: 0.8489  acc: 0.5464    eval auc: 0.7477  acc: 0.5088    test auc: 0.7582  acc: 0.5148, time: 1.0790
epoch 9    train auc: 0.8705  acc: 0.7703    eval auc: 0.7480  acc: 0.7215    test auc: 0.7539  acc: 0.7285, time: 0.6480
epoch 10    train auc: 0.8693  acc: 0.6352    eval auc: 0.7789  acc: 0.5484    test auc: 0.7874  acc: 0.5535, time: 1.0820
epoch 11    train auc: 0.8914  acc: 0.7866    eval auc: 0.7723  acc: 0.7342    test auc: 0.7755  acc: 0.7409, time: 0.6410
epoch 12    train auc: 0.8827  acc: 0.7156    eval auc: 0.7811  acc: 0.6007    test auc: 0.7882  acc: 0.6004, time: 1.0650
epoch 13    train auc: 0.9002  acc: 0.7991    eval auc: 0.7801  acc: 0.7303    test auc: 0.7819  acc: 0.7274, time: 0.6700
epoch 14    train auc: 0.8885  acc: 0.7351    eval auc: 0.7811  acc: 0.6197    test auc: 0.7877  acc: 0.6160, time: 1.0230
epoch 15    train auc: 0.9063  acc: 0.8038    eval auc: 0.7829  acc: 0.7255    test auc: 0.7837  acc: 0.7206, time: 0.6280
epoch 16    train auc: 0.8950  acc: 0.7530    eval auc: 0.7811  acc: 0.6330    test auc: 0.7865  acc: 0.6318, time: 1.0070
epoch 17    train auc: 0.9107  acc: 0.8094    eval auc: 0.7848  acc: 0.7207    test auc: 0.7851  acc: 0.7127, time: 0.6280
epoch 18    train auc: 0.8987  acc: 0.7625    eval auc: 0.7804  acc: 0.6412    test auc: 0.7854  acc: 0.6384, time: 0.9750
epoch 19    train auc: 0.9139  acc: 0.8128    eval auc: 0.7856  acc: 0.7185    test auc: 0.7853  acc: 0.7105, time: 0.5850
epoch 20    train auc: 0.9003  acc: 0.7659    eval auc: 0.7779  acc: 0.6440    test auc: 0.7829  acc: 0.6402, time: 0.9550
epoch 21    train auc: 0.9164  acc: 0.8119    eval auc: 0.7856  acc: 0.7194    test auc: 0.7846  acc: 0.7108, time: 0.6080
epoch 22    train auc: 0.9025  acc: 0.7708    eval auc: 0.7760  acc: 0.6478    test auc: 0.7805  acc: 0.6431, time: 0.9500
epoch 23    train auc: 0.9189  acc: 0.8161    eval auc: 0.7851  acc: 0.7166    test auc: 0.7838  acc: 0.7080, time: 0.5910
epoch 24    train auc: 0.9033  acc: 0.7721    eval auc: 0.7734  acc: 0.6485    test auc: 0.7779  acc: 0.6458, time: 0.9560
epoch 25    train auc: 0.9208  acc: 0.8174    eval auc: 0.7846  acc: 0.7152    test auc: 0.7832  acc: 0.7082, time: 0.5800
epoch 26    train auc: 0.9041  acc: 0.7739    eval auc: 0.7710  acc: 0.6503    test auc: 0.7755  acc: 0.6479, time: 0.9480
epoch 27    train auc: 0.9227  acc: 0.8195    eval auc: 0.7839  acc: 0.7146    test auc: 0.7824  acc: 0.7065, time: 0.5850
epoch 28    train auc: 0.9043  acc: 0.7746    eval auc: 0.7682  acc: 0.6503    test auc: 0.7725  acc: 0.6475, time: 0.9510
epoch 29    train auc: 0.9241  acc: 0.8199    eval auc: 0.7833  acc: 0.7147    test auc: 0.7815  acc: 0.7058, time: 0.5750
epoch 30    train auc: 0.9047  acc: 0.7761    eval auc: 0.7663  acc: 0.6512    test auc: 0.7706  acc: 0.6494, time: 0.9450
epoch 31    train auc: 0.9257  acc: 0.8224    eval auc: 0.7817  acc: 0.7119    test auc: 0.7801  acc: 0.7055, time: 0.5750
epoch 32    train auc: 0.9063  acc: 0.7804    eval auc: 0.7655  acc: 0.6559    test auc: 0.7695  acc: 0.6531, time: 0.9360
epoch 33    train auc: 0.9269  acc: 0.8240    eval auc: 0.7811  acc: 0.7102    test auc: 0.7794  acc: 0.7046, time: 0.5900
epoch 34    train auc: 0.9057  acc: 0.7788    eval auc: 0.7630  acc: 0.6539    test auc: 0.7671  acc: 0.6514, time: 0.9430
epoch 35    train auc: 0.9280  acc: 0.8256    eval auc: 0.7805  acc: 0.7096    test auc: 0.7788  acc: 0.7033, time: 0.5810
epoch 36    train auc: 0.9064  acc: 0.7811    eval auc: 0.7634  acc: 0.6589    test auc: 0.7673  acc: 0.6554, time: 0.9350
epoch 37    train auc: 0.9293  acc: 0.8286    eval auc: 0.7791  acc: 0.7074    test auc: 0.7776  acc: 0.6994, time: 0.5800
epoch 38    train auc: 0.9074  acc: 0.7818    eval auc: 0.7626  acc: 0.6596    test auc: 0.7662  acc: 0.6565, time: 0.9190
epoch 39    train auc: 0.9303  acc: 0.8296    eval auc: 0.7784  acc: 0.7061    test auc: 0.7768  acc: 0.6977, time: 0.5750
epoch 40    train auc: 0.9079  acc: 0.7837    eval auc: 0.7623  acc: 0.6625    test auc: 0.7660  acc: 0.6582, time: 0.9160
epoch 41    train auc: 0.9309  acc: 0.8301    eval auc: 0.7785  acc: 0.7070    test auc: 0.7767  acc: 0.6998, time: 0.5670
epoch 42    train auc: 0.9088  acc: 0.7853    eval auc: 0.7620  acc: 0.6641    test auc: 0.7657  acc: 0.6591, time: 0.9150
epoch 43    train auc: 0.9316  acc: 0.8298    eval auc: 0.7778  acc: 0.7070    test auc: 0.7756  acc: 0.7010, time: 0.5560
epoch 44    train auc: 0.9090  acc: 0.7866    eval auc: 0.7613  acc: 0.6645    test auc: 0.7650  acc: 0.6604, time: 0.9140
epoch 45    train auc: 0.9317  acc: 0.8282    eval auc: 0.7781  acc: 0.7101    test auc: 0.7756  acc: 0.7029, time: 0.5510
epoch 46    train auc: 0.9097  acc: 0.7879    eval auc: 0.7615  acc: 0.6657    test auc: 0.7650  acc: 0.6621, time: 0.9140
epoch 47    train auc: 0.9328  acc: 0.8312    eval auc: 0.7769  acc: 0.7048    test auc: 0.7745  acc: 0.7007, time: 0.5480
epoch 48    train auc: 0.9102  acc: 0.7888    eval auc: 0.7608  acc: 0.6664    test auc: 0.7643  acc: 0.6637, time: 0.8930
epoch 49    train auc: 0.9331  acc: 0.8315    eval auc: 0.7764  acc: 0.7053    test auc: 0.7740  acc: 0.7011, time: 0.5450
avg time per epoch : 0.8004179716110229
--- 51.287997007369995 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:44:34.149101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:44:34.149437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4966  acc: 0.4991    eval auc: 0.5090  acc: 0.4968    test auc: 0.5013  acc: 0.5061, time: 1.1970
epoch 1    train auc: 0.4854  acc: 0.4871    eval auc: 0.5189  acc: 0.5210    test auc: 0.5248  acc: 0.5177, time: 0.5460
epoch 2    train auc: 0.5353  acc: 0.5122    eval auc: 0.4452  acc: 0.4809    test auc: 0.4499  acc: 0.4825, time: 0.8890
epoch 3    train auc: 0.5747  acc: 0.5269    eval auc: 0.3916  acc: 0.4617    test auc: 0.3868  acc: 0.4577, time: 0.5430
epoch 4    train auc: 0.5824  acc: 0.5529    eval auc: 0.3804  acc: 0.4238    test auc: 0.3761  acc: 0.4174, time: 0.8620
epoch 5    train auc: 0.5883  acc: 0.5625    eval auc: 0.3715  acc: 0.4065    test auc: 0.3691  acc: 0.4058, time: 0.5470
epoch 6    train auc: 0.5917  acc: 0.5632    eval auc: 0.3674  acc: 0.4061    test auc: 0.3643  acc: 0.4043, time: 0.8600
epoch 7    train auc: 0.5935  acc: 0.5640    eval auc: 0.3657  acc: 0.4039    test auc: 0.3616  acc: 0.4041, time: 0.5320
epoch 8    train auc: 0.5947  acc: 0.5651    eval auc: 0.3641  acc: 0.4038    test auc: 0.3603  acc: 0.4010, time: 0.8540
epoch 9    train auc: 0.5953  acc: 0.5660    eval auc: 0.3637  acc: 0.4019    test auc: 0.3594  acc: 0.4000, time: 0.5270
epoch 10    train auc: 0.5957  acc: 0.5665    eval auc: 0.3633  acc: 0.4019    test auc: 0.3591  acc: 0.3985, time: 0.8610
epoch 11    train auc: 0.5960  acc: 0.5668    eval auc: 0.3632  acc: 0.4021    test auc: 0.3586  acc: 0.3977, time: 0.5320
epoch 12    train auc: 0.5962  acc: 0.5669    eval auc: 0.3628  acc: 0.4011    test auc: 0.3587  acc: 0.3983, time: 0.8540
epoch 13    train auc: 0.5964  acc: 0.5669    eval auc: 0.3629  acc: 0.4013    test auc: 0.3583  acc: 0.3980, time: 0.5260
epoch 14    train auc: 0.5965  acc: 0.5669    eval auc: 0.3630  acc: 0.4017    test auc: 0.3581  acc: 0.3977, time: 0.8690
epoch 15    train auc: 0.5966  acc: 0.5669    eval auc: 0.3629  acc: 0.4011    test auc: 0.3581  acc: 0.3983, time: 0.5210
epoch 16    train auc: 0.5967  acc: 0.5669    eval auc: 0.3630  acc: 0.4012    test auc: 0.3579  acc: 0.3982, time: 0.8420
epoch 17    train auc: 0.5968  acc: 0.5669    eval auc: 0.3626  acc: 0.4026    test auc: 0.3581  acc: 0.3967, time: 0.5280
epoch 18    train auc: 0.5968  acc: 0.5669    eval auc: 0.3628  acc: 0.4015    test auc: 0.3580  acc: 0.3979, time: 0.8390
epoch 19    train auc: 0.5969  acc: 0.5669    eval auc: 0.3628  acc: 0.4011    test auc: 0.3579  acc: 0.3983, time: 0.5100
epoch 20    train auc: 0.5969  acc: 0.5669    eval auc: 0.3626  acc: 0.3999    test auc: 0.3581  acc: 0.3995, time: 0.8420
epoch 21    train auc: 0.5970  acc: 0.5669    eval auc: 0.3631  acc: 0.4023    test auc: 0.3575  acc: 0.3971, time: 0.5140
epoch 22    train auc: 0.5970  acc: 0.5669    eval auc: 0.3630  acc: 0.4016    test auc: 0.3576  acc: 0.3978, time: 0.8370
epoch 23    train auc: 0.5970  acc: 0.5669    eval auc: 0.3631  acc: 0.4017    test auc: 0.3575  acc: 0.3977, time: 0.5080
epoch 24    train auc: 0.5970  acc: 0.5669    eval auc: 0.3631  acc: 0.4030    test auc: 0.3575  acc: 0.3964, time: 0.8460
epoch 25    train auc: 0.5971  acc: 0.5669    eval auc: 0.3630  acc: 0.4018    test auc: 0.3576  acc: 0.3976, time: 0.5130
epoch 26    train auc: 0.5971  acc: 0.5669    eval auc: 0.3631  acc: 0.4013    test auc: 0.3576  acc: 0.3980, time: 0.8370
epoch 27    train auc: 0.5971  acc: 0.5669    eval auc: 0.3630  acc: 0.3997    test auc: 0.3576  acc: 0.3997, time: 0.5110
epoch 28    train auc: 0.5971  acc: 0.5669    eval auc: 0.3630  acc: 0.4011    test auc: 0.3577  acc: 0.3983, time: 0.8190
epoch 29    train auc: 0.5971  acc: 0.5669    eval auc: 0.3628  acc: 0.4002    test auc: 0.3579  acc: 0.3992, time: 0.5100
epoch 30    train auc: 0.5971  acc: 0.5669    eval auc: 0.3634  acc: 0.4021    test auc: 0.3574  acc: 0.3973, time: 0.8230
epoch 31    train auc: 0.5971  acc: 0.5669    eval auc: 0.3633  acc: 0.4019    test auc: 0.3575  acc: 0.3974, time: 0.5010
epoch 32    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4026    test auc: 0.3573  acc: 0.3967, time: 0.8280
epoch 33    train auc: 0.5971  acc: 0.5669    eval auc: 0.3636  acc: 0.4024    test auc: 0.3571  acc: 0.3970, time: 0.5030
epoch 34    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4012    test auc: 0.3575  acc: 0.3982, time: 0.8100
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4030    test auc: 0.3576  acc: 0.3964, time: 0.5140
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4030    test auc: 0.3575  acc: 0.3964, time: 0.9330
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4018    test auc: 0.3575  acc: 0.3976, time: 0.5520
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4037    test auc: 0.3574  acc: 0.3957, time: 0.9050
epoch 39    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4021    test auc: 0.3573  acc: 0.3973, time: 0.5519
epoch 40    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4013    test auc: 0.3575  acc: 0.3980, time: 0.8940
epoch 41    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4023    test auc: 0.3573  acc: 0.3971, time: 0.5470
epoch 42    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4017    test auc: 0.3576  acc: 0.3977, time: 0.8900
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4013    test auc: 0.3574  acc: 0.3980, time: 0.5390
epoch 44    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4010    test auc: 0.3575  acc: 0.3984, time: 0.8690
epoch 45    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4023    test auc: 0.3575  acc: 0.3971, time: 0.5330
epoch 46    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4025    test auc: 0.3577  acc: 0.3969, time: 0.8770
epoch 47    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4024    test auc: 0.3576  acc: 0.3970, time: 0.5300
epoch 48    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4016    test auc: 0.3577  acc: 0.3978, time: 0.8750
epoch 49    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4006    test auc: 0.3577  acc: 0.3987, time: 0.5330
avg time per epoch : 0.6996756410598755
--- 44.50799894332886 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-06, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:45:18.721074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:45:18.721417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5153  acc: 0.5124    eval auc: 0.4801  acc: 0.4861    test auc: 0.4925  acc: 0.4906, time: 1.1520
epoch 1    train auc: 0.5133  acc: 0.5099    eval auc: 0.4867  acc: 0.4920    test auc: 0.4856  acc: 0.4867, time: 0.6000
epoch 2    train auc: 0.5378  acc: 0.5229    eval auc: 0.4562  acc: 0.4776    test auc: 0.4719  acc: 0.4820, time: 0.9710
epoch 3    train auc: 0.5437  acc: 0.5282    eval auc: 0.4428  acc: 0.4640    test auc: 0.4436  acc: 0.4597, time: 0.6010
epoch 4    train auc: 0.5671  acc: 0.5476    eval auc: 0.4094  acc: 0.4383    test auc: 0.4109  acc: 0.4344, time: 0.9670
epoch 5    train auc: 0.5803  acc: 0.5562    eval auc: 0.3990  acc: 0.4305    test auc: 0.4008  acc: 0.4248, time: 0.5890
epoch 6    train auc: 0.6088  acc: 0.5773    eval auc: 0.4152  acc: 0.4420    test auc: 0.4154  acc: 0.4400, time: 0.9540
epoch 7    train auc: 0.7098  acc: 0.6503    eval auc: 0.5266  acc: 0.5167    test auc: 0.5329  acc: 0.5200, time: 0.5900
epoch 8    train auc: 0.8148  acc: 0.7284    eval auc: 0.6643  acc: 0.6525    test auc: 0.6730  acc: 0.6637, time: 0.9750
epoch 9    train auc: 0.8571  acc: 0.7585    eval auc: 0.7141  acc: 0.6952    test auc: 0.7211  acc: 0.7034, time: 0.5980
epoch 10    train auc: 0.8763  acc: 0.7848    eval auc: 0.7401  acc: 0.7014    test auc: 0.7458  acc: 0.7068, time: 1.0240
epoch 11    train auc: 0.8846  acc: 0.7803    eval auc: 0.7492  acc: 0.7190    test auc: 0.7534  acc: 0.7232, time: 0.6350
epoch 12    train auc: 0.8916  acc: 0.7870    eval auc: 0.7582  acc: 0.7248    test auc: 0.7615  acc: 0.7295, time: 1.0020
epoch 13    train auc: 0.8959  acc: 0.7972    eval auc: 0.7615  acc: 0.7199    test auc: 0.7641  acc: 0.7158, time: 0.5940
epoch 14    train auc: 0.9004  acc: 0.8042    eval auc: 0.7671  acc: 0.7177    test auc: 0.7691  acc: 0.7124, time: 0.9780
epoch 15    train auc: 0.9037  acc: 0.8038    eval auc: 0.7695  acc: 0.7206    test auc: 0.7709  acc: 0.7177, time: 0.6000
epoch 16    train auc: 0.9069  acc: 0.8074    eval auc: 0.7726  acc: 0.7205    test auc: 0.7733  acc: 0.7141, time: 0.9570
epoch 17    train auc: 0.9095  acc: 0.8138    eval auc: 0.7740  acc: 0.7140    test auc: 0.7745  acc: 0.7080, time: 0.5920
epoch 18    train auc: 0.9120  acc: 0.8125    eval auc: 0.7765  acc: 0.7179    test auc: 0.7765  acc: 0.7150, time: 0.9400
epoch 19    train auc: 0.9141  acc: 0.8160    eval auc: 0.7771  acc: 0.7167    test auc: 0.7766  acc: 0.7126, time: 0.5780
epoch 20    train auc: 0.9161  acc: 0.8163    eval auc: 0.7782  acc: 0.7187    test auc: 0.7775  acc: 0.7153, time: 0.9380
epoch 21    train auc: 0.9179  acc: 0.8188    eval auc: 0.7781  acc: 0.7177    test auc: 0.7771  acc: 0.7113, time: 0.5890
epoch 22    train auc: 0.9194  acc: 0.8187    eval auc: 0.7792  acc: 0.7197    test auc: 0.7776  acc: 0.7139, time: 0.9350
epoch 23    train auc: 0.9210  acc: 0.8207    eval auc: 0.7785  acc: 0.7181    test auc: 0.7769  acc: 0.7102, time: 0.5760
epoch 24    train auc: 0.9222  acc: 0.8226    eval auc: 0.7791  acc: 0.7172    test auc: 0.7774  acc: 0.7105, time: 0.9330
epoch 25    train auc: 0.9234  acc: 0.8236    eval auc: 0.7790  acc: 0.7165    test auc: 0.7772  acc: 0.7117, time: 0.5730
epoch 26    train auc: 0.9245  acc: 0.8251    eval auc: 0.7791  acc: 0.7164    test auc: 0.7772  acc: 0.7101, time: 0.9680
epoch 27    train auc: 0.9256  acc: 0.8254    eval auc: 0.7784  acc: 0.7160    test auc: 0.7763  acc: 0.7087, time: 0.5950
epoch 28    train auc: 0.9265  acc: 0.8282    eval auc: 0.7779  acc: 0.7109    test auc: 0.7759  acc: 0.7061, time: 0.9640
epoch 29    train auc: 0.9273  acc: 0.8263    eval auc: 0.7780  acc: 0.7137    test auc: 0.7757  acc: 0.7100, time: 0.5940
epoch 30    train auc: 0.9281  acc: 0.8296    eval auc: 0.7768  acc: 0.7093    test auc: 0.7750  acc: 0.7067, time: 0.9590
epoch 31    train auc: 0.9290  acc: 0.8286    eval auc: 0.7764  acc: 0.7104    test auc: 0.7740  acc: 0.7070, time: 0.5920
epoch 32    train auc: 0.9294  acc: 0.8288    eval auc: 0.7772  acc: 0.7124    test auc: 0.7747  acc: 0.7096, time: 0.9490
epoch 33    train auc: 0.9303  acc: 0.8312    eval auc: 0.7757  acc: 0.7083    test auc: 0.7733  acc: 0.7058, time: 0.5830
epoch 34    train auc: 0.9309  acc: 0.8315    eval auc: 0.7746  acc: 0.7047    test auc: 0.7726  acc: 0.7052, time: 0.9370
epoch 35    train auc: 0.9315  acc: 0.8325    eval auc: 0.7741  acc: 0.7037    test auc: 0.7721  acc: 0.7047, time: 0.5840
epoch 36    train auc: 0.9318  acc: 0.8315    eval auc: 0.7757  acc: 0.7081    test auc: 0.7734  acc: 0.7073, time: 0.9230
epoch 37    train auc: 0.9325  acc: 0.8331    eval auc: 0.7726  acc: 0.7035    test auc: 0.7708  acc: 0.7026, time: 0.5670
epoch 38    train auc: 0.9330  acc: 0.8329    eval auc: 0.7738  acc: 0.7033    test auc: 0.7714  acc: 0.7043, time: 0.9340
epoch 39    train auc: 0.9336  acc: 0.8343    eval auc: 0.7715  acc: 0.7017    test auc: 0.7693  acc: 0.7014, time: 0.5640
epoch 40    train auc: 0.9339  acc: 0.8332    eval auc: 0.7731  acc: 0.7023    test auc: 0.7709  acc: 0.7037, time: 0.9010
epoch 41    train auc: 0.9345  acc: 0.8346    eval auc: 0.7718  acc: 0.7009    test auc: 0.7696  acc: 0.7027, time: 0.5640
epoch 42    train auc: 0.9349  acc: 0.8347    eval auc: 0.7717  acc: 0.7007    test auc: 0.7694  acc: 0.7023, time: 0.9140
epoch 43    train auc: 0.9353  acc: 0.8356    eval auc: 0.7709  acc: 0.6997    test auc: 0.7686  acc: 0.7011, time: 0.5500
epoch 44    train auc: 0.9356  acc: 0.8354    eval auc: 0.7708  acc: 0.7004    test auc: 0.7686  acc: 0.7011, time: 0.9070
epoch 45    train auc: 0.9358  acc: 0.8354    eval auc: 0.7710  acc: 0.7027    test auc: 0.7685  acc: 0.7036, time: 0.5510
epoch 46    train auc: 0.9364  acc: 0.8369    eval auc: 0.7696  acc: 0.7004    test auc: 0.7676  acc: 0.7017, time: 0.8910
epoch 47    train auc: 0.9366  acc: 0.8356    eval auc: 0.7698  acc: 0.7010    test auc: 0.7675  acc: 0.7022, time: 0.5610
epoch 48    train auc: 0.9371  acc: 0.8371    eval auc: 0.7675  acc: 0.6972    test auc: 0.7656  acc: 0.6988, time: 0.8850
epoch 49    train auc: 0.9372  acc: 0.8369    eval auc: 0.7690  acc: 0.7004    test auc: 0.7667  acc: 0.7013, time: 0.5450
avg time per epoch : 0.768456711769104
--- 48.865036487579346 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:46:07.684565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:46:07.685040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4808  acc: 0.4953    eval auc: 0.5320  acc: 0.5027    test auc: 0.5307  acc: 0.5116, time: 1.1920
epoch 1    train auc: 0.5230  acc: 0.5015    eval auc: 0.5692  acc: 0.5128    test auc: 0.5676  acc: 0.5192, time: 0.5400
epoch 2    train auc: 0.8675  acc: 0.7427    eval auc: 0.7828  acc: 0.7206    test auc: 0.7899  acc: 0.7302, time: 0.8800
epoch 3    train auc: 0.8973  acc: 0.7896    eval auc: 0.7942  acc: 0.7494    test auc: 0.7974  acc: 0.7564, time: 0.5550
epoch 4    train auc: 0.8942  acc: 0.7682    eval auc: 0.7930  acc: 0.7309    test auc: 0.7927  acc: 0.7360, time: 0.9740
epoch 5    train auc: 0.9166  acc: 0.8140    eval auc: 0.7890  acc: 0.7251    test auc: 0.7881  acc: 0.7184, time: 0.5840
epoch 6    train auc: 0.9137  acc: 0.7969    eval auc: 0.7926  acc: 0.7290    test auc: 0.7895  acc: 0.7311, time: 0.9470
epoch 7    train auc: 0.9266  acc: 0.8234    eval auc: 0.7803  acc: 0.7104    test auc: 0.7773  acc: 0.7023, time: 0.5870
epoch 8    train auc: 0.9203  acc: 0.8025    eval auc: 0.7860  acc: 0.7238    test auc: 0.7819  acc: 0.7190, time: 0.9640
epoch 9    train auc: 0.9314  acc: 0.8285    eval auc: 0.7733  acc: 0.6965    test auc: 0.7712  acc: 0.6967, time: 0.5930
epoch 10    train auc: 0.9257  acc: 0.8100    eval auc: 0.7833  acc: 0.7223    test auc: 0.7796  acc: 0.7164, time: 0.9450
epoch 11    train auc: 0.9323  acc: 0.8223    eval auc: 0.7749  acc: 0.7093    test auc: 0.7715  acc: 0.7021, time: 0.5800
epoch 12    train auc: 0.9264  acc: 0.8103    eval auc: 0.7833  acc: 0.7239    test auc: 0.7795  acc: 0.7177, time: 0.9470
epoch 13    train auc: 0.9370  acc: 0.8342    eval auc: 0.7670  acc: 0.6939    test auc: 0.7656  acc: 0.6922, time: 0.5720
epoch 14    train auc: 0.9326  acc: 0.8216    eval auc: 0.7770  acc: 0.7137    test auc: 0.7753  acc: 0.7102, time: 0.9290
epoch 15    train auc: 0.9395  acc: 0.8388    eval auc: 0.7610  acc: 0.6867    test auc: 0.7598  acc: 0.6873, time: 0.5650
epoch 16    train auc: 0.9351  acc: 0.8245    eval auc: 0.7712  acc: 0.7055    test auc: 0.7693  acc: 0.7036, time: 0.9290
epoch 17    train auc: 0.9410  acc: 0.8399    eval auc: 0.7625  acc: 0.6903    test auc: 0.7618  acc: 0.6906, time: 0.5810
epoch 18    train auc: 0.9366  acc: 0.8271    eval auc: 0.7706  acc: 0.7063    test auc: 0.7698  acc: 0.7041, time: 0.9450
epoch 19    train auc: 0.9426  acc: 0.8407    eval auc: 0.7605  acc: 0.6902    test auc: 0.7602  acc: 0.6902, time: 0.5740
epoch 20    train auc: 0.9388  acc: 0.8301    eval auc: 0.7653  acc: 0.6981    test auc: 0.7648  acc: 0.7010, time: 0.9140
epoch 21    train auc: 0.9442  acc: 0.8438    eval auc: 0.7577  acc: 0.6854    test auc: 0.7577  acc: 0.6877, time: 0.5590
epoch 22    train auc: 0.9403  acc: 0.8327    eval auc: 0.7644  acc: 0.6969    test auc: 0.7643  acc: 0.6978, time: 0.9110
epoch 23    train auc: 0.9450  acc: 0.8439    eval auc: 0.7569  acc: 0.6865    test auc: 0.7574  acc: 0.6866, time: 0.5550
epoch 24    train auc: 0.9420  acc: 0.8355    eval auc: 0.7611  acc: 0.6936    test auc: 0.7616  acc: 0.6943, time: 0.8960
epoch 25    train auc: 0.9475  acc: 0.8491    eval auc: 0.7554  acc: 0.6837    test auc: 0.7565  acc: 0.6858, time: 0.5490
epoch 26    train auc: 0.9438  acc: 0.8406    eval auc: 0.7603  acc: 0.6934    test auc: 0.7616  acc: 0.6937, time: 0.9040
epoch 27    train auc: 0.9491  acc: 0.8493    eval auc: 0.7539  acc: 0.6847    test auc: 0.7554  acc: 0.6844, time: 0.5440
epoch 28    train auc: 0.9454  acc: 0.8409    eval auc: 0.7598  acc: 0.6921    test auc: 0.7613  acc: 0.6925, time: 0.9070
epoch 29    train auc: 0.9519  acc: 0.8543    eval auc: 0.7510  acc: 0.6828    test auc: 0.7525  acc: 0.6836, time: 0.5460
epoch 30    train auc: 0.9477  acc: 0.8420    eval auc: 0.7574  acc: 0.6908    test auc: 0.7588  acc: 0.6908, time: 0.8910
epoch 31    train auc: 0.9559  acc: 0.8574    eval auc: 0.7484  acc: 0.6827    test auc: 0.7505  acc: 0.6825, time: 0.5540
epoch 32    train auc: 0.9512  acc: 0.8449    eval auc: 0.7564  acc: 0.6882    test auc: 0.7582  acc: 0.6917, time: 0.8880
epoch 33    train auc: 0.9620  acc: 0.8682    eval auc: 0.7433  acc: 0.6758    test auc: 0.7447  acc: 0.6792, time: 0.5470
epoch 34    train auc: 0.9604  acc: 0.8689    eval auc: 0.7539  acc: 0.6866    test auc: 0.7554  acc: 0.6926, time: 0.8790
epoch 35    train auc: 0.9672  acc: 0.8783    eval auc: 0.7422  acc: 0.6756    test auc: 0.7442  acc: 0.6794, time: 0.5400
epoch 36    train auc: 0.9667  acc: 0.8805    eval auc: 0.7505  acc: 0.6909    test auc: 0.7520  acc: 0.6903, time: 0.8660
epoch 37    train auc: 0.9719  acc: 0.8898    eval auc: 0.7420  acc: 0.6779    test auc: 0.7431  acc: 0.6812, time: 0.5390
epoch 38    train auc: 0.9706  acc: 0.8866    eval auc: 0.7477  acc: 0.6897    test auc: 0.7498  acc: 0.6915, time: 0.8640
epoch 39    train auc: 0.9758  acc: 0.8992    eval auc: 0.7393  acc: 0.6787    test auc: 0.7405  acc: 0.6787, time: 0.5300
epoch 40    train auc: 0.9750  acc: 0.8936    eval auc: 0.7451  acc: 0.6866    test auc: 0.7480  acc: 0.6928, time: 0.8690
epoch 41    train auc: 0.9788  acc: 0.9075    eval auc: 0.7373  acc: 0.6804    test auc: 0.7391  acc: 0.6808, time: 0.5260
epoch 42    train auc: 0.9787  acc: 0.9023    eval auc: 0.7408  acc: 0.6845    test auc: 0.7429  acc: 0.6856, time: 0.8570
epoch 43    train auc: 0.9818  acc: 0.9109    eval auc: 0.7361  acc: 0.6758    test auc: 0.7368  acc: 0.6778, time: 0.5290
epoch 44    train auc: 0.9802  acc: 0.9037    eval auc: 0.7400  acc: 0.6852    test auc: 0.7423  acc: 0.6857, time: 0.8570
epoch 45    train auc: 0.9837  acc: 0.9172    eval auc: 0.7332  acc: 0.6797    test auc: 0.7337  acc: 0.6768, time: 0.5330
epoch 46    train auc: 0.9830  acc: 0.9108    eval auc: 0.7378  acc: 0.6852    test auc: 0.7390  acc: 0.6825, time: 0.8410
epoch 47    train auc: 0.9855  acc: 0.9192    eval auc: 0.7306  acc: 0.6754    test auc: 0.7308  acc: 0.6717, time: 0.5200
epoch 48    train auc: 0.9843  acc: 0.9148    eval auc: 0.7365  acc: 0.6858    test auc: 0.7374  acc: 0.6824, time: 0.8360
epoch 49    train auc: 0.9865  acc: 0.9240    eval auc: 0.7277  acc: 0.6763    test auc: 0.7283  acc: 0.6749, time: 0.5190
avg time per epoch : 0.7330571317672729
--- 46.6779682636261 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 0.0002, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:46:54.268230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:46:54.268566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5058  acc: 0.5062    eval auc: 0.5123  acc: 0.5070    test auc: 0.5172  acc: 0.5103, time: 1.1750
epoch 1    train auc: 0.5277  acc: 0.5187    eval auc: 0.4754  acc: 0.4836    test auc: 0.4589  acc: 0.4702, time: 0.5080
epoch 2    train auc: 0.5649  acc: 0.5418    eval auc: 0.4778  acc: 0.4836    test auc: 0.4715  acc: 0.4813, time: 0.8370
epoch 3    train auc: 0.5560  acc: 0.5337    eval auc: 0.4300  acc: 0.4609    test auc: 0.4076  acc: 0.4397, time: 0.5210
epoch 4    train auc: 0.5703  acc: 0.5487    eval auc: 0.4087  acc: 0.4382    test auc: 0.3890  acc: 0.4178, time: 0.8360
epoch 5    train auc: 0.5744  acc: 0.5527    eval auc: 0.4017  acc: 0.4324    test auc: 0.3816  acc: 0.4119, time: 0.5110
epoch 6    train auc: 0.5824  acc: 0.5589    eval auc: 0.3936  acc: 0.4276    test auc: 0.3758  acc: 0.4067, time: 0.8320
epoch 7    train auc: 0.5866  acc: 0.5600    eval auc: 0.3911  acc: 0.4241    test auc: 0.3734  acc: 0.4048, time: 0.5010
epoch 8    train auc: 0.6421  acc: 0.5986    eval auc: 0.4334  acc: 0.4508    test auc: 0.4235  acc: 0.4446, time: 0.8260
epoch 9    train auc: 0.7208  acc: 0.6562    eval auc: 0.5322  acc: 0.5220    test auc: 0.5279  acc: 0.5164, time: 0.5140
epoch 10    train auc: 0.8334  acc: 0.7490    eval auc: 0.6848  acc: 0.6209    test auc: 0.6899  acc: 0.6289, time: 0.8360
epoch 11    train auc: 0.8571  acc: 0.7589    eval auc: 0.7131  acc: 0.6879    test auc: 0.7165  acc: 0.6962, time: 0.5060
epoch 12    train auc: 0.8836  acc: 0.7800    eval auc: 0.7536  acc: 0.7231    test auc: 0.7554  acc: 0.7245, time: 0.8370
epoch 13    train auc: 0.8887  acc: 0.7896    eval auc: 0.7573  acc: 0.7207    test auc: 0.7583  acc: 0.7192, time: 0.5130
epoch 14    train auc: 0.8960  acc: 0.8002    eval auc: 0.7708  acc: 0.7301    test auc: 0.7711  acc: 0.7223, time: 0.8200
epoch 15    train auc: 0.8992  acc: 0.7990    eval auc: 0.7699  acc: 0.7257    test auc: 0.7691  acc: 0.7211, time: 0.5090
epoch 16    train auc: 0.9032  acc: 0.8044    eval auc: 0.7764  acc: 0.7321    test auc: 0.7755  acc: 0.7233, time: 0.8310
epoch 17    train auc: 0.9056  acc: 0.8085    eval auc: 0.7739  acc: 0.7213    test auc: 0.7723  acc: 0.7127, time: 0.5120
epoch 18    train auc: 0.9085  acc: 0.8094    eval auc: 0.7793  acc: 0.7279    test auc: 0.7776  acc: 0.7199, time: 0.8240
epoch 19    train auc: 0.9103  acc: 0.8110    eval auc: 0.7765  acc: 0.7223    test auc: 0.7736  acc: 0.7143, time: 0.5160
epoch 20    train auc: 0.9126  acc: 0.8131    eval auc: 0.7810  acc: 0.7259    test auc: 0.7786  acc: 0.7191, time: 0.8230
epoch 21    train auc: 0.9141  acc: 0.8154    eval auc: 0.7777  acc: 0.7185    test auc: 0.7744  acc: 0.7138, time: 0.5170
epoch 22    train auc: 0.9158  acc: 0.8163    eval auc: 0.7820  acc: 0.7251    test auc: 0.7790  acc: 0.7185, time: 0.8420
epoch 23    train auc: 0.9173  acc: 0.8192    eval auc: 0.7781  acc: 0.7128    test auc: 0.7744  acc: 0.7079, time: 0.5270
epoch 24    train auc: 0.9185  acc: 0.8182    eval auc: 0.7823  acc: 0.7218    test auc: 0.7790  acc: 0.7177, time: 0.8350
epoch 25    train auc: 0.9199  acc: 0.8201    eval auc: 0.7791  acc: 0.7124    test auc: 0.7751  acc: 0.7095, time: 0.5060
epoch 26    train auc: 0.9207  acc: 0.8206    eval auc: 0.7822  acc: 0.7190    test auc: 0.7789  acc: 0.7150, time: 0.8390
epoch 27    train auc: 0.9221  acc: 0.8217    eval auc: 0.7790  acc: 0.7125    test auc: 0.7748  acc: 0.7111, time: 0.5340
epoch 28    train auc: 0.9225  acc: 0.8232    eval auc: 0.7815  acc: 0.7165    test auc: 0.7782  acc: 0.7109, time: 0.8470
epoch 29    train auc: 0.9240  acc: 0.8240    eval auc: 0.7788  acc: 0.7120    test auc: 0.7745  acc: 0.7104, time: 0.5149
epoch 30    train auc: 0.9242  acc: 0.8242    eval auc: 0.7811  acc: 0.7166    test auc: 0.7778  acc: 0.7105, time: 0.8280
epoch 31    train auc: 0.9258  acc: 0.8264    eval auc: 0.7774  acc: 0.7105    test auc: 0.7733  acc: 0.7050, time: 0.5260
epoch 32    train auc: 0.9257  acc: 0.8243    eval auc: 0.7811  acc: 0.7170    test auc: 0.7777  acc: 0.7135, time: 0.8240
epoch 33    train auc: 0.9273  acc: 0.8282    eval auc: 0.7770  acc: 0.7095    test auc: 0.7729  acc: 0.7050, time: 0.5120
epoch 34    train auc: 0.9269  acc: 0.8272    eval auc: 0.7795  acc: 0.7137    test auc: 0.7765  acc: 0.7088, time: 0.8360
epoch 35    train auc: 0.9285  acc: 0.8286    eval auc: 0.7766  acc: 0.7087    test auc: 0.7728  acc: 0.7023, time: 0.5240
epoch 36    train auc: 0.9280  acc: 0.8268    eval auc: 0.7802  acc: 0.7139    test auc: 0.7771  acc: 0.7118, time: 0.9550
epoch 37    train auc: 0.9297  acc: 0.8294    eval auc: 0.7757  acc: 0.7076    test auc: 0.7720  acc: 0.7019, time: 0.6070
epoch 38    train auc: 0.9292  acc: 0.8291    eval auc: 0.7786  acc: 0.7118    test auc: 0.7756  acc: 0.7075, time: 0.9770
epoch 39    train auc: 0.9309  acc: 0.8311    eval auc: 0.7743  acc: 0.7029    test auc: 0.7706  acc: 0.7003, time: 0.6019
epoch 40    train auc: 0.9300  acc: 0.8293    eval auc: 0.7783  acc: 0.7104    test auc: 0.7756  acc: 0.7096, time: 0.9819
epoch 41    train auc: 0.9318  acc: 0.8312    eval auc: 0.7748  acc: 0.7046    test auc: 0.7712  acc: 0.7050, time: 0.6010
epoch 42    train auc: 0.9310  acc: 0.8312    eval auc: 0.7773  acc: 0.7083    test auc: 0.7746  acc: 0.7078, time: 0.9950
epoch 43    train auc: 0.9327  acc: 0.8323    eval auc: 0.7739  acc: 0.7028    test auc: 0.7703  acc: 0.7041, time: 0.6070
epoch 44    train auc: 0.9319  acc: 0.8316    eval auc: 0.7767  acc: 0.7054    test auc: 0.7740  acc: 0.7072, time: 0.9950
epoch 45    train auc: 0.9332  acc: 0.8312    eval auc: 0.7740  acc: 0.7040    test auc: 0.7702  acc: 0.7052, time: 0.5960
epoch 46    train auc: 0.9324  acc: 0.8318    eval auc: 0.7763  acc: 0.7065    test auc: 0.7737  acc: 0.7067, time: 0.9630
epoch 47    train auc: 0.9341  acc: 0.8335    eval auc: 0.7731  acc: 0.7028    test auc: 0.7695  acc: 0.7049, time: 0.5910
epoch 48    train auc: 0.9332  acc: 0.8331    eval auc: 0.7742  acc: 0.7039    test auc: 0.7718  acc: 0.7041, time: 0.9760
epoch 49    train auc: 0.9348  acc: 0.8341    eval auc: 0.7724  acc: 0.7020    test auc: 0.7690  acc: 0.7034, time: 0.5980
avg time per epoch : 0.7128968954086303
--- 45.32896614074707 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.001}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:47:39.727473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:47:39.727840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.4902  acc: 0.4956    eval auc: 0.5171  acc: 0.5056    test auc: 0.5124  acc: 0.5077, time: 1.4040
epoch 1    train auc: 0.5016  acc: 0.5023    eval auc: 0.4948  acc: 0.4981    test auc: 0.5004  acc: 0.4951, time: 0.5810
epoch 2    train auc: 0.5021  acc: 0.4992    eval auc: 0.4982  acc: 0.5043    test auc: 0.4955  acc: 0.4981, time: 0.9430
epoch 3    train auc: 0.5635  acc: 0.5436    eval auc: 0.4076  acc: 0.4390    test auc: 0.4044  acc: 0.4302, time: 0.5770
epoch 4    train auc: 0.5868  acc: 0.5613    eval auc: 0.3747  acc: 0.4090    test auc: 0.3715  acc: 0.4071, time: 0.9530
epoch 5    train auc: 0.5900  acc: 0.5630    eval auc: 0.3693  acc: 0.4052    test auc: 0.3683  acc: 0.4057, time: 0.5710
epoch 6    train auc: 0.5932  acc: 0.5646    eval auc: 0.3658  acc: 0.4039    test auc: 0.3631  acc: 0.4022, time: 0.9410
epoch 7    train auc: 0.5944  acc: 0.5653    eval auc: 0.3650  acc: 0.4038    test auc: 0.3613  acc: 0.4003, time: 0.5800
epoch 8    train auc: 0.5952  acc: 0.5660    eval auc: 0.3642  acc: 0.4037    test auc: 0.3600  acc: 0.3982, time: 0.9600
epoch 9    train auc: 0.5957  acc: 0.5664    eval auc: 0.3639  acc: 0.4037    test auc: 0.3591  acc: 0.3970, time: 0.5770
epoch 10    train auc: 0.5961  acc: 0.5664    eval auc: 0.3635  acc: 0.4019    test auc: 0.3588  acc: 0.3987, time: 0.9870
epoch 11    train auc: 0.5963  acc: 0.5667    eval auc: 0.3635  acc: 0.4021    test auc: 0.3584  acc: 0.3979, time: 0.5830
epoch 12    train auc: 0.5965  acc: 0.5668    eval auc: 0.3632  acc: 0.4003    test auc: 0.3583  acc: 0.3993, time: 0.9310
epoch 13    train auc: 0.5966  acc: 0.5668    eval auc: 0.3633  acc: 0.4025    test auc: 0.3579  acc: 0.3971, time: 0.5740
epoch 14    train auc: 0.5967  acc: 0.5668    eval auc: 0.3633  acc: 0.4016    test auc: 0.3578  acc: 0.3979, time: 0.9450
epoch 15    train auc: 0.5968  acc: 0.5668    eval auc: 0.3633  acc: 0.4011    test auc: 0.3576  acc: 0.3984, time: 0.5710
epoch 16    train auc: 0.5969  acc: 0.5669    eval auc: 0.3633  acc: 0.4015    test auc: 0.3575  acc: 0.3979, time: 0.9490
epoch 17    train auc: 0.5969  acc: 0.5669    eval auc: 0.3631  acc: 0.4017    test auc: 0.3576  acc: 0.3977, time: 0.5800
epoch 18    train auc: 0.5970  acc: 0.5669    eval auc: 0.3631  acc: 0.4024    test auc: 0.3577  acc: 0.3970, time: 0.9550
epoch 19    train auc: 0.5970  acc: 0.5669    eval auc: 0.3632  acc: 0.4019    test auc: 0.3574  acc: 0.3974, time: 0.5750
epoch 20    train auc: 0.5971  acc: 0.5669    eval auc: 0.3630  acc: 0.3995    test auc: 0.3577  acc: 0.3999, time: 0.9470
epoch 21    train auc: 0.5971  acc: 0.5669    eval auc: 0.3633  acc: 0.4018    test auc: 0.3574  acc: 0.3976, time: 0.5710
epoch 22    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4016    test auc: 0.3574  acc: 0.3978, time: 0.9360
epoch 23    train auc: 0.5971  acc: 0.5669    eval auc: 0.3634  acc: 0.4028    test auc: 0.3572  acc: 0.3966, time: 0.5880
epoch 24    train auc: 0.5971  acc: 0.5669    eval auc: 0.3632  acc: 0.4028    test auc: 0.3574  acc: 0.3966, time: 0.9390
epoch 25    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4023    test auc: 0.3573  acc: 0.3971, time: 0.5740
epoch 26    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4023    test auc: 0.3573  acc: 0.3971, time: 0.9400
epoch 27    train auc: 0.5972  acc: 0.5669    eval auc: 0.3630  acc: 0.3993    test auc: 0.3576  acc: 0.4000, time: 0.5790
epoch 28    train auc: 0.5972  acc: 0.5669    eval auc: 0.3632  acc: 0.4012    test auc: 0.3576  acc: 0.3982, time: 0.9410
epoch 29    train auc: 0.5972  acc: 0.5669    eval auc: 0.3630  acc: 0.4006    test auc: 0.3577  acc: 0.3987, time: 0.5830
epoch 30    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4003    test auc: 0.3574  acc: 0.3991, time: 0.9300
epoch 31    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4016    test auc: 0.3573  acc: 0.3978, time: 0.5700
epoch 32    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4026    test auc: 0.3571  acc: 0.3967, time: 0.9330
epoch 33    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.3998    test auc: 0.3571  acc: 0.3996, time: 0.5780
epoch 34    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4010    test auc: 0.3573  acc: 0.3984, time: 0.9400
epoch 35    train auc: 0.5972  acc: 0.5669    eval auc: 0.3631  acc: 0.4011    test auc: 0.3575  acc: 0.3983, time: 0.5790
epoch 36    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4018    test auc: 0.3573  acc: 0.3976, time: 0.9380
epoch 37    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4009    test auc: 0.3571  acc: 0.3985, time: 0.5600
epoch 38    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4017    test auc: 0.3572  acc: 0.3977, time: 0.9180
epoch 39    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4026    test auc: 0.3570  acc: 0.3967, time: 0.5600
epoch 40    train auc: 0.5972  acc: 0.5669    eval auc: 0.3633  acc: 0.4003    test auc: 0.3573  acc: 0.3991, time: 0.9090
epoch 41    train auc: 0.5972  acc: 0.5669    eval auc: 0.3635  acc: 0.4028    test auc: 0.3572  acc: 0.3966, time: 0.5550
epoch 42    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4016    test auc: 0.3573  acc: 0.3978, time: 0.9160
epoch 43    train auc: 0.5972  acc: 0.5669    eval auc: 0.3634  acc: 0.4015    test auc: 0.3572  acc: 0.3979, time: 0.5780
epoch 44    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4009    test auc: 0.3571  acc: 0.3985, time: 0.9430
epoch 45    train auc: 0.5972  acc: 0.5669    eval auc: 0.3637  acc: 0.4036    test auc: 0.3571  acc: 0.3958, time: 0.5750
epoch 46    train auc: 0.5973  acc: 0.5669    eval auc: 0.3635  acc: 0.4019    test auc: 0.3574  acc: 0.3974, time: 0.9310
epoch 47    train auc: 0.5972  acc: 0.5669    eval auc: 0.3636  acc: 0.4010    test auc: 0.3572  acc: 0.3984, time: 0.5650
epoch 48    train auc: 0.5973  acc: 0.5669    eval auc: 0.3635  acc: 0.4041    test auc: 0.3573  acc: 0.3953, time: 0.9210
epoch 49    train auc: 0.5973  acc: 0.5669    eval auc: 0.3634  acc: 0.3998    test auc: 0.3574  acc: 0.3996, time: 0.5540
avg time per epoch : 0.7657578325271607
--- 48.80203914642334 seconds to train and predict model ---
VALUES:{'H': 1, 'L': 1, 'batch_size': 256, 'conv_layer_filters': 16, 'dense_layer_filters': 16, 'dim': 16, 'kge_interval': 2, 'l2_weight': 1e-07, 'lr_kge': 2e-05, 'lr_rs': 0.0002}
reading rating file ...
splitting dataset ...
reading KG file ...
data loaded.
2021-06-25 22:48:28.620365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-25 22:48:28.620703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]
epoch 0    train auc: 0.5237  acc: 0.5030    eval auc: 0.4821  acc: 0.4976    test auc: 0.4697  acc: 0.4933, time: 1.2200
epoch 1    train auc: 0.5395  acc: 0.5090    eval auc: 0.4593  acc: 0.4884    test auc: 0.4504  acc: 0.4851, time: 0.5700
epoch 2    train auc: 0.5549  acc: 0.5147    eval auc: 0.4367  acc: 0.4766    test auc: 0.4293  acc: 0.4810, time: 0.9120
epoch 3    train auc: 0.5707  acc: 0.5256    eval auc: 0.4184  acc: 0.4631    test auc: 0.4085  acc: 0.4644, time: 0.5690
epoch 4    train auc: 0.5873  acc: 0.5569    eval auc: 0.4122  acc: 0.4381    test auc: 0.4052  acc: 0.4304, time: 0.9170
epoch 5    train auc: 0.6385  acc: 0.5958    eval auc: 0.4509  acc: 0.4677    test auc: 0.4496  acc: 0.4626, time: 0.5470
epoch 6    train auc: 0.7525  acc: 0.6804    eval auc: 0.5878  acc: 0.5644    test auc: 0.5971  acc: 0.5689, time: 0.9030
epoch 7    train auc: 0.8352  acc: 0.7430    eval auc: 0.6922  acc: 0.6615    test auc: 0.6992  acc: 0.6719, time: 0.5470
epoch 8    train auc: 0.8701  acc: 0.7491    eval auc: 0.7360  acc: 0.7092    test auc: 0.7403  acc: 0.7174, time: 0.8950
epoch 9    train auc: 0.8842  acc: 0.7803    eval auc: 0.7557  acc: 0.7135    test auc: 0.7583  acc: 0.7204, time: 0.5440
epoch 10    train auc: 0.8918  acc: 0.7938    eval auc: 0.7654  acc: 0.7140    test auc: 0.7677  acc: 0.7145, time: 0.8980
epoch 11    train auc: 0.8964  acc: 0.7944    eval auc: 0.7696  acc: 0.7189    test auc: 0.7709  acc: 0.7179, time: 0.5450
epoch 12    train auc: 0.9000  acc: 0.7933    eval auc: 0.7730  acc: 0.7225    test auc: 0.7735  acc: 0.7263, time: 0.8890
epoch 13    train auc: 0.9034  acc: 0.8041    eval auc: 0.7754  acc: 0.7197    test auc: 0.7759  acc: 0.7161, time: 0.5500
epoch 14    train auc: 0.9060  acc: 0.8047    eval auc: 0.7774  acc: 0.7205    test auc: 0.7774  acc: 0.7172, time: 0.8740
epoch 15    train auc: 0.9085  acc: 0.8086    eval auc: 0.7782  acc: 0.7192    test auc: 0.7780  acc: 0.7159, time: 0.5350
epoch 16    train auc: 0.9106  acc: 0.8059    eval auc: 0.7792  acc: 0.7212    test auc: 0.7783  acc: 0.7204, time: 0.8690
epoch 17    train auc: 0.9132  acc: 0.8157    eval auc: 0.7795  acc: 0.7161    test auc: 0.7789  acc: 0.7099, time: 0.5420
epoch 18    train auc: 0.9147  acc: 0.8098    eval auc: 0.7800  acc: 0.7198    test auc: 0.7786  acc: 0.7194, time: 0.8620
epoch 19    train auc: 0.9170  acc: 0.8176    eval auc: 0.7798  acc: 0.7139    test auc: 0.7785  acc: 0.7098, time: 0.5360
epoch 20    train auc: 0.9185  acc: 0.8151    eval auc: 0.7793  acc: 0.7165    test auc: 0.7776  acc: 0.7131, time: 0.8800
epoch 21    train auc: 0.9203  acc: 0.8198    eval auc: 0.7788  acc: 0.7135    test auc: 0.7771  acc: 0.7056, time: 0.5290
epoch 22    train auc: 0.9214  acc: 0.8180    eval auc: 0.7792  acc: 0.7172    test auc: 0.7766  acc: 0.7124, time: 0.8520
epoch 23    train auc: 0.9231  acc: 0.8225    eval auc: 0.7781  acc: 0.7118    test auc: 0.7758  acc: 0.7039, time: 0.5490
epoch 24    train auc: 0.9241  acc: 0.8213    eval auc: 0.7785  acc: 0.7134    test auc: 0.7758  acc: 0.7080, time: 0.8550
epoch 25    train auc: 0.9253  acc: 0.8244    eval auc: 0.7779  acc: 0.7099    test auc: 0.7751  acc: 0.7043, time: 0.5210
epoch 26    train auc: 0.9263  acc: 0.8230    eval auc: 0.7779  acc: 0.7111    test auc: 0.7746  acc: 0.7059, time: 0.8590
epoch 27    train auc: 0.9274  acc: 0.8256    eval auc: 0.7764  acc: 0.7082    test auc: 0.7734  acc: 0.7013, time: 0.5240
epoch 28    train auc: 0.9283  acc: 0.8262    eval auc: 0.7765  acc: 0.7068    test auc: 0.7731  acc: 0.7015, time: 0.8460
epoch 29    train auc: 0.9291  acc: 0.8260    eval auc: 0.7763  acc: 0.7067    test auc: 0.7727  acc: 0.7039, time: 0.5280
epoch 30    train auc: 0.9299  acc: 0.8285    eval auc: 0.7754  acc: 0.7041    test auc: 0.7719  acc: 0.7001, time: 0.8420
epoch 31    train auc: 0.9308  acc: 0.8295    eval auc: 0.7738  acc: 0.7027    test auc: 0.7700  acc: 0.6998, time: 0.5070
epoch 32    train auc: 0.9310  acc: 0.8260    eval auc: 0.7750  acc: 0.7078    test auc: 0.7708  acc: 0.7050, time: 0.8390
epoch 33    train auc: 0.9321  acc: 0.8304    eval auc: 0.7736  acc: 0.7027    test auc: 0.7697  acc: 0.7007, time: 0.5250
epoch 34    train auc: 0.9328  acc: 0.8310    eval auc: 0.7730  acc: 0.7020    test auc: 0.7693  acc: 0.6982, time: 0.8390
epoch 35    train auc: 0.9334  acc: 0.8326    eval auc: 0.7722  acc: 0.7002    test auc: 0.7686  acc: 0.6981, time: 0.5150
epoch 36    train auc: 0.9334  acc: 0.8293    eval auc: 0.7736  acc: 0.7026    test auc: 0.7697  acc: 0.7021, time: 0.8420
epoch 37    train auc: 0.9343  acc: 0.8352    eval auc: 0.7705  acc: 0.6982    test auc: 0.7675  acc: 0.6939, time: 0.5090
epoch 38    train auc: 0.9346  acc: 0.8319    eval auc: 0.7718  acc: 0.7014    test auc: 0.7678  acc: 0.6980, time: 0.8480
epoch 39    train auc: 0.9357  acc: 0.8366    eval auc: 0.7693  acc: 0.6982    test auc: 0.7659  acc: 0.6943, time: 0.5130
epoch 40    train auc: 0.9357  acc: 0.8330    eval auc: 0.7709  acc: 0.7009    test auc: 0.7674  acc: 0.6994, time: 0.8370
epoch 41    train auc: 0.9366  acc: 0.8375    eval auc: 0.7684  acc: 0.6970    test auc: 0.7654  acc: 0.6937, time: 0.5160
epoch 42    train auc: 0.9367  acc: 0.8352    eval auc: 0.7692  acc: 0.6994    test auc: 0.7658  acc: 0.6974, time: 0.8310
epoch 43    train auc: 0.9374  acc: 0.8365    eval auc: 0.7680  acc: 0.6988    test auc: 0.7648  acc: 0.6954, time: 0.5090
epoch 44    train auc: 0.9376  acc: 0.8362    eval auc: 0.7683  acc: 0.6996    test auc: 0.7651  acc: 0.6949, time: 0.8270
epoch 45    train auc: 0.9379  acc: 0.8363    eval auc: 0.7678  acc: 0.6985    test auc: 0.7644  acc: 0.6949, time: 0.5140
epoch 46    train auc: 0.9385  acc: 0.8376    eval auc: 0.7673  acc: 0.6972    test auc: 0.7641  acc: 0.6934, time: 0.8250
epoch 47    train auc: 0.9390  acc: 0.8393    eval auc: 0.7662  acc: 0.6972    test auc: 0.7635  acc: 0.6926, time: 0.5130
epoch 48    train auc: 0.9395  acc: 0.8406    eval auc: 0.7653  acc: 0.6957    test auc: 0.7625  acc: 0.6911, time: 0.8260
epoch 49    train auc: 0.9396  acc: 0.8396    eval auc: 0.7654  acc: 0.6962    test auc: 0.7627  acc: 0.6918, time: 0.5080
avg time per epoch : 0.7030392456054687
--- 44.80999803543091 seconds to train and predict model ---

Process finished with exit code 0
